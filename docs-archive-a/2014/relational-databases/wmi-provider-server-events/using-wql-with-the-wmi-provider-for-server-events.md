---
title: Usar WQL con el proveedor WMI para eventos de servidor | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- queries [WMI]
- query language [WMI]
- WMI Query Language [WMI]
- WQL [WMI]
- WMI Provider for Server Events, WQL
ms.assetid: 58b67426-1e66-4445-8e2c-03182e94c4be
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: df2bbf5c6031781494695f95116441fde34bf4f5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672833"
---
# <a name="using-wql-with-the-wmi-provider-for-server-events"></a><span data-ttu-id="a4078-102">Usar WQL con el proveedor WMI para eventos de servidor</span><span class="sxs-lookup"><span data-stu-id="a4078-102">Using WQL with the WMI Provider for Server Events</span></span>
  <span data-ttu-id="a4078-103">Las aplicaciones de administración tienen acceso a los eventos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] que utilizan el proveedor WMI de eventos de servidor emitiendo instrucciones WQL (Lenguaje de consulta de WMI).</span><span class="sxs-lookup"><span data-stu-id="a4078-103">Management applications access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] events using the WMI Provider for Server Events by issuing WMI Query Language (WQL) statements.</span></span> <span data-ttu-id="a4078-104">WQL es un subconjunto simplificado de lenguaje de consulta estructurado (SQL) con algunas extensiones específicas de WMI.</span><span class="sxs-lookup"><span data-stu-id="a4078-104">WQL is a simplified subset of structured query language (SQL), with some WMI-specific extensions.</span></span> <span data-ttu-id="a4078-105">Al utilizar WQL, una aplicación recupera un tipo de evento con una instancia concreta de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], una base de datos o un objeto de base de datos (el único objeto actualmente admitido es la cola).</span><span class="sxs-lookup"><span data-stu-id="a4078-105">In using WQL, an application retrieves an event type against a specific instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], a database, or a database object (the only object currently supported is queue).</span></span> <span data-ttu-id="a4078-106">El proveedor WMI de eventos de servidor convierte la consulta en una notificación de eventos que se crea en la base de datos de destino para las notificaciones de eventos de ámbito de base de datos o de ámbito de objeto, o en la base de datos **maestra** para las notificaciones de eventos de ámbito de servidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-106">The WMI Provider for Server Events translates the query into an event notification that is created in the target database for database-scoped or object-scoped event notifications, or in the **master** database for server-scoped event notifications.</span></span>  
  
 <span data-ttu-id="a4078-107">Por ejemplo, considere la siguiente consulta WQL:</span><span class="sxs-lookup"><span data-stu-id="a4078-107">For example, consider the following WQL query:</span></span>  
  
```  
SELECT * FROM DDL_DATABASE_LEVEL_EVENTS WHERE DatabaseName = 'AdventureWorks'  
```  
  
 <span data-ttu-id="a4078-108">En esta consulta, el proveedor WMI intenta generar el equivalente de esta notificación de eventos en el servidor de destino:</span><span class="sxs-lookup"><span data-stu-id="a4078-108">From this query, the WMI Provider tries to produce the equivalent of this event notification on the target server:</span></span>  
  
```  
USE AdventureWorks ;  
GO  
  
CREATE EVENT NOTIFICATION SQLWEP_76CF38C1_18BB_42DD_A7DC_C8820155B0E9  
    ON DATABASE  
    WITH FAN_IN  
    FOR DDL_DATABASE_LEVEL_EVENTS  
    TO SERVICE   
        'SQL/Notifications/ProcessWMIEventProviderNotification/v1.0',  
        'A7E5521A-1CA6-4741-865D-826F804E5135';  
GO  
```  
  
 <span data-ttu-id="a4078-109">El argumento de la cláusula `FROM` de la consulta WQL (`DDL_DATABASE_LEVEL_EVENTS`) puede ser cualquier evento válido en el que se pueda crear una notificación de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4078-109">The argument in the `FROM` clause of the WQL query (`DDL_DATABASE_LEVEL_EVENTS`) can be any valid event upon which an event notification can be created.</span></span> <span data-ttu-id="a4078-110">Los argumentos de las cláusulas `SELECT` y `WHERE` pueden especificar cualquier propiedad de evento asociada a un evento o a su evento principal.</span><span class="sxs-lookup"><span data-stu-id="a4078-110">The arguments in the `SELECT` and `WHERE` clauses can specify any event property associated with an event or its parent event.</span></span> <span data-ttu-id="a4078-111">Para obtener una lista de eventos y propiedades de evento válidos, vea [notificaciones de eventos (motor de base de datos)](https://technet.microsoft.com/library/ms182602.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4078-111">For a list of valid events and event properties, see [Event Notifications (Database Engine)](https://technet.microsoft.com/library/ms182602.aspx).</span></span>  
  
 <span data-ttu-id="a4078-112">El proveedor WMI de eventos de servidor admite explícitamente la sintaxis WQL siguiente.</span><span class="sxs-lookup"><span data-stu-id="a4078-112">The following WQL syntax is supported explicitly by the WMI Provider for Server Events.</span></span> <span data-ttu-id="a4078-113">Se puede especificar sintaxis WQL adicional, pero no es específica de este proveedor y es analizada en su lugar por el servicio de host de WMI.</span><span class="sxs-lookup"><span data-stu-id="a4078-113">Additional WQL syntax may be specified, but it is not specific to this provider and is parsed instead by the WMI host service.</span></span> <span data-ttu-id="a4078-114">Para obtener más información acerca del Lenguaje de consulta de WMI, vea la documentación de WQL en Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="a4078-114">For more information about the WMI Query Language, see the WQL documentation on the Microsoft Developer Network (MSDN).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="a4078-115">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="a4078-115">Syntax</span></span>  
  
```  
  
SELECT { event_property [ ,...n ] | * }  
FROM event_type   
WHERE where_condition  
```  
  
## <a name="arguments"></a><span data-ttu-id="a4078-116">Argumentos</span><span class="sxs-lookup"><span data-stu-id="a4078-116">Arguments</span></span>  
 <span data-ttu-id="a4078-117">*event_property*</span><span class="sxs-lookup"><span data-stu-id="a4078-117">*event_property*</span></span>  
 <span data-ttu-id="a4078-118">Es una propiedad de un evento.</span><span class="sxs-lookup"><span data-stu-id="a4078-118">Is a property of an event.</span></span> <span data-ttu-id="a4078-119">Entre los ejemplos se incluyen `PostTime`, `SPID` y `LoginName`.</span><span class="sxs-lookup"><span data-stu-id="a4078-119">Examples include `PostTime`, `SPID`, and `LoginName`.</span></span> <span data-ttu-id="a4078-120">Busque todos los eventos enumerados en el [proveedor WMI para las clases y propiedades de eventos de servidor](wmi-provider-for-server-events-classes-and-properties.md) para determinar qué propiedades contiene.</span><span class="sxs-lookup"><span data-stu-id="a4078-120">Look up each event listed in [WMI Provider for Server Events Classes and Properties](wmi-provider-for-server-events-classes-and-properties.md) to determine which properties it holds.</span></span> <span data-ttu-id="a4078-121">Por ejemplo, el evento DDL_DATABASE_LEVEL_EVENTS contiene las propiedades `DatabaseName` y `UserName`.</span><span class="sxs-lookup"><span data-stu-id="a4078-121">For example, the DDL_DATABASE_LEVEL_EVENTS event holds the `DatabaseName` and `UserName` properties.</span></span> <span data-ttu-id="a4078-122">También hereda las propiedades `SQLInstance`, `LoginName`, `PostTime`, `SPID` y `ComputerName` de sus eventos principales.</span><span class="sxs-lookup"><span data-stu-id="a4078-122">It also inherits the `SQLInstance`, `LoginName`, `PostTime`, `SPID`, and `ComputerName` properties from its parent events.</span></span>  
  
 <span data-ttu-id="a4078-123">**,** *... n*</span><span class="sxs-lookup"><span data-stu-id="a4078-123">**,** *...n*</span></span>  
 <span data-ttu-id="a4078-124">Indica que *event_property* se pueden consultar varias veces, separadas por comas.</span><span class="sxs-lookup"><span data-stu-id="a4078-124">Indicates that *event_property* can be queried multiple times, separated by commas.</span></span>  
  
 \*  
 <span data-ttu-id="a4078-125">Especifica que se consultan todas las propiedades asociadas a un evento.</span><span class="sxs-lookup"><span data-stu-id="a4078-125">Specifies that all properties associated with an event are queried.</span></span>  
  
 <span data-ttu-id="a4078-126">*event_type*</span><span class="sxs-lookup"><span data-stu-id="a4078-126">*event_type*</span></span>  
 <span data-ttu-id="a4078-127">Es cualquier evento sobre el que se puede crear una notificación de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4078-127">Is any event against which an event notification can be created.</span></span> <span data-ttu-id="a4078-128">Para obtener una lista de eventos disponibles, vea [proveedor WMI para las clases y propiedades de eventos de servidor](https://technet.microsoft.com/library/ms186449.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4078-128">For a list of available events, see [WMI Provider for Server Events Classes and Properties](https://technet.microsoft.com/library/ms186449.aspx).</span></span> <span data-ttu-id="a4078-129">Tenga en cuenta que los nombres de *tipo de evento* corresponden al mismo *event_type*  |  *event_group* que se pueden especificar al crear manualmente una notificación de eventos mediante la creación de una notificación de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4078-129">Note that *event type* names correspond to the same *event_type* | *event_group* that can be specified when you manually create an event notification by using CREATE EVENT NOTIFICATION.</span></span> <span data-ttu-id="a4078-130">Entre los ejemplos de *tipos de evento* se incluyen CREATE_TABLE, LOCK_DEADLOCK, DDL_USER_EVENTS y TRC_DATABASE.</span><span class="sxs-lookup"><span data-stu-id="a4078-130">Examples of *event type* include CREATE_TABLE, LOCK_DEADLOCK, DDL_USER_EVENTS, and TRC_DATABASE.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a4078-131">Determinados procedimientos almacenados del sistema que realizan operaciones similares a DDL también pueden activar notificaciones de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4078-131">Certain system stored procedures that perform DDL-like operations can also fire event notifications.</span></span> <span data-ttu-id="a4078-132">Pruebe las notificaciones de eventos para determinar su respuesta a los procedimientos almacenados del sistema que se ejecutan.</span><span class="sxs-lookup"><span data-stu-id="a4078-132">Test your event notifications to determine their responses to system stored procedures that are run.</span></span> <span data-ttu-id="a4078-133">Por ejemplo, la instrucción CREATE TYPE y **sp_addtype** procedimiento almacenado activarán una notificación de eventos que se crea en un evento de CREATE_TYPE.</span><span class="sxs-lookup"><span data-stu-id="a4078-133">For example, the CREATE TYPE statement and **sp_addtype** stored procedure will both fire an event notification that is created on a CREATE_TYPE event.</span></span> <span data-ttu-id="a4078-134">Sin embargo, el **sp_rename** procedimiento almacenado no activa ninguna notificación de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4078-134">However, the **sp_rename** stored procedure does not fire any event notifications.</span></span> <span data-ttu-id="a4078-135">Para obtener más información, vea[eventos DDL](../triggers/ddl-events.md).</span><span class="sxs-lookup"><span data-stu-id="a4078-135">For more information, see[DDL Events](../triggers/ddl-events.md).</span></span>  
  
 <span data-ttu-id="a4078-136">*where_condition*</span><span class="sxs-lookup"><span data-stu-id="a4078-136">*where_condition*</span></span>  
 <span data-ttu-id="a4078-137">Es un predicado de consulta de la cláusula WHERE formado por nombres de *event_property* y operadores lógicos y de comparación.</span><span class="sxs-lookup"><span data-stu-id="a4078-137">Is a WHERE clause query predicate made up of *event_property* names and logical and comparison operators.</span></span> <span data-ttu-id="a4078-138">El *where_condition* determina el ámbito en el que se registra la notificación de eventos correspondiente en la base de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="a4078-138">The *where_condition* determines the scope in which the corresponding event notification is registered in the target database.</span></span> <span data-ttu-id="a4078-139">También puede actuar como un filtro para tener como destino un esquema o un objeto determinado desde el que consultar *event_type.*</span><span class="sxs-lookup"><span data-stu-id="a4078-139">It can also act as a filter to target a particular schema or object from which to query *event_type.*</span></span> <span data-ttu-id="a4078-140">Para obtener más información, vea la sección Comentarios más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="a4078-140">For more information, see the Remarks section later in this topic.</span></span>  
  
 <span data-ttu-id="a4078-141">Solo se puede utilizar el operando `=` junto con `DatabaseName`, `SchemaName` y `ObjectName`.</span><span class="sxs-lookup"><span data-stu-id="a4078-141">Only the `=` operand can be used together with `DatabaseName`, `SchemaName`, and `ObjectName`.</span></span> <span data-ttu-id="a4078-142">Otras expresiones no se pueden utilizar con estas propiedades de evento.</span><span class="sxs-lookup"><span data-stu-id="a4078-142">Other expressions cannot be used with these event properties.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="a4078-143">Observaciones</span><span class="sxs-lookup"><span data-stu-id="a4078-143">Remarks</span></span>  
 <span data-ttu-id="a4078-144">La *where_condition* de la sintaxis del proveedor WMI para eventos de servidor determina lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="a4078-144">The *where_condition* of the WMI Provider for Server Events syntax determines the following:</span></span>  
  
-   <span data-ttu-id="a4078-145">El ámbito por el que el proveedor intenta recuperar el *event_type*especificado: el nivel de servidor, el nivel de base de datos o el nivel de objeto (el único objeto actualmente admitido es la cola).</span><span class="sxs-lookup"><span data-stu-id="a4078-145">The scope by which the provider tries to retrieve the specified *event_type*: the server level, database level, or object level (the only object currently supported is queue).</span></span> <span data-ttu-id="a4078-146">Finalmente, este ámbito determina el tipo de notificación de eventos creado en la base de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="a4078-146">Ultimately, this scope determines the type of event notification created in the target database.</span></span> <span data-ttu-id="a4078-147">Este proceso efectuó una llamada al registro de notificación de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4078-147">This process called event notification registration.</span></span>  
  
-   <span data-ttu-id="a4078-148">La base de datos, el esquema y el objeto, según corresponda, en que registrarse.</span><span class="sxs-lookup"><span data-stu-id="a4078-148">The database, schema, and object, where appropriate, on which to register.</span></span>  
  
 <span data-ttu-id="a4078-149">El proveedor WMI de eventos de servidor usa un algoritmo ascendente de tipo "el primero que sea válido" para generar un ámbito lo más restringido posible para la EVENT NOTIFICATION subyacente.</span><span class="sxs-lookup"><span data-stu-id="a4078-149">The WMI Provider for Server Events uses a bottom-up, first-fit algorithm to produce the narrowest possible scope for the underlying EVENT NOTIFICATION.</span></span> <span data-ttu-id="a4078-150">El algoritmo intenta minimizar la actividad interna en el tráfico del servidor y de la red entre la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] y el proceso de host de WMI.</span><span class="sxs-lookup"><span data-stu-id="a4078-150">The algorithm tries to minimize internal activity on the server and network traffic between the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the WMI host process.</span></span> <span data-ttu-id="a4078-151">El proveedor examina el *event_type* especificado en la cláusula FROM y las condiciones de la cláusula WHERE e intenta registrar la notificación de eventos subyacente con el ámbito más restringido posible.</span><span class="sxs-lookup"><span data-stu-id="a4078-151">The provider examines the *event_type* specified in the FROM clause and the conditions in the WHERE clause, and tries to register the underlying EVENT NOTIFICATION with the narrowest possible scope.</span></span> <span data-ttu-id="a4078-152">Si el proveedor no se puede registrar en el ámbito más restringido, intenta registrarse en ámbitos superiores consecutivamente hasta que el registro resulta satisfactorio finalmente.</span><span class="sxs-lookup"><span data-stu-id="a4078-152">If the provider cannot register at the narrowest scope, it tries to register at successively higher scopes until a registration finally succeeds.</span></span> <span data-ttu-id="a4078-153">Si llega al ámbito superior en el nivel de servidor y se produce un error, devuelve un error al consumidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-153">If it reaches the highest scope the server-level) and fails, it returns an error to the consumer.</span></span>  
  
 <span data-ttu-id="a4078-154">Por ejemplo, si se especifica DatabaseName =**'** AdventureWorks **'** en la cláusula WHERE, el proveedor intenta registrar una notificación de eventos en la [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] base de datos.</span><span class="sxs-lookup"><span data-stu-id="a4078-154">For example, if DatabaseName=**'** AdventureWorks **'** is specified in the WHERE clause, the provider tries to register an event notification in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="a4078-155">Si la base de datos [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] existe y el cliente que realiza la llamada tiene los permisos necesarios para crear una notificación de eventos en [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)], el registro es satisfactorio.</span><span class="sxs-lookup"><span data-stu-id="a4078-155">If the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database exists and the calling client has the required permissions to create an event notification in [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)], the registration is successful.</span></span> <span data-ttu-id="a4078-156">De lo contrario, se intenta registrar la notificación de eventos en el nivel de servidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-156">Otherwise, an attempt is made to register the event notification at the server level.</span></span> <span data-ttu-id="a4078-157">El registro es satisfactorio si el cliente de WMI tiene los permisos necesarios.</span><span class="sxs-lookup"><span data-stu-id="a4078-157">The registration succeeds if the WMI client has the required permissions.</span></span> <span data-ttu-id="a4078-158">Sin embargo, en esta situación, los eventos no se devuelven al cliente hasta que no se haya creado la base de datos [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a4078-158">However, under this scenario, events are not returned to the client until the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database has been created.</span></span>  
  
 <span data-ttu-id="a4078-159">El *where_condition* también puede actuar como filtro para limitar además la consulta a una base de datos, un esquema o un objeto específicos.</span><span class="sxs-lookup"><span data-stu-id="a4078-159">The *where_condition* can also act as a filter to additionally limit the query to a specific database, schema, or object.</span></span> <span data-ttu-id="a4078-160">Por ejemplo, considere la siguiente consulta WQL:</span><span class="sxs-lookup"><span data-stu-id="a4078-160">For example, consider the following WQL query:</span></span>  
  
```  
SELECT * FROM ALTER_TABLE   
WHERE DatabaseName = 'AdventureWorks' AND SchemaName = 'Sales'   
    AND ObjectType='Table' AND ObjectName = 'SalesOrderDetail'  
```  
  
 <span data-ttu-id="a4078-161">Dependiendo del resultado del proceso de registro, esta consulta WQL se puede registrar en el nivel de base de datos o de servidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-161">Depending on the outcome of the registration process, this WQL query may be registered either at the database or server level.</span></span> <span data-ttu-id="a4078-162">Sin embargo, aunque se registre en el nivel del servidor, el proveedor filtra finalmente los eventos `ALTER_TABLE` que no se aplican a la tabla `AdventureWorks.Sales.SalesOrderDetail`.</span><span class="sxs-lookup"><span data-stu-id="a4078-162">However, even if it is registered at the server level, the provider ultimately filters any `ALTER_TABLE` events that do not apply to the `AdventureWorks.Sales.SalesOrderDetail` table.</span></span> <span data-ttu-id="a4078-163">En otras palabras, el proveedor devuelve solamente las propiedades de los eventos `ALTER_TABLE` que se producen en esa tabla concreta.</span><span class="sxs-lookup"><span data-stu-id="a4078-163">In other words, the provider returns only the properties of the `ALTER_TABLE` events that occur on that specific table.</span></span>  
  
 <span data-ttu-id="a4078-164">Si se especifica una expresión compuesta como `DatabaseName='AW1'` OR `DatabaseName='AW2'`, se intenta registrar una notificación de eventos única en el ámbito de servidor en lugar de dos notificaciones de eventos independientes.</span><span class="sxs-lookup"><span data-stu-id="a4078-164">If a compound expression such as `DatabaseName='AW1'` OR `DatabaseName='AW2'` is specified, an attempt is made to register a single event notification at the server scope instead of two separate event notifications.</span></span> <span data-ttu-id="a4078-165">El registro es satisfactorio si el cliente que realiza la llamada tiene permisos.</span><span class="sxs-lookup"><span data-stu-id="a4078-165">The registration succeeds if the calling client has permissions.</span></span>  
  
 <span data-ttu-id="a4078-166">Si `SchemaName='X' AND ObjectType='Y' AND ObjectName='Z'` se especifican todos en la `WHERE` cláusula, se intenta registrar la notificación de eventos directamente en el objeto `Z` en el esquema `X` .</span><span class="sxs-lookup"><span data-stu-id="a4078-166">If `SchemaName='X' AND ObjectType='Y' AND ObjectName='Z'` are all specified in the `WHERE` clause, an attempt is made to register the event notification directly on object `Z` in schema `X`.</span></span> <span data-ttu-id="a4078-167">El registro es satisfactorio si el cliente que realiza la llamada tiene permisos.</span><span class="sxs-lookup"><span data-stu-id="a4078-167">The registration succeeds if the client has permissions.</span></span> <span data-ttu-id="a4078-168">Tenga en cuenta que, actualmente, los eventos de nivel de objeto solo se admiten en las colas y solo en el *event_type*de QUEUE_ACTIVATION.</span><span class="sxs-lookup"><span data-stu-id="a4078-168">Note that currently, object-level events are supported only on queues, and only for the QUEUE_ACTIVATION *event_type*.</span></span>  
  
 <span data-ttu-id="a4078-169">Observe que no todos los eventos se pueden consultar en cualquier ámbito determinado.</span><span class="sxs-lookup"><span data-stu-id="a4078-169">Note that not all events can be queried at any particular scope.</span></span> <span data-ttu-id="a4078-170">Por ejemplo, una consulta WQL en un evento de seguimiento como Lock_Deadlock o un grupo de eventos de seguimiento como TRC_LOCKS, solo se puede registrar en el nivel de servidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-170">For example, a WQL query on a trace event such as Lock_Deadlock, or a trace event group such as TRC_LOCKS, can only be registered at the server level.</span></span> <span data-ttu-id="a4078-171">De forma similar, el evento CREATE_ENDPOINT y el grupo de eventos DDL_ENDPOINT_EVENTS también se pueden registrar solo en el nivel de servidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-171">Similarly, the CREATE_ENDPOINT event and the DDL_ENDPOINT_EVENTS event group can also be registered only at the server level.</span></span> <span data-ttu-id="a4078-172">Para obtener más información acerca del ámbito adecuado para registrar eventos, consulte [diseño de notificaciones de eventos](https://technet.microsoft.com/library/ms175854\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="a4078-172">For more information about the appropriate scope for registering events, see [Designing Event Notifications](https://technet.microsoft.com/library/ms175854\(v=sql.105\).aspx).</span></span> <span data-ttu-id="a4078-173">Un intento de registrar una consulta WQL cuyo *event_type* solo se puede registrar en el nivel de servidor siempre se realiza en el nivel de servidor.</span><span class="sxs-lookup"><span data-stu-id="a4078-173">An attempt to register a WQL query whose *event_type* can only be registered at the server level is always made at the server level.</span></span> <span data-ttu-id="a4078-174">El registro es satisfactorio si el cliente de WMI tiene permisos.</span><span class="sxs-lookup"><span data-stu-id="a4078-174">Registration succeeds if the WMI client has permissions.</span></span> <span data-ttu-id="a4078-175">De lo contrario, se devuelve un error al cliente.</span><span class="sxs-lookup"><span data-stu-id="a4078-175">Otherwise, an error is returned to the client.</span></span> <span data-ttu-id="a4078-176">En algunos casos, sin embargo, puede utilizar todavía la cláusula WHERE como filtro para los eventos en el nivel de servidor basados en las propiedades que corresponden al evento.</span><span class="sxs-lookup"><span data-stu-id="a4078-176">In some cases, however, you can still use the WHERE clause as a filter for server-level events based on the properties that correspond to the event.</span></span> <span data-ttu-id="a4078-177">Por ejemplo, muchos eventos de seguimiento tienen una propiedad `DatabaseName` que se puede utilizar en la cláusula WHERE como filtro.</span><span class="sxs-lookup"><span data-stu-id="a4078-177">For example, many trace events have a `DatabaseName` property that can be used in the WHERE clause as a filter.</span></span>  
  
 <span data-ttu-id="a4078-178">Las notificaciones de eventos de ámbito de servidor se crean en la base de datos **maestra** y se pueden consultar los metadatos mediante la vista de catálogo [Sys. server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="a4078-178">Server-scoped event notifications are created in the **master** database and can be queried for metadata by using the [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) catalog view.</span></span>  
  
 <span data-ttu-id="a4078-179">Las notificaciones de eventos de ámbito de base de datos o de ámbito de objeto se crean en la base de datos especificada y se pueden consultar para los metadatos mediante la vista de catálogo [Sys. event_notifications](/sql/relational-databases/system-catalog-views/sys-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="a4078-179">Database-scoped or object-scoped event notifications are created in the specified database and can be queried for metadata by using the [sys.event_notifications](/sql/relational-databases/system-catalog-views/sys-event-notifications-transact-sql) catalog view.</span></span> <span data-ttu-id="a4078-180">(Debe anteponer a la vista de catálogo el nombre de la base de datos correspondiente).</span><span class="sxs-lookup"><span data-stu-id="a4078-180">(You must prefix the catalog view with the corresponding database name.)</span></span>  
  
## <a name="examples"></a><span data-ttu-id="a4078-181">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="a4078-181">Examples</span></span>  
  
### <a name="a-querying-for-events-at-the-server-scope"></a><span data-ttu-id="a4078-182">A.</span><span class="sxs-lookup"><span data-stu-id="a4078-182">A.</span></span> <span data-ttu-id="a4078-183">Consultar eventos en el ámbito de servidor</span><span class="sxs-lookup"><span data-stu-id="a4078-183">Querying for events at the server scope</span></span>  
 <span data-ttu-id="a4078-184">La consulta WQL siguiente recupera todas las propiedades de evento de los eventos de seguimiento `SERVER_MEMORY_CHANGE` que se produzcan en la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a4078-184">The following WQL query retrieves all event properties for any `SERVER_MEMORY_CHANGE` trace event that occurs on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
```  
SELECT * FROM SERVER_MEMORY_CHANGE  
```  
  
### <a name="b-querying-for-events-at-the-database-scope"></a><span data-ttu-id="a4078-185">B.</span><span class="sxs-lookup"><span data-stu-id="a4078-185">B.</span></span> <span data-ttu-id="a4078-186">Consultar eventos en el ámbito de base de datos</span><span class="sxs-lookup"><span data-stu-id="a4078-186">Querying for events at the database scope</span></span>  
 <span data-ttu-id="a4078-187">La consulta WQL siguiente recupera propiedades de evento concretas de los eventos que se produzcan en la base de datos `AdventureWorks` y existan bajo el grupo de eventos `DDL_DATABASE_LEVEL_EVENTS`.</span><span class="sxs-lookup"><span data-stu-id="a4078-187">The following WQL query retrieves specific event properties for any event that occurs in the `AdventureWorks` database and exists under the `DDL_DATABASE_LEVEL_EVENTS` event group.</span></span>  
  
```  
SELECT SPID, SQLInstance, DatabaseName FROM DDL_DATABASE_LEVEL_EVENTS   
WHERE DatabaseName = 'AdventureWorks'   
```  
  
### <a name="c-querying-for-events-at-the-database-scope-filtering-by-schema-and-object"></a><span data-ttu-id="a4078-188">C.</span><span class="sxs-lookup"><span data-stu-id="a4078-188">C.</span></span> <span data-ttu-id="a4078-189">Consultar eventos en el ámbito de base de datos, filtrar por esquema y objeto</span><span class="sxs-lookup"><span data-stu-id="a4078-189">Querying for events at the database scope, filtering by schema and object</span></span>  
 <span data-ttu-id="a4078-190">La consulta siguiente recupera todas las propiedades de evento de los eventos `ALTER_TABLE` que se produzcan en la tabla `AdventureWorks.Sales.SalesOrderDetail`.</span><span class="sxs-lookup"><span data-stu-id="a4078-190">The following query retrieves all event properties for any `ALTER_TABLE` event that occurs on table `AdventureWorks.Sales.SalesOrderDetail`.</span></span>  
  
```  
SELECT * FROM ALTER_TABLE   
WHERE DatabaseName = 'AdventureWorks' AND SchemaName = 'Sales'   
    AND ObjectType='Table' AND ObjectName = 'SalesOrderDetail'  
```  
  
## <a name="see-also"></a><span data-ttu-id="a4078-191">Consulte también</span><span class="sxs-lookup"><span data-stu-id="a4078-191">See Also</span></span>  
 <span data-ttu-id="a4078-192">[Conceptos del proveedor WMI para eventos de servidor](https://technet.microsoft.com/library/ms180560.aspx) </span><span class="sxs-lookup"><span data-stu-id="a4078-192">[WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx) </span></span>  
 [<span data-ttu-id="a4078-193">Notificaciones de eventos (motor de base de datos)</span><span class="sxs-lookup"><span data-stu-id="a4078-193">Event Notifications (Database Engine)</span></span>](https://technet.microsoft.com/library/ms182602.aspx)  
  
  
