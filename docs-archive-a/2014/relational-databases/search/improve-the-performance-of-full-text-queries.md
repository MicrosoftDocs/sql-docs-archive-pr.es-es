---
title: Mejorar el rendimiento de las consultas de texto completo | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
ms.assetid: 0658dc74-25eb-4486-bbd6-e85c1f92c272
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: a1437f710725df5c87d31f6a80939a5d7869b412
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87746859"
---
# <a name="improve-the-performance-of-full-text-queries"></a><span data-ttu-id="1b374-102">Mejorar el rendimiento de las consultas de texto completo</span><span class="sxs-lookup"><span data-stu-id="1b374-102">Improve the Performance of Full-Text Queries</span></span>
  <span data-ttu-id="1b374-103">A continuación se ofrece una lista de recomendaciones que servirán para mejorar el rendimiento de las consultas de texto completo.</span><span class="sxs-lookup"><span data-stu-id="1b374-103">The following is a list of recommendations that will help to improve the performance of full-text queries.</span></span>  
  
 <span data-ttu-id="1b374-104">El rendimiento de las consultas de texto completo también se ve afectado por los recursos de hardware, como la memoria, la velocidad de disco y de CPU, y la arquitectura del equipo.</span><span class="sxs-lookup"><span data-stu-id="1b374-104">The performance of full-text queries is also influenced by hardware resources, such as memory, disk speed, CPU speed, and machine architecture.</span></span>  
  
-   <span data-ttu-id="1b374-105">Desfragmente el índice de la tabla base mediante [ALTER INDEX REORGANIZE](/sql/t-sql/statements/alter-index-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="1b374-105">Defragment the index of the base table by using [ALTER INDEX REORGANIZE](/sql/t-sql/statements/alter-index-transact-sql).</span></span>  
  
-   <span data-ttu-id="1b374-106">Reorganice el catálogo de texto completo mediante [ALTER FULLTEXT CATALOG REORGANIZE](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="1b374-106">Reorganize the full-text catalog by using [ALTER FULLTEXT CATALOG REORGANIZE](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql).</span></span> <span data-ttu-id="1b374-107">Asegúrese de hacerlo antes de realizar pruebas de rendimiento porque la ejecución de esta instrucción produce una mezcla maestra de los índices de texto completo del catálogo.</span><span class="sxs-lookup"><span data-stu-id="1b374-107">Make sure that you do this before performance testing because running this statement causes a master merge of the full-text indexes in that catalog.</span></span>  
  
-   <span data-ttu-id="1b374-108">Limite la selección de columnas de clave de texto completo a una columna pequeña.</span><span class="sxs-lookup"><span data-stu-id="1b374-108">Restrict your choice of full-text key columns to a small column.</span></span> <span data-ttu-id="1b374-109">Aunque se admite una columna de 900 bytes, recomendamos usar una columna de clave menor en un índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="1b374-109">Although a 900-byte column is supported, we recommend using a smaller key column in a full-text index.</span></span> <span data-ttu-id="1b374-110">`int` y `bigint` ofrecen el mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="1b374-110">`int` and `bigint` provide the best performance.</span></span>  
  
-   <span data-ttu-id="1b374-111">Al usar una clave de texto completo de un tipo entero, se evita una combinación con la tabla de asignación **docid** .</span><span class="sxs-lookup"><span data-stu-id="1b374-111">Using an integer full-text key avoids a join with the **docid** mapping table.</span></span> <span data-ttu-id="1b374-112">Por consiguiente, este tipo de clave mejora el rendimiento de las consultas en un orden de magnitud y mejora el rendimiento del rastreo.</span><span class="sxs-lookup"><span data-stu-id="1b374-112">Therefore, an integer full-text key improves query performance by an order of magnitude and improves crawl performance.</span></span> <span data-ttu-id="1b374-113">Podrían producirse ventajas adicionales en el rendimiento si la clave de texto completo también es la del índice clúster.</span><span class="sxs-lookup"><span data-stu-id="1b374-113">Additional performance benefits might result if the full-text key is also the clustered index key.</span></span>  
  
-   <span data-ttu-id="1b374-114">Combine varios predicados [CONTAINS](/sql/t-sql/queries/contains-transact-sql) en un predicado CONTAINS.</span><span class="sxs-lookup"><span data-stu-id="1b374-114">Combine multiple [CONTAINS](/sql/t-sql/queries/contains-transact-sql) predicates into one CONTAINS predicate.</span></span> <span data-ttu-id="1b374-115">En [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] puede especificar una lista de columnas en la consulta CONTAINS.</span><span class="sxs-lookup"><span data-stu-id="1b374-115">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can specify a list of columns in the CONTAINS query.</span></span>  
  
-   <span data-ttu-id="1b374-116">Si solo necesita información de clave de texto completo o de clasificación, use [CONTAINSTABLE](/sql/relational-databases/system-functions/containstable-transact-sql) o [FREETEXTTABLE](/sql/relational-databases/system-functions/freetexttable-transact-sql) en lugar de CONTAINS o FREETEXT, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1b374-116">If you only require full-text key or rank information, use [CONTAINSTABLE](/sql/relational-databases/system-functions/containstable-transact-sql) or [FREETEXTTABLE](/sql/relational-databases/system-functions/freetexttable-transact-sql) instead of CONTAINS or FREETEXT, respectively.</span></span>  
  
-   <span data-ttu-id="1b374-117">Para limitar los resultados y aumentar el rendimiento, use el parámetro *top_n_by_rank* de las funciones CONTAINSTABLE y FREETEXTTABLE.</span><span class="sxs-lookup"><span data-stu-id="1b374-117">To limit results and increase performance, use the *top_n_by_rank* parameter of the FREETEXTTABLE and CONTAINSTABLE functions.</span></span> <span data-ttu-id="1b374-118">*top_n_by_rank* permite volver a recuperar solo las coincidencias más pertinentes.</span><span class="sxs-lookup"><span data-stu-id="1b374-118">*top_n_by_rank* allows you to recall only the most relevant hits.</span></span> <span data-ttu-id="1b374-119">Use este parámetro únicamente si su escenario empresarial no requiere recuperar todas las coincidencias posibles (es decir, no requiere *recuperación total*).</span><span class="sxs-lookup"><span data-stu-id="1b374-119">Use this parameter only if your business scenario does not require recalling all possible hits (that is, it does not require *total recall*).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="1b374-120">La recuperación total suele ser necesaria en escenarios legales, pero puede ser menos importante que el rendimiento en escenarios empresariales como un sistema de comercio electrónico.</span><span class="sxs-lookup"><span data-stu-id="1b374-120">Total recall is typically necessary for legal scenarios but might be less important than performance for business scenarios such as an e-business.</span></span>  
  
-   <span data-ttu-id="1b374-121">Compruebe el plan de consultas de texto completo para asegurarse de que se selecciona el plan de combinaciones adecuado.</span><span class="sxs-lookup"><span data-stu-id="1b374-121">Check the full-text query plan to make sure that the appropriate join plan is chosen.</span></span> <span data-ttu-id="1b374-122">Use una sugerencia de combinación o una sugerencia de consulta si es necesario.</span><span class="sxs-lookup"><span data-stu-id="1b374-122">Use a join hint or query hint if you have to.</span></span> <span data-ttu-id="1b374-123">Si se usa un parámetro en la consulta de texto completo, el valor de primera vez del parámetro determina el plan de consultas.</span><span class="sxs-lookup"><span data-stu-id="1b374-123">If a parameter is used in the full-text query, the first-time value of the parameter determines the query plan.</span></span> <span data-ttu-id="1b374-124">Puede usar la [sugerencia de consulta](/sql/t-sql/queries/hints-transact-sql-query) OPTIMIZE FOR para hacer que la consulta realice la compilación con el valor deseado.</span><span class="sxs-lookup"><span data-stu-id="1b374-124">You can use the OPTIMIZE FOR [query hint](/sql/t-sql/queries/hints-transact-sql-query) to force the query to compile with the value you want.</span></span> <span data-ttu-id="1b374-125">Así se contribuye a lograr un plan de consultas determinista y un mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="1b374-125">This helps achieve a deterministic query plan and better performance.</span></span>  
  
-   <span data-ttu-id="1b374-126">Demasiados fragmentos del índice de texto completo pueden conducir a una degradación sustancial del rendimiento de las consultas.</span><span class="sxs-lookup"><span data-stu-id="1b374-126">Too many full-text index fragments in the full-text index, can lead to substantial degradation in query performance.</span></span> <span data-ttu-id="1b374-127">Para reducir el número de fragmentos, reorganice el catálogo de texto completo mediante la opción REORGANIZE de la instrucción [ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql) de [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1b374-127">To reduce the number of fragments, reorganize the full-text catalog by using the REORGANIZE option of the [ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)[!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="1b374-128">Esencialmente, esta instrucción combina todos los fragmentos en un único fragmento mayor y quita todas las entradas obsoletas del índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="1b374-128">This statement essentially merges all the fragments into a single larger fragment and removes all obsolete entries from the full-text index.</span></span>  
  
-   <span data-ttu-id="1b374-129">En la búsqueda de texto completo de , los operadores lógicos especificados en CONTAINSTABLE (AND, OR) se pueden implementar bien como combinaciones de SQL o dentro de las funciones con valores de tabla de transmisión por secuencias (STVF) de ejecución de texto completo.</span><span class="sxs-lookup"><span data-stu-id="1b374-129">In  full-text search, logical operators specified in CONTAINSTABLE (AND, OR) can be implemented either as SQL joins or inside the full-text execution streaming table-valued functions (STVF).</span></span> <span data-ttu-id="1b374-130">Normalmente, las consultas con solo un tipo de operadores lógicos se implementan meramente mediante la ejecución de texto completo, mientras que las consultas que mezclan operadores lógicos también presentan combinaciones de SQL.</span><span class="sxs-lookup"><span data-stu-id="1b374-130">Typically, queries with only one type of logical operators are implemented purely by full-text execution, whereas queries that mix logical operators also possess SQL joins.</span></span> <span data-ttu-id="1b374-131">La implementación de un operador lógico dentro de la STVF de ejecución de texto completo utiliza algunas propiedades de índice especiales que hacen que sean mucho más rápidas que las combinaciones de SQL.</span><span class="sxs-lookup"><span data-stu-id="1b374-131">Implementation of a logical operator inside the full-text execution STVF uses some special index properties that make it much faster than SQL joins.</span></span> <span data-ttu-id="1b374-132">Por esta razón, recomendamos que, siempre que sea posible, cree las consultas utilizando únicamente un tipo de operador lógico.</span><span class="sxs-lookup"><span data-stu-id="1b374-132">For this reason, we recommend that, where possible, you frame queries using only a single type of logical operator.</span></span>  
  
-   <span data-ttu-id="1b374-133">Con las aplicaciones que contienen predicados de relación selectiva, las consultas que usan predicados relacionales selectivos y predicados de texto completo no selectivos podrían demostrar un mejor comportamiento cuando se escriben para utilizar el optimizador de consultas.</span><span class="sxs-lookup"><span data-stu-id="1b374-133">For applications that contain selective-relation predications, queries that use selective relational predicates and unselective full-text predicates might perform best when they are written to use the query optimizer.</span></span> <span data-ttu-id="1b374-134">Esto permite al optimizador de consultas decidir si puede explotar el predicado o una pila de intervalo para generar un plan de consulta efectivo.</span><span class="sxs-lookup"><span data-stu-id="1b374-134">This allows the query optimizer to decide whether it can exploit predicate or range pushdown to produce an effective query plan.</span></span> <span data-ttu-id="1b374-135">Este enfoque es más sencillo y a menudo más eficaz que indizar los datos relacionales como datos de texto completo.</span><span class="sxs-lookup"><span data-stu-id="1b374-135">This approach is simpler and often more efficient than indexing relational data as full-text data.</span></span>  
  
## <a name="related-resources"></a><span data-ttu-id="1b374-136">Recursos relacionados</span><span class="sxs-lookup"><span data-stu-id="1b374-136">Related Resources</span></span>  
 [<span data-ttu-id="1b374-137">Búsqueda de texto completo en SQL Server 2008: características internas y mejoras</span><span class="sxs-lookup"><span data-stu-id="1b374-137">SQL Server 2008 Full-Text Search: Internals and Enhancements</span></span>](https://go.microsoft.com/fwlink/?LinkId=129544)  
  
## <a name="see-also"></a><span data-ttu-id="1b374-138">Consulte también</span><span class="sxs-lookup"><span data-stu-id="1b374-138">See Also</span></span>  
 <span data-ttu-id="1b374-139">[sys.dm_fts_memory_buffers &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-buffers-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="1b374-139">[sys.dm_fts_memory_buffers &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-buffers-transact-sql) </span></span>  
 [<span data-ttu-id="1b374-140">sys.dm_fts_memory_pools &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="1b374-140">sys.dm_fts_memory_pools &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-pools-transact-sql)  
  
  
