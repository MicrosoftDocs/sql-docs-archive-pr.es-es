---
title: IBCPSession::BCPInit (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPInit (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPInit method
ms.assetid: 583096d7-da34-49be-87fd-31210aac81aa
author: rothja
ms.author: jroth
ms.openlocfilehash: 25a01c71811de9d47ce01714402460bb53d4c70e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87745274"
---
# <a name="ibcpsessionbcpinit-ole-db"></a><span data-ttu-id="f0e7c-102">IBCPSession::BCPInit (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="f0e7c-102">IBCPSession::BCPInit (OLE DB)</span></span>
  <span data-ttu-id="f0e7c-103">Inicializa la estructura de copia masiva, realiza algunas comprobaciones de errores, comprueba que los datos y los nombres de archivo de formato son correctos y, a continuación, los abre.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-103">Initializes the bulk copy structure, performs some error checking, verifies that the data and format file names are correct, and then opens them.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="f0e7c-104">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="f0e7c-104">Syntax</span></span>  
  
```  
  
HRESULT BCPInit(   
const wchar_t *pwszTable,  
const wchar_t *pwszDataFile,  
const wchar_t *pwszErrorFile,  
inteDirection);  
```  
  
## <a name="remarks"></a><span data-ttu-id="f0e7c-105">Observaciones</span><span class="sxs-lookup"><span data-stu-id="f0e7c-105">Remarks</span></span>  
 <span data-ttu-id="f0e7c-106">Es necesario llamar al método **BCPInit** antes de llamar a cualquier otro método de copia masiva.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-106">The **BCPInit** method should be called before any other bulk-copy method.</span></span> <span data-ttu-id="f0e7c-107">El método **BCPInit** realiza las inicializaciones necesarias para una copia masiva de datos entre la estación de trabajo y [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f0e7c-107">The **BCPInit** method performs the necessary initializations for a bulk copy of data between the workstation and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="f0e7c-108">El método **BCPInit** examina la estructura del origen de base de datos o la tabla de destino, no el archivo de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-108">The **BCPInit** method examines the structure of the database source or target table, not the data file.</span></span> <span data-ttu-id="f0e7c-109">Especifica los valores de formato de datos del archivo de datos basándose en cada columna de la tabla de base de datos, la vista o el conjunto de resultados de la instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-109">It specifies data format values for the data file based on each column in the database table, view, or SELECT result set.</span></span> <span data-ttu-id="f0e7c-110">Esta especificación incluye el tipo de datos de cada columna, la presencia o ausencia de cadenas de bytes de un indicador de longitud o nulo y de terminador en los datos, y el ancho de los tipos de datos de longitud fija.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-110">This specification includes the data type of each column, the presence or absence of a length or null indicator and terminator byte strings in the data, and the width of fixed-length data types.</span></span> <span data-ttu-id="f0e7c-111">El método **BCPInit** establece estos valores como sigue:</span><span class="sxs-lookup"><span data-stu-id="f0e7c-111">The **BCPInit** method sets these values as follows:</span></span>  
  
-   <span data-ttu-id="f0e7c-112">El tipo de datos especificado es el tipo de datos de la columna de la tabla de base de datos, la vista o el conjunto de resultados de una instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-112">The data type specified is the data type of the column in the database table, view, or SELECT result set.</span></span> <span data-ttu-id="f0e7c-113">El tipo de datos se enumera mediante los [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tipos de datos nativos especificados en el [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] archivo de encabezado de Native Client (SQLNCLI. h).</span><span class="sxs-lookup"><span data-stu-id="f0e7c-113">The data type is enumerated by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types specified in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client header file (sqlncli.h).</span></span> <span data-ttu-id="f0e7c-114">Sus valores están en el modelo de BCP_TYPE_XXX.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-114">Their values are in the pattern of BCP_TYPE_XXX.</span></span> <span data-ttu-id="f0e7c-115">Los datos están representados en el formato del equipo.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-115">The data is represented in its computer form.</span></span> <span data-ttu-id="f0e7c-116">Es decir, los datos de una columna de tipo de datos entero están representados por una secuencia de cuatro bytes "big endian" o "little endian" basada en el equipo que creó el archivo de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-116">That is, data from a column of integer data type is represented by a four-byte sequence that is big-or little-endian based on the computer that created the data file.</span></span>  
  
-   <span data-ttu-id="f0e7c-117">Si un tipo de datos de base de datos es de longitud fija, los datos del archivo de datos también serán de longitud fija.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-117">If a database data type is fixed in length, the data file data is also fixed in length.</span></span> <span data-ttu-id="f0e7c-118">Los métodos de copia masiva que procesan los datos (por ejemplo, [IBCPSession::BCPExec](ibcpsession-bcpexec-ole-db.md)) analizan las filas de datos esperando que la longitud de los datos del archivo de datos sea idéntica a la longitud de los datos especificados en la tabla de base de datos, la vista o la lista de columnas de la instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-118">Bulk-copy methods that process data (for example, [IBCPSession::BCPExec](ibcpsession-bcpexec-ole-db.md)) parse data rows expecting the length of the data in the data file to be identical to the length of the data specified in the database table, view, or SELECT column list.</span></span> <span data-ttu-id="f0e7c-119">Por ejemplo, los datos de una columna de base de datos definidos como `char(13)` deben estar representados por 13 caracteres por cada fila de datos del archivo.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-119">For example, data for a database column defined as `char(13)` must be represented by 13 characters for each row of data in the file.</span></span> <span data-ttu-id="f0e7c-120">Los datos de longitud fija pueden tener como prefijo un indicador nulo si la columna de base de datos permite valores nulos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-120">Fixed-length data can be prefixed with a null indicator if the database column allows null values.</span></span>  
  
-   <span data-ttu-id="f0e7c-121">Cuando se copian datos en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], el archivo de datos debe tener datos para cada columna de la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-121">When copying data to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the data file must have data for each column in the database table.</span></span> <span data-ttu-id="f0e7c-122">Cuando se copian datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], los datos de todas las columnas de la tabla de base de datos, la vista o el conjunto de resultados de la instrucción SELECT se copian en el archivo de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-122">When copying data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], data from all columns in the database table, view, or SELECT result set are copied to the data file.</span></span>  
  
-   <span data-ttu-id="f0e7c-123">Cuando se copian datos en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la posición ordinal de una columna en el archivo de datos debe ser idéntica a la de la columna en la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-123">When copying data to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the ordinal position of a column in the data file must be identical to the ordinal position of the column in the database table.</span></span> <span data-ttu-id="f0e7c-124">Cuando se copian datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], el método **BCPExec** coloca los datos en función de la posición ordinal de la columna en la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-124">When copying data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the **BCPExec** method places data based on the ordinal position of the column in the database table.</span></span>  
  
-   <span data-ttu-id="f0e7c-125">Si un tipo de datos de base de datos es de longitud variable (por ejemplo, `varbinary(22)`) o si una columna de base de datos puede contener valores NULL, se antepone a los datos del archivo de datos un indicador de longitud o nulo.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-125">If a database data type is variable in length (for example, `varbinary(22)`) or if a database column can contain null values, data in the data file is prefixed by a length/null indicator.</span></span> <span data-ttu-id="f0e7c-126">El ancho del indicador varía en función del tipo de datos y de la versión de copia masiva.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-126">The width of the indicator varies based on the data type and version of bulk copy.</span></span> <span data-ttu-id="f0e7c-127">La opción [IBCPSession::BCPControl](ibcpsession-bcpcontrol-ole-db.md) del método BCP_OPTION_FILEFMT proporciona compatibilidad entre los archivos de datos de copia masiva anteriores y los servidores donde se ejecutan versiones posteriores de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] al indicar cuándo el ancho de los indicadores de los datos es inferior a lo esperado.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-127">The [IBCPSession::BCPControl](ibcpsession-bcpcontrol-ole-db.md) method option BCP_OPTION_FILEFMT provides compatibility between earlier bulk-copy data files and servers running later versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by indicating when the width of indicators in the data is narrower than expected.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f0e7c-128">Para cambiar los valores de formato de datos especificados para un archivo de datos, use los métodos [IBCPSession::BCPColumns](ibcpsession-bcpcolumns-ole-db.md) e [IBCPSession::BCPColFmt](ibcpsession-bcpcolfmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="f0e7c-128">To change the data format values specified for a data file, use the [IBCPSession::BCPColumns](ibcpsession-bcpcolumns-ole-db.md) and [IBCPSession::BCPColFmt](ibcpsession-bcpcolfmt-ole-db.md) methods.</span></span>  
  
 <span data-ttu-id="f0e7c-129">Las copias masivas en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] se pueden optimizar para las tablas que no contienen índices estableciendo la opción de base de datos **select into/bulkcopy**.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-129">Bulk copies to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be optimized for tables that do not contain indexes by setting the database option **select into/bulkcopy**.</span></span>  
  
## <a name="arguments"></a><span data-ttu-id="f0e7c-130">Argumentos</span><span class="sxs-lookup"><span data-stu-id="f0e7c-130">Arguments</span></span>  
 <span data-ttu-id="f0e7c-131">*pwszTable*[in]</span><span class="sxs-lookup"><span data-stu-id="f0e7c-131">*pwszTable*[in]</span></span>  
 <span data-ttu-id="f0e7c-132">Nombre de la tabla de base de datos en o de la que se va a copiar.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-132">The name of the database table to be copied into or out of.</span></span> <span data-ttu-id="f0e7c-133">El nombre puede incluir el nombre de la base de datos o el nombre del propietario.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-133">The name can include the database name or the owner name.</span></span> <span data-ttu-id="f0e7c-134">Por ejemplo, "pubs.username.titles", "pubs..titles", "username.titles".</span><span class="sxs-lookup"><span data-stu-id="f0e7c-134">For example, "pubs.username.titles", "pubs..titles", "username.titles".</span></span>  
  
 <span data-ttu-id="f0e7c-135">Si el argumento eDirection está establecido en BCP_DIRECTION_OUT, el argumento pwszTable puede ser el nombre de una vista de base de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-135">If the eDirection argument is set to BCP_DIRECTION_OUT, the pwszTable argument can be the name of a database view.</span></span>  
  
 <span data-ttu-id="f0e7c-136">Si el argumento eDirection está establecido en BCP_DIRECTION_OUT y se especifica una instrucción SELECT con el método **BCPControl** antes de llamar al método **BCPExec**, el argumento *pwszTable* tiene que establecerse en NULL.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-136">If the eDirection argument is set to BCP_DIRECTION_OUT and a SELECT statement is specified using the **BCPControl** method before the **BCPExec** method is called, the *pwszTable* argument must be set to NULL.</span></span>  
  
 <span data-ttu-id="f0e7c-137">*pwszDataFile*[in]</span><span class="sxs-lookup"><span data-stu-id="f0e7c-137">*pwszDataFile*[in]</span></span>  
 <span data-ttu-id="f0e7c-138">Nombre del archivo de usuario en o del que se va a copiar.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-138">The name of the user file to be copied into or out of.</span></span>  
  
 <span data-ttu-id="f0e7c-139">*pwszErrorFile*[in]</span><span class="sxs-lookup"><span data-stu-id="f0e7c-139">*pwszErrorFile*[in]</span></span>  
 <span data-ttu-id="f0e7c-140">Nombre del archivo de error que se va a rellenar con mensajes de progreso, mensajes de error y copias de las filas que, por cualquier razón, no se puedan copiar de un archivo de usuario en una tabla.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-140">The name of the error file to be filled with progress messages, error messages, and copies of any rows that could not be copied from a user file to a table.</span></span> <span data-ttu-id="f0e7c-141">Si el argumento *pwszErrorFile* se establece en NULL, no se usa ningún archivo de error.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-141">If the *pwszErrorFile* argument is set to NULL, no error file is used.</span></span>  
  
 <span data-ttu-id="f0e7c-142">*eDirection*[in]</span><span class="sxs-lookup"><span data-stu-id="f0e7c-142">*eDirection*[in]</span></span>  
 <span data-ttu-id="f0e7c-143">Dirección de la operación de copia, BCP_DIRECTION_IN o BCP_DIRECTION_OUT.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-143">The direction of the copy operation, either BCP_DIRECTION_IN or BCP_DIRECTION _OUT.</span></span> <span data-ttu-id="f0e7c-144">BCP_DIRECTION_IN indica una copia de un archivo de usuario en una tabla de base de datos; BCP_DIRECTION_OUT indica una copia de una tabla de base de datos en un archivo de usuario.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-144">BCP_DIRECTION _IN indicates a copy from a user file to a database table; BCP_DIRECTION _OUT indicates a copy from a database table to a user file.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="f0e7c-145">Valores de código de retorno</span><span class="sxs-lookup"><span data-stu-id="f0e7c-145">Return Code Values</span></span>  
 <span data-ttu-id="f0e7c-146">S_OK</span><span class="sxs-lookup"><span data-stu-id="f0e7c-146">S_OK</span></span>  
 <span data-ttu-id="f0e7c-147">El método se ha llevado a cabo de forma correcta.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-147">The method succeeded.</span></span>  
  
 <span data-ttu-id="f0e7c-148">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="f0e7c-148">E_FAIL</span></span>  
 <span data-ttu-id="f0e7c-149">Se produjo un error específico del proveedor ' para obtener información detallada, use la interfaz [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) .</span><span class="sxs-lookup"><span data-stu-id="f0e7c-149">A provider specific error occurred' for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="f0e7c-150">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="f0e7c-150">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="f0e7c-151">Error de memoria insuficiente.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-151">Out-of-memory error.</span></span>  
  
 <span data-ttu-id="f0e7c-152">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="f0e7c-152">E_INVALIDARG</span></span>  
 <span data-ttu-id="f0e7c-153">No se han especificado correctamente uno o varios argumentos.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-153">One or more of the arguments was not correctly specified.</span></span> <span data-ttu-id="f0e7c-154">Por ejemplo, se proporcionó un nombre de archivo no válido.</span><span class="sxs-lookup"><span data-stu-id="f0e7c-154">For example, an invalid file name was given.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f0e7c-155">Consulte también</span><span class="sxs-lookup"><span data-stu-id="f0e7c-155">See Also</span></span>  
 <span data-ttu-id="f0e7c-156">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="f0e7c-156">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="f0e7c-157">Realizar operaciones de copia masiva</span><span class="sxs-lookup"><span data-stu-id="f0e7c-157">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
