---
title: Determinar las características de un conjunto de resultados (ODBC) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- result sets [ODBC], characteristics
- SQL Server Native Client ODBC driver, result sets
- ODBC applications, result sets
- SQLDescribeCol function
- metadata [ODBC]
- SQLColAttribute function
- SQLNumResultCols function
ms.assetid: 90be414c-04b3-46c0-906b-ae7537989b7d
author: rothja
ms.author: jroth
ms.openlocfilehash: 5957092cdddfbcbce904d9a6483914672565d337
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87671036"
---
# <a name="determining-the-characteristics-of-a-result-set-odbc"></a><span data-ttu-id="9524b-102">Determinar las características de un conjunto de resultados (ODBC)</span><span class="sxs-lookup"><span data-stu-id="9524b-102">Determining the Characteristics of a Result Set (ODBC)</span></span>
  <span data-ttu-id="9524b-103">Los metadatos son datos que describen otros datos.</span><span class="sxs-lookup"><span data-stu-id="9524b-103">Metadata is data that describes other data.</span></span> <span data-ttu-id="9524b-104">Por ejemplo, los metadatos de conjunto de resultados describen las características de un conjunto de resultados, como el número de columnas del conjunto de resultados, los tipos de datos de esas columnas, sus nombres, la precisión y la nulabilidad.</span><span class="sxs-lookup"><span data-stu-id="9524b-104">For example, result set metadata describes the characteristics of a result set, such as the number of columns in the result set, the data types of those columns, their names, precision, and nullability.</span></span>  
  
 <span data-ttu-id="9524b-105">ODBC proporciona metadatos a las aplicaciones mediante las funciones de API de catálogo.</span><span class="sxs-lookup"><span data-stu-id="9524b-105">ODBC supplies metadata to applications through its catalog API functions.</span></span> <span data-ttu-id="9524b-106">El [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] controlador ODBC de Native Client implementa muchas de las funciones de catálogo de la API de ODBC como llamadas a un [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] procedimiento de catálogo correspondiente.</span><span class="sxs-lookup"><span data-stu-id="9524b-106">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver implements many of the ODBC API catalog functions as calls to a corresponding [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] catalog procedure.</span></span>  
  
 <span data-ttu-id="9524b-107">Las aplicaciones requieren metadatos para la mayoría de las operaciones de conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9524b-107">Applications require metadata for most result set operations.</span></span> <span data-ttu-id="9524b-108">Por ejemplo, la aplicación utiliza el tipo de datos de una columna para determinar qué tipo de variable se ha de enlazar a esa columna.</span><span class="sxs-lookup"><span data-stu-id="9524b-108">For example, the application uses the data type of a column to determine what kind of variable to bind to that column.</span></span> <span data-ttu-id="9524b-109">Utiliza la longitud de bytes de una columna de caracteres para determinar cuánto espacio debe tener para mostrar datos de esa columna.</span><span class="sxs-lookup"><span data-stu-id="9524b-109">It uses the byte length of a character column to determine how much space it must have to display data from that column.</span></span> <span data-ttu-id="9524b-110">El modo en que una aplicación determina los metadatos de una columna depende del tipo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9524b-110">How an application determines the metadata for a column depends on the type of the application.</span></span>  
  
 <span data-ttu-id="9524b-111">Las aplicaciones verticales suelen funcionar con tablas predefinidas y realizan operaciones predefinidas en esas tablas.</span><span class="sxs-lookup"><span data-stu-id="9524b-111">Vertical applications typically work with predefined tables and perform predefined operations on those tables.</span></span> <span data-ttu-id="9524b-112">Dado que los metadatos de conjunto de resultados para dichas aplicaciones se definen antes incluso de que el programador escriba y controle la aplicación, pueden estar codificados de forma rígida en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9524b-112">Because the result set metadata for such applications is defined before the application is even written and is controlled by the developer, it can be hard-coded into the application.</span></span> <span data-ttu-id="9524b-113">Por ejemplo, si una columna Id. de pedido se define como un entero de 4 bytes en el origen de datos, la aplicación siempre puede enlazar un entero de 4 bytes a esa columna.</span><span class="sxs-lookup"><span data-stu-id="9524b-113">For example, if an order ID column is defined as a 4-byte integer in the data source, the application can always bind a 4-byte integer to that column.</span></span> <span data-ttu-id="9524b-114">Cuando los metadatos están codificados de forma rígida en la aplicación, un cambio en las tablas utilizadas por la aplicación suele implicar un cambio en el código de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9524b-114">When metadata is hard-coded in the application, a change to the tables used by the application generally implies a change to the application code.</span></span>  
  
 <span data-ttu-id="9524b-115">En aplicaciones genéricas, especialmente en aplicaciones que admiten consultas ad hoc, los metadatos de los conjuntos de resultados que crean suelen desconocerse hasta la ejecución.</span><span class="sxs-lookup"><span data-stu-id="9524b-115">In generic applications, especially applications that support ad hoc queries, the metadata of the result sets they create is typically unknown until run time.</span></span>  
  
 <span data-ttu-id="9524b-116">Para determinar las características de un conjunto de resultados, una aplicación puede llamar a los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="9524b-116">To determine the characteristics of a result set, an application can call:</span></span>  
  
-   <span data-ttu-id="9524b-117">[SQLNumResultCols](../native-client-odbc-api/sqlnumresultcols.md) para determinar el número de columnas que ha devuelto una solicitud.</span><span class="sxs-lookup"><span data-stu-id="9524b-117">[SQLNumResultCols](../native-client-odbc-api/sqlnumresultcols.md) to determine how many columns a request returned.</span></span>  
  
-   <span data-ttu-id="9524b-118">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md) o [SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md) para describir una columna en el conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9524b-118">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md) or [SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md) to describe a column in the result set.</span></span>  
  
 <span data-ttu-id="9524b-119">Una aplicación bien diseñada se escribe con la suposición de que el conjunto de resultados es desconocido y utiliza la información devuelta por estas funciones para enlazar las columnas del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9524b-119">A well-designed application is written with the assumption that the result set is unknown and uses the information returned by these functions to bind the columns in the result set.</span></span> <span data-ttu-id="9524b-120">Una aplicación puede llamar a estas funciones en cualquier momento posterior a la preparación o ejecución de una instrucción.</span><span class="sxs-lookup"><span data-stu-id="9524b-120">An application can call these functions at any time after a statement is prepared or executed.</span></span> <span data-ttu-id="9524b-121">Sin embargo, para obtener un rendimiento óptimo, una aplicación debe llamar a **SQLColAttribute**, **SQLDescribeCol**y **SQLNumResultCols** después de ejecutar una instrucción.</span><span class="sxs-lookup"><span data-stu-id="9524b-121">However, for optimal performance, an application should call **SQLColAttribute**, **SQLDescribeCol**, and **SQLNumResultCols** after a statement is executed.</span></span>  
  
 <span data-ttu-id="9524b-122">Puede tener varias llamadas simultáneas a metadatos.</span><span class="sxs-lookup"><span data-stu-id="9524b-122">You can have multiple concurrent calls for metadata.</span></span> <span data-ttu-id="9524b-123">El controlador ODBC puede llamar a los procedimientos de catálogo del sistema que subyacen en las implementaciones de API de catálogo de ODBC mientras está utilizando los cursores de servidor estáticos.</span><span class="sxs-lookup"><span data-stu-id="9524b-123">The system catalog procedures underlying the ODBC catalog API implementations can be called by the ODBC driver while it is using static server cursors.</span></span> <span data-ttu-id="9524b-124">Esto permite a las aplicaciones procesar simultáneamente varias llamadas a funciones de catálogo de ODBC.</span><span class="sxs-lookup"><span data-stu-id="9524b-124">This lets applications concurrently process multiple calls to ODBC catalog functions.</span></span>  
  
 <span data-ttu-id="9524b-125">Si una aplicación utiliza un conjunto de metadatos concreto más de una vez, probablemente resultará beneficioso almacenar en memoria caché la información en variables privadas la primera vez que se obtenga.</span><span class="sxs-lookup"><span data-stu-id="9524b-125">If an application uses a particular set of metadata more than one time, it will probably benefit from caching the information in private variables when it is first obtained.</span></span> <span data-ttu-id="9524b-126">Esto evita la realización de llamadas posteriores a las funciones de catálogo de ODBC para obtener la misma información, lo que obliga al controlador a realizar viajes de ida y vuelta al servidor.</span><span class="sxs-lookup"><span data-stu-id="9524b-126">This prevents later calls to the ODBC catalog functions for the same information, which force the driver to make round trips to the server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9524b-127">Consulte también</span><span class="sxs-lookup"><span data-stu-id="9524b-127">See Also</span></span>  
 [<span data-ttu-id="9524b-128">Procesar los resultados &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="9524b-128">Processing Results &#40;ODBC&#41;</span></span>](processing-results-odbc.md)  
  
  
