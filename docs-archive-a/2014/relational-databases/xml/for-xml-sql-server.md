---
title: FOR XML (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: conceptual
helpviewer_keywords:
- FOR XML clause, about FOR XML clause
- PATH FOR XML mode, construction
- EXPLICIT FOR XML mode
- RAW FOR XML mode
- retrieving XML data
- XML [SQL Server], FOR XML clause
- AUTO FOR XML mode
- XML [SQL Server], construction
ms.assetid: 2b6b5c61-c5bd-49d2-8c0c-b7cf15857906
author: rothja
ms.author: jroth
ms.openlocfilehash: 6fe55186e89020f57ae1eb078625d1cdce262864
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87751997"
---
# <a name="for-xml-sql-server"></a><span data-ttu-id="4f741-102">FOR XML (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="4f741-102">FOR XML (SQL Server)</span></span>
  <span data-ttu-id="4f741-103">Una consulta SELECT devuelve los resultados como un conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="4f741-103">A SELECT query returns results as a rowset.</span></span> <span data-ttu-id="4f741-104">Opcionalmente, se pueden recuperar resultados formales de una consulta SQL como XML especificando la cláusula FOR XML en la consulta.</span><span class="sxs-lookup"><span data-stu-id="4f741-104">You can optionally retrieve formal results of a SQL query as XML by specifying the FOR XML clause in the query.</span></span> <span data-ttu-id="4f741-105">La cláusula FOR XML puede usarse en consultas de nivel superior y en subconsultas.</span><span class="sxs-lookup"><span data-stu-id="4f741-105">The FOR XML clause can be used in top-level queries and in sub queries.</span></span> <span data-ttu-id="4f741-106">La cláusula FOR XML de nivel superior solo puede usarse en la instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="4f741-106">The top-level FOR XML clause can be used only in the SELECT statement.</span></span> <span data-ttu-id="4f741-107">En el caso de las subconsultas, FOR XML puede usarse en las instrucciones INSERT, UPDATE y DELETE.</span><span class="sxs-lookup"><span data-stu-id="4f741-107">In sub queries, FOR XML can be used in the INSERT, UPDATE, and DELETE statements.</span></span> <span data-ttu-id="4f741-108">También puede usarse en instrucciones de asignación.</span><span class="sxs-lookup"><span data-stu-id="4f741-108">It can also be used in assignment statements.</span></span>  
  
 <span data-ttu-id="4f741-109">En una cláusula FOR XML se especifica uno de estos modos:</span><span class="sxs-lookup"><span data-stu-id="4f741-109">In a FOR XML clause, you specify one of these modes:</span></span>  
  
-   <span data-ttu-id="4f741-110">RAW</span><span class="sxs-lookup"><span data-stu-id="4f741-110">RAW</span></span>  
  
-   <span data-ttu-id="4f741-111">AUTO</span><span class="sxs-lookup"><span data-stu-id="4f741-111">AUTO</span></span>  
  
-   <span data-ttu-id="4f741-112">EXPLICIT</span><span class="sxs-lookup"><span data-stu-id="4f741-112">EXPLICIT</span></span>  
  
-   <span data-ttu-id="4f741-113">PATH</span><span class="sxs-lookup"><span data-stu-id="4f741-113">PATH</span></span>  
  
 <span data-ttu-id="4f741-114">El modo RAW genera un único elemento \<row> por cada fila del conjunto de filas que devuelve la instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="4f741-114">The RAW mode generates a single \<row> element per row in the rowset that is returned by the SELECT statement.</span></span> <span data-ttu-id="4f741-115">Para generar una jerarquía XML se pueden escribir consultas FOR XML anidadas.</span><span class="sxs-lookup"><span data-stu-id="4f741-115">You can generate XML hierarchy by writing nested FOR XML queries.</span></span>  
  
 <span data-ttu-id="4f741-116">El modo AUTO genera anidamiento en el XML resultante utilizando heurística basada en la forma en que se especifica la instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="4f741-116">The AUTO mode generates nesting in the resulting XML by using heuristics based on the way the SELECT statement is specified.</span></span> <span data-ttu-id="4f741-117">El control sobre la forma del XML generado es mínimo.</span><span class="sxs-lookup"><span data-stu-id="4f741-117">You have minimal control over the shape of the XML generated.</span></span> <span data-ttu-id="4f741-118">Es posible escribir consultas FOR XML anidadas para generar una jerarquía XML más allá de la forma del XML generado mediante la heurística del modo AUTO.</span><span class="sxs-lookup"><span data-stu-id="4f741-118">The nested FOR XML queries can be written to generate XML hierarchy beyond the XML shape that is generated by AUTO mode heuristics.</span></span>  
  
 <span data-ttu-id="4f741-119">El modo EXPLICIT concede un mayor control de la forma del XML.</span><span class="sxs-lookup"><span data-stu-id="4f741-119">The EXPLICIT mode allows more control over the shape of the XML.</span></span> <span data-ttu-id="4f741-120">Es posible mezclar atributos y elementos con total libertad para decidir la forma del XML.</span><span class="sxs-lookup"><span data-stu-id="4f741-120">You can mix attributes and elements at will in deciding the shape of the XML.</span></span> <span data-ttu-id="4f741-121">Requiere un formato específico para el conjunto de filas resultante generado debido a la ejecución de la consulta.</span><span class="sxs-lookup"><span data-stu-id="4f741-121">It requires a specific format for the resulting rowset that is generated because of query execution.</span></span> <span data-ttu-id="4f741-122">Después, el formato del conjunto de filas se asigna a una forma de XML.</span><span class="sxs-lookup"><span data-stu-id="4f741-122">This rowset format is then mapped into XML shape.</span></span> <span data-ttu-id="4f741-123">La eficacia del modo EXPLICIT reside en que se pueden mezclar atributos y elementos con total libertad, crear contenedores y propiedades complejas anidadas, crear valores separados por espacios (por ejemplo, el atributo OrderID puede tener una lista de valores de Id. de orden) y contenido mezclado.</span><span class="sxs-lookup"><span data-stu-id="4f741-123">The power of EXPLICIT mode is to mix attributes and elements at will, create wrappers and nested complex properties, create space-separated values (for example, OrderID attribute may have a list of order ID values), and mixed contents.</span></span>  
  
 <span data-ttu-id="4f741-124">Sin embargo, escribir consultas con el modo EXPLICIT puede ser un proceso complejo.</span><span class="sxs-lookup"><span data-stu-id="4f741-124">However, writing EXPLICIT mode queries can be cumbersome.</span></span> <span data-ttu-id="4f741-125">Se pueden utilizar algunas de las características nuevas de FOR XML, como la posibilidad de escribir consultas anidadas FOR XML en modo RAW/AUTO/PATH y la directiva TYPE, en lugar de utilizar el modo EXPLICIT para generar las jerarquías.</span><span class="sxs-lookup"><span data-stu-id="4f741-125">You can use some of the new FOR XML capabilities, such as writing nested FOR XML RAW/AUTO/PATH mode queries and the TYPE directive, instead of using EXPLICIT mode to generate the hierarchies.</span></span> <span data-ttu-id="4f741-126">Las consultas FOR XML anidadas pueden generar el mismo XML que el modo EXPLICIT.</span><span class="sxs-lookup"><span data-stu-id="4f741-126">The nested FOR XML queries can produce any XML that you can generate by using the EXPLICIT mode.</span></span> <span data-ttu-id="4f741-127">Para obtener más información, vea [Usar consultas FOR XML anidadas](use-nested-for-xml-queries.md) y [Directiva TYPE en consultas FOR XML](type-directive-in-for-xml-queries.md).</span><span class="sxs-lookup"><span data-stu-id="4f741-127">For more information, see [Use Nested FOR XML Queries](use-nested-for-xml-queries.md) and [TYPE Directive in FOR XML Queries](type-directive-in-for-xml-queries.md).</span></span>  
  
 <span data-ttu-id="4f741-128">El modo PATH, junto con la característica de las consultas anidadas FOR XML, proporciona la flexibilidad del modo EXPLICIT de una manera más sencilla.</span><span class="sxs-lookup"><span data-stu-id="4f741-128">The PATH mode together with the nested FOR XML query capability provides the flexibility of the EXPLICIT mode in a simpler manner.</span></span>  
  
 <span data-ttu-id="4f741-129">Estos modos solamente tienen efecto en la ejecución de la consulta para la que se configuraron.</span><span class="sxs-lookup"><span data-stu-id="4f741-129">These modes are in effect only for the execution of the query for which they are set.</span></span> <span data-ttu-id="4f741-130">No afectan a los resultados de ninguna de las consultas posteriores.</span><span class="sxs-lookup"><span data-stu-id="4f741-130">They do not affect the results of any subsequent queries.</span></span>  
  
 <span data-ttu-id="4f741-131">La cláusula FOR XML no es válida en una selección que se use junto con una cláusula FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="4f741-131">FOR XML is not valid for any selection that is used with a FOR BROWSE clause.</span></span>  
  
## <a name="example"></a><span data-ttu-id="4f741-132">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="4f741-132">Example</span></span>  
 <span data-ttu-id="4f741-133">La siguiente instrucción `SELECT` recupera información de las tablas `Sales.Customer` y `Sales.SalesOrderHeader` de la base de datos `AdventureWorks2012` .</span><span class="sxs-lookup"><span data-stu-id="4f741-133">The following `SELECT` statement retrieves information from the `Sales.Customer` and `Sales.SalesOrderHeader` tables in the `AdventureWorks2012` database.</span></span> <span data-ttu-id="4f741-134">Esta consulta especifica el modo `AUTO` en la cláusula `FOR XML` :</span><span class="sxs-lookup"><span data-stu-id="4f741-134">This query specifies the `AUTO` mode in the `FOR XML` clause:</span></span>  
  
```  
USE AdventureWorks2012  
GO  
SELECT Cust.CustomerID,   
       OrderHeader.CustomerID,  
       OrderHeader.SalesOrderID,   
       OrderHeader.Status  
FROM Sales.Customer Cust   
INNER JOIN Sales.SalesOrderHeader OrderHeader  
ON Cust.CustomerID = OrderHeader.CustomerID  
FOR XML AUTO  
```  
  
## <a name="the-for-xml-clause-and-server-names"></a><span data-ttu-id="4f741-135">La cláusula FOR XML y nombres de servidor</span><span class="sxs-lookup"><span data-stu-id="4f741-135">The FOR XML Clause and Server Names</span></span>  
 <span data-ttu-id="4f741-136">Cuando una instrucción SELECT con una cláusula FOR XML especifica un nombre de cuatro partes en la consulta, el nombre de servidor no se devuelve en el documento XML resultante cuando la consulta se ejecuta en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="4f741-136">When a SELECT statement with a FOR XML clause specifies a four-part name in the query, the server name is not returned in the resulting XML document when the query is executed on the local computer.</span></span> <span data-ttu-id="4f741-137">Sin embargo, el nombre del servidor se devuelve como un nombre de cuatro partes cuando la consulta se ejecuta en un servidor de red.</span><span class="sxs-lookup"><span data-stu-id="4f741-137">However, the server name is returned as the four-part name when the query is executed on a network server.</span></span>  
  
 <span data-ttu-id="4f741-138">Por ejemplo, considere esta consulta:</span><span class="sxs-lookup"><span data-stu-id="4f741-138">For example, consider this query:</span></span>  
  
```  
SELECT TOP 1 LastName  
FROM ServerName.AdventureWorks2012.Person.Person  
FOR XML AUTO  
```  
  
 <span data-ttu-id="4f741-139">Cuando `ServerName` es un servidor local, la consulta devuelve lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="4f741-139">When `ServerName` is a local server, the query returns the following:</span></span>  
  
```  
<AdventureWorks2012.Person.Person LastName="Achong" />  
```  
  
 <span data-ttu-id="4f741-140">Cuando `ServerName` es un servidor de red, la consulta devuelve lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="4f741-140">When `ServerName` is a network server, the query returns the following:</span></span>  
  
```  
<ServerName.AdventureWorks2012.Person.Person LastName="Achong" />  
```  
  
 <span data-ttu-id="4f741-141">Se puede evitar esta ambigüedad especificando este alias:</span><span class="sxs-lookup"><span data-stu-id="4f741-141">This potential ambiguity can be avoided by specifying this alias:</span></span>  
  
```  
SELECT TOP 1 LastName  
FROM ServerName.AdventureWorks2012.Person.Person x  
FOR XML AUTO   
```  
  
 <span data-ttu-id="4f741-142">Esta consulta devuelve lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="4f741-142">This query returns the following:</span></span>  
  
```  
<x LastName="Achong"/>  
```  
  
## <a name="see-also"></a><span data-ttu-id="4f741-143">Consulte también</span><span class="sxs-lookup"><span data-stu-id="4f741-143">See Also</span></span>  
 <span data-ttu-id="4f741-144">[Sintaxis básica de la cláusula FOR XML](basic-syntax-of-the-for-xml-clause.md) </span><span class="sxs-lookup"><span data-stu-id="4f741-144">[Basic Syntax of the FOR XML Clause](basic-syntax-of-the-for-xml-clause.md) </span></span>  
 <span data-ttu-id="4f741-145">[Usar el modo RAW con FOR XML](use-raw-mode-with-for-xml.md) </span><span class="sxs-lookup"><span data-stu-id="4f741-145">[Use RAW Mode with FOR XML](use-raw-mode-with-for-xml.md) </span></span>  
 <span data-ttu-id="4f741-146">[Usar el modo AUTO con FOR XML](use-auto-mode-with-for-xml.md) </span><span class="sxs-lookup"><span data-stu-id="4f741-146">[Use AUTO Mode with FOR XML](use-auto-mode-with-for-xml.md) </span></span>  
 <span data-ttu-id="4f741-147">[Usar el modo EXPLICIT con FOR XML](use-explicit-mode-with-for-xml.md) </span><span class="sxs-lookup"><span data-stu-id="4f741-147">[Use EXPLICIT Mode with FOR XML](use-explicit-mode-with-for-xml.md) </span></span>  
 <span data-ttu-id="4f741-148">[Usar el modo PATH con FOR XML](use-path-mode-with-for-xml.md) </span><span class="sxs-lookup"><span data-stu-id="4f741-148">[Use PATH Mode with FOR XML](use-path-mode-with-for-xml.md) </span></span>  
 <span data-ttu-id="4f741-149">[&#41;de SQL Server de &#40;OPENXML](openxml-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="4f741-149">[OPENXML &#40;SQL Server&#41;](openxml-sql-server.md) </span></span>  
 [<span data-ttu-id="4f741-150">Agregar espacios de nombres a consultas con WITH XMLNAMESPACES</span><span class="sxs-lookup"><span data-stu-id="4f741-150">Add Namespaces to Queries with WITH XMLNAMESPACES</span></span>](add-namespaces-to-queries-with-with-xmlnamespaces.md)  
  
  
