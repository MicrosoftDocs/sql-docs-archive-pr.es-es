---
title: Tipo de datos XML y columnas (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: conceptual
ms.assetid: 00db8f21-7d4b-4347-ae43-3a7c314d2fa1
author: rothja
ms.author: jroth
ms.openlocfilehash: 575f8b8fc640ea5ff671a6b0cef4208e7447898f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750546"
---
# <a name="xml-data-type-and-columns-sql-server"></a><span data-ttu-id="d5721-102">Tipo de datos XML y columnas (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="d5721-102">XML Data Type and Columns (SQL Server)</span></span>
  <span data-ttu-id="d5721-103">En este tema se describen las ventajas y las limitaciones del `xml` tipo de datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , y le ayuda a elegir cómo almacenar datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-103">This topic discusses the advantages and the limitations of the `xml` data type in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and helps you to choose how to store XML data.</span></span>  
  
## <a name="relational-or-xml-data-model"></a><span data-ttu-id="d5721-104">Modelo de datos relacionales o XML</span><span class="sxs-lookup"><span data-stu-id="d5721-104">Relational or XML Data Model</span></span>  
 <span data-ttu-id="d5721-105">Si los datos están muy estructurados con un esquema conocido, el modelo relacional tiene más probabilidades de funcionar mejor para el almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="d5721-105">If your data is highly structured with known schema, the relational model is likely to work best for data storage.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d5721-106">proporciona la funcionalidad y las herramientas necesarias.</span><span class="sxs-lookup"><span data-stu-id="d5721-106">provides the required functionality and tools you may need.</span></span> <span data-ttu-id="d5721-107">Por otra parte, si los datos están semiestructurados o no están estructurados, o no se conoce su estructura, debe contemplar la posibilidad de crear un modelo para los datos.</span><span class="sxs-lookup"><span data-stu-id="d5721-107">On the other hand, if the structure is semi-structured or unstructured, or unknown, you have to give consideration to modeling such data.</span></span>  
  
 <span data-ttu-id="d5721-108">XML es una buena opción si desea un modelo independiente de la plataforma para garantizar la portabilidad de los datos mediante el uso de marcado estructural y semántico.</span><span class="sxs-lookup"><span data-stu-id="d5721-108">XML is a good choice if you want a platform-independent model in order to ensure portability of the data by using structural and semantic markup.</span></span> <span data-ttu-id="d5721-109">Además, es una opción apropiada si se cumplen algunas de las siguientes propiedades:</span><span class="sxs-lookup"><span data-stu-id="d5721-109">Additionally, it is an appropriate option if some of the following properties are satisfied:</span></span>  
  
-   <span data-ttu-id="d5721-110">Los datos están dispersos o no se conoce la estructura de los mismos, o la estructura de los datos puede cambiar de manera importante en el futuro.</span><span class="sxs-lookup"><span data-stu-id="d5721-110">Your data is sparse or you do not know the structure of the data, or the structure of your data may change significantly in the future.</span></span>  
  
-   <span data-ttu-id="d5721-111">Los datos representan una jerarquía de inclusión, en lugar de referencias entre entidades, y pueden ser recursivos.</span><span class="sxs-lookup"><span data-stu-id="d5721-111">Your data represents containment hierarchy, instead of references among entities, and may be recursive.</span></span>  
  
-   <span data-ttu-id="d5721-112">El orden es inherente a los datos.</span><span class="sxs-lookup"><span data-stu-id="d5721-112">Order is inherent in your data.</span></span>  
  
-   <span data-ttu-id="d5721-113">Desea realizar consultas en los datos o actualizar parte de ellos, basándose en su estructura.</span><span class="sxs-lookup"><span data-stu-id="d5721-113">You want to query into the data or update parts of it, based on its structure.</span></span>  
  
 <span data-ttu-id="d5721-114">Si no se cumple ninguna de estas condiciones, debe utilizar el modelo de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="d5721-114">If none of these conditions is met, you should use the relational data model.</span></span> <span data-ttu-id="d5721-115">Por ejemplo, si los datos tienen formato XML pero la aplicación solo utiliza la base de datos para almacenar y recuperar los datos, solo necesitará una columna `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="d5721-115">For example, if your data is in XML format but your application just uses the database to store and retrieve the data, an `[n]varchar(max)` column is all you require.</span></span> <span data-ttu-id="d5721-116">Almacenar los datos en una columna XML tiene más ventajas.</span><span class="sxs-lookup"><span data-stu-id="d5721-116">Storing the data in an XML column has additional benefits.</span></span> <span data-ttu-id="d5721-117">Una de ellas es que se puede hacer que el motor determine si los datos tienen un formato correcto o son válidos, y otra es la posibilidad de realizar consultas y actualizaciones detalladas en los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-117">This includes having the engine determine that the data is well formed or valid, and also includes support for fine-grained query and updates into the XML data.</span></span>  
  
## <a name="reasons-for-storing-xml-data-in-sql-server"></a><span data-ttu-id="d5721-118">Razones para almacenar datos XML en SQL Server</span><span class="sxs-lookup"><span data-stu-id="d5721-118">Reasons for Storing XML Data in SQL Server</span></span>  
 <span data-ttu-id="d5721-119">A continuación, se indican algunas de las razones para usar características XML nativas en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en lugar de administrar los datos XML en el sistema de archivos:</span><span class="sxs-lookup"><span data-stu-id="d5721-119">Following are some of the reasons to use native XML features in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instead of managing your XML data in the file system:</span></span>  
  
-   <span data-ttu-id="d5721-120">Desea compartir los datos XML, hacer consultas en ellos y modificarlos de forma eficaz y con transacciones.</span><span class="sxs-lookup"><span data-stu-id="d5721-120">You want to share, query, and modify your XML data in an efficient and transacted way.</span></span> <span data-ttu-id="d5721-121">El acceso a datos con precisión es importante para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5721-121">Fine-grained data access is important to your application.</span></span> <span data-ttu-id="d5721-122">Por ejemplo, tal vez desee extraer alguna sección de un documento XML, o insertar una nueva sección sin reemplazar todo el documento.</span><span class="sxs-lookup"><span data-stu-id="d5721-122">For example, you may want to extract some of the sections within an XML document, or you may want to insert a new section without replacing your whole document.</span></span>  
  
-   <span data-ttu-id="d5721-123">Tiene datos relacionales y datos XML y desea que ambos tipos de datos puedan interoperar dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5721-123">You have relational data and XML data and you want interoperability between both relational and XML data within your application.</span></span>  
  
-   <span data-ttu-id="d5721-124">Necesita compatibilidad con lenguajes para realizar consultas y modificar datos en aplicaciones situadas en diversos dominios.</span><span class="sxs-lookup"><span data-stu-id="d5721-124">You need language support for query and data modification for cross-domain applications.</span></span>  
  
-   <span data-ttu-id="d5721-125">Desea que el servidor garantice que los datos tienen un formato correcto y además, opcionalmente, validar los datos de acuerdo con esquemas XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-125">You want the server to guarantee that the data is well formed and also optionally validate your data according to XML schemas.</span></span>  
  
-   <span data-ttu-id="d5721-126">Desea indizar los datos XML para obtener un procesamiento eficiente de las consultas y una buena escalabilidad, y el uso de un optimizador de consultas de primera clase.</span><span class="sxs-lookup"><span data-stu-id="d5721-126">You want indexing of XML data for efficient query processing and good scalability, and the use of a first-rate query optimizer.</span></span>  
  
-   <span data-ttu-id="d5721-127">Desea el acceso de SOAP, ADO.NET y OLE DB a los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-127">You want SOAP, ADO.NET, and OLE DB access to XML data.</span></span>  
  
-   <span data-ttu-id="d5721-128">Desea utilizar la funcionalidad administrativa del servidor de base de datos para administrar los datos XML,</span><span class="sxs-lookup"><span data-stu-id="d5721-128">You want to use administrative functionality of the database server for managing your XML data.</span></span> <span data-ttu-id="d5721-129">por ejemplo, para realizar copias de seguridad, recuperaciones y réplicas.</span><span class="sxs-lookup"><span data-stu-id="d5721-129">For example, this would be backup, recovery, and replication.</span></span>  
  
 <span data-ttu-id="d5721-130">Si no se satisface ninguna de estas condiciones, es posible que convenga almacenar los datos como tipo de objeto grande no XML, por ejemplo, `[n]varchar(max)` o `varbinary(max)`.</span><span class="sxs-lookup"><span data-stu-id="d5721-130">If none of these conditions is satisfied, it may be better to store your data as a non-XML, large object type, such as `[n]varchar(max)` or `varbinary(max)`.</span></span>  
  
## <a name="xml-storage-options"></a><span data-ttu-id="d5721-131">Opciones de almacenamiento de XML</span><span class="sxs-lookup"><span data-stu-id="d5721-131">XML Storage Options</span></span>  
 <span data-ttu-id="d5721-132">Las opciones de almacenamiento para XML en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="d5721-132">The storage options for XML in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] include the following:</span></span>  
  
-   <span data-ttu-id="d5721-133">Almacenamiento nativo como tipo de datos `xml`.</span><span class="sxs-lookup"><span data-stu-id="d5721-133">Native storage as `xml` data type</span></span>  
  
     <span data-ttu-id="d5721-134">Los datos se almacenan en una representación interna que conserva el contenido XML de los mismos.</span><span class="sxs-lookup"><span data-stu-id="d5721-134">The data is stored in an internal representation that preserves the XML content of the data.</span></span> <span data-ttu-id="d5721-135">Esta representación interna incluye información sobre la jerarquía de inclusión, el orden de los documentos y los valores de los elementos y los atributos.</span><span class="sxs-lookup"><span data-stu-id="d5721-135">This internal representation includes information about the containment hierarchy, document order, and element and attribute values.</span></span> <span data-ttu-id="d5721-136">En concreto, se conserva el contenido InfoSet de los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-136">Specifically, the InfoSet content of the XML data is preserved.</span></span> <span data-ttu-id="d5721-137">Para obtener más información sobre InfoSet, visite [http://www.w3.org/TR/xml-infoset](https://go.microsoft.com/fwlink/?LinkId=48843).</span><span class="sxs-lookup"><span data-stu-id="d5721-137">For more information about InfoSet, visit [http://www.w3.org/TR/xml-infoset](https://go.microsoft.com/fwlink/?LinkId=48843).</span></span> <span data-ttu-id="d5721-138">El contenido del InfoSet puede no ser una copia idéntica del texto XML, porque no se retiene la información siguiente: espacios en blanco no significativos, orden de los atributos, prefijos de los espacios de nombres y declaración XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-138">The InfoSet content may not be an identical copy of the text XML, because the following information is not retained: insignificant white spaces, order of attributes, namespace prefixes, and XML declaration.</span></span>  
  
     <span data-ttu-id="d5721-139">En el caso del tipo de datos con tipo `xml` , un `xml` tipo de datos enlazado a esquemas XML, el conjunto de información posterior a la validación del esquema (PSVI) agrega información de tipo al infoset y se codifica en la representación interna.</span><span class="sxs-lookup"><span data-stu-id="d5721-139">For typed `xml` data type, an `xml` data type bound to XML schemas, the post-schema validation InfoSet (PSVI) adds type information to the InfoSet and is encoded in the internal representation.</span></span> <span data-ttu-id="d5721-140">De este modo, se mejora considerablemente la velocidad de análisis.</span><span class="sxs-lookup"><span data-stu-id="d5721-140">This improves parsing speed significantly.</span></span> <span data-ttu-id="d5721-141">Para obtener más información, vea las especificaciones del esquema XML de W3C en [http://www.w3.org/TR/xmlschema-1](https://go.microsoft.com/fwlink/?LinkId=48881) y [http://www.w3.org/TR/xmlschema-2](https://go.microsoft.com/fwlink/?LinkId=4871).</span><span class="sxs-lookup"><span data-stu-id="d5721-141">For more information, see the W3C XML Schema specifications at [http://www.w3.org/TR/xmlschema-1](https://go.microsoft.com/fwlink/?LinkId=48881) and [http://www.w3.org/TR/xmlschema-2](https://go.microsoft.com/fwlink/?LinkId=4871).</span></span>  
  
-   <span data-ttu-id="d5721-142">Asignar entre almacenamiento XML y relacional</span><span class="sxs-lookup"><span data-stu-id="d5721-142">Mapping between XML and relational storage</span></span>  
  
     <span data-ttu-id="d5721-143">El esquema anotado (AXSD) permite descomponer el código XML en columnas en una o más tablas.</span><span class="sxs-lookup"><span data-stu-id="d5721-143">By using an annotated schema (AXSD), the XML is decomposed into columns in one or more tables.</span></span> <span data-ttu-id="d5721-144">Así, se preserva la fidelidad de los datos en el nivel relacional.</span><span class="sxs-lookup"><span data-stu-id="d5721-144">This preserves fidelity of the data at the relational level.</span></span> <span data-ttu-id="d5721-145">Como resultado, la estructura jerárquica se mantiene aunque se omita el orden entre los elementos.</span><span class="sxs-lookup"><span data-stu-id="d5721-145">As a result, the hierarchical structure is preserved although order among elements is ignored.</span></span> <span data-ttu-id="d5721-146">El esquema no puede ser recursivo.</span><span class="sxs-lookup"><span data-stu-id="d5721-146">The schema cannot be recursive.</span></span>  
  
-   <span data-ttu-id="d5721-147">Almacenamiento de objetos grandes, `[n]varchar(max)` y `varbinary(max)`</span><span class="sxs-lookup"><span data-stu-id="d5721-147">Large object storage, `[n]varchar(max)` and `varbinary(max)`</span></span>  
  
     <span data-ttu-id="d5721-148">Se almacena una copia idéntica de los datos.</span><span class="sxs-lookup"><span data-stu-id="d5721-148">An identical copy of the data is stored.</span></span> <span data-ttu-id="d5721-149">Esto resulta útil en el caso de aplicaciones para fines específicos, como documentos legales.</span><span class="sxs-lookup"><span data-stu-id="d5721-149">This is useful for special-purpose applications such as legal documents.</span></span> <span data-ttu-id="d5721-150">La mayoría de las aplicaciones no requieren una copia exacta y les basta con el contenido XML (fidelidad InfoSet).</span><span class="sxs-lookup"><span data-stu-id="d5721-150">Most applications do not require an exact copy and are satisfied with the XML content (InfoSet fidelity).</span></span>  
  
 <span data-ttu-id="d5721-151">En general, es posible que se tenga que usar una combinación de estos enfoques.</span><span class="sxs-lookup"><span data-stu-id="d5721-151">Generally, you may have to use a combination of these approaches.</span></span> <span data-ttu-id="d5721-152">Por ejemplo, tal vez desee almacenar los datos XML en una columna de tipo de datos `xml` y promover las propiedades correspondientes en columnas relacionales.</span><span class="sxs-lookup"><span data-stu-id="d5721-152">For example, you may want to store your XML data in an `xml` data type column and promote properties from it into relational columns.</span></span> <span data-ttu-id="d5721-153">O bien, puede que desee usar la tecnología de asignación para almacenar partes de no recursiva en columnas no XML y solo en las partes recursivas de `xml` las columnas de tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="d5721-153">Or, you may want to use mapping technology to store nonrecursive parts in non-XML columns and only the recursive parts in `xml` data type columns.</span></span>  
  
### <a name="choice-of-xml-technology"></a><span data-ttu-id="d5721-154">Elección de la tecnología XML</span><span class="sxs-lookup"><span data-stu-id="d5721-154">Choice of XML Technology</span></span>  
 <span data-ttu-id="d5721-155">La elección de la tecnología XML, XML nativo frente a vista XML, en general depende de los siguientes factores:</span><span class="sxs-lookup"><span data-stu-id="d5721-155">The choice of XML technology, native XML versus XML view, generally depends upon the following factors:</span></span>  
  
-   <span data-ttu-id="d5721-156">Opciones de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="d5721-156">Storage options</span></span>  
  
     <span data-ttu-id="d5721-157">Los datos XML pueden ser más apropiados para el almacenamiento de objetos grandes (por ejemplo, el manual de un producto) o más sensibles al almacenamiento en columnas relacionales (por ejemplo, un elemento de línea convertido a XML).</span><span class="sxs-lookup"><span data-stu-id="d5721-157">Your XML data may be more appropriate for large object storage (for example, a product manual), or more amenable to storage in relational columns (for example, a line item converted to XML).</span></span> <span data-ttu-id="d5721-158">Cada opción de almacenamiento preserva la fidelidad del documento en distinta medida.</span><span class="sxs-lookup"><span data-stu-id="d5721-158">Each storage option preserves document fidelity to a different extent.</span></span>  
  
-   <span data-ttu-id="d5721-159">Funciones de consultas</span><span class="sxs-lookup"><span data-stu-id="d5721-159">Query capabilities</span></span>  
  
     <span data-ttu-id="d5721-160">Es posible que una opción de almacenamiento le parezca más apropiada que otra en función de la naturaleza de las consultas y del nivel de detalle con que desea consultar los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-160">You may find one storage option more appropriate than another, based on the nature of your queries and on the extent to which you query your XML data.</span></span> <span data-ttu-id="d5721-161">La consulta detallada de los datos XML (por ejemplo, evaluación de predicados en nodos XML) se admite en diversos grados en las dos opciones de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d5721-161">Fine-grained query of your XML data, for example, predicate evaluation on XML nodes, is supported to varying degrees in the two storage options.</span></span>  
  
-   <span data-ttu-id="d5721-162">Indizar datos XML</span><span class="sxs-lookup"><span data-stu-id="d5721-162">Indexing XML data</span></span>  
  
     <span data-ttu-id="d5721-163">Tal vez desee indizar los datos XML para acelerar el rendimiento de las consultas XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-163">You may want to index the XML data to speed up XML query performance.</span></span> <span data-ttu-id="d5721-164">Las opciones de indización varían según las opciones de almacenamiento; es necesario hacer la elección apropiada para optimizar la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d5721-164">Indexing options vary with the storage options; you have to make the appropriate choice to optimize your workload.</span></span>  
  
-   <span data-ttu-id="d5721-165">Funciones para la modificación de datos</span><span class="sxs-lookup"><span data-stu-id="d5721-165">Data modification capabilities</span></span>  
  
     <span data-ttu-id="d5721-166">Algunas cargas de trabajo implican una modificación detallada de los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-166">Some workloads involve fine-grained modification of XML data.</span></span> <span data-ttu-id="d5721-167">Éste es el caso de agregar una sección nueva a un documento. Sin embargo, otras cargas de trabajo, como el contenido web, no implican la modificación detallada de los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-167">For example, this can include adding a new section within a document, while other workloads, such as Web content, do not.</span></span> <span data-ttu-id="d5721-168">La compatibilidad con el lenguaje de modificación de datos puede ser importante para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5721-168">Data modification language support may be important for your application.</span></span>  
  
-   <span data-ttu-id="d5721-169">Compatibilidad con esquemas</span><span class="sxs-lookup"><span data-stu-id="d5721-169">Schema support</span></span>  
  
     <span data-ttu-id="d5721-170">Los datos XML se pueden describir mediante un esquema que puede ser o no un documento de esquema XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-170">Your XML data may be described by a schema that may or may not be an XML schema document.</span></span> <span data-ttu-id="d5721-171">La compatibilidad con XML enlazado a un esquema depende de la tecnología XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-171">The support for schema-bound XML depends upon the XML technology.</span></span>  
  
 <span data-ttu-id="d5721-172">Las diferentes opciones también tienen distintas características en cuanto al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d5721-172">Different choices also have different performance characteristics.</span></span>  
  
### <a name="native-xml-storage"></a><span data-ttu-id="d5721-173">Almacenamiento de XML nativo</span><span class="sxs-lookup"><span data-stu-id="d5721-173">Native XML Storage</span></span>  
 <span data-ttu-id="d5721-174">Los datos XML se pueden almacenar en una columna de tipo de datos `xml` en el servidor.</span><span class="sxs-lookup"><span data-stu-id="d5721-174">You can store your XML data in an `xml` data type column at the server.</span></span> <span data-ttu-id="d5721-175">Esta es una elección apropiada si se cumple lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="d5721-175">This is an appropriate choice if the following applies:</span></span>  
  
-   <span data-ttu-id="d5721-176">Desea una manera directa de almacenar los datos XML en el servidor y, al mismo tiempo, preservar el orden y la estructura de los documentos.</span><span class="sxs-lookup"><span data-stu-id="d5721-176">You want a straightforward way to store your XML data at the server and, at the same time, preserve document order and document structure.</span></span>  
  
-   <span data-ttu-id="d5721-177">Puede tener o no un esquema para los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-177">You may or may not have a schema for your XML data.</span></span>  
  
-   <span data-ttu-id="d5721-178">Desea consultar y modificar los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-178">You want to query and modify your XML data.</span></span>  
  
-   <span data-ttu-id="d5721-179">Desea indizar los datos XML para procesar más rápido las consultas.</span><span class="sxs-lookup"><span data-stu-id="d5721-179">You want to index the XML data for faster query processing.</span></span>  
  
-   <span data-ttu-id="d5721-180">La aplicación necesita vistas de catálogo del sistema para administrar los datos XML y los esquemas XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-180">Your application needs system catalog views to administer your XML data and XML schemas.</span></span>  
  
 <span data-ttu-id="d5721-181">El almacenamiento XML nativo es útil cuando se tienen documentos XML con una serie de estructuras, o si se tienen documentos XML que se ajustan a esquemas diferentes o completos que son demasiado difíciles de asignar a estructuras relacionales.</span><span class="sxs-lookup"><span data-stu-id="d5721-181">Native XML storage is useful when you have XML documents that have a range of structures, or you have XML documents that conform to different or complex schemas that are too hard to map to relational structures.</span></span>  
  
#### <a name="example-modeling-xml-data-using-the-xml-data-type"></a><span data-ttu-id="d5721-182">Ejemplo: modelado de datos XML mediante el tipo de datos xml</span><span class="sxs-lookup"><span data-stu-id="d5721-182">Example: Modeling XML Data Using the xml Data Type</span></span>  
 <span data-ttu-id="d5721-183">Piense en el manual de un producto en formato XML compuesto por un capítulo independiente para cada tema y por varias secciones dentro de cada capítulo.</span><span class="sxs-lookup"><span data-stu-id="d5721-183">Consider a product manual in XML format that is made up of a separate chapter for each topic and that has multiple sections within each chapter.</span></span> <span data-ttu-id="d5721-184">Una sección puede contener subsecciones.</span><span class="sxs-lookup"><span data-stu-id="d5721-184">A section can contain subsections.</span></span> <span data-ttu-id="d5721-185">Como resultado, \<section> es un elemento recursivo.</span><span class="sxs-lookup"><span data-stu-id="d5721-185">As a result, \<section> is a recursive element.</span></span> <span data-ttu-id="d5721-186">Los manuales de productos contienen una gran cantidad de contenido, diagramas y material técnico entremezclado; los datos están semiestructurados.</span><span class="sxs-lookup"><span data-stu-id="d5721-186">Product manuals contain a large amount of mixed content, diagrams, and technical material; the data is semi-structured.</span></span> <span data-ttu-id="d5721-187">Es posible que los usuarios deseen efectuar búsquedas contextuales de temas de interés, como la sección sobre "índices clúster" en el capítulo sobre "indización", y consultar dimensiones técnicas.</span><span class="sxs-lookup"><span data-stu-id="d5721-187">Users may want to perform a contextual search for topics of interest such as searching for the section on "clustered index" within the chapter on "indexing", and query technical quantities.</span></span>  
  
 <span data-ttu-id="d5721-188">Un modelo de almacenamiento apropiado para los documentos XML es una columna de tipo de datos `xml`.</span><span class="sxs-lookup"><span data-stu-id="d5721-188">An appropriate storage model for your XML documents is an `xml` data type column.</span></span> <span data-ttu-id="d5721-189">Así se preserva el contenido InfoSet de los datos XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-189">This preserves the InfoSet content of your XML data.</span></span> <span data-ttu-id="d5721-190">La indización de la columna XML favorece el rendimiento de las consultas.</span><span class="sxs-lookup"><span data-stu-id="d5721-190">Indexing the XML column benefits query performance.</span></span>  
  
#### <a name="example-retaining-exact-copies-of-xml-data"></a><span data-ttu-id="d5721-191">Ejemplo: conservación de copias exactas de los datos XML</span><span class="sxs-lookup"><span data-stu-id="d5721-191">Example: Retaining Exact Copies of XML Data</span></span>  
 <span data-ttu-id="d5721-192">A modo de ilustración, suponga que las normativas del gobierno le exigen que retenga copias textuales exactas de sus documentos XML,</span><span class="sxs-lookup"><span data-stu-id="d5721-192">For illustration, assume that government regulations require you to retain exact textual copies of your XML documents.</span></span> <span data-ttu-id="d5721-193">como documentos firmados, documentos legales o pedidos de transacciones de almacén.</span><span class="sxs-lookup"><span data-stu-id="d5721-193">For example, these could include signed documents, legal documents, or stock transaction orders.</span></span> <span data-ttu-id="d5721-194">Tal vez desee almacenar los documentos en una columna `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="d5721-194">You may want to store your documents in a `[n]varchar(max)` column.</span></span>  
  
 <span data-ttu-id="d5721-195">Para realizar consultas, convierta los datos al tipo de datos `xml` en tiempo de ejecución y ejecute Xquery.</span><span class="sxs-lookup"><span data-stu-id="d5721-195">For querying, convert the data to `xml` data type at run time and execute Xquery on it.</span></span> <span data-ttu-id="d5721-196">La conversión en tiempo de ejecución puede ser larga, especialmente si el documento es grande.</span><span class="sxs-lookup"><span data-stu-id="d5721-196">The run-time conversion may be costly, especially when the document is large.</span></span> <span data-ttu-id="d5721-197">Si realiza consultas con frecuencia, puede almacenar repetidamente los documentos en una columna de tipo de datos `xml` e indizarla mientras devuelve copias exactas de los documentos desde la columna `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="d5721-197">If you query frequently, you can redundantly store the documents in an `xml` data type column and index it while you return exact document copies from the `[n]varchar(max)` column.</span></span>  
  
 <span data-ttu-id="d5721-198">La columna XML puede ser una columna calculada basada en la columna `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="d5721-198">The XML column may be a computed column, based on the `[n]varchar(max)` column.</span></span> <span data-ttu-id="d5721-199">Sin embargo, no se puede crear un índice XML en una columna XML calculada, ni se puede generar un índice XML `[n]varchar(max)` en `varbinary(max)` columnas o.</span><span class="sxs-lookup"><span data-stu-id="d5721-199">However, you cannot create an XML index on a computed, XML column, nor can an XML index be built on `[n]varchar(max)` or `varbinary(max)` columns.</span></span>  
  
### <a name="xml-view-technology"></a><span data-ttu-id="d5721-200">Tecnología de vistas XML</span><span class="sxs-lookup"><span data-stu-id="d5721-200">XML View Technology</span></span>  
 <span data-ttu-id="d5721-201">La definición de una asignación entre los esquemas XML y las tablas de una base de datos permite crear una "vista XML" de los datos permanentes.</span><span class="sxs-lookup"><span data-stu-id="d5721-201">By defining a mapping between your XML schemas and the tables in a database, you create an "XML view" of your persistent data.</span></span> <span data-ttu-id="d5721-202">Se puede efectuar una carga masiva de XML para rellenar las tablas subyacentes mediante la vista XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-202">XML bulk load can be used to populate the underlying tables by using the XML view.</span></span> <span data-ttu-id="d5721-203">Puede efectuar una consulta en la vista XML mediante XPath versión 1.0; la consulta se traduce en consultas SQL en las tablas.</span><span class="sxs-lookup"><span data-stu-id="d5721-203">You can query the XML view by using XPath version 1.0; the query is translated to SQL queries on the tables.</span></span> <span data-ttu-id="d5721-204">Del mismo modo, las actualizaciones también se propagan a dichas tablas.</span><span class="sxs-lookup"><span data-stu-id="d5721-204">Similarly, updates are also propagated to those tables.</span></span>  
  
 <span data-ttu-id="d5721-205">Esta tecnología es útil en las situaciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="d5721-205">This technology is useful in the following situations:</span></span>  
  
-   <span data-ttu-id="d5721-206">Desea tener un modelo de programación centrado en XML utilizando vistas XML sobre los datos relacionales existentes.</span><span class="sxs-lookup"><span data-stu-id="d5721-206">You want to have an XML-centric programming model using XML views over your existing relational data.</span></span>  
  
-   <span data-ttu-id="d5721-207">Tiene un esquema (XSD, XDR) para los datos XML que puede haberle proporcionado un asociado externo.</span><span class="sxs-lookup"><span data-stu-id="d5721-207">You have a schema (XSD, XDR) for your XML data that an external partner may have provided.</span></span>  
  
-   <span data-ttu-id="d5721-208">El orden no es importante para los datos, los datos de la tabla de la consulta no son recursivos, o el grado máximo de recursividad se conoce de antemano.</span><span class="sxs-lookup"><span data-stu-id="d5721-208">Order is not important in your data, or your query table data is not recursive, or the maximal recursion depth is known in advance.</span></span>  
  
-   <span data-ttu-id="d5721-209">Desea consultar y modificar los datos a través de la vista XML mediante XPath versión 1.0.</span><span class="sxs-lookup"><span data-stu-id="d5721-209">You want to query and modify the data through the XML view by using XPath version 1.0.</span></span>  
  
-   <span data-ttu-id="d5721-210">Desea efectuar una carga masiva de datos XML y distribuirlos en las tablas subyacentes mediante la vista XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-210">You want to bulk load XML data and decompose them into the underlying tables by using the XML view.</span></span>  
  
 <span data-ttu-id="d5721-211">Algunos ejemplos son datos relacionales expuestos como XML para el intercambio de datos y servicios web, y datos XML con esquema fijo.</span><span class="sxs-lookup"><span data-stu-id="d5721-211">Examples include relational data exposed as XML for data exchange and Web services, and XML data with fixed schema.</span></span> <span data-ttu-id="d5721-212">Para obtener más información, vea la biblioteca en línea [MSDN Library](https://go.microsoft.com/fwlink/?linkid=31174).</span><span class="sxs-lookup"><span data-stu-id="d5721-212">For more information, see the [MSDN Online Library](https://go.microsoft.com/fwlink/?linkid=31174).</span></span>  
  
#### <a name="example-modeling-data-using-an-annotated-xml-schema-axsd"></a><span data-ttu-id="d5721-213">Ejemplo: modelado de datos con un esquema XML anotado (AXSD)</span><span class="sxs-lookup"><span data-stu-id="d5721-213">Example: Modeling Data Using an Annotated XML Schema (AXSD)</span></span>  
 <span data-ttu-id="d5721-214">A modo de ilustración, suponga que tiene datos relacionales como clientes, pedidos y artículos de línea, que desea tratar como XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-214">For illustration, assume that you have existing relational data, such as customers, orders, and line items, that you want to handle as XML.</span></span> <span data-ttu-id="d5721-215">Defina una vista XML utilizando AXSD sobre los datos relacionales.</span><span class="sxs-lookup"><span data-stu-id="d5721-215">Define an XML view by using AXSD over the relational data.</span></span> <span data-ttu-id="d5721-216">La vista XML permite efectuar una carga masiva de datos XML en las tablas así como consultar y actualizar los datos relacionales utilizando dicha vista.</span><span class="sxs-lookup"><span data-stu-id="d5721-216">The XML view allows you to bulk load XML data into your tables and query and update the relational data by using the XML view.</span></span> <span data-ttu-id="d5721-217">Este modelo es útil si hay que intercambiar datos que contienen marcado XML con otras aplicaciones, mientras las aplicaciones SQL se ejecutan ininterrumpidamente.</span><span class="sxs-lookup"><span data-stu-id="d5721-217">This model is useful if you have to exchange data that contains XML markup with other applications while your SQL applications work uninterrupted.</span></span>  
  
### <a name="hybrid-model"></a><span data-ttu-id="d5721-218">Modelo híbrido</span><span class="sxs-lookup"><span data-stu-id="d5721-218">Hybrid Model</span></span>  
 <span data-ttu-id="d5721-219">Con frecuencia, una combinación de columnas relacionales y de `xml` tipo de datos es adecuada para el modelado de datos.</span><span class="sxs-lookup"><span data-stu-id="d5721-219">Frequently, a combination of relational and `xml` data type columns is appropriate for data modeling.</span></span> <span data-ttu-id="d5721-220">Algunos valores de los datos XML se pueden almacenar en columnas relacionales y, el resto, o el conjunto de valores XML, en una columna XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-220">Some of the values from your XML data can be stored in relational columns, and the rest, or the whole XML value stored in an XML column.</span></span> <span data-ttu-id="d5721-221">De este modo, se puede obtener un mejor rendimiento ya que se tiene más control sobre los índices creados en las columnas relacionales y las características de bloqueo.</span><span class="sxs-lookup"><span data-stu-id="d5721-221">This may yield better performance in that you have more control over the indexes created on the relational columns and locking characteristics.</span></span>  
  
 <span data-ttu-id="d5721-222">Los valores para almacenar en columnas relacionales dependen de la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d5721-222">The values to store in relational columns depend on your workload.</span></span> <span data-ttu-id="d5721-223">Por ejemplo, si se recuperan todos los valores XML basados en la expresión de ruta de acceso, /Customer/@CustId, promoviendo el valor del atributo **CustId** a una columna relacional e indexándolo, se puede lograr un mejor rendimiento en las consultas.</span><span class="sxs-lookup"><span data-stu-id="d5721-223">For example, if you retrieve all the XML values based on the path expression, /Customer/@CustId, promoting the value of the **CustId** attribute into a relational column and indexing it may yield faster query performance.</span></span> <span data-ttu-id="d5721-224">Por otra parte, si los datos XML se distribuyen ampliamente y sin redundancias en columnas relacionales, el costo del reensamblado puede ser importante.</span><span class="sxs-lookup"><span data-stu-id="d5721-224">On the other hand, if your XML data is extensively and nonredundantly decomposed into relational columns, the re-assembly cost may be significant.</span></span>  
  
 <span data-ttu-id="d5721-225">En el caso de datos XML muy estructurados, por ejemplo, el contenido de una tabla se ha convertido en XML; se pueden asignar todos los valores a columnas relacionales y, posiblemente, usar la tecnología de vistas XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-225">For highly structured XML data, for example, the content of a table has been converted into XML; you can map all values to relational columns, and possibly use XML view technology.</span></span>  
  
## <a name="granularity-of-xml-data"></a><span data-ttu-id="d5721-226">Granularidad de los datos XML</span><span class="sxs-lookup"><span data-stu-id="d5721-226">Granularity of XML Data</span></span>  
 <span data-ttu-id="d5721-227">La granularidad de los datos XML almacenados en una columna XML es muy importante para los bloqueos y, en menor medida, para las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="d5721-227">The granularity of the XML data stored in an XML column is very important for locking and, to a lesser degree, it is also important for updates.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d5721-228">usa el mismo mecanismo de bloqueo tanto para datos XML como no XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-228">uses the same locking mechanism for both XML and non-XML data.</span></span> <span data-ttu-id="d5721-229">Por lo tanto, un bloqueo de nivel de fila provoca que todas las instancias XML de la fila queden bloqueadas.</span><span class="sxs-lookup"><span data-stu-id="d5721-229">Therefore, row-level locking causes all XML instances in the row to be locked.</span></span> <span data-ttu-id="d5721-230">Cuando la granularidad es grande, el bloqueo de instancias XML grandes provoca una disminución del rendimiento en un escenario multiusuario.</span><span class="sxs-lookup"><span data-stu-id="d5721-230">When the granularity is large, locking large XML instances for updates causes throughput to decline in a multiuser scenario.</span></span> <span data-ttu-id="d5721-231">Por otra parte, una distribución amplia provoca una pérdida de la encapsulación de objetos e incrementa el costo del reensamblado.</span><span class="sxs-lookup"><span data-stu-id="d5721-231">On the other hand, severe decomposition loses object encapsulation and increases reassembly cost.</span></span>  
  
 <span data-ttu-id="d5721-232">Para lograr un buen diseño, es importante alcanzar un equilibrio entre los requisitos necesarios para crear modelos de datos y las características de bloqueo y actualización.</span><span class="sxs-lookup"><span data-stu-id="d5721-232">A balance between data modeling requirements and locking and update characteristics is important for good design.</span></span> <span data-ttu-id="d5721-233">Sin embargo, en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], el tamaño de las instancias XML almacenadas realmente no es tan importante.</span><span class="sxs-lookup"><span data-stu-id="d5721-233">However, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the size of actual stored XML instances is not as critical.</span></span>  
  
 <span data-ttu-id="d5721-234">Por ejemplo, las actualizaciones de una instancia XML se efectúan utilizando el nuevo soporte para actualizaciones parciales de objetos binarios grandes (BLOB) y de índices en las que la instancia XML almacenada existente se compara con su versión actualizada.</span><span class="sxs-lookup"><span data-stu-id="d5721-234">For example, updates to an XML instance are performed by using new support for partial binary large object (BLOB) and partial index updates in which the existing stored XML instance is compared to its updated version.</span></span> <span data-ttu-id="d5721-235">La actualización parcial de objetos binarios grandes (BLOB) realiza una comparación diferencial entre las dos instancias XML y únicamente actualiza las diferencias.</span><span class="sxs-lookup"><span data-stu-id="d5721-235">Partial binary large object (BLOB) update performs a differential comparison between the two XML instances and updates only the differences.</span></span> <span data-ttu-id="d5721-236">Las actualizaciones parciales de índices solo modifican aquellas filas que se deben cambiar en el índice XML.</span><span class="sxs-lookup"><span data-stu-id="d5721-236">Partial index updates modify only those rows that must be changed in the XML index.</span></span>  
  
## <a name="limitations-of-the-xml-data-type"></a><span data-ttu-id="d5721-237">Limitaciones del tipo de datos xml</span><span class="sxs-lookup"><span data-stu-id="d5721-237">Limitations of the xml Data Type</span></span>  
 <span data-ttu-id="d5721-238">Tenga en cuenta que el tipo de datos `xml` tiene las limitaciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="d5721-238">Note the following general limitations that apply to the `xml` data type:</span></span>  
  
-   <span data-ttu-id="d5721-239">La representación almacenada de las instancias del tipo de datos `xml` no puede superar los 2 GB.</span><span class="sxs-lookup"><span data-stu-id="d5721-239">The stored representation of `xml` data type instances cannot exceed 2 GB.</span></span>  
  
-   <span data-ttu-id="d5721-240">No puede usarse como un subtipo de una instancia de **sql_variant** .</span><span class="sxs-lookup"><span data-stu-id="d5721-240">It cannot be used as a subtype of a **sql_variant** instance.</span></span>  
  
-   <span data-ttu-id="d5721-241">No admite la conversión a `text` ni a `ntext`.</span><span class="sxs-lookup"><span data-stu-id="d5721-241">It does not support casting or converting to either `text` or `ntext`.</span></span> <span data-ttu-id="d5721-242">Use `varchar(max)` o `nvarchar(max)` en su lugar.</span><span class="sxs-lookup"><span data-stu-id="d5721-242">Use `varchar(max)` or `nvarchar(max)` instead.</span></span>  
  
-   <span data-ttu-id="d5721-243">No puede compararse ni ordenarse.</span><span class="sxs-lookup"><span data-stu-id="d5721-243">It cannot be compared or sorted.</span></span> <span data-ttu-id="d5721-244">Esto significa que un tipo de datos `xml` no puede utilizarse en una instrucción GROUP BY.</span><span class="sxs-lookup"><span data-stu-id="d5721-244">This means an `xml` data type cannot be used in a GROUP BY statement.</span></span>  
  
-   <span data-ttu-id="d5721-245">No puede utilizarse como parámetro de ninguna función integrada escalar que no sea ISNULL, COALESCE o DATALENGTH.</span><span class="sxs-lookup"><span data-stu-id="d5721-245">It cannot be used as a parameter to any scalar, built-in functions other than ISNULL, COALESCE, and DATALENGTH.</span></span>  
  
-   <span data-ttu-id="d5721-246">No puede utilizarse como columna de clave de un índice.</span><span class="sxs-lookup"><span data-stu-id="d5721-246">It cannot be used as a key column in an index.</span></span> <span data-ttu-id="d5721-247">Sin embargo, puede incluirse en forma de datos en un índice clúster o puede agregarse explícitamente a un índice no clúster mediante el uso de la palabra clave INCLUDE al crear el índice no clúster.</span><span class="sxs-lookup"><span data-stu-id="d5721-247">However, it can be included as data in a clustered index or explicitly added to a nonclustered index by using the INCLUDE keyword when the nonclustered index is created.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d5721-248">Consulte también</span><span class="sxs-lookup"><span data-stu-id="d5721-248">See Also</span></span>  
 [<span data-ttu-id="d5721-249">Ejemplos de importación y exportación en bloque de documentos XML &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="d5721-249">Examples of Bulk Import and Export of XML Documents &#40;SQL Server&#41;</span></span>](../import-export/examples-of-bulk-import-and-export-of-xml-documents-sql-server.md)  
  
  
