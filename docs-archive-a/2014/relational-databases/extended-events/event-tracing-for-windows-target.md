---
title: Seguimiento de eventos para Windows como destino | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xevents
ms.topic: conceptual
helpviewer_keywords:
- event tracing for windows target
- ETW target
- targets [SQL Server extended events], event tracing for windows target
ms.assetid: ca2bb295-b7f6-49c3-91ed-0ad4c39f89d5
author: rothja
ms.author: jroth
ms.openlocfilehash: 55f247af30b5278f614b6505a94266cc07ec6c54
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87663488"
---
# <a name="event-tracing-for-windows-target"></a><span data-ttu-id="acadb-102">seguimiento de eventos para Windows de destino</span><span class="sxs-lookup"><span data-stu-id="acadb-102">Event Tracing for Windows Target</span></span>
  <span data-ttu-id="acadb-103">Antes de utilizar el Seguimiento de eventos para Windows (ETW) como destino, se recomienda tener conocimientos prácticos de ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-103">Before you use Event Tracing for Windows (ETW) as a target, we recommend that you have a working knowledge of ETW.</span></span> <span data-ttu-id="acadb-104">El Seguimiento de eventos para Windows (ETW) se utiliza junto a Extended Events o como un consumidor de eventos de Extended Events.</span><span class="sxs-lookup"><span data-stu-id="acadb-104">ETW tracing is either used together with Extended Events or as an Extended Events event consumer.</span></span> <span data-ttu-id="acadb-105">Los vínculos externos siguientes proporcionan un punto de inicio para obtener información general sobre ETW:</span><span class="sxs-lookup"><span data-stu-id="acadb-105">The following external links provide a starting point for obtaining background information about ETW:</span></span>  
  
-   [<span data-ttu-id="acadb-106">Eventos de Windows</span><span class="sxs-lookup"><span data-stu-id="acadb-106">Windows Events</span></span>](https://go.microsoft.com/fwlink/?LinkId=92380)  
  
-   [<span data-ttu-id="acadb-107">Mejorar la depuración y el ajuste del rendimiento con ETW</span><span class="sxs-lookup"><span data-stu-id="acadb-107">Improve Debugging And Performance Tuning With ETW</span></span>](https://go.microsoft.com/fwlink/?LinkId=92381)  
  
 <span data-ttu-id="acadb-108">El destino ETW es un destino singleton, aunque el destino se puede agregar a muchas sesiones.</span><span class="sxs-lookup"><span data-stu-id="acadb-108">The ETW target is a singleton target, although the target can be added to many sessions.</span></span> <span data-ttu-id="acadb-109">Si un evento se provoca en muchas sesiones, solamente se difundirá al destino ETW una vez por cada vez que se produzca.</span><span class="sxs-lookup"><span data-stu-id="acadb-109">If an event is raised on many sessions, the event will only be propagated to the ETW target one time per event occurrence.</span></span> <span data-ttu-id="acadb-110">El motor de Extended Events está limitado a una sola instancia por proceso.</span><span class="sxs-lookup"><span data-stu-id="acadb-110">The Extended Events engine is limited to a single instance per process.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="acadb-111">Para que el destino ETW funcione, la cuenta de inicio del servicio [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] debe ser miembro del grupo de usuarios del registro de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="acadb-111">For the ETW target to work, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Service startup account must be a member of the Performance Log Users group.</span></span>  
  
 <span data-ttu-id="acadb-112">El proceso que hospeda el motor de Extended Events controla la configuración de los eventos presentes en una sesión ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-112">The configuration of the events present in an ETW session is controlled by the process that hosts the Extended Events engine.</span></span> <span data-ttu-id="acadb-113">El motor controla los eventos que se van a provocar y las condiciones que se deben cumplir para que se produzca un evento.</span><span class="sxs-lookup"><span data-stu-id="acadb-113">The engine controls which events to raise and what conditions must be met for an event to occur.</span></span>  
  
 <span data-ttu-id="acadb-114">Después de enlazar a una sesión de Extended Events, que adjunta el destino ETW por primera vez en el período de duración de un proceso, el destino ETW abre una única sesión ETW en el proveedor de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="acadb-114">After binding to an Extended Events session, which attaches the ETW target for the first time during the lifetime of a process, the ETW target opens a single ETW session on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="acadb-115">Si ya existe una sesión ETW, el destino ETW obtiene una referencia a la sesión existente.</span><span class="sxs-lookup"><span data-stu-id="acadb-115">If an ETW session already exists, the ETW target obtains a reference to the existing session.</span></span> <span data-ttu-id="acadb-116">Esta sesión ETW se comparte con todas las instancias de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en un equipo determinado.</span><span class="sxs-lookup"><span data-stu-id="acadb-116">This ETW session is shared across all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instances on a given computer.</span></span> <span data-ttu-id="acadb-117">Esta sesión ETW recibe todos los eventos de las sesiones que tienen el destino ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-117">This ETW session receives all the events from sessions that have the ETW target.</span></span>  
  
 <span data-ttu-id="acadb-118">Dado que ETW necesita proveedores para habilitarse y así utilizar los eventos y encauzarlos a ETW, se habilitan todos los paquetes de Extended Events en la sesión.</span><span class="sxs-lookup"><span data-stu-id="acadb-118">Because ETW needs providers to be enabled to consume events and flow them down to the ETW, all Extended Events packages are enabled on the session.</span></span> <span data-ttu-id="acadb-119">Cuando se activa un evento, el destino ETW envía el evento a la sesión en la que está habilitado el proveedor para el evento.</span><span class="sxs-lookup"><span data-stu-id="acadb-119">When an event is fired, the ETW target sends the event to the session on which the provider for the event is enabled.</span></span>  
  
 <span data-ttu-id="acadb-120">El destino ETW admite la publicación sincrónica de eventos en el subproceso que provoca el evento.</span><span class="sxs-lookup"><span data-stu-id="acadb-120">The ETW target supports synchronous publishing of events on the thread that raises the event.</span></span> <span data-ttu-id="acadb-121">Sin embargo, el destino ETW no admite la publicación asincrónica de eventos.</span><span class="sxs-lookup"><span data-stu-id="acadb-121">However, the ETW target does not support asynchronous event publishing.</span></span>  
  
 <span data-ttu-id="acadb-122">El destino ETW no admite el control de las controladoras ETW externas como logman.exe.</span><span class="sxs-lookup"><span data-stu-id="acadb-122">The ETW target does not support control from external ETW controllers such as Logman.exe.</span></span> <span data-ttu-id="acadb-123">Para generar seguimientos de ETW, se debe crear una sesión de evento con el destino ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-123">To produce ETW traces, an event session must be created with the ETW target.</span></span> <span data-ttu-id="acadb-124">Para obtener más información, vea [CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="acadb-124">For more information, see [CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="acadb-125">Al habilitar el destino ETW se crea una sesión ETW denominada XE_DEFAULT_ETW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="acadb-125">Enabling the ETW target creates an ETW session that is named XE_DEFAULT_ETW_SESSION.</span></span> <span data-ttu-id="acadb-126">Si ya existe una sesión con el nombre XE_DEFAULT_ETW_SESSION, se usa sin modificar ninguna de las propiedades de la sesión existente.</span><span class="sxs-lookup"><span data-stu-id="acadb-126">If a session with the name XE_DEFAULT_ETW_SESSION already exists, it is used without modifying any properties of the existing session.</span></span> <span data-ttu-id="acadb-127">XE_DEFAULT_ETW_SESSION se comparte entre todas las instancias de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="acadb-127">The XE_DEFAULT_ETW_SESSION is shared between all instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="acadb-128">Después de iniciar una sesión XE_DEFAULT_ETW_SESSION, debe detenerla mediante una controladora ETW, como la herramienta Logman.</span><span class="sxs-lookup"><span data-stu-id="acadb-128">After you start the XE_DEFAULT_ETW_SESSION, you must stop it by using an ETW controller, such as the Logman tool.</span></span> <span data-ttu-id="acadb-129">Por ejemplo, puede ejecutar el siguiente comando en el símbolo del sistema: `logman stop XE_DEFAULT_ETW_SESSION -ets`.</span><span class="sxs-lookup"><span data-stu-id="acadb-129">For example, you can run the following command at the command prompt: `logman stop XE_DEFAULT_ETW_SESSION -ets`.</span></span>  
  
 <span data-ttu-id="acadb-130">En la tabla siguiente se describen las opciones disponibles para configurar el destino ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-130">The following table describes the available options for configuring the ETW target.</span></span>  
  
|<span data-ttu-id="acadb-131">Opción</span><span class="sxs-lookup"><span data-stu-id="acadb-131">Option</span></span>|<span data-ttu-id="acadb-132">Valores permitidos</span><span class="sxs-lookup"><span data-stu-id="acadb-132">Allowed values</span></span>|<span data-ttu-id="acadb-133">Descripción</span><span class="sxs-lookup"><span data-stu-id="acadb-133">Description</span></span>|  
|------------|--------------------|-----------------|  
|<span data-ttu-id="acadb-134">default_xe_session_name</span><span class="sxs-lookup"><span data-stu-id="acadb-134">default_xe_session_name</span></span>|<span data-ttu-id="acadb-135">Cualquier cadena de 256 caracteres, como máximo.</span><span class="sxs-lookup"><span data-stu-id="acadb-135">Any string up to 256 characters.</span></span> <span data-ttu-id="acadb-136">Este valor es opcional.</span><span class="sxs-lookup"><span data-stu-id="acadb-136">This value is optional.</span></span>|<span data-ttu-id="acadb-137">El nombre de la sesión de Extended Events.</span><span class="sxs-lookup"><span data-stu-id="acadb-137">The Extended Events session name.</span></span> <span data-ttu-id="acadb-138">De forma predeterminada, es XE_DEFAULT_ETW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="acadb-138">By default, this is XE_DEFAULT_ETW_SESSION.</span></span>|  
|<span data-ttu-id="acadb-139">default_etw_session_logfile_path</span><span class="sxs-lookup"><span data-stu-id="acadb-139">default_etw_session_logfile_path</span></span>|<span data-ttu-id="acadb-140">Cualquier cadena de 256 caracteres, como máximo.</span><span class="sxs-lookup"><span data-stu-id="acadb-140">Any string up to 256 characters.</span></span> <span data-ttu-id="acadb-141">Este valor es opcional.</span><span class="sxs-lookup"><span data-stu-id="acadb-141">This value is optional.</span></span>|<span data-ttu-id="acadb-142">La ruta de acceso del archivo de registro para la sesión de Extended Events.</span><span class="sxs-lookup"><span data-stu-id="acadb-142">The path of the log file for the Extended Events session.</span></span> <span data-ttu-id="acadb-143">De forma predeterminada, es %TEMP%\XEEtw.etl.</span><span class="sxs-lookup"><span data-stu-id="acadb-143">By default, this is %TEMP%\ XEEtw.etl.</span></span>|  
|<span data-ttu-id="acadb-144">default_etw_session_logfile_size_mb</span><span class="sxs-lookup"><span data-stu-id="acadb-144">default_etw_session_logfile_size_mb</span></span>|<span data-ttu-id="acadb-145">Un entero sin signo.</span><span class="sxs-lookup"><span data-stu-id="acadb-145">Any unsigned integer.</span></span> <span data-ttu-id="acadb-146">Este valor es opcional.</span><span class="sxs-lookup"><span data-stu-id="acadb-146">This value is optional.</span></span>|<span data-ttu-id="acadb-147">El tamaño del archivo de registro, en megabytes (MB), para la sesión de Extended Events.</span><span class="sxs-lookup"><span data-stu-id="acadb-147">The log file size, in megabytes (MB), for the Extended Events session.</span></span> <span data-ttu-id="acadb-148">El valor predeterminado es 20 MB.</span><span class="sxs-lookup"><span data-stu-id="acadb-148">The default is 20 MB.</span></span>|  
|<span data-ttu-id="acadb-149">default_etw_session_buffer_size_kb</span><span class="sxs-lookup"><span data-stu-id="acadb-149">default_etw_session_buffer_size_kb</span></span>|<span data-ttu-id="acadb-150">Un entero sin signo.</span><span class="sxs-lookup"><span data-stu-id="acadb-150">Any unsigned integer.</span></span> <span data-ttu-id="acadb-151">Este valor es opcional.</span><span class="sxs-lookup"><span data-stu-id="acadb-151">This value is optional.</span></span>|<span data-ttu-id="acadb-152">El tamaño de búfer en memoria, en kilobytes (kB), para la sesión de Extended Events.</span><span class="sxs-lookup"><span data-stu-id="acadb-152">The in-memory buffer size, in kilobytes (KB), for the Extended Events session.</span></span> <span data-ttu-id="acadb-153">El valor predeterminado es 128 kB.</span><span class="sxs-lookup"><span data-stu-id="acadb-153">The default is 128 KB.</span></span>|  
|<span data-ttu-id="acadb-154">retries</span><span class="sxs-lookup"><span data-stu-id="acadb-154">retries</span></span>|<span data-ttu-id="acadb-155">Un entero sin signo.</span><span class="sxs-lookup"><span data-stu-id="acadb-155">Any unsigned integer.</span></span>|<span data-ttu-id="acadb-156">El número de veces que se debe reintentar publicar el evento al subsistema de ETW antes de quitar el evento.</span><span class="sxs-lookup"><span data-stu-id="acadb-156">The number of times to retry publishing the event to the ETW subsystem before dropping the event.</span></span> <span data-ttu-id="acadb-157">El valor predeterminado es 0.</span><span class="sxs-lookup"><span data-stu-id="acadb-157">The default is 0.</span></span>|  
  
 <span data-ttu-id="acadb-158">La configuración de estos valores es opcional.</span><span class="sxs-lookup"><span data-stu-id="acadb-158">Configuring these settings is optional.</span></span> <span data-ttu-id="acadb-159">El destino ETW utiliza los valores predeterminados para estos valores.</span><span class="sxs-lookup"><span data-stu-id="acadb-159">The ETW target uses default values for these settings.</span></span>  
  
 <span data-ttu-id="acadb-160">El destino ETW es responsable de:</span><span class="sxs-lookup"><span data-stu-id="acadb-160">The ETW target is responsible for:</span></span>  
  
-   <span data-ttu-id="acadb-161">Crear la sesión ETW predeterminada.</span><span class="sxs-lookup"><span data-stu-id="acadb-161">Creating the default ETW session.</span></span>  
  
-   <span data-ttu-id="acadb-162">Registrar todos los paquetes de Extended Events con ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-162">Registering all Extended Events packages with ETW.</span></span> <span data-ttu-id="acadb-163">Así se asegura de que ETW no quita los eventos.</span><span class="sxs-lookup"><span data-stu-id="acadb-163">This ensures that events are not dropped by ETW.</span></span>  
  
-   <span data-ttu-id="acadb-164">Administrar el flujo de eventos a ETW.</span><span class="sxs-lookup"><span data-stu-id="acadb-164">Managing the flow of events to ETW.</span></span> <span data-ttu-id="acadb-165">El destino ETW crea un evento ETW con los datos de Extended Events y lo envía a la sesión ETW adecuada.</span><span class="sxs-lookup"><span data-stu-id="acadb-165">The ETW target creates an ETW event with Extended Events data and sends it to the appropriate ETW session.</span></span> <span data-ttu-id="acadb-166">Si el evento es mayor que el tamaño de búfer o los datos no caben en un evento ETW, ETW dividirá el evento en varios fragmentos.</span><span class="sxs-lookup"><span data-stu-id="acadb-166">If the event is larger than the buffer size, or data cannot fit in one ETW event, ETW splits the event into fragments.</span></span>  
  
-   <span data-ttu-id="acadb-167">Mantener los paquetes de Extended Events habilitados en todo momento.</span><span class="sxs-lookup"><span data-stu-id="acadb-167">Keeping Extended Events packages enabled at all times.</span></span>  
  
 <span data-ttu-id="acadb-168">ETW utiliza las siguientes ubicaciones predeterminadas de archivos:</span><span class="sxs-lookup"><span data-stu-id="acadb-168">The following default file locations are used by ETW:</span></span>  
  
-   <span data-ttu-id="acadb-169">El archivo de salida ETW está en %TEMP%\XEEtw.etl.</span><span class="sxs-lookup"><span data-stu-id="acadb-169">The ETW output file is in %TEMP%\XEEtw.etl.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="acadb-170">No se puede cambiar la ruta de acceso del archivo después de que la primera sesión se haya iniciado.</span><span class="sxs-lookup"><span data-stu-id="acadb-170">The file path cannot be changed after the first session starts.</span></span>  
  
-   <span data-ttu-id="acadb-171">Los archivos MOF Managed Object Format (MOF) se encuentran en *\<your install path>* \Microsoft SQL Server\Shared.</span><span class="sxs-lookup"><span data-stu-id="acadb-171">Managed Object Format (MOF) files are in *\<your install path>* \Microsoft SQL Server\Shared.</span></span> <span data-ttu-id="acadb-172">Para obtener más información, vea [Formato de objetos administrados](https://go.microsoft.com/fwlink/?LinkId=92851) en MSDN.</span><span class="sxs-lookup"><span data-stu-id="acadb-172">For more information, see [Managed Object Format](https://go.microsoft.com/fwlink/?LinkId=92851) on MSDN.</span></span>  
  
## <a name="adding-the-target-to-a-session"></a><span data-ttu-id="acadb-173">Agregar el destino a una sesión</span><span class="sxs-lookup"><span data-stu-id="acadb-173">Adding the Target to a Session</span></span>  
 <span data-ttu-id="acadb-174">Para agregar el destino ETW a una sesión de eventos extendidos, debe incluir la siguiente instrucción al crear o modificar una sesión de eventos:</span><span class="sxs-lookup"><span data-stu-id="acadb-174">To add the ETW target to an Extended Events session, you must include the following statement when you create or alter an event session:</span></span>  
  
```  
ADD TARGET package0.etw_classic_sync_target  
```  
  
 <span data-ttu-id="acadb-175">Para obtener más información sobre un ejemplo completo que muestra cómo usar el destino ETW, incluida la forma de ver los datos, vea [Supervisar la actividad del sistema mediante eventos extendidos](monitor-system-activity-using-extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="acadb-175">For more information about a full example that shows how to use the ETW target, including how to view the data, see [Monitor System Activity Using Extended Events](monitor-system-activity-using-extended-events.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="acadb-176">Consulte también</span><span class="sxs-lookup"><span data-stu-id="acadb-176">See Also</span></span>  
 <span data-ttu-id="acadb-177">[Destinos de SQL Server Extended Events](../../database-engine/sql-server-extended-events-targets.md) </span><span class="sxs-lookup"><span data-stu-id="acadb-177">[SQL Server Extended Events Targets](../../database-engine/sql-server-extended-events-targets.md) </span></span>  
 <span data-ttu-id="acadb-178">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acadb-178">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span></span>  
 <span data-ttu-id="acadb-179">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="acadb-179">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span></span>  
 [<span data-ttu-id="acadb-180">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="acadb-180">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-event-session-transact-sql)  
  
  
