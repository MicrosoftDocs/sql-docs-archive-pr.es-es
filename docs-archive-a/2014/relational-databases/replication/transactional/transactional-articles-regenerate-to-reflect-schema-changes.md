---
title: Volver a generar procedimientos transaccionales personalizados para reflejar cambios de esquema | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- custom procedures [SQL Server replication]
- transactional replication, replicating schema changes
- schemas [SQL Server replication], replicating changes
ms.assetid: ccf68a13-e748-4455-8168-90e6d2868098
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 7b41b5309816e037ce3619e880b796e0653c7506
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87748726"
---
# <a name="regenerate-custom-transactional-procedures-to-reflect-schema-changes"></a><span data-ttu-id="b1c71-102">Volver a generar procedimientos transaccionales personalizados para reflejar cambios de esquema</span><span class="sxs-lookup"><span data-stu-id="b1c71-102">Regenerate Custom Transactional Procedures to Reflect Schema Changes</span></span>
  <span data-ttu-id="b1c71-103">De manera predeterminada, la replicación transaccional lleva a cabo todos los cambios de datos en los suscriptores a través de procedimientos almacenados generados por procedimientos internos para cada artículo de la tabla en la publicación.</span><span class="sxs-lookup"><span data-stu-id="b1c71-103">By default transactional replication makes all data changes at Subscribers through stored procedures that are generated by internal procedures for each table article in the publication.</span></span> <span data-ttu-id="b1c71-104">Los tres procedimientos (para inserciones, actualizaciones y eliminaciones, respectivamente) se copian al suscriptor y se ejecutan cuando se replica una inserción, actualización o eliminación en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="b1c71-104">The three procedures (one each for inserts, updates, and deletes) are copied to the Subscriber and execute when an insert, update, or delete is replicated to the Subscriber.</span></span> <span data-ttu-id="b1c71-105">Cuando se realiza un cambio de esquema en una tabla de un publicador de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , la replicación vuelve a generar automáticamente estos procedimientos, llamando al mismo conjunto de procedimientos internos de scripting para que los nuevos procedimientos coincidan con el nuevo esquema (no se admite la replicación de cambios de esquema para los publicadores de Oracle).</span><span class="sxs-lookup"><span data-stu-id="b1c71-105">When a schema change is made to a table on a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publisher, replication regenerates these procedures automatically by calling the same set of internal scripting procedures so that the new procedures match the new schema (replication of schema changes is not supported for Oracle Publishers).</span></span>  
  
 <span data-ttu-id="b1c71-106">También es posible especificar procedimientos personalizados para reemplazar uno o más de los procedimientos predeterminados.</span><span class="sxs-lookup"><span data-stu-id="b1c71-106">It is also possible to specify custom procedures to replace one or more of the default procedures.</span></span> <span data-ttu-id="b1c71-107">Los procedimientos personalizados se deben modificar si el cambio de esquema va a afectar al procedimiento.</span><span class="sxs-lookup"><span data-stu-id="b1c71-107">The custom procedures should be changed if the schema change will affect the procedure.</span></span> <span data-ttu-id="b1c71-108">Por ejemplo, si un procedimiento hace referencia a una columna que se quita en un cambio de esquema, se deben quitar del procedimiento las referencias a esa columna.</span><span class="sxs-lookup"><span data-stu-id="b1c71-108">For example, if a procedure references a column that is dropped in a schema change, references to the column should be removed from the procedure.</span></span> <span data-ttu-id="b1c71-109">La replicación propaga un nuevo procedimiento personalizado a los suscriptores de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="b1c71-109">There are two ways for replication to propagate a new custom procedure to Subscribers:</span></span>  
  
-   <span data-ttu-id="b1c71-110">La primera opción es utilizar un procedimiento de scripting personalizado para reemplazar los valores predeterminados que utiliza la replicación:</span><span class="sxs-lookup"><span data-stu-id="b1c71-110">The first option is to use a custom scripting procedure to replace the defaults used by replication:</span></span>  
  
    1.  <span data-ttu-id="b1c71-111">Al ejecutar [sp_addarticle &#40;&#41;de Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), asegúrese de **@schema_option** que el bit 0x02 es **true**.</span><span class="sxs-lookup"><span data-stu-id="b1c71-111">When executing [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), ensure the **@schema_option** 0x02 bit is to **true**.</span></span>  
  
    2.  <span data-ttu-id="b1c71-112">Ejecute [sp_register_custom_scripting &#40;&#41;de Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql) y especifique un valor de ' INSERT ', ' update ' o ' delete ' para el parámetro **@type** y el nombre del procedimiento de scripting personalizado para el parámetro **@value** .</span><span class="sxs-lookup"><span data-stu-id="b1c71-112">Execute [sp_register_custom_scripting &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql) and specify a value of 'insert', 'update', or 'delete' for the parameter **@type** and the name of the custom scripting procedure for the parameter **@value**.</span></span>  
  
     <span data-ttu-id="b1c71-113">La siguiente vez que se lleve a cabo un cambio de esquema, la replicación llamará a este procedimiento almacenado para crear un script de la definición para el nuevo procedimiento almacenado personalizado definido por el usuario y, después, propagará el procedimiento a cada suscriptor.</span><span class="sxs-lookup"><span data-stu-id="b1c71-113">The next time a schema change is made, replication calls this stored procedure to script out the definition for the new user defined custom stored procedure, and then propagates the procedure to each Subscriber.</span></span>  
  
-   <span data-ttu-id="b1c71-114">La segunda opción es utilizar un script que contenga una nueva definición de procedimiento personalizado:</span><span class="sxs-lookup"><span data-stu-id="b1c71-114">The second option is to use a script that contains a new custom procedure definition:</span></span>  
  
    1.  <span data-ttu-id="b1c71-115">Al ejecutar [sp_addarticle &#40;&#41;de Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), establezca el **@schema_option** bit 0x02 en **false** para que la replicación no genere automáticamente procedimientos personalizados en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="b1c71-115">When executing [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), set the **@schema_option** 0x02 bit to **false** so replication does not automatically generate custom procedures at the Subscriber.</span></span>  
  
    2.  <span data-ttu-id="b1c71-116">Antes de cada cambio de esquema, cree un nuevo archivo de script y registre el script con la replicación, ejecutando [sp_register_custom_scripting &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b1c71-116">Before each schema change, create a new script file and register the script with replication by executing [sp_register_custom_scripting &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql).</span></span> <span data-ttu-id="b1c71-117">Especifique un valor de ' custom_script ' para el parámetro **@type** y la ruta de acceso al script en el publicador para el parámetro **@value** .</span><span class="sxs-lookup"><span data-stu-id="b1c71-117">Specify a value of 'custom_script' for the parameter **@type** and the path to the script on the Publisher for the parameter **@value**.</span></span>  
  
     <span data-ttu-id="b1c71-118">La siguiente vez que realice un cambio de esquema importante, este script se ejecutará en cada suscriptor en la misma transacción que el comando DDL.</span><span class="sxs-lookup"><span data-stu-id="b1c71-118">The next time a relevant schema change is made, this script executes on each Subscriber within the same transaction as the DDL command.</span></span> <span data-ttu-id="b1c71-119">Una vez realizado el cambio de esquema, el script se elimina del registro.</span><span class="sxs-lookup"><span data-stu-id="b1c71-119">After the schema change is made, the script is unregistered.</span></span> <span data-ttu-id="b1c71-120">Debe volver a registrar el script para que se ejecute de nuevo después del siguiente cambio de esquema.</span><span class="sxs-lookup"><span data-stu-id="b1c71-120">You must re-register the script to have it executed after a subsequent schema change.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b1c71-121">Consulte también</span><span class="sxs-lookup"><span data-stu-id="b1c71-121">See Also</span></span>  
 <span data-ttu-id="b1c71-122">[Especificar cómo se propagan los cambios para los artículos transaccionales](transactional-articles-specify-how-changes-are-propagated.md) </span><span class="sxs-lookup"><span data-stu-id="b1c71-122">[Specify How Changes Are Propagated for Transactional Articles](transactional-articles-specify-how-changes-are-propagated.md) </span></span>  
 [<span data-ttu-id="b1c71-123">Realizar cambios de esquema en bases de datos de publicaciones</span><span class="sxs-lookup"><span data-stu-id="b1c71-123">Make Schema Changes on Publication Databases</span></span>](../publish/make-schema-changes-on-publication-databases.md)  
  
  
