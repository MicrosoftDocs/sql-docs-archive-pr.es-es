---
title: Agrupar cambios en filas relacionadas con registros lógicos | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication logical records [SQL Server replication]
- articles [SQL Server replication], logical records
- logical records [SQL Server replication]
ms.assetid: ad76799c-4486-4b98-9705-005433041321
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 433e0edbe83d102e6002bd133f967f27a236f66e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87661967"
---
# <a name="group-changes-to-related-rows-with-logical-records"></a><span data-ttu-id="c4a87-102">Agrupar cambios en filas relacionadas con registros lógicos</span><span class="sxs-lookup"><span data-stu-id="c4a87-102">Group Changes to Related Rows with Logical Records</span></span>
  
> [!NOTE]
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]

 <span data-ttu-id="c4a87-103">De manera predeterminada, la replicación de mezcla procesa los cambios de datos fila por fila.</span><span class="sxs-lookup"><span data-stu-id="c4a87-103">By default, merge replication processes data changes on a row-by-row basis.</span></span> <span data-ttu-id="c4a87-104">Esto es apropiado en muchos casos, pero para algunas aplicaciones, es fundamental que las filas relacionadas se procesen como una unidad.</span><span class="sxs-lookup"><span data-stu-id="c4a87-104">In many circumstances this is appropriate, but for some applications, it is essential that related rows be processed as a unit.</span></span> <span data-ttu-id="c4a87-105">La característica de registros lógicos de la replicación de mezcla permite definir una relación entre filas relacionadas de diferentes tablas, para que las filas se procesen como una unidad.</span><span class="sxs-lookup"><span data-stu-id="c4a87-105">The logical records feature of merge replication allows you to define a relationship between related rows in different tables so that the rows are processed as a unit.</span></span>

> [!NOTE]
>  <span data-ttu-id="c4a87-106">La característica de registros lógicos se puede utilizar sola o con los filtros de combinación.</span><span class="sxs-lookup"><span data-stu-id="c4a87-106">The logical records feature can be used alone or in conjunction with join filters.</span></span> <span data-ttu-id="c4a87-107">Para obtener más información acerca de los filtros de combinación, vea [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-107">For more information about join filters, see [Join Filters](join-filters.md).</span></span> <span data-ttu-id="c4a87-108">Para utilizar los registros lógicos, el nivel de compatibilidad de la publicación debe ser de al menos 90RTM.</span><span class="sxs-lookup"><span data-stu-id="c4a87-108">To use logical records, the compatibility level of the publication must be at least 90RTM.</span></span>

 <span data-ttu-id="c4a87-109">Considere estas tres tablas relacionadas:</span><span class="sxs-lookup"><span data-stu-id="c4a87-109">Consider these three related tables:</span></span>

 <span data-ttu-id="c4a87-110">![Tres registros lógicos de tabla, solo con los nombres de columna](../media/logical-records-01.gif "Tres registros lógicos de tabla, solo con los nombres de columna")</span><span class="sxs-lookup"><span data-stu-id="c4a87-110">![Three table logical record, with column names only](../media/logical-records-01.gif "Three table logical record, with column names only")</span></span>

 <span data-ttu-id="c4a87-111">La tabla **Customers** es la tabla primaria en esta relación y tiene una columna de clave principal, **CustID**.</span><span class="sxs-lookup"><span data-stu-id="c4a87-111">The **Customers** table is the parent table in this relationship and has a primary key column **CustID**.</span></span> <span data-ttu-id="c4a87-112">La tabla **Orders** tiene una columna de clave principal, **OrderID**, con una restricción de clave externa en la columna **CustID** que hace referencia a la columna **CustID** de la tabla **Customers** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-112">The **Orders** table has a primary key column **OrderID**, with a foreign key constraint on the **CustID** column that references the **CustID** column in the **Customers** table.</span></span> <span data-ttu-id="c4a87-113">De la misma forma, la tabla **OrderItems** tiene una columna de clave principal, **OrderItemID**, con una restricción de clave externa en la columna **OrderID** que hace referencia a la columna **OrderID** de la tabla **Orders** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-113">Similarly, the **OrderItems** table has a primary key column **OrderItemID**, with a foreign key constraint on the **OrderID** column that references the **OrderID** column in the **Orders** table.</span></span>

 <span data-ttu-id="c4a87-114">En este ejemplo, un registro lógico está formado por todas las filas de la tabla **Orders** relacionadas con un solo valor **CustID** y todas las filas de la tabla **OrderItems** relacionadas con esas filas en la tabla **Orders** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-114">In this example, a logical record consists of all the rows in the **Orders** table that are related to a single **CustID** value and all of the rows in the **OrderItems** table that are related to those rows in the **Orders** table.</span></span> <span data-ttu-id="c4a87-115">En este diagrama se muestran todas las filas de las tres tablas que se incluyen en el registro lógico para Customer2:</span><span class="sxs-lookup"><span data-stu-id="c4a87-115">This diagram shows all the rows in the three tables that are in the logical record for Customer2:</span></span>

 <span data-ttu-id="c4a87-116">![Tres registros lógicos de tabla con valores](../media/logical-records-02.gif "Tres registros lógicos de tabla con valores")</span><span class="sxs-lookup"><span data-stu-id="c4a87-116">![Three table logical record with values](../media/logical-records-02.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="c4a87-117">Para definir una relación lógica entre artículos, vea [Definir una relación de registros lógicos entre artículos de tabla de mezcla](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-117">To define a logical record relationship between articles, see [Define a Logical Record Relationship Between Merge Table Articles](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span></span>

## <a name="benefits-of-logical-records"></a><span data-ttu-id="c4a87-118">Ventajas de los registros lógicos</span><span class="sxs-lookup"><span data-stu-id="c4a87-118">Benefits of Logical Records</span></span>
 <span data-ttu-id="c4a87-119">La característica de registros lógicos tiene dos ventajas principales:</span><span class="sxs-lookup"><span data-stu-id="c4a87-119">The logical records feature has two primary benefits:</span></span>

-   <span data-ttu-id="c4a87-120">Los cambios de datos se aplican como una unidad.</span><span class="sxs-lookup"><span data-stu-id="c4a87-120">Application of data changes as a unit.</span></span>

-   <span data-ttu-id="c4a87-121">Los conflictos se detectan y resuelven simultáneamente en varias filas de varias tablas.</span><span class="sxs-lookup"><span data-stu-id="c4a87-121">The detection and resolution of conflicts simultaneously on multiple rows from multiple tables.</span></span>

### <a name="the-application-of-changes-as-a-unit"></a><span data-ttu-id="c4a87-122">Aplicación de cambios como una unidad</span><span class="sxs-lookup"><span data-stu-id="c4a87-122">The Application of Changes As a Unit</span></span>
 <span data-ttu-id="c4a87-123">Si se utilizan registros lógicos y se interrumpe el proceso de mezcla, como ocurre en el caso de que se termine la conexión, se revierte el conjunto de cambios relacionados replicados parcialmente.</span><span class="sxs-lookup"><span data-stu-id="c4a87-123">If merge processing is interrupted, such as in the case of a dropped connection, the partially completed set of related replicated changes is rolled back if logical records are used.</span></span> <span data-ttu-id="c4a87-124">Por ejemplo, considere el caso en el que un suscriptor agrega un nuevo pedido con **OrderID** = 6 y dos filas nuevas a la tabla **OrderItems** con **OrderItemID** = 10 y **OrderItemID** = 11 para **OrderID** = 6.</span><span class="sxs-lookup"><span data-stu-id="c4a87-124">For example, consider the case where a Subscriber adds a new order with **OrderID** = 6 and two new rows in the **OrderItems** table with **OrderItemID** = 10 and **OrderItemID** = 11 for **OrderID** = 6.</span></span>

 <span data-ttu-id="c4a87-125">![Tres registros lógicos de tabla con valores](../media/logical-records-04.gif "Tres registros lógicos de tabla con valores")</span><span class="sxs-lookup"><span data-stu-id="c4a87-125">![Three table logical record with values](../media/logical-records-04.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="c4a87-126">Si no se utilizan registros lógicos y el proceso de replicación se interrumpe después de finalizar la fila **Orders** para **OrderID** = 6 pero antes de finalizar **OrderItems** 10 y 11, el valor de **OrderTotal** para **OrderID** = 6 no será coherente con la suma de los valores **OrderAmount** de las filas **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-126">If the replication process is interrupted after the **Orders** row for **OrderID** = 6 is complete, but before the **OrderItems** 10 and 11 are completed, and logical records are not used, the **OrderTotal** value for **OrderID** = 6 will not be consistent with the sum of the **OrderAmount** values for the **OrderItems** rows.</span></span> <span data-ttu-id="c4a87-127">Si se utilizan registros lógicos, la fila **Orders** para **OrderID** = 6 no se confirma hasta que se repliquen los cambios de **OrderItems** relacionados.</span><span class="sxs-lookup"><span data-stu-id="c4a87-127">If logical records are used, the **Orders** row for **OrderID** = 6 is not committed until the related **OrderItems** changes are replicated.</span></span>

 <span data-ttu-id="c4a87-128">En un escenario distinto, si se utilizan registros lógicos y alguien está consultando las tablas cuando el proceso de mezcla está aplicando cambios, el usuario no verá los cambios parcialmente replicados hasta que finalicen.</span><span class="sxs-lookup"><span data-stu-id="c4a87-128">In a different scenario, if logical records are used, and someone is querying tables when the merge process is applying changes, the user will not see the partially replicated changes until they are all complete.</span></span> <span data-ttu-id="c4a87-129">Por ejemplo, el proceso de replicación ha cargado la fila Orders para **OrderID** = 6, pero un usuario consulta las tablas antes de que el proceso de replicación haya replicado las filas **OrderItems** . En este caso, el valor **OrderTotal** no será igual a la suma de los valores **OrderAmount** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-129">For example, the replication process has uploaded the Orders row for **OrderID** = 6, but a user queries the tables before the replication process has replicated the **OrderItems** rows, the **OrderTotal** value would not be the same as the sum of the **OrderAmount** values.</span></span> <span data-ttu-id="c4a87-130">Si se utilizan registros lógicos, la fila **Orders** no estará visible hasta que finalicen las filas **OrderItems** y la transacción se confirme como una unidad.</span><span class="sxs-lookup"><span data-stu-id="c4a87-130">If logical records are used, the **Orders** row would not be visible until the **OrderItems** rows are complete and the transaction has been committed as a unit.</span></span>

### <a name="the-application-of-conflict-handling-to-more-than-one-table"></a><span data-ttu-id="c4a87-131">Aplicación del control de conflictos a más de una tabla</span><span class="sxs-lookup"><span data-stu-id="c4a87-131">The Application of Conflict Handling to More Than One Table</span></span>
 <span data-ttu-id="c4a87-132">Considere el caso en el que dos suscriptores tienen el conjunto de datos anterior:</span><span class="sxs-lookup"><span data-stu-id="c4a87-132">Consider the case where two Subscribers have the data set above:</span></span>

-   <span data-ttu-id="c4a87-133">Un usuario del primer suscriptor cambia **OrderAmount** de **OrderItemID** 5 de 100 a 150 y **OrderTotal** de **OrderID** 3 de 200 a 250.</span><span class="sxs-lookup"><span data-stu-id="c4a87-133">A user at the first Subscriber changes the **OrderAmount** of **OrderItemID** 5 from 100 to 150 and the **OrderTotal** of **OrderID** 3 from 200 to 250.</span></span>

-   <span data-ttu-id="c4a87-134">Un usuario del segundo suscriptor cambia **OrderAmount** de **OrderItemID** 6 de 25 a 125 y **OrderTotal** de **OrderID** 3 de 200 a 300.</span><span class="sxs-lookup"><span data-stu-id="c4a87-134">A user at the second Subscriber changes the **OrderAmount** of **OrderItemID** 6 from 25 to 125 and the **OrderTotal** of **OrderID** 3 from 200 to 300.</span></span>

 <span data-ttu-id="c4a87-135">Si estos cambios se replican sin utilizar registros lógicos, los diferentes valores de **OrderTotal** producirán un conflicto y solo se replicará uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-135">If these changes are replicated without using logical records, the different **OrderTotal** values would result in a conflict and only one of them would be replicated.</span></span> <span data-ttu-id="c4a87-136">Sin embargo, los cambios que no tengan conflictos en la tabla **OrderItems** se replicarán sin conflictos, lo que dejará los valores finales de **OrderTotal** en un estado incoherente respecto a las filas **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-136">But the non-conflicting changes in the **OrderItems** table would be replicated without conflict, leaving the final **OrderTotal** values in an inconsistent state with respect to the **OrderItems** rows.</span></span> <span data-ttu-id="c4a87-137">Si se utilizan registros lógicos en este escenario, también se revertirá el cambio de **OrderItems** asociado a la tabla **Orders** perdedora y el valor final de **OrderTotal** será un resumen exacto de las filas **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-137">If logical records are used in this scenario, the **OrderItems** change associated with the losing **Orders** table change would also be rolled back, and the final **OrderTotal** value would be an accurate summary of the **OrderItems** rows.</span></span>

 <span data-ttu-id="c4a87-138">Para obtener más información sobre las opciones relacionadas con la detección y resolución de conflictos con registros lógicos, vea [Detectar y solucionar conflictos en registros lógicos](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-138">For more information about options related to conflict detection and resolution with logical records, see [Detecting and Resolving Conflicts in Logical Records](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>

## <a name="considerations-for-using-logical-records"></a><span data-ttu-id="c4a87-139">Consideraciones para el uso de registros lógicos</span><span class="sxs-lookup"><span data-stu-id="c4a87-139">Considerations for Using Logical Records</span></span>
 <span data-ttu-id="c4a87-140">Tenga en cuenta las consideraciones siguientes al utilizar registros lógicos:</span><span class="sxs-lookup"><span data-stu-id="c4a87-140">Keep the following considerations in mind when using logical records.</span></span>

### <a name="general-considerations"></a><span data-ttu-id="c4a87-141">Consideraciones generales</span><span class="sxs-lookup"><span data-stu-id="c4a87-141">General Considerations</span></span>

-   <span data-ttu-id="c4a87-142">Se recomienda mantener el menor número de tablas posible en un registro lógico; se recomienda utilizar cinco tablas o menos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-142">It is recommended that you keep the number of tables in a logical record as low as possible; five tables or less is recommended.</span></span>

-   <span data-ttu-id="c4a87-143">Los registros lógicos no pueden hacer referencia a columnas con ninguno de los siguientes tipos de datos:</span><span class="sxs-lookup"><span data-stu-id="c4a87-143">Logical records cannot reference columns with any of the following data types:</span></span>

    -   <span data-ttu-id="c4a87-144">`varchar(max)` y `nvarchar(max)`</span><span class="sxs-lookup"><span data-stu-id="c4a87-144">`varchar(max)` and `nvarchar(max)`</span></span>

    -   `varbinary(max)`

    -   <span data-ttu-id="c4a87-145">`text` y `ntext`</span><span class="sxs-lookup"><span data-stu-id="c4a87-145">`text` and `ntext`</span></span>

    -   `image`

    -   `XML`

    -   `UDT`

-   <span data-ttu-id="c4a87-146">Las relaciones de clave externa en las tablas publicadas no se pueden definir con la opción CASCADE.</span><span class="sxs-lookup"><span data-stu-id="c4a87-146">Foreign key relationships in published tables cannot be defined with the CASCADE option.</span></span> <span data-ttu-id="c4a87-147">Para obtener más información, vea [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) y [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c4a87-147">For more information, see [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) and [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span></span>

-   <span data-ttu-id="c4a87-148">No puede actualizar columnas que se utilicen en una cláusula de relación lógica.</span><span class="sxs-lookup"><span data-stu-id="c4a87-148">You cannot update any columns that are used in the logical relation clause.</span></span>

-   <span data-ttu-id="c4a87-149">No se admite la resolución de conflictos personalizada con controladores de lógica de negocios o solucionadores personalizados para los artículos incluidos en un registro lógico.</span><span class="sxs-lookup"><span data-stu-id="c4a87-149">Custom conflict resolution with business logic handlers or custom resolvers is not supported for articles that are included in a logical record.</span></span>

-   <span data-ttu-id="c4a87-150">Si se utilizan registros lógicos en una publicación que incluye filtros con parámetros, debe inicializar cada suscripción con una instantánea para su partición.</span><span class="sxs-lookup"><span data-stu-id="c4a87-150">If logical records are used in a publication that includes parameterized filters, you must initialize each Subscriber with a snapshot for its partition.</span></span> <span data-ttu-id="c4a87-151">Si inicializa un suscriptor con otro método, se producirá un error en el Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="c4a87-151">If you initialize a Subscriber with another method, the Merge Agent will fail.</span></span> <span data-ttu-id="c4a87-152">Para más información, consulte [Instantáneas para publicaciones de combinación con filtros con parámetros](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-152">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>

-   <span data-ttu-id="c4a87-153">Los conflictos que implican registros lógicos no se muestran en el Visor de conflictos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-153">Conflicts that involve logical records are not displayed in Conflict Viewer.</span></span> <span data-ttu-id="c4a87-154">Para ver información acerca de estos conflictos, utilice procedimientos almacenados de replicación.</span><span class="sxs-lookup"><span data-stu-id="c4a87-154">To view information about these conflicts, use replication stored procedures.</span></span> <span data-ttu-id="c4a87-155">Para obtener más información, vea [Ver información de conflictos para publicaciones de mezcla &#40;programación de la replicación con Transact-SQL&#41;](../view-conflict-information-for-merge-publications.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-155">For more information, see [View Conflict Information for Merge Publications &#40;Replication Transact-SQL Programming&#41;](../view-conflict-information-for-merge-publications.md).</span></span>

### <a name="publication-settings"></a><span data-ttu-id="c4a87-156">Configuración de publicaciones</span><span class="sxs-lookup"><span data-stu-id="c4a87-156">Publication Settings</span></span>

-   <span data-ttu-id="c4a87-157">La publicación debe tener un nivel de compatibilidad igual o superior a 90RTM.</span><span class="sxs-lookup"><span data-stu-id="c4a87-157">The publication must have a compatibility level of 90RTM or greater.</span></span> <span data-ttu-id="c4a87-158">Para obtener más información, vea la sección sobre el nivel de compatibilidad de las publicaciones en el tema [Replication Backward Compatibility](../replication-backward-compatibility.md)(Compatibilidad con versiones anteriores de replicación).</span><span class="sxs-lookup"><span data-stu-id="c4a87-158">For more information, see the "Publication Compatibility Level" section of [Replication Backward Compatibility](../replication-backward-compatibility.md).</span></span>

-   <span data-ttu-id="c4a87-159">La publicación debe utilizar un modo de instantánea nativo.</span><span class="sxs-lookup"><span data-stu-id="c4a87-159">The publication must use native snapshot mode.</span></span> <span data-ttu-id="c4a87-160">Ésta es la opción predeterminada, a menos que esté replicando en [!INCLUDE[ssEW](../../../includes/ssew-md.md)], que no admite registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-160">This is the default unless you are replicating to [!INCLUDE[ssEW](../../../includes/ssew-md.md)], which does not support logical records.</span></span>

-   <span data-ttu-id="c4a87-161">La publicación no permite la sincronización web.</span><span class="sxs-lookup"><span data-stu-id="c4a87-161">The publication cannot allow Web synchronization.</span></span> <span data-ttu-id="c4a87-162">Para obtener más información acerca de la sincronización web, vea [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-162">For more information about Web synchronization, see [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span></span>

-   <span data-ttu-id="c4a87-163">Para utilizar registros lógicos en una publicación filtrada:</span><span class="sxs-lookup"><span data-stu-id="c4a87-163">In order to use logical records on a filtered publication:</span></span>

    -   <span data-ttu-id="c4a87-164">También debe utilizar particiones precalculadas.</span><span class="sxs-lookup"><span data-stu-id="c4a87-164">Precomputed partitions must also be used.</span></span> <span data-ttu-id="c4a87-165">Los requisitos de las particiones precalculadas también se aplican a los registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-165">The requirements of precomputed partitions also apply to logical records.</span></span> <span data-ttu-id="c4a87-166">Para obtener más información, vea [Optimización del rendimiento de los filtros con parámetros con particiones calculadas previamente](parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-166">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>

    -   <span data-ttu-id="c4a87-167">No puede utilizar filtros con parámetros no superpuestos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-167">You cannot use nonoverlapping parameterized filters.</span></span> <span data-ttu-id="c4a87-168">Para obtener más información, vea la sección la sección sobre cómo establecer opciones de partición en el tema [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-168">For more information, see the "Setting 'partition options'" section of [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span></span>

-   <span data-ttu-id="c4a87-169">Si la publicación utiliza filtros de combinación, debe establecer la propiedad **join unique key** en **true** para todos los filtros de combinación involucrados en relaciones de registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-169">If the publication uses join filters, the **join unique key** property must be set to **true** for all join filters that are involved in logical record relationships.</span></span> <span data-ttu-id="c4a87-170">Para obtener más información, consulte [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="c4a87-170">For more information, see [Join Filters](join-filters.md).</span></span>

### <a name="relationships-between-tables"></a><span data-ttu-id="c4a87-171">Relaciones entre tablas</span><span class="sxs-lookup"><span data-stu-id="c4a87-171">Relationships Between Tables</span></span>

-   <span data-ttu-id="c4a87-172">Las tablas relacionadas a través de registros lógicos deben tener una relación clave principal-clave externa.</span><span class="sxs-lookup"><span data-stu-id="c4a87-172">Tables related through logical records must have a primary key-foreign key relationship.</span></span>

-   <span data-ttu-id="c4a87-173">No se puede establecer la opción NOT FOR REPLICATION para restricciones de clave externa.</span><span class="sxs-lookup"><span data-stu-id="c4a87-173">The NOT FOR REPLICATION option cannot be set for foreign key constraints.</span></span>

-   <span data-ttu-id="c4a87-174">Las tablas secundarias solo pueden tener una tabla primaria.</span><span class="sxs-lookup"><span data-stu-id="c4a87-174">Child tables can have only one parent table.</span></span>

     <span data-ttu-id="c4a87-175">Por ejemplo. una base de datos que realice un seguimiento de las clases y los estudiantes puede tener un diseño similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="c4a87-175">For example, a database tracking classes and students might have a design similar to:</span></span>

     <span data-ttu-id="c4a87-176">![Tabla secundaria con más de una tabla primaria](../media/logical-records-03.gif "Tabla secundaria con más de una tabla primaria")</span><span class="sxs-lookup"><span data-stu-id="c4a87-176">![Child table with more than one parent table](../media/logical-records-03.gif "Child table with more than one parent table")</span></span>

     <span data-ttu-id="c4a87-177">No puede utilizar un registro lógico para representar las tres tablas en esta relación, ya que las filas de **ClassMembers** no están asociadas con una sola fila de clave principal.</span><span class="sxs-lookup"><span data-stu-id="c4a87-177">You cannot use a logical record to represent the three tables in this relationship, because the rows in **ClassMembers** are not associated with a single primary key row.</span></span> <span data-ttu-id="c4a87-178">Las tablas **Classes** y **ClassMembers** pueden formar un registro lógico, al igual que las tablas **ClassMembers** y **Students**, pero no las tres juntas.</span><span class="sxs-lookup"><span data-stu-id="c4a87-178">The tables **Classes** and **ClassMembers** could still form a logical record, as could the tables **ClassMembers** and **Students**, but not all three.</span></span>

-   <span data-ttu-id="c4a87-179">La publicación no puede contener relaciones circulares de filtros de combinación.</span><span class="sxs-lookup"><span data-stu-id="c4a87-179">The publication cannot contain circular join filter relationships.</span></span>

     <span data-ttu-id="c4a87-180">Siguiendo el ejemplo de las tablas **Customers**, **Orders**y **OrderItems**, no puede utilizar registros lógicos si la tabla **Orders** también tiene una restricción de clave externa que hace referencia a la tabla **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="c4a87-180">Using the example with the tables **Customers**, **Orders**, and **OrderItems**, you could not use logical records if the **Orders** table also had a foreign key constraint that referenced the **OrderItems** table.</span></span>

## <a name="performance-implications-of-logical-records"></a><span data-ttu-id="c4a87-181">Consecuencias de los registros lógicos en el rendimiento</span><span class="sxs-lookup"><span data-stu-id="c4a87-181">Performance implications of logical records</span></span>
 <span data-ttu-id="c4a87-182">La característica de registros lógicos tiene un costo en rendimiento.</span><span class="sxs-lookup"><span data-stu-id="c4a87-182">The logical record feature does come with a performance cost.</span></span> <span data-ttu-id="c4a87-183">Si no se utilizan registros lógicos, el agente de replicación puede procesar todos los cambios para un artículo determinado a la vez, y como los cambios se aplican fila por fila, los requisitos de bloqueo y registro de transacciones necesarios para aplicar los cambios son mínimos.</span><span class="sxs-lookup"><span data-stu-id="c4a87-183">If logical records are not used, the replication agent can process all of the changes for a given article at the same time, and because the changes are applied in a row-by-row fashion, the locking and transaction log requirements necessary for applying the changes are minimal.</span></span>

 <span data-ttu-id="c4a87-184">Si se utilizan registros lógicos, el Agente de mezcla debe procesar juntos los cambios de todo el registro lógico.</span><span class="sxs-lookup"><span data-stu-id="c4a87-184">If logical records are used, the Merge Agent must process the changes for each entire logical record together.</span></span> <span data-ttu-id="c4a87-185">Esto afecta al tiempo que tarda el Agente de mezcla en replicar las filas.</span><span class="sxs-lookup"><span data-stu-id="c4a87-185">This has an effect on the amount of time it takes the Merge Agent to replicate the rows.</span></span> <span data-ttu-id="c4a87-186">Además, como el agente abre una transacción distinta para cada registro lógico, los requisitos de bloqueo pueden aumentar.</span><span class="sxs-lookup"><span data-stu-id="c4a87-186">Additionally, because the agent opens a separate transaction for each logical record, locking requirements can increase.</span></span>

## <a name="see-also"></a><span data-ttu-id="c4a87-187">Consulte también</span><span class="sxs-lookup"><span data-stu-id="c4a87-187">See Also</span></span>
 [<span data-ttu-id="c4a87-188">Opciones de artículos para replicación de mezcla</span><span class="sxs-lookup"><span data-stu-id="c4a87-188">Article Options for Merge Replication</span></span>](article-options-for-merge-replication.md)


