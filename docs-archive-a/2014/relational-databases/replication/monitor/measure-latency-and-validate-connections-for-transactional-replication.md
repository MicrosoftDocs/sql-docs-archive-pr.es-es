---
title: Medición de la latencia y validación de las conexiones de la replicación transaccional | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Replication Monitor, performance
- tracer tokens [SQL Server replication]
- latency [SQL Server replication]
- transactional replication, tracer tokens
- monitoring performance [SQL Server replication], tracer tokens
ms.assetid: 4addd426-7523-4067-8d7d-ca6bae4c9e34
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3ba1e5eddfdcffa5fbefdea323f110ba9d15ca8c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87670934"
---
# <a name="measure-latency-and-validate-connections-for-transactional-replication"></a><span data-ttu-id="33b1d-102">Medir la latencia y validar las conexiones de la replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="33b1d-102">Measure Latency and Validate Connections for Transactional Replication</span></span>
  <span data-ttu-id="33b1d-103">En este tema se describe cómo medir la latencia y validar conexiones para la replicación transaccional en [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] mediante el Monitor de replicación, [!INCLUDE[tsql](../../../includes/tsql-md.md)]o Replication Management Objects (RMO).</span><span class="sxs-lookup"><span data-stu-id="33b1d-103">This topic describes how to measure latency and validate connections for transactional replication in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using Replication Monitor, [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="33b1d-104">La replicación transaccional proporciona la característica de testigo de seguimiento, que ofrece una forma cómoda de medir la latencia en topologías de replicación transaccional y validar las conexiones entre el publicador, el distribuidor y los suscriptores.</span><span class="sxs-lookup"><span data-stu-id="33b1d-104">Transactional replication provides the tracer token feature, which provides a convenient way to measure latency in transactional replication topologies and to validate the connections between the Publisher, Distributor and Subscribers.</span></span> <span data-ttu-id="33b1d-105">Se escribe un token (una pequeña cantidad de datos) en el registro de transacción de la base de datos de publicaciones, marcado como si fuese una transacción replicada, y se envía a través del sistema, de forma que permite calcular:</span><span class="sxs-lookup"><span data-stu-id="33b1d-105">A token (a small amount of data) is written to the transaction log of the publication database, marked as though it were a typical replicated transaction, and sent through the system, allowing a calculation of:</span></span>  
  
-   <span data-ttu-id="33b1d-106">Cuánto tiempo transcurre desde que se confirma una transacción en el publicador hasta que se inserta el comando correspondiente en la base de datos de distribución del distribuidor.</span><span class="sxs-lookup"><span data-stu-id="33b1d-106">How much time elapses between a transaction being committed at the Publisher and the corresponding command being inserted in the distribution database at the Distributor.</span></span>  
  
-   <span data-ttu-id="33b1d-107">Cuánto tiempo transcurre desde que se inserta un comando en la base de datos de distribución hasta que se confirma la transacción correspondiente en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="33b1d-107">How much time elapses between a command being inserted in the distribution database and the corresponding transaction being committed at a Subscriber.</span></span>  
  
 <span data-ttu-id="33b1d-108">A partir de estos cálculos, podrá responder a diversas preguntas, como por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="33b1d-108">From these calculations, you can answer a number of questions, including:</span></span>  
  
-   <span data-ttu-id="33b1d-109">¿Qué suscriptores tardan más en recibir un cambio del publicador?</span><span class="sxs-lookup"><span data-stu-id="33b1d-109">Which Subscribers take the longest to receive a change from the Publisher?</span></span>  
  
-   <span data-ttu-id="33b1d-110">De los suscriptores que esperan recibir el testigo de seguimiento, ¿cuáles, si los hay, no lo han recibido?</span><span class="sxs-lookup"><span data-stu-id="33b1d-110">Of the Subscribers expected to receive the tracer token, which, if any, have not received it?</span></span>  
  
 <span data-ttu-id="33b1d-111">**En este tema**</span><span class="sxs-lookup"><span data-stu-id="33b1d-111">**In This Topic**</span></span>  
  
-   <span data-ttu-id="33b1d-112">**Antes de empezar:**</span><span class="sxs-lookup"><span data-stu-id="33b1d-112">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="33b1d-113">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="33b1d-113">Limitations and Restrictions</span></span>](#Restrictions)  
  
-   <span data-ttu-id="33b1d-114">**Para medir la latencia y validar conexiones con:**</span><span class="sxs-lookup"><span data-stu-id="33b1d-114">**To measure latency and validate connections, using:**</span></span>  
  
     [<span data-ttu-id="33b1d-115">Monitor de replicación de SQL Server</span><span class="sxs-lookup"><span data-stu-id="33b1d-115">SQL Server Replication Monitor</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="33b1d-116">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="33b1d-116">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="33b1d-117">Replication Management Objects</span><span class="sxs-lookup"><span data-stu-id="33b1d-117">Replication Management Objects</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="33b1d-118">Antes de comenzar</span><span class="sxs-lookup"><span data-stu-id="33b1d-118">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="33b1d-119">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="33b1d-119">Limitations and Restrictions</span></span>  
 <span data-ttu-id="33b1d-120">Los testigos de seguimiento también pueden ser útiles al detener el sistema, lo que implica detener todas las actividades y comprobar que todos los nodos han recibido todos los cambios pendientes.</span><span class="sxs-lookup"><span data-stu-id="33b1d-120">Tracer tokens can also be useful when quiescing a system, which involves stopping all activity and verifying that all nodes have received all outstanding changes.</span></span> <span data-ttu-id="33b1d-121">Para más información, vea [Poner en modo inactivo una topología de replicación &#40;programación de la replicación con Transact-SQL&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="33b1d-121">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
 <span data-ttu-id="33b1d-122">Para usar testigos de seguimiento, debe utilizar ciertas versiones de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="33b1d-122">To use tracer tokens, you must use certain versions of [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="33b1d-123">El distribuidor debe ser [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o posterior.</span><span class="sxs-lookup"><span data-stu-id="33b1d-123">The Distributor must be [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later.</span></span>  
  
-   <span data-ttu-id="33b1d-124">El publicador debe ser de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o posterior, o un publicador de Oracle.</span><span class="sxs-lookup"><span data-stu-id="33b1d-124">The Publisher must be [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later or be an Oracle Publisher.</span></span>  
  
-   <span data-ttu-id="33b1d-125">En el caso de las suscripciones de extracción, las estadísticas del token de seguimiento se recopilan desde el publicador, el distribuidor y los suscriptores, si el suscriptor es [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7,0 o posterior.</span><span class="sxs-lookup"><span data-stu-id="33b1d-125">For push subscriptions, tracer token statistics are gathered from the Publisher, Distributor, and Subscribers if the Subscriber is [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7.0 or later.</span></span>  
  
-   <span data-ttu-id="33b1d-126">Para las suscripciones de extracción, las estadísticas del token de seguimiento se obtienen solo de los suscriptores, si el suscriptor es de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o posterior.</span><span class="sxs-lookup"><span data-stu-id="33b1d-126">For pull subscriptions, tracer token statistics are gathered from Subscribers only if the Subscriber is [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later.</span></span> <span data-ttu-id="33b1d-127">Si el suscriptor es [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7,0 o [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , las estadísticas solo se recopilan desde el publicador y el distribuidor.</span><span class="sxs-lookup"><span data-stu-id="33b1d-127">If the Subscriber is [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7.0 or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], statistics are gathered only from the Publisher and Distributor.</span></span>  
  
 <span data-ttu-id="33b1d-128">También hay que tener en cuenta otros problemas y restricciones:</span><span class="sxs-lookup"><span data-stu-id="33b1d-128">There are also a number of other issues and restrictions to be aware of:</span></span>  
  
-   <span data-ttu-id="33b1d-129">Para recibir un token de seguimiento, las suscripciones deben estar activas.</span><span class="sxs-lookup"><span data-stu-id="33b1d-129">Subscriptions must be active to receive a tracer token.</span></span> <span data-ttu-id="33b1d-130">Una suscripción está activa si se ha inicializado.</span><span class="sxs-lookup"><span data-stu-id="33b1d-130">A subscription is active if it has been initialized.</span></span>  
  
-   <span data-ttu-id="33b1d-131">La reinicialización quita los testigos de seguimiento pendientes en las suscripciones correspondientes.</span><span class="sxs-lookup"><span data-stu-id="33b1d-131">Reinitialization removes any pending tracer tokens for the relevant subscriptions.</span></span>  
  
-   <span data-ttu-id="33b1d-132">Los suscriptores solo reciben los testigos de seguimiento que se han creado después de la sincronización inicial.</span><span class="sxs-lookup"><span data-stu-id="33b1d-132">Subscribers only receive tracer tokens that were created after their initial synchronization.</span></span>  
  
-   <span data-ttu-id="33b1d-133">Los suscriptores que vuelven a publicar no reenvían los testigos de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="33b1d-133">Tracer tokens are not forwarded by republishing Subscribers.</span></span>  
  
-   <span data-ttu-id="33b1d-134">Después de la conmutación por error a un elemento secundario, el Monitor de replicación no puede ajustar el nombre de la instancia de publicación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y seguirá mostrando información de replicación bajo el nombre de la instancia principal original de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="33b1d-134">After failover to a secondary, Replication Monitor is unable to adjust the name of the publishing instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and will continue to display replication information under the name of the original primary instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="33b1d-135">Después de la conmutación por error, el Monitor de replicación no puede especificar un token de seguimiento, aunque muestra un token de seguimiento especificado en el nuevo publicador mediante [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="33b1d-135">After failover, a tracer token cannot be entered by using the Replication Monitor, however a tracer token entered on the new publisher by using [!INCLUDE[tsql](../../../includes/tsql-md.md)], is visible in Replication Monitor.</span></span>  
  
##  <a name="using-sql-server-replication-monitor"></a><a name="SSMSProcedure"></a><span data-ttu-id="33b1d-136">Uso del monitor de Replicación de SQL Server</span><span class="sxs-lookup"><span data-stu-id="33b1d-136">Using SQL Server Replication Monitor</span></span>  
 <span data-ttu-id="33b1d-137">Para información sobre cómo iniciar el Monitor de replicación, vea [Iniciar el Monitor de replicación](start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="33b1d-137">For information about starting Replication Monitor, see [Start the Replication Monitor](start-the-replication-monitor.md).</span></span>  
  
#### <a name="to-insert-a-tracer-token-and-view-information-on-the-token"></a><span data-ttu-id="33b1d-138">Para insertar un testigo de seguimiento y ver la información del token</span><span class="sxs-lookup"><span data-stu-id="33b1d-138">To insert a tracer token and view information on the token</span></span>  
  
1.  <span data-ttu-id="33b1d-139">Expanda un grupo de publicador en el panel izquierdo, expanda un publicador y, a continuación, haga clic en una publicación.</span><span class="sxs-lookup"><span data-stu-id="33b1d-139">Expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="33b1d-140">Haga clic en la pestaña **Testigos de seguimiento** .</span><span class="sxs-lookup"><span data-stu-id="33b1d-140">Click the **Tracer Tokens** tab.</span></span>  
  
3.  <span data-ttu-id="33b1d-141">Haga clic en **Insertar seguimiento**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-141">Click **Insert Tracer**.</span></span>  
  
4.  <span data-ttu-id="33b1d-142">Vea el tiempo transcurrido para el testigo de seguimiento en las siguientes columnas: **Publicador a distribuidor**, **Distribuidor a suscriptor**y **Latencia total**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-142">View elapsed time for the tracer token in the following columns: **Publisher to Distributor**, **Distributor to Subscriber**, **Total Latency**.</span></span> <span data-ttu-id="33b1d-143">Un valor de **Pending** indica que el token no ha alcanzado un punto determinado.</span><span class="sxs-lookup"><span data-stu-id="33b1d-143">A value of **Pending** indicates that the token has not reached a given point.</span></span>  
  
#### <a name="to-view-information-on-a-tracer-token-inserted-previously"></a><span data-ttu-id="33b1d-144">Para ver información en el testigo de seguimiento insertado previamente</span><span class="sxs-lookup"><span data-stu-id="33b1d-144">To view information on a tracer token inserted previously</span></span>  
  
1.  <span data-ttu-id="33b1d-145">Expanda un grupo de publicador en el panel izquierdo, expanda un publicador y, a continuación, haga clic en una publicación.</span><span class="sxs-lookup"><span data-stu-id="33b1d-145">Expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="33b1d-146">Haga clic en la pestaña **Testigos de seguimiento** .</span><span class="sxs-lookup"><span data-stu-id="33b1d-146">Click the **Tracer Tokens** tab.</span></span>  
  
3.  <span data-ttu-id="33b1d-147">Seleccione una hora en la lista desplegable **Hora de inserción** .</span><span class="sxs-lookup"><span data-stu-id="33b1d-147">Select a time from the **Time inserted** drop-down list.</span></span>  
  
4.  <span data-ttu-id="33b1d-148">Vea el tiempo transcurrido para el testigo de seguimiento en las siguientes columnas: **Publicador a distribuidor**, **Distribuidor a suscriptor**y **Latencia total**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-148">View elapsed time for the tracer token in the following columns: **Publisher to Distributor**, **Distributor to Subscriber**, **Total Latency**.</span></span> <span data-ttu-id="33b1d-149">Un valor de **Pending** indica que el token no ha alcanzado un punto determinado.</span><span class="sxs-lookup"><span data-stu-id="33b1d-149">A value of **Pending** indicates that the token has not reached a given point.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="33b1d-150">La información del testigo de seguimiento se guarda durante el mismo período que otros datos del historial, que depende del período de retención de historial de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="33b1d-150">Tracer token information is retained for the same time period as other historical data, which is governed by the history retention period of the distribution database.</span></span> <span data-ttu-id="33b1d-151">Para obtener información sobre cómo cambiar las propiedades de la base de datos de distribución, vea [Ver y modificar las propiedades del distribuidor y del publicador](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="33b1d-151">For information about changing distribution database properties, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="33b1d-152">Usar Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="33b1d-152">Using Transact-SQL</span></span>  
  
#### <a name="to-post-a-tracer-token-to-a-transactional-publication"></a><span data-ttu-id="33b1d-153">Para exponer un token de seguimiento en una publicación transaccional</span><span class="sxs-lookup"><span data-stu-id="33b1d-153">To post a tracer token to a transactional publication</span></span>  
  
1.  <span data-ttu-id="33b1d-154">(Opcional) en la base de datos de publicación del publicador, ejecute [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="33b1d-154">(Optional) At the Publisher on the publication database, execute [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> <span data-ttu-id="33b1d-155">Compruebe que la publicación existe y que el estado está activo.</span><span class="sxs-lookup"><span data-stu-id="33b1d-155">Verify that the publication exists and that the status is active.</span></span>  
  
2.  <span data-ttu-id="33b1d-156">(Opcional) en la base de datos de publicación del publicador, ejecute [sp_helpsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="33b1d-156">(Optional) At the Publisher on the publication database, execute [sp_helpsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql).</span></span> <span data-ttu-id="33b1d-157">Compruebe que la suscripción existe y que el estado está activo.</span><span class="sxs-lookup"><span data-stu-id="33b1d-157">Verify that the subscription exists and that the status is active.</span></span>  
  
3.  <span data-ttu-id="33b1d-158">En la base de datos de publicación del publicador, ejecute [sp_posttracertoken &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-posttracertoken-transact-sql) y especifique **@publication**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-158">At the Publisher on the publication database, execute [sp_posttracertoken &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-posttracertoken-transact-sql), specifying **@publication**.</span></span> <span data-ttu-id="33b1d-159">Anote el valor del **@tracer_token_id** parámetro de salida.</span><span class="sxs-lookup"><span data-stu-id="33b1d-159">Note the value of the **@tracer_token_id** output parameter.</span></span>  
  
#### <a name="to-determine-latency-and-validate-connections-for-a-transactional-publication"></a><span data-ttu-id="33b1d-160">Para medir la latencia y validar las conexiones de una replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="33b1d-160">To determine latency and validate connections for a transactional publication</span></span>  
  
1.  <span data-ttu-id="33b1d-161">Exponga un token de seguimiento en la publicación utilizando el procedimiento anterior.</span><span class="sxs-lookup"><span data-stu-id="33b1d-161">Post a tracer token to the publication using the previous procedure.</span></span>  
  
2.  <span data-ttu-id="33b1d-162">En la base de datos de publicación del publicador, ejecute [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql) y especifique **@publication**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-162">At the Publisher on the publication database, execute [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql), specifying **@publication**.</span></span> <span data-ttu-id="33b1d-163">Esto devuelve una lista de todos los testigos de seguimiento expuestos en la publicación.</span><span class="sxs-lookup"><span data-stu-id="33b1d-163">This returns a list of all tracer tokens posted to the publication.</span></span> <span data-ttu-id="33b1d-164">Anote el **tracer_id** que desee del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="33b1d-164">Note the desired **tracer_id** in the result set.</span></span>  
  
3.  <span data-ttu-id="33b1d-165">En la base de datos de publicación del publicador, ejecute [sp_helptracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokenhistory-transact-sql) y especifique **@publication** y el identificador del testigo de seguimiento del paso 2 para **@tracer_id**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-165">At the Publisher on the publication database, execute [sp_helptracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokenhistory-transact-sql), specifying **@publication** and the tracer token ID from step 2 for **@tracer_id**.</span></span> <span data-ttu-id="33b1d-166">Esto devuelve información de latencia del token de seguimiento seleccionado.</span><span class="sxs-lookup"><span data-stu-id="33b1d-166">This returns latency information for the selected tracer token.</span></span>  
  
#### <a name="to-remove-tracer-tokens"></a><span data-ttu-id="33b1d-167">Para quitar los testigos de seguimiento</span><span class="sxs-lookup"><span data-stu-id="33b1d-167">To remove tracer tokens</span></span>  
  
1.  <span data-ttu-id="33b1d-168">En la base de datos de publicación del publicador, ejecute [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql) y especifique **@publication**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-168">At the Publisher on the publication database, execute [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql), specifying **@publication**.</span></span> <span data-ttu-id="33b1d-169">Esto devuelve una lista de todos los testigos de seguimiento expuestos en la publicación.</span><span class="sxs-lookup"><span data-stu-id="33b1d-169">This returns a list of all tracer tokens posted to the publication.</span></span> <span data-ttu-id="33b1d-170">Anote el **tracer_id** del token de seguimiento que se va a eliminar del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="33b1d-170">Note the **tracer_id** for the tracer token to delete in the result set.</span></span>  
  
2.  <span data-ttu-id="33b1d-171">En la base de datos de publicación del publicador, ejecute [sp_deletetracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-deletetracertokenhistory-transact-sql) y especifique **@publication** y el id. del seguimiento para eliminar desde el paso 2 para **@tracer_id**.</span><span class="sxs-lookup"><span data-stu-id="33b1d-171">At the Publisher on the publication database, execute [sp_deletetracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-deletetracertokenhistory-transact-sql), specifying **@publication** and the ID of the tracer to delete from step 2 for **@tracer_id**.</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="33b1d-172">Ejemplo (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="33b1d-172">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="33b1d-173">Este ejemplo expone un registro de token de seguimiento y utiliza el Id. devuelto del token de seguimiento expuesto para ver información de la latencia.</span><span class="sxs-lookup"><span data-stu-id="33b1d-173">This example posts a tracer token record and uses the returned ID of the posted tracer token to view latency information.</span></span>  
  
 [!code-sql[HowTo#sp_tracertokens](../../../snippets/tsql/SQL15/replication/howto/tsql/createtracertokens.sql#sp_tracertokens)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="33b1d-174">Uso de Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="33b1d-174">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-post-a-tracer-token-to-a-transactional-publication"></a><span data-ttu-id="33b1d-175">Para exponer un token de seguimiento en una publicación transaccional</span><span class="sxs-lookup"><span data-stu-id="33b1d-175">To post a tracer token to a transactional publication</span></span>  
  
1.  <span data-ttu-id="33b1d-176">Cree una conexión al publicador mediante la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-176">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="33b1d-177">Cree una instancia de la clase <xref:Microsoft.SqlServer.Replication.TransPublication>.</span><span class="sxs-lookup"><span data-stu-id="33b1d-177">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span>  
  
3.  <span data-ttu-id="33b1d-178">Establezca las propiedades <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> y <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> para la publicación y la propiedad <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> en la conexión creada en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="33b1d-178">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
4.  <span data-ttu-id="33b1d-179">Llame al método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> para obtener las propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="33b1d-179">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="33b1d-180">Si este método devuelve `false`, significa que las propiedades de publicación del paso 3 se definieron incorrectamente, o bien que la publicación no existe.</span><span class="sxs-lookup"><span data-stu-id="33b1d-180">If this method returns `false`, either the publication properties in step 3 were defined incorrectly or the publication does not exist.</span></span>  
  
5.  <span data-ttu-id="33b1d-181">Llame al método <xref:Microsoft.SqlServer.Replication.TransPublication.PostTracerToken%2A> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-181">Call the <xref:Microsoft.SqlServer.Replication.TransPublication.PostTracerToken%2A> method.</span></span> <span data-ttu-id="33b1d-182">Este método inserta un token de seguimiento en el registro de transacciones de la publicación.</span><span class="sxs-lookup"><span data-stu-id="33b1d-182">This method inserts a tracer token into the publication's transaction log.</span></span>  
  
#### <a name="to-determine-latency-and-validate-connections-for-a-transactional-publication"></a><span data-ttu-id="33b1d-183">Para medir la latencia y validar las conexiones de una replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="33b1d-183">To determine latency and validate connections for a transactional publication</span></span>  
  
1.  <span data-ttu-id="33b1d-184">Cree una conexión al distribuidor mediante la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-184">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="33b1d-185">Cree una instancia de la clase <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="33b1d-185">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="33b1d-186">Establezca las propiedades <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>y <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> , y la propiedad <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> en la conexión creada en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="33b1d-186">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> properties, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
4.  <span data-ttu-id="33b1d-187">Llame al método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> para obtener las propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="33b1d-187">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="33b1d-188">Si este método devuelve `false`, significa que las propiedades del monitor de la publicación del paso 3 se definieron incorrectamente, o bien que la publicación no existe.</span><span class="sxs-lookup"><span data-stu-id="33b1d-188">If this method returns `false`, either the publication monitor properties in step 3 were defined incorrectly or the publication does not exist.</span></span>  
  
5.  <span data-ttu-id="33b1d-189">Llame al método <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-189">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> method.</span></span> <span data-ttu-id="33b1d-190">Convierta el objeto <xref:System.Collections.ArrayList> devuelto a una matriz de objetos <xref:Microsoft.SqlServer.Replication.TracerToken> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-190">Cast the returned <xref:System.Collections.ArrayList> object to an array of <xref:Microsoft.SqlServer.Replication.TracerToken> objects.</span></span>  
  
6.  <span data-ttu-id="33b1d-191">Llame al método <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-191">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> method.</span></span> <span data-ttu-id="33b1d-192">Pase un valor de <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> para un token de seguimiento del paso 5.</span><span class="sxs-lookup"><span data-stu-id="33b1d-192">Pass a value of <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> for a tracer token from step 5.</span></span> <span data-ttu-id="33b1d-193">Esto devuelve información de latencia del token de seguimiento seleccionado como objeto <xref:System.Data.DataSet> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-193">This returns latency information for the selected tracer token as a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="33b1d-194">Si se devuelve toda la información del token de seguimiento, la conexión entre el publicador y el distribuidor y la conexión entre el distribuidor y el suscriptor existen, y la topología de replicación está funcionando.</span><span class="sxs-lookup"><span data-stu-id="33b1d-194">If all tracer token information is returned, the connection between the Publisher and Distributor and the connection between the Distributor and the Subscriber both exist and the replication topology is functioning.</span></span>  
  
#### <a name="to-remove-tracer-tokens"></a><span data-ttu-id="33b1d-195">Para quitar los testigos de seguimiento</span><span class="sxs-lookup"><span data-stu-id="33b1d-195">To remove tracer tokens</span></span>  
  
1.  <span data-ttu-id="33b1d-196">Cree una conexión al distribuidor mediante la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-196">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="33b1d-197">Cree una instancia de la clase <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="33b1d-197">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="33b1d-198">Establezca las propiedades <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>y <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> , y la propiedad <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> en la conexión creada en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="33b1d-198">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> properties, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
4.  <span data-ttu-id="33b1d-199">Llame al método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> para obtener las propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="33b1d-199">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="33b1d-200">Si este método devuelve `false`, significa que las propiedades del monitor de la publicación del paso 3 se definieron incorrectamente, o bien que la publicación no existe.</span><span class="sxs-lookup"><span data-stu-id="33b1d-200">If this method returns `false`, either the publication monitor properties in step 3 were defined incorrectly or the publication does not exist.</span></span>  
  
5.  <span data-ttu-id="33b1d-201">Llame al método <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-201">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> method.</span></span> <span data-ttu-id="33b1d-202">Convierta el objeto <xref:System.Collections.ArrayList> devuelto a una matriz de objetos <xref:Microsoft.SqlServer.Replication.TracerToken> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-202">Cast the returned <xref:System.Collections.ArrayList> object to an array of <xref:Microsoft.SqlServer.Replication.TracerToken> objects.</span></span>  
  
6.  <span data-ttu-id="33b1d-203">Llame al método <xref:Microsoft.SqlServer.Replication.PublicationMonitor.CleanUpTracerTokenHistory%2A> .</span><span class="sxs-lookup"><span data-stu-id="33b1d-203">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.CleanUpTracerTokenHistory%2A> method.</span></span> <span data-ttu-id="33b1d-204">Pase uno de los siguientes valores:</span><span class="sxs-lookup"><span data-stu-id="33b1d-204">Pass one of the following values:</span></span>  
  
    -   <span data-ttu-id="33b1d-205">El <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> para un token de seguimiento del paso 5.</span><span class="sxs-lookup"><span data-stu-id="33b1d-205">The <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> for a tracer token from step 5.</span></span> <span data-ttu-id="33b1d-206">Esto elimina información de un token seleccionado.</span><span class="sxs-lookup"><span data-stu-id="33b1d-206">This deletes information for a selected token.</span></span>  
  
    -   <span data-ttu-id="33b1d-207">Objeto <xref:System.DateTime>.</span><span class="sxs-lookup"><span data-stu-id="33b1d-207">A <xref:System.DateTime> object.</span></span> <span data-ttu-id="33b1d-208">Esto elimina información de todos los tokens anteriores a la fecha y hora especificada.</span><span class="sxs-lookup"><span data-stu-id="33b1d-208">This deletes information for all tokens older than the specified date and time.</span></span>  
  
###  <a name="PShellExample"></a>  
