---
title: Proteger la carpeta de instantáneas | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], security
ms.assetid: 3cd877d1-ffb8-48fd-a72b-98eb948aad27
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c977936ad2aca6e5a98ee685a15662a00b625494
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87675265"
---
# <a name="secure-the-snapshot-folder"></a><span data-ttu-id="60f9e-102">Proteger la carpeta de instantáneas</span><span class="sxs-lookup"><span data-stu-id="60f9e-102">Secure the Snapshot Folder</span></span>
  <span data-ttu-id="60f9e-103">La carpeta de instantáneas es un directorio que almacena archivos de instantáneas. Se recomienda que sea un directorio dedicado para el almacenamiento de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="60f9e-103">The snapshot folder is a directory that stores snapshot files; it is recommended that you dedicate the directory for snapshot storage.</span></span> <span data-ttu-id="60f9e-104">Conceda al Agente de instantáneas permiso de escritura en la carpeta y asegúrese de que el permiso de lectura se concede solamente a la cuenta de Windows que utiliza el Agente de mezcla o el Agente de distribución cuando tiene acceso a la carpeta.</span><span class="sxs-lookup"><span data-stu-id="60f9e-104">Grant the Snapshot Agent write permission to the folder, and ensure that read permission is granted only to the Windows account that the Merge Agent or Distribution agent uses when accessing the folder.</span></span> <span data-ttu-id="60f9e-105">Para tener acceso a una carpeta de instantáneas que se encuentra en un equipo remoto, la cuenta de Windows asociada con el agente debe ser una cuenta de dominio.</span><span class="sxs-lookup"><span data-stu-id="60f9e-105">The Windows account associated with the agent must be a domain account to access a snapshot folder that is located on a remote computer.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="60f9e-106">Control de cuentas de usuario (UAC) ayuda a los administradores a administrar sus derechos de usuario elevados (que a veces reciben el nombre de *privilegios*).</span><span class="sxs-lookup"><span data-stu-id="60f9e-106">User Account Control (UAC)  helps administrators manage their elevated user rights (sometimes called *privileges*).</span></span> <span data-ttu-id="60f9e-107">Cuando se ejecuta en sistemas operativos que tienen UAC habilitado, los administradores no utilizan sus derechos administrativos.</span><span class="sxs-lookup"><span data-stu-id="60f9e-107">When running on operating systems that have UAC enabled, administrators do not use their administrative rights.</span></span> <span data-ttu-id="60f9e-108">En su lugar, realizan la mayoría de acciones como usuarios estándar (no administrativos) y solo usan sus derechos administrativos de forma temporal cuando es necesario.</span><span class="sxs-lookup"><span data-stu-id="60f9e-108">Instead, they perform most actions as standard (non-administrative) users, temporarily assuming their administrative rights only when it is required.</span></span> <span data-ttu-id="60f9e-109">UAC puede impedir el acceso administrativo al recurso compartido de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="60f9e-109">UAC can prevent administrative access to the snapshot share.</span></span> <span data-ttu-id="60f9e-110">Por lo tanto, debe conceder de forma explícita permisos del recurso compartido de instantáneas a las cuentas de Windows usadas por el Agente de instantáneas, el Agente de distribución y el Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="60f9e-110">You must therefore explicitly grant snapshot share permissions to the Windows accounts that are used by the Snapshot Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="60f9e-111">Debe hacerlo incluso si las cuentas de Windows pertenecen al grupo Administradores.</span><span class="sxs-lookup"><span data-stu-id="60f9e-111">You must do this even if the Windows accounts are members of the Administrators group.</span></span>  
  
 <span data-ttu-id="60f9e-112">Al configurar un distribuidor mediante el Asistente para configurar la distribución o el Asistente para nueva publicación, la carpeta de instantáneas tiene como valor predeterminado una ruta de acceso local: X:\Archivos de programa\Microsoft SQL Server\\ *\<instance>* \MSSQL\ReplData.</span><span class="sxs-lookup"><span data-stu-id="60f9e-112">When configuring a Distributor through the Configure Distribution Wizard or the New Publication Wizard, the snapshot folder defaults to a local path: X:\Program Files\Microsoft SQL Server\\*\<instance>* \MSSQL\ReplData.</span></span> <span data-ttu-id="60f9e-113">Si usa un distribuidor remoto o suscripciones de extracción, debe especificar un recurso compartido de red UNC (como \\\\<*nombre de equipo>* \instantánea) en lugar de una ruta de acceso local.</span><span class="sxs-lookup"><span data-stu-id="60f9e-113">If you are using a remote Distributor or pull subscriptions, you must specify a UNC network share (such as \\\\<*computername>* \snapshot) rather than a local path.</span></span>  
  
 <span data-ttu-id="60f9e-114">Los permisos para tener acceso a la carpeta de instantáneas deben concederse según la forma en la que se tiene acceso a la carpeta.</span><span class="sxs-lookup"><span data-stu-id="60f9e-114">When granting permissions to access the snapshot folder, you must grant them according to the way in which the folder is accessed.</span></span> <span data-ttu-id="60f9e-115">En [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003 se utilizan las pestañas del siguiente cuadro de diálogo:</span><span class="sxs-lookup"><span data-stu-id="60f9e-115">The following dialog box tabs are used in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003:</span></span>  
  
-   <span data-ttu-id="60f9e-116">Si especifica una ruta de acceso local, conceda permisos mediante la pestaña **Seguridad** del cuadro de diálogo **Propiedades** de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="60f9e-116">If you specify a local path, grant permissions through the **Security** tab of the **Properties** dialog box for the folder.</span></span>  
  
-   <span data-ttu-id="60f9e-117">Si especifica un recurso compartido de red, conceda permisos mediante la pestaña **Compartir** del cuadro de diálogo **Propiedades** de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="60f9e-117">If you specify a network share, grant permissions through the **Sharing** tab of the **Properties** dialog box for the folder.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="60f9e-118">Si el Agente de replicación se ejecuta en el distribuidor, use la pestaña **Seguridad** del cuadro de diálogo **Propiedades** de la carpeta para conceder permisos a la cuenta de Windows que se usa para ejecutar el agente.</span><span class="sxs-lookup"><span data-stu-id="60f9e-118">If the replication agent runs on the Distributor, use the **Security** tab of the **Properties** dialog box for the folder to grant permissions to the Windows account used to run the agent.</span></span> <span data-ttu-id="60f9e-119">Siga el procedimiento descrito incluso cuando se use un recurso compartido de red.</span><span class="sxs-lookup"><span data-stu-id="60f9e-119">Do this even when a network share is used.</span></span> <span data-ttu-id="60f9e-120">Esto se aplica al Agente de mezcla y al Agente de distribución para una suscripción de inserción, y al Agente de instantáneas cuando el publicador y el distribuidor se encuentran en el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="60f9e-120">This applies to the Merge Agent and Distribution Agent for a push subscription and to the Snapshot Agent when the Publisher and Distributor are on the same computer.</span></span>  
  
 <span data-ttu-id="60f9e-121">Para obtener más información acerca de cómo establecer permisos para rutas de acceso locales y recursos de red compartidos, vea la documentación de Windows.</span><span class="sxs-lookup"><span data-stu-id="60f9e-121">For more information about setting permissions for local paths and network shares, see the Windows documentation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="60f9e-122">Si se quita una publicación, la replicación intenta quitar la carpeta de instantáneas en el contexto de seguridad de la cuenta de servicio de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="60f9e-122">If a publication is dropped, replication attempts to remove the snapshot folder under the security context of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account.</span></span> <span data-ttu-id="60f9e-123">Si esta cuenta no tiene privilegios suficientes, inicie la sesión con una cuenta que tenga privilegios suficientes y quite la carpeta manualmente.</span><span class="sxs-lookup"><span data-stu-id="60f9e-123">If this account does not have sufficient privileges, log in with an account that does have sufficient privileges and remove the folder manually.</span></span> <span data-ttu-id="60f9e-124">Para quitar una carpeta es necesario el privilegio **Modificar** si la carpeta es una ruta de acceso local o el privilegio **Control total** si la carpeta es una ruta de acceso de red.</span><span class="sxs-lookup"><span data-stu-id="60f9e-124">Removing a folder requires the **Modify** privilege if the folder is a local path or the **Full Control** privilege if the folder is a network path.</span></span>  
  
## <a name="delivering-snapshots-through-ftp"></a><span data-ttu-id="60f9e-125">Entregar instantáneas mediante FTP</span><span class="sxs-lookup"><span data-stu-id="60f9e-125">Delivering Snapshots Through FTP</span></span>  
 <span data-ttu-id="60f9e-126">Para obtener la máxima seguridad se recomienda almacenar las instantáneas en un recurso compartido UNC, pero las instantáneas se pueden almacenar en un recurso compartido FTP y, a continuación, entregarse a un suscriptor mediante FTP.</span><span class="sxs-lookup"><span data-stu-id="60f9e-126">It is recommended as a security best practice that snapshots be stored in a UNC share, but snapshots can be stored in an FTP share and then delivered to a Subscriber through FTP.</span></span> <span data-ttu-id="60f9e-127">Al configurar el servidor FTP, asegúrese de que el directorio virtual ofrece un recurso compartido UNC subyacente que permita acceso de escritura mediante el Agente de instantáneas para la publicación.</span><span class="sxs-lookup"><span data-stu-id="60f9e-127">When configuring the FTP server, ensure that the virtual directory exposes an underlying UNC share that permits write access by the Snapshot Agent for the publication.</span></span>  
  
 <span data-ttu-id="60f9e-128">Para configurar que un suscriptor recupere la instantánea mediante FTP, primero configure el servidor FTP con un inicio de sesión y una contraseña FTP que permitan a los suscriptores acceso de lectura (u "obtención") para que se puedan descargar los archivos de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="60f9e-128">To configure a Subscriber to retrieve the Snapshot via FTP, first set up an FTP server with an FTP login and password that allows Subscribers read (or "get") access to allow the snapshot files to be downloaded.</span></span>  
  
 <span data-ttu-id="60f9e-129">Para entregar instantáneas mediante FTP, vea [Deliver a Snapshot Through FTP](../publish/deliver-a-snapshot-through-ftp.md) (Entregar una instantánea mediante FTP).</span><span class="sxs-lookup"><span data-stu-id="60f9e-129">To deliver snapshots through FTP, see [Deliver a Snapshot Through FTP](../publish/deliver-a-snapshot-through-ftp.md).</span></span>  
  
 <span data-ttu-id="60f9e-130">Para obtener información acerca de cómo establecer y cambiar la contraseña para tener acceso a instantáneas mediante FTP, vea la sección "Entrega de instantáneas a través de FTP" en el tema [Secure the Publisher](secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="60f9e-130">For information about setting and changing the password for access to snapshots through FTP, see the section "FTP Snapshot Delivery" in the topic [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="60f9e-131">Consulte también</span><span class="sxs-lookup"><span data-stu-id="60f9e-131">See Also</span></span>  
 <span data-ttu-id="60f9e-132">[Ubicaciones de carpeta de instantáneas alternativas](../alternate-snapshot-folder-locations.md) </span><span class="sxs-lookup"><span data-stu-id="60f9e-132">[Alternate Snapshot Folder Locations](../alternate-snapshot-folder-locations.md) </span></span>  
 <span data-ttu-id="60f9e-133">[Inicializar una suscripción con una instantánea](../initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="60f9e-133">[Initialize a Subscription with a Snapshot](../initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="60f9e-134">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="60f9e-134">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="60f9e-135">[Seguridad de Replicación de SQL Server](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="60f9e-135">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="60f9e-136">Transferir instantáneas mediante FTP</span><span class="sxs-lookup"><span data-stu-id="60f9e-136">Transfer Snapshots Through FTP</span></span>](../transfer-snapshots-through-ftp.md)  
  
  
