---
title: Realización de cambios de esquema en bases de datos de publicación | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], schema changes
- snapshot replication [SQL Server], replicating schema changes
- merge replication [SQL Server replication], replicating schema changes
- transactional replication, replicating schema changes
- schemas [SQL Server replication], replicating changes
- publishing [SQL Server replication], schema changes
ms.assetid: 926c88d7-a844-402f-bcb9-db49e5013b69
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e26d3e89fcba41d474ca56637f9e465f17127348
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87662806"
---
# <a name="make-schema-changes-on-publication-databases"></a><span data-ttu-id="85d8e-102">Realizar cambios de esquema en bases de datos de publicaciones</span><span class="sxs-lookup"><span data-stu-id="85d8e-102">Make Schema Changes on Publication Databases</span></span>
  <span data-ttu-id="85d8e-103">La replicación admite una gran variedad de cambios en el esquema de objetos publicados.</span><span class="sxs-lookup"><span data-stu-id="85d8e-103">Replication supports a wide range of schema changes to published objects.</span></span> <span data-ttu-id="85d8e-104">Cuando realice cualquiera de los siguientes cambios de esquema en el objeto publicado correspondiente en un publicador de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], ese cambio se propaga de manera predeterminada a todos los suscriptores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="85d8e-104">When you make any of the following schema changes on the appropriate published object at a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publisher, that change is propagated by default to all [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscribers:</span></span>  
  
-   <span data-ttu-id="85d8e-105">ALTER TABLE</span><span class="sxs-lookup"><span data-stu-id="85d8e-105">ALTER TABLE</span></span>  
  
-   <span data-ttu-id="85d8e-106">ALTER TABLE SET LOCK ESCALATION no se debería usar si la replicación de cambio de esquema está habilitada y una topología incluye [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span><span class="sxs-lookup"><span data-stu-id="85d8e-106">ALTER TABLE SET LOCK ESCALATION should not be used if schema change replication is enabled and a topology includes [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span></span>  
  
-   <span data-ttu-id="85d8e-107">ALTER PROCEDURE</span><span class="sxs-lookup"><span data-stu-id="85d8e-107">ALTER PROCEDURE</span></span>  
  
-   <span data-ttu-id="85d8e-108">ALTER FUNCTION</span><span class="sxs-lookup"><span data-stu-id="85d8e-108">ALTER FUNCTION</span></span>  
  
-   <span data-ttu-id="85d8e-109">ALTER TRIGGER</span><span class="sxs-lookup"><span data-stu-id="85d8e-109">ALTER TRIGGER</span></span>  
  
     <span data-ttu-id="85d8e-110">ALTER TRIGGER solo puede utilizarse para desencadenadores de lenguaje de manipulación de datos (DML), ya que los desencadenadores de lenguaje de definición de datos (DDL) no se pueden replicar.</span><span class="sxs-lookup"><span data-stu-id="85d8e-110">ALTER TRIGGER can be used only for data manipulation language [DML] triggers because data definition language [DDL] triggers cannot be replicated.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="85d8e-111">Los cambios de esquema de las tablas deben realizarse con [!INCLUDE[tsql](../../../includes/tsql-md.md)] u Objetos de administración de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (SMO).</span><span class="sxs-lookup"><span data-stu-id="85d8e-111">Schema changes to tables must be made by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO).</span></span> <span data-ttu-id="85d8e-112">Cuando se realizan cambios de esquema en [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] intenta quitar y volver a crear la tabla.</span><span class="sxs-lookup"><span data-stu-id="85d8e-112">When schema changes are made in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] attempts to drop and re-create the table.</span></span> <span data-ttu-id="85d8e-113">Debido a que no es posible quitar objetos publicados, se produce un error en el cambio de esquema.</span><span class="sxs-lookup"><span data-stu-id="85d8e-113">You cannot drop published objects, therefore the schema change fails.</span></span>  
  
 <span data-ttu-id="85d8e-114">En la replicación transaccional y de mezcla, los cambios de esquema se propagan de forma incremental al ejecutar el Agente de distribución o el Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="85d8e-114">For transactional replication and merge replication, schema changes are propagated incrementally when the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="85d8e-115">En la replicación de instantáneas, los cambios de esquema se propagan al aplicar una nueva instantánea en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-115">For snapshot replication, schema changes are propagated when a new snapshot is applied at the Subscriber.</span></span> <span data-ttu-id="85d8e-116">En la replicación de instantáneas, se envía una nueva copia del esquema al suscriptor cada vez que se produce la sincronización.</span><span class="sxs-lookup"><span data-stu-id="85d8e-116">In snapshot replication, a new copy of the schema is sent to the Subscriber each time synchronization occurs.</span></span> <span data-ttu-id="85d8e-117">Por tanto, todos los cambios de esquema (y no solo los indicados antes) en objetos previamente publicados se propagan automáticamente con cada sincronización.</span><span class="sxs-lookup"><span data-stu-id="85d8e-117">Therefore, all schema changes (not just those listed above) to previously published objects are automatically propagated with each synchronization.</span></span>  
  
 <span data-ttu-id="85d8e-118">Para obtener información sobre cómo agregar y quitar artículos de publicaciones, vea [Agregar y quitar artículos de publicaciones existentes](add-articles-to-and-drop-articles-from-existing-publications.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-118">For information about adding and removing articles from publications, see [Add Articles to and Drop Articles from Existing Publications](add-articles-to-and-drop-articles-from-existing-publications.md).</span></span>  
  
 <span data-ttu-id="85d8e-119">**Para replicar cambios de esquema**</span><span class="sxs-lookup"><span data-stu-id="85d8e-119">**To replicate schema changes**</span></span>  
  
 <span data-ttu-id="85d8e-120">Los cambios de esquema antes indicados se replican de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="85d8e-120">The schema changes listed above are replicated by default.</span></span> <span data-ttu-id="85d8e-121">Para obtener información acerca de cómo deshabilitar la replicación de los cambios de esquema, vea [Replicate Schema Changes](replicate-schema-changes.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-121">For information about disabling the replication of schema changes, see [Replicate Schema Changes](replicate-schema-changes.md).</span></span>  
  
## <a name="considerations-for-schema-changes"></a><span data-ttu-id="85d8e-122">Consideraciones para los cambios de esquema</span><span class="sxs-lookup"><span data-stu-id="85d8e-122">Considerations for Schema Changes</span></span>  
 <span data-ttu-id="85d8e-123">Tenga en cuenta las consideraciones siguientes al replicar cambios de esquema.</span><span class="sxs-lookup"><span data-stu-id="85d8e-123">Keep the following considerations in mind when replicating schema changes.</span></span>  
  
### <a name="general-considerations"></a><span data-ttu-id="85d8e-124">Consideraciones generales</span><span class="sxs-lookup"><span data-stu-id="85d8e-124">General Considerations</span></span>  
  
-   <span data-ttu-id="85d8e-125">Los cambios de esquema están sujetos a las restricciones impuestas por [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85d8e-125">Schema changes are subject to any restrictions imposed by [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="85d8e-126">Por ejemplo, ALTER TABLE no permite aplicar ALTER a las columnas de clave principal.</span><span class="sxs-lookup"><span data-stu-id="85d8e-126">For example, ALTER TABLE does not allow you to ALTER primary key columns.</span></span>  
  
-   <span data-ttu-id="85d8e-127">La asignación de tipo de datos solo se realiza para la instantánea inicial.</span><span class="sxs-lookup"><span data-stu-id="85d8e-127">Data type mapping is performed only for the initial snapshot.</span></span> <span data-ttu-id="85d8e-128">Los cambios de esquema no se asignan a versiones anteriores de tipos de datos.</span><span class="sxs-lookup"><span data-stu-id="85d8e-128">Schema changes are not mapped to previous versions of data types.</span></span> <span data-ttu-id="85d8e-129">Por ejemplo, si la instrucción `ALTER TABLE ADD datetime2 column` se utiliza en [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], el tipo de datos no se traduce a `nvarchar` para los suscriptores de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85d8e-129">For example, if the statement `ALTER TABLE ADD datetime2 column` is used in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], the data type is not translated to `nvarchar` for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Subscribers.</span></span> <span data-ttu-id="85d8e-130">En algunos casos, los cambios de esquema se bloquean en el publicador.</span><span class="sxs-lookup"><span data-stu-id="85d8e-130">In some cases, schema changes are blocked on the Publisher.</span></span>  
  
-   <span data-ttu-id="85d8e-131">Si una publicación está configurada para permitir la propagación de los cambios de esquema, éstos se propagarán independientemente de cómo esté establecida la opción de esquema relacionada para un artículo de la publicación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-131">If a publication is set to allow the propagation of schema changes, schema changes are propagated regardless of how the related schema option is set for an article in the publication.</span></span> <span data-ttu-id="85d8e-132">Por ejemplo, si elige no replicar las restricciones de clave externa para un artículo de la tabla y después emite un comando ALTER TABLE que agrega una clave externa a la tabla en el publicador, la clave externa se agregará a la tabla en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-132">For example, if you select not to replicate foreign key constraints for a table article, but then issue an ALTER TABLE command that adds a foreign key to the table at the Publisher, the foreign key is added to the table at the Subscriber.</span></span> <span data-ttu-id="85d8e-133">Para evitarlo, deshabilite la propagación de los cambios de esquema antes de emitir el comando ALTER TABLE.</span><span class="sxs-lookup"><span data-stu-id="85d8e-133">To prevent this, disable the propagation of schema changes before issuing the ALTER TABLE command.</span></span>  
  
-   <span data-ttu-id="85d8e-134">Los cambios de esquema deben realizarse únicamente en el publicador y no en los suscriptores (incluidos los suscriptores de republicación).</span><span class="sxs-lookup"><span data-stu-id="85d8e-134">Schema changes should be made only at the Publisher, not at Subscribers (including republishing Subscribers).</span></span> <span data-ttu-id="85d8e-135">La replicación de mezcla impide los cambios de esquema en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-135">Merge replication prevents schema changes at the Subscriber.</span></span> <span data-ttu-id="85d8e-136">La replicación transaccional no impide los cambios, pero los cambios pueden causar errores en la replicación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-136">Transactional replication does not prevent the changes, but the changes can cause replication to fail.</span></span>  
  
-   <span data-ttu-id="85d8e-137">Los cambios propagados a un suscriptor de republicación se propagan de manera predeterminada a sus suscriptores.</span><span class="sxs-lookup"><span data-stu-id="85d8e-137">Changes propagated to a republishing Subscriber are by default propagated to its Subscribers.</span></span>  
  
-   <span data-ttu-id="85d8e-138">Si el cambio de esquema hace referencia a objetos o restricciones existentes en el publicador, pero no en el suscriptor, el cambio de esquema se realizará correctamente en el publicador pero se producirá un error en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-138">If the schema change references objects or constraints existing on the Publisher but not on the Subscriber, the schema change will succeed on the Publisher but will fail on the Subscriber.</span></span>  
  
-   <span data-ttu-id="85d8e-139">Todos los objetos del suscriptor a los que se hace referencia al agregar una clave externa deben tener el mismo nombre y propietario que el objeto correspondiente en el publicador.</span><span class="sxs-lookup"><span data-stu-id="85d8e-139">All objects on the Subscriber that are referenced when adding a foreign key must have the same name and owner as the corresponding object on the Publisher.</span></span>  
  
-   <span data-ttu-id="85d8e-140">No se permite agregar, quitar ni alterar índices explícitamente.</span><span class="sxs-lookup"><span data-stu-id="85d8e-140">Explicitly adding, dropping, or altering indexes is not supported.</span></span> <span data-ttu-id="85d8e-141">Se admiten los índices creados implícitamente para las restricciones (como la restricción de clave principal).</span><span class="sxs-lookup"><span data-stu-id="85d8e-141">Indexes created implicitly for constraints (such as a primary key constraint) are supported.</span></span>  
  
-   <span data-ttu-id="85d8e-142">No se permite alterar ni quitar columnas de identidad administradas por la replicación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-142">Altering or dropping identity columns that are managed by replication is not supported.</span></span> <span data-ttu-id="85d8e-143">Para obtener más información sobre la administración automática de las columnas de identidad, vea [Replicar columnas de identidad](replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-143">For more information about automatic management of identity columns, see [Replicate Identity Columns](replicate-identity-columns.md).</span></span>  
  
-   <span data-ttu-id="85d8e-144">No se admiten los cambios de esquema que incluyen funciones no deterministas, ya que pueden producir datos distintos en el publicador y en el suscriptor (falta de convergencia).</span><span class="sxs-lookup"><span data-stu-id="85d8e-144">Schema changes that include nondeterministic functions are not supported because they can result in data at the Publisher and Subscriber being different (referred to as non-convergence).</span></span> <span data-ttu-id="85d8e-145">Por ejemplo, si emite en el publicador el comando `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, los valores serán distintos cuando el comando se replique en el suscriptor y se ejecute.</span><span class="sxs-lookup"><span data-stu-id="85d8e-145">For example, if you issue the following command at the Publisher: `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, the values are different when the command is replicated to the Subscriber and executed.</span></span> <span data-ttu-id="85d8e-146">Para obtener más información acerca de las funciones no deterministas, vea [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-146">For more information about nondeterministic functions, see [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span></span>  
  
-   <span data-ttu-id="85d8e-147">Se recomienda asignar explícitamente un nombre a las restricciones.</span><span class="sxs-lookup"><span data-stu-id="85d8e-147">It is recommended that constraints be explicitly named.</span></span> <span data-ttu-id="85d8e-148">Si una restricción no tiene un nombre explícito, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] genera un nombre para la restricción y estos nombres serán diferentes en el publicador y en cada suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-148">If a constraint is not explicitly named, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a name for the constraint, and these names will be different on the Publisher and each Subscriber.</span></span> <span data-ttu-id="85d8e-149">Esto puede causar problemas durante la replicación de cambios de esquema.</span><span class="sxs-lookup"><span data-stu-id="85d8e-149">This can cause issues during the replication of schema changes.</span></span> <span data-ttu-id="85d8e-150">Por ejemplo, si quita una columna en el publicador y se quita una restricción dependiente, la replicación intentará quitar la restricción en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-150">For example, if you drop a column at the Publisher and a dependent constraint is dropped, replication will attempt to drop the constraint at the Subscriber.</span></span> <span data-ttu-id="85d8e-151">Esta eliminación en el suscriptor no se podrá llevar a cabo porque el nombre de la restricción es diferente.</span><span class="sxs-lookup"><span data-stu-id="85d8e-151">The drop at the Subscriber will fail because the name of the constraint is different.</span></span> <span data-ttu-id="85d8e-152">Si no funciona la sincronización por un problema de nombre de restricción, quite manualmente la restricción en el suscriptor y ejecute de nuevo el agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="85d8e-152">If synchronization fails because of a constraint naming issue, manually drop the constraint at the Subscriber and then rerun the Merge Agent.</span></span>  
  
-   <span data-ttu-id="85d8e-153">Si se publica una tabla para la replicación, no se puede modificar una columna de esa tabla a un tipo de datos de XML si ya se ha generado una instantánea de publicación. Para modificar la columna, antes debe quitar la replicación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-153">If a table is published for replication, it is not possible to alter a column in that table to a data type of XML if a publication snapshot has already been generated To alter the column, you must first remove replication.</span></span>  
  
-   <span data-ttu-id="85d8e-154">La lectura no confirmada no es un nivel de aislamiento compatible al hacer DDL en una tabla publicada.</span><span class="sxs-lookup"><span data-stu-id="85d8e-154">Read uncommitted is not a supported isolation level when doing DDL on a published table.</span></span>  
  
-   <span data-ttu-id="85d8e-155">No se debe usar `SET CONTEXT_INFO` para modificar el contexto de las transacciones en las que se realizan cambios de esquema en objetos publicados.</span><span class="sxs-lookup"><span data-stu-id="85d8e-155">`SET CONTEXT_INFO` should not be used to modify the context of transactions where schema changes are performed against published objects.</span></span>  
  
#### <a name="adding-columns"></a><span data-ttu-id="85d8e-156">Agregar columnas</span><span class="sxs-lookup"><span data-stu-id="85d8e-156">Adding Columns</span></span>  
  
-   <span data-ttu-id="85d8e-157">Para agregar una columna nueva a una tabla e incluirla en una publicación existente, ejecute ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="85d8e-157">To add a new column to a table and include that column in an existing publication, execute ALTER TABLE \<Table> ADD \<Column>.</span></span> <span data-ttu-id="85d8e-158">De manera predeterminada, la columna se replicará en todos los suscriptores.</span><span class="sxs-lookup"><span data-stu-id="85d8e-158">By default, the column is then replicated to all Subscribers.</span></span> <span data-ttu-id="85d8e-159">La columna debe admitir valores NULL o incluir una restricción predeterminada.</span><span class="sxs-lookup"><span data-stu-id="85d8e-159">The column must allow NULL values or include a default constraint.</span></span> <span data-ttu-id="85d8e-160">Para obtener más información sobre la forma de agregar columnas, consulte la sección "Replicación de mezcla" de este tema.</span><span class="sxs-lookup"><span data-stu-id="85d8e-160">For more information about adding columns, see the "Merge Replication" section in this topic.</span></span>  
  
-   <span data-ttu-id="85d8e-161">Para agregar una columna nueva a una tabla sin incluirla en una publicación existente, deshabilite la replicación de los cambios de esquema y, después, ejecute ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="85d8e-161">To add a new column to a table and not include that column in an existing publication, disable the replication of schema changes, and then execute ALTER TABLE \<Table> ADD \<Column>.</span></span>  
  
-   <span data-ttu-id="85d8e-162">Para incluir una columna existente en una publicación existente, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) o el cuadro de diálogo **Propiedades de la publicación: \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="85d8e-162">To include an existing column in an existing publication, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="85d8e-163">Para más información, consulte [definir y modificar un filtro de columna](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-163">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="85d8e-164">Será necesario reinicializar las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="85d8e-164">This will require subscriptions to be reinitialized.</span></span>  
  
-   <span data-ttu-id="85d8e-165">No se admite la posibilidad de agregar una columna de identidad a una tabla publicada porque puede dar como resultado la falta de convergencia cuando la columna se replica en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-165">Adding an identity column to a published table is not supported, because it can result in non-convergence when the column is replicated to the Subscriber.</span></span> <span data-ttu-id="85d8e-166">Los valores de la columna de identidad en el publicador dependen del orden en que se almacenen físicamente las filas de la tabla afectada.</span><span class="sxs-lookup"><span data-stu-id="85d8e-166">The values in the identity column at the Publisher depend on the order in which the rows for the affected table are physically stored.</span></span> <span data-ttu-id="85d8e-167">Las filas se pueden almacenar de forma diferente en el suscriptor; por tanto, el valor de la columna de identidad puede ser diferente para las mismas filas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-167">The rows might be stored differently at the Subscriber; therefore the value for the identity column can be different for the same rows.</span></span>  
  
#### <a name="dropping-columns"></a><span data-ttu-id="85d8e-168">Quitar columnas</span><span class="sxs-lookup"><span data-stu-id="85d8e-168">Dropping Columns</span></span>  
  
-   <span data-ttu-id="85d8e-169">Para quitar una columna de una publicación existente y de la tabla del publicador, ejecute ALTER TABLE \<Table> DROP \<Column>.</span><span class="sxs-lookup"><span data-stu-id="85d8e-169">To drop a column from an existing publication and drop the column from the table at the Publisher, execute ALTER TABLE \<Table> DROP \<Column>.</span></span> <span data-ttu-id="85d8e-170">De forma predeterminada, la columna se quitará de la tabla en todos los suscriptores.</span><span class="sxs-lookup"><span data-stu-id="85d8e-170">By default, the column is then dropped from the table at all Subscribers.</span></span>  
  
-   <span data-ttu-id="85d8e-171">Para quitar una columna de una publicación existente, pero conservarla en la tabla del publicador, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) o el cuadro de diálogo **Propiedades de la publicación: \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="85d8e-171">To drop a column from an existing publication but retain the column in the table at the Publisher, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="85d8e-172">Para más información, consulte [definir y modificar un filtro de columna](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-172">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="85d8e-173">Será necesario generar una instantánea nueva.</span><span class="sxs-lookup"><span data-stu-id="85d8e-173">This will require a new snapshot to be generated.</span></span>  
  
-   <span data-ttu-id="85d8e-174">La columna que se quita no puede utilizarse en las cláusulas de filtro de ningún artículo de ninguna publicación de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="85d8e-174">The column to be dropped cannot be used in the filter clauses of any article of any publication in the database.</span></span>  
  
-   <span data-ttu-id="85d8e-175">Al quitar una columna de un artículo publicado, tenga en cuenta las restricciones, índices o propiedades de la columna que pudieran afectar a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="85d8e-175">When dropping a column from a published article, take into consideration any constraints, indexes, or properties of the column that could affect the database.</span></span> <span data-ttu-id="85d8e-176">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="85d8e-176">For example:</span></span>  
  
    -   <span data-ttu-id="85d8e-177">No puede quitar columnas utilizadas en una clave principal de los artículos en publicaciones transaccionales, ya que se utilizan en la replicación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-177">You cannot drop columns used in a primary key from articles in transactional publications, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="85d8e-178">No puede quitar la columna rowguid de los artículos de publicaciones de combinación ni la columna mstran_repl_version de los artículos de publicaciones transaccionales que admiten suscripciones de actualización, ya que se usan en la replicación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-178">You cannot drop the rowguid column from articles in merge publications or the mstran_repl_version column from articles in transactional publications that support updating subscriptions, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="85d8e-179">Los cambios de índice no se propagan a los suscriptores: si quita una columna en el publicador y se quita un índice dependiente, la eliminación del índice no se replica.</span><span class="sxs-lookup"><span data-stu-id="85d8e-179">Index changes are not propagated to Subscribers: if you drop a column at the Publisher and a dependent index is dropped, the index drop is not replicated.</span></span> <span data-ttu-id="85d8e-180">Debe quitar el índice en el suscriptor antes de quitar la columna en el publicador, de manera que se lleve a cabo correctamente la eliminación de la columna cuando se replique desde el publicador al suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-180">You should drop the index at the Subscriber before dropping the column at the Publisher, so that the column drop succeeds when it is replicated from the Publisher to the Subscriber.</span></span> <span data-ttu-id="85d8e-181">Si no funciona la sincronización debido a un índice en el suscriptor, quite manualmente el índice y ejecute de nuevo el agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="85d8e-181">If synchronization fails because of an index at the Subscriber, manually drop the index and then rerun the Merge Agent.</span></span>  
  
    -   <span data-ttu-id="85d8e-182">Las restricciones deben tener un nombre explícito para permitir la eliminación.</span><span class="sxs-lookup"><span data-stu-id="85d8e-182">Constraints should be explicitly named to allow for dropping.</span></span> <span data-ttu-id="85d8e-183">Para obtener más información, vea la sección "Consideraciones generales" de este tema.</span><span class="sxs-lookup"><span data-stu-id="85d8e-183">For more information, see the "General Considerations" section earlier in this topic.</span></span>  
  
### <a name="transactional-replication"></a><span data-ttu-id="85d8e-184">Replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="85d8e-184">Transactional Replication</span></span>  
  
-   <span data-ttu-id="85d8e-185">Los cambios de esquema se propagan a los suscriptores que ejecutan versiones anteriores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], pero la instrucción DDL solo debe incluir sintaxis compatible con la versión instalada en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-185">Schema changes are propagated to Subscribers running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], but the DDL statement should only include syntax supported by the version at the Subscriber.</span></span>  
  
     <span data-ttu-id="85d8e-186">Si el suscriptor vuelve a publicar los datos, los únicos cambios de esquema admitidos serán agregar y quitar una columna.</span><span class="sxs-lookup"><span data-stu-id="85d8e-186">If the Subscriber republishes data, the only supported schema changes are adding and dropping a column.</span></span> <span data-ttu-id="85d8e-187">Estos cambios deberían realizarse en el publicador mediante [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) y [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) en lugar de mediante la sintaxis ALTER TABLE DDL.</span><span class="sxs-lookup"><span data-stu-id="85d8e-187">These changes should be made on the Publisher using [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) rather than ALTER TABLE DDL syntax.</span></span>  
  
-   <span data-ttu-id="85d8e-188">Los cambios de esquema no se replican en los suscriptores que no sean de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="85d8e-188">Schema changes are not replicated to non-SQL Server Subscribers.</span></span>  
  
-   <span data-ttu-id="85d8e-189">Los cambios de esquema no se propagan desde los publicadores que no sean de[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="85d8e-189">Schema changes are not propagated from non-[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publishers.</span></span>  
  
-   <span data-ttu-id="85d8e-190">No se pueden alterar las vistas indizadas que se replican como tablas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-190">You cannot alter indexed views that are replicated as tables.</span></span> <span data-ttu-id="85d8e-191">Se pueden alterar las vistas indizadas que se replican como tales, pero esto hará que se conviertan en vistas normales en lugar de vistas indizadas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-191">Indexed views that are replicated as indexed views can be altered, but altering them will cause them to become regular views, rather than indexed views.</span></span>  
  
-   <span data-ttu-id="85d8e-192">Si la publicación admite suscripciones de actualización inmediata o en cola, se debe poner el sistema en modo inactivo antes de realizar cambios de esquema: es necesario detener toda la actividad en la tabla publicada en el publicador y los suscriptores, y propagar los datos pendientes a todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="85d8e-192">If the publication supports immediate updating or queued updating subscriptions, the system must be quiesced before making schema changes: all activity on the published table must be stopped at the Publisher and Subscribers, and pending data changes must be propagated to all nodes.</span></span> <span data-ttu-id="85d8e-193">Una vez propagados los cambios de esquema a todos los nodos, se puede reiniciar la actividad en las tablas publicadas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-193">After the schema changes have propagated to all nodes, activity can resume on the published tables.</span></span>  
  
-   <span data-ttu-id="85d8e-194">Si la publicación está en una topología punto a punto, se debe poner el sistema en modo inactivo antes de realizar cambios de esquema.</span><span class="sxs-lookup"><span data-stu-id="85d8e-194">If the publication is in a peer-to-peer topology, the system must be quiesced before making schema changes.</span></span> <span data-ttu-id="85d8e-195">Para más información, vea [Poner en modo inactivo una topología de replicación &#40;programación de la replicación con Transact-SQL&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="85d8e-195">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="85d8e-196">La adición de una columna de marca de tiempo a una tabla y la asignación de la marca de tiempo a binary(8) hacen que se reinicialice el artículo para todas las suscripciones activas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-196">Adding a timestamp column to a table and mapping the timestamp to binary(8) causes the article to be reinitialized for all active subscriptions.</span></span>  
  
### <a name="merge-replication"></a><span data-ttu-id="85d8e-197">Replicación de mezcla</span><span class="sxs-lookup"><span data-stu-id="85d8e-197">Merge Replication</span></span>  
  
-   <span data-ttu-id="85d8e-198">El nivel de compatibilidad de las publicaciones determina la forma en que la replicación de mezcla controla los cambios de esquema y si la instantánea debe establecerse en modo nativo (valor predeterminado) o en modo de carácter:</span><span class="sxs-lookup"><span data-stu-id="85d8e-198">How merge replication handles schema changes is determined by the publication compatibility level, and whether the snapshot is set to native mode (default) or character mode:</span></span>  
  
    -   <span data-ttu-id="85d8e-199">Para replicar cambios de esquema, el nivel de compatibilidad de la publicación debe ser de al menos 90RTM.</span><span class="sxs-lookup"><span data-stu-id="85d8e-199">To replicate schema changes, the compatibility level of the publication must be at least 90RTM.</span></span> <span data-ttu-id="85d8e-200">Si los suscriptores ejecutan versiones anteriores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o el nivel de compatibilidad es inferior a 90RTM, puede usar [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) y [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) para agregar y quitar columnas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-200">If Subscribers are running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or the compatibility level is less than 90RTM you can use [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) to add and drop columns.</span></span> <span data-ttu-id="85d8e-201">No obstante, estos procedimientos están desusados.</span><span class="sxs-lookup"><span data-stu-id="85d8e-201">However, these procedures are deprecated.</span></span>  
  
    -   <span data-ttu-id="85d8e-202">Si intenta agregar a un artículo existente una columna con un tipo de datos introducido en [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] se comportará de este modo:</span><span class="sxs-lookup"><span data-stu-id="85d8e-202">If you try to add to an existing article a column with a data type that was introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has the following behavior:</span></span>  
  
        ||<span data-ttu-id="85d8e-203">100RTM, instantánea nativa</span><span class="sxs-lookup"><span data-stu-id="85d8e-203">100RTM, native snapshot</span></span>|<span data-ttu-id="85d8e-204">100RTM, instantánea de carácter</span><span class="sxs-lookup"><span data-stu-id="85d8e-204">100RTM, character snapshot</span></span>|<span data-ttu-id="85d8e-205">Todos los demás niveles de compatibilidad</span><span class="sxs-lookup"><span data-stu-id="85d8e-205">All other compatibility levels</span></span>|  
        |-|-----------------------------|--------------------------------|------------------------------------|  
        |`hierarchyid`|<span data-ttu-id="85d8e-206">Permitir cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-206">Allow change</span></span>|<span data-ttu-id="85d8e-207">Bloquear cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-207">Block change</span></span>|<span data-ttu-id="85d8e-208">Bloquear cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-208">Block change</span></span>|  
        |<span data-ttu-id="85d8e-209">`geography` y `geometry`</span><span class="sxs-lookup"><span data-stu-id="85d8e-209">`geography` and `geometry`</span></span>|<span data-ttu-id="85d8e-210">Permitir cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-210">Allow change</span></span>|<span data-ttu-id="85d8e-211">Permitir cambio<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="85d8e-211">Allow change<sup>1</sup></span></span>|<span data-ttu-id="85d8e-212">Bloquear cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-212">Block change</span></span>|  
        |`filestream`|<span data-ttu-id="85d8e-213">Permitir cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-213">Allow change</span></span>|<span data-ttu-id="85d8e-214">Bloquear cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-214">Block change</span></span>|<span data-ttu-id="85d8e-215">Bloquear cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-215">Block change</span></span>|  
        |<span data-ttu-id="85d8e-216">`date`, `time`, `datetime2` y `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="85d8e-216">`date`, `time`, `datetime2`, and `datetimeoffset`</span></span>|<span data-ttu-id="85d8e-217">Permitir cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-217">Allow change</span></span>|<span data-ttu-id="85d8e-218">Permitir cambio<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="85d8e-218">Allow change<sup>1</sup></span></span>|<span data-ttu-id="85d8e-219">Bloquear cambio</span><span class="sxs-lookup"><span data-stu-id="85d8e-219">Block change</span></span>|  
  
         <span data-ttu-id="85d8e-220"><sup>1</sup> SQL Server Compact los suscriptores convierten estos tipos de datos en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="85d8e-220"><sup>1</sup> SQL Server Compact Subscribers convert these data types at the Subscriber.</span></span>  
  
-   <span data-ttu-id="85d8e-221">En caso de error al aplicar un cambio de esquema (por ejemplo, un error que se produce por agregar una clave externa que hace referencia a una tabla que no está disponible en el suscriptor), se produce un error en la sincronización y es necesario reinicializar la suscripción.</span><span class="sxs-lookup"><span data-stu-id="85d8e-221">If an error occurs when applying a schema change (such as an error resulting from adding a foreign key that references a table not available at the Subscriber), synchronization fails and the subscription must be reinitialized.</span></span>  
  
-   <span data-ttu-id="85d8e-222">Si se realiza un cambio de esquema en una columna que forma parte de un filtro de combinación o con parámetros, es necesario reinicializar todas las suscripciones y volver a generar la instantánea.</span><span class="sxs-lookup"><span data-stu-id="85d8e-222">If a schema change is made on a column involved in a join filter or parameterized filter, you must reinitialize all subscriptions and regenerate the snapshot.</span></span>  
  
-   <span data-ttu-id="85d8e-223">La replicación de mezcla proporciona procedimientos almacenados para omitir los cambios de esquema durante la solución de problemas.</span><span class="sxs-lookup"><span data-stu-id="85d8e-223">Merge replication provides stored procedures to skip schema changes during troubleshooting.</span></span> <span data-ttu-id="85d8e-224">Para obtener más información, vea [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) y [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="85d8e-224">For more information, see [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) and [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="85d8e-225">Consulte también</span><span class="sxs-lookup"><span data-stu-id="85d8e-225">See Also</span></span>  
 <span data-ttu-id="85d8e-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="85d8e-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span></span>  
 <span data-ttu-id="85d8e-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="85d8e-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span></span>  
 <span data-ttu-id="85d8e-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="85d8e-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span></span>  
 <span data-ttu-id="85d8e-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="85d8e-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span></span>  
 <span data-ttu-id="85d8e-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="85d8e-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span></span>  
 <span data-ttu-id="85d8e-231">[Publicar datos y objetos de base de datos](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="85d8e-231">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 [<span data-ttu-id="85d8e-232">Volver a generar procedimientos transaccionales personalizados para reflejar cambios de esquema</span><span class="sxs-lookup"><span data-stu-id="85d8e-232">Regenerate Custom Transactional Procedures to Reflect Schema Changes</span></span>](../transactional/transactional-articles-regenerate-to-reflect-schema-changes.md)  
  
  
