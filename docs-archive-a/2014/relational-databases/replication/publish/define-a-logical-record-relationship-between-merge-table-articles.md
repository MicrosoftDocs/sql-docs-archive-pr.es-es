---
title: Definición de una relación de registros lógicos entre artículos de tabla de mezcla | Microsoft Docs
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication logical records [SQL Server replication]
- articles [SQL Server replication], logical records
- logical records [SQL Server replication]
ms.assetid: ff847b3a-c6b0-4eaf-b225-2ffc899c5558
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 60c92a237562704e5bc5d43717f863aa78a14b55
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750685"
---
# <a name="define-a-logical-record-relationship-between-merge-table-articles"></a><span data-ttu-id="6ca6a-102">Definir una relación de registros lógicos entre artículos de tabla de mezcla</span><span class="sxs-lookup"><span data-stu-id="6ca6a-102">Define a Logical Record Relationship Between Merge Table Articles</span></span>
  <span data-ttu-id="6ca6a-103">En este tema se describe cómo definir una relación de registros lógicos entre los artículos de tabla de mezcla en [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] mediante [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]o Replication Management Objects (RMO).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-103">This topic describes how to define a logical record relationship between merge table articles in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="6ca6a-104">La replicación de mezcla le permite definir una relación entre filas relacionadas de tablas diferentes.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-104">Merge replication allows you to define a relationship between related rows in different tables.</span></span> <span data-ttu-id="6ca6a-105">De ese modo, las filas se pueden procesar como una unidad transaccional durante la sincronización.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-105">These rows can then be processed as a transactional unit during synchronization.</span></span> <span data-ttu-id="6ca6a-106">Se puede definir un registro lógico entre dos artículos independientemente de que tengan una relación de filtro de unión o no.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-106">A logical record can be defined between two articles whether or not they have a join filter relationship.</span></span> <span data-ttu-id="6ca6a-107">Para más información, vea [Agrupar cambios en filas relacionadas con registros lógicos](../merge/group-changes-to-related-rows-with-logical-records.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-107">For more information, see [Group Changes to Related Rows with Logical Records](../merge/group-changes-to-related-rows-with-logical-records.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
 <span data-ttu-id="6ca6a-108">**En este tema**</span><span class="sxs-lookup"><span data-stu-id="6ca6a-108">**In This Topic**</span></span>  
  
-   <span data-ttu-id="6ca6a-109">**Antes de empezar:**</span><span class="sxs-lookup"><span data-stu-id="6ca6a-109">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="6ca6a-110">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="6ca6a-110">Limitations and Restrictions</span></span>](#Restrictions)  
  
-   <span data-ttu-id="6ca6a-111">**Para definir una relación de registros lógicos entre artículos de tabla de mezcla con:**</span><span class="sxs-lookup"><span data-stu-id="6ca6a-111">**To define a logical record relationship between merge table articles, using:**</span></span>  
  
     [<span data-ttu-id="6ca6a-112">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6ca6a-112">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="6ca6a-113">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6ca6a-113">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="6ca6a-114">Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="6ca6a-114">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="6ca6a-115">Antes de comenzar</span><span class="sxs-lookup"><span data-stu-id="6ca6a-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="6ca6a-116">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="6ca6a-116">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="6ca6a-117">Si agrega, modifica o elimina un registro lógico una vez inicializadas las suscripciones a la publicación, deberá generar una instantánea nueva y reinicializar todas las suscripciones después de realizar el cambio.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-117">If you add, modify, or delete a logical record after subscriptions to the publication have been initialized, you must generate a new snapshot and reinitialize all subscriptions after making the change.</span></span> <span data-ttu-id="6ca6a-118">Para obtener más información sobre los requisitos para los cambios de propiedad, consulte [Cambiar las propiedades de la publicación y de los artículos](change-publication-and-article-properties.md) (Cambiar las propiedades de la publicación y de los artículos).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-118">For more information about requirements for property changes, see [Change Publication and Article Properties](change-publication-and-article-properties.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="6ca6a-119">Uso de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6ca6a-119">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="6ca6a-120">Defina registros lógicos en el cuadro de diálogo **Agregar combinación**, que está disponible en el Asistente para nueva publicación y en el cuadro de diálogo **Propiedades de la publicación: \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-120">Define logical records in the **Add Join** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="6ca6a-121">Para obtener más información sobre el uso del asistente y el acceso al cuadro de diálogo, consulte [Create a Publication](create-a-publication.md) (Crear una publicación) y [Ver y modificar propiedades de publicación](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-121">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
 <span data-ttu-id="6ca6a-122">Los registros lógicos se pueden definir en el cuadro de diálogo **Agregar combinación** solamente si se aplican a un filtro de combinación en una publicación de combinación y la publicación cumple los requisitos para utilizar particiones precalculadas.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-122">Logical records can be defined in the **Add Join** dialog box only if they are applied to a join filter in a merge publication, and the publication follows the requirements for using precomputed partitions.</span></span> <span data-ttu-id="6ca6a-123">Debe utilizar procedimientos almacenados para definir registros lógicos que no se aplican a los filtros de combinación y para establecer la detección y resolución de conflictos en el nivel de registro lógico.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-123">To define logical records that are not applied to join filters and to set conflict detection and resolution at the logical record level, you must use stored procedures.</span></span>  
  
#### <a name="to-define-a-logical-record-relationship"></a><span data-ttu-id="6ca6a-124">Para definir una relación de registros lógicos</span><span class="sxs-lookup"><span data-stu-id="6ca6a-124">To define a logical record relationship</span></span>  
  
1.  <span data-ttu-id="6ca6a-125">En la página **Filtrar filas de tabla** del Asistente para nueva publicación o la página **Filtrar filas** del cuadro de diálogo **Propiedades de la publicación: \<Publication>** , seleccione un filtro de fila en el panel **Tablas filtradas**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-125">On the **Filter Table Rows** page of the New Publication Wizard or the **Filter Rows** page of the **Publication Properties - \<Publication>** dialog box, select a row filter in the **Filtered Tables** pane.</span></span>  
  
     <span data-ttu-id="6ca6a-126">Una relación de registros lógicos está asociada con un filtro de combinación, que amplía un filtro de fila.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-126">A logical record relationship is associated with a join filter, which extends a row filter.</span></span> <span data-ttu-id="6ca6a-127">Por tanto, debe definir un filtro de fila antes de poder ampliar el filtro con una combinación y aplicar una relación de registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-127">Therefore you must define a row filter before you can extend the filter with a join and apply a logical record relationship.</span></span> <span data-ttu-id="6ca6a-128">Una vez definido el filtro de combinación, podrá ampliarlo con otro filtro de combinación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-128">After one join filter is defined, you can extend this join filter with another join filter.</span></span> <span data-ttu-id="6ca6a-129">Para obtener más información acerca de cómo definir filtros de combinación, vea [Definir y modificar un filtro de combinación entre artículos de mezcla](define-and-modify-a-join-filter-between-merge-articles.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-129">For more information about defining join filters, see [Define and Modify a Join Filter Between Merge Articles](define-and-modify-a-join-filter-between-merge-articles.md).</span></span>  
  
2.  <span data-ttu-id="6ca6a-130">Haga clic en **Agregar**y, a continuación, en **Agregar combinación para ampliar el filtro seleccionado**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-130">Click **Add**, and then click **Add Join to Extend the Selected Filter**.</span></span>  
  
3.  <span data-ttu-id="6ca6a-131">Defina el filtro de combinación en el cuadro de diálogo **Agregar combinación** y, a continuación, active la casilla **Registro lógico**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-131">Define a join filter in the **Add Join** dialog box, and then select the check box **Logical Record**.</span></span>  
  
4.  <span data-ttu-id="6ca6a-132">Si está en el cuadro de diálogo **Propiedades de la publicación: \<Publication>** , haga clic en **Aceptar** para guardar y cerrar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-132">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-delete-a-logical-record-relationship"></a><span data-ttu-id="6ca6a-133">Para eliminar una relación de registros lógicos</span><span class="sxs-lookup"><span data-stu-id="6ca6a-133">To delete a logical record relationship</span></span>  
  
-   <span data-ttu-id="6ca6a-134">Elimine solamente la relación de registros lógicos o elimine la relación de registros lógicos y el filtro de combinación asociado a la misma.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-134">Delete only the logical record relationship or delete the logical record relationship and the join filter associated with it.</span></span>  
  
     <span data-ttu-id="6ca6a-135">Para eliminar solamente la relación de registros lógicos:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-135">To delete only the logical record relationship:</span></span>  
  
    1.  <span data-ttu-id="6ca6a-136">En la página **Filtrar filas** del Asistente para nueva publicación o en la página **Filtrar filas** del cuadro de diálogo **Propiedades de la publicación: \<Publication>** , seleccione el filtro de combinación asociado con la relación de registros lógicos del panel **Tablas filtradas** y haga clic en **Editar**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-136">On the **Filter Rows** page of the New Publication Wizard or the **Filter Rows** page of the **Publication Properties - \<Publication>** dialog box, select the join filter associated with the logical record relationship in the **Filtered Tables** pane, and then click **Edit**.</span></span>  
  
    2.  <span data-ttu-id="6ca6a-137">En el cuadro de diálogo **Editar combinación** , desactive la casilla **Registro lógico**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-137">In the **Edit Join** dialog box, clear the check box **Logical Record**.</span></span>  
  
    3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
     <span data-ttu-id="6ca6a-138">Para eliminar la relación de registros lógicos y el filtro de combinación asociado a la misma:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-138">To delete the logical record relationship and join filter associated with it:</span></span>  
  
    -   <span data-ttu-id="6ca6a-139">En la página **Filtrar filas** del Asistente para nueva publicación o en el cuadro de diálogo **Propiedades de la publicación: \<Publication>** , seleccione un filtro en el panel **Tablas filtradas** y haga clic en **Eliminar**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-139">On the **Filter Rows** page of the New Publication Wizard or **Publication Properties - \<Publication>** dialog box, select a filter in the **Filtered Tables** pane, and then click **Delete**.</span></span> <span data-ttu-id="6ca6a-140">Si el filtro de combinación que elimina está a su vez ampliado por otras combinaciones, esas combinaciones también se eliminarán.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-140">If the join filter you delete is itself extended by other joins, those joins will also be deleted.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="6ca6a-141">Usar Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6ca6a-141">Using Transact-SQL</span></span>  
 <span data-ttu-id="6ca6a-142">Puede especificar mediante programación las relaciones de registros lógicos entre los artículos usando procedimientos almacenados de replicación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-142">You can programmatically specify logical record relationships between articles using replication stored procedures.</span></span>  
  
#### <a name="to-define-a-logical-record-relationship-without-an-associated-join-filter"></a><span data-ttu-id="6ca6a-143">Para definir una relación de registros lógicos sin un filtro de combinación asociado</span><span class="sxs-lookup"><span data-stu-id="6ca6a-143">To define a logical record relationship without an associated join filter</span></span>  
  
1.  <span data-ttu-id="6ca6a-144">Si la publicación contiene cualquier artículo que se filtra, ejecute [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql)y tenga en cuenta el valor de **use_partition_groups** en el conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-144">If the publication contains any articles that are filtered, execute [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), and note the value of **use_partition_groups** in the result set.</span></span>  
  
    -   <span data-ttu-id="6ca6a-145">Si el valor es **1**, las particiones precalculadas ya se están usando.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-145">If the value is **1**, then precomputed partitions are already being used.</span></span>  
  
    -   <span data-ttu-id="6ca6a-146">Si el valor es **0**, ejecute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql) en el Publicador de la base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-146">If the value is **0**, then execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="6ca6a-147">Especifique un valor de **use_partition_groups** para **@property** y un valor de **true** para **@value**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-147">Specify a value of **use_partition_groups** for **@property** and a value of **true** for **@value**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6ca6a-148">Si la publicación no admite las particiones precalculadas, no se pueden usar registros lógicos.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-148">If the publication does not support precomputed partitions, then logical records cannot be used.</span></span> <span data-ttu-id="6ca6a-149">Para obtener más información, vea la sección Requisitos para utilizar particiones precalculadas de [Optimizar el rendimiento de los filtros con parámetros con particiones calculadas previamente](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-149">For more information, see Requirements for Using Precomputed Partitions in the topic [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>  
  
    -   <span data-ttu-id="6ca6a-150">Si el valor es NULL, el Agente de instantáneas tiene que seguir ejecutándose para generar la instantánea inicial para la publicación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-150">If the value is NULL, then the Snapshot Agent needs to be run to generate the initial snapshot for the publication.</span></span>  
  
2.  <span data-ttu-id="6ca6a-151">Si no existen los artículos que comprenderán el registro lógico, ejecute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) en el Publicador de la base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-151">If the articles that will comprise the logical record do not exist, execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="6ca6a-152">Especifique una de las siguientes opciones de detección y resolución de conflictos para el registro lógico:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-152">Specify one of the following conflict detection and resolution options for the logical record:</span></span>  
  
    -   <span data-ttu-id="6ca6a-153">Para detectar y solucionar conflictos que se producen dentro de las filas relacionadas en el registro lógico, especifique un valor de **true** para **@logical_record_level_conflict_detection** y **@logical_record_level_conflict_resolution**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-153">To detect and resolve conflicts that occur within related rows in the logic record, specify a value of **true** for **@logical_record_level_conflict_detection** and **@logical_record_level_conflict_resolution**.</span></span>  
  
    -   <span data-ttu-id="6ca6a-154">Para usar la detección y resolución de conflictos de nivel de fila o de columna estándar, especifique un valor de `false` para **@logical_record_level_conflict_detection** y **@logical_record_level_conflict_resolution** , que es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-154">To use the standard row- or column-level conflict detection and resolution, specify a value of `false` for **@logical_record_level_conflict_detection** and **@logical_record_level_conflict_resolution**, which is the default.</span></span>  
  
3.  <span data-ttu-id="6ca6a-155">Repita el paso 2 para cada artículo que comprenderá el registro lógico.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-155">Repeat step 2 for each article that will comprise the logical record.</span></span> <span data-ttu-id="6ca6a-156">Debe usar la misma opción de detección y resolución de conflictos para cada artículo del registro lógico.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-156">You must use the same conflict detection and resolution option for each article in the logical record.</span></span> <span data-ttu-id="6ca6a-157">Para más información, consulte [Detectar y solucionar conflictos en registros lógicos](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-157">For more information, see [Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>  
  
4.  <span data-ttu-id="6ca6a-158">En la base de datos de publicación del publicador, ejecute [sp_addmergefilter](/sql/relational-databases/system-stored-procedures/sp-addmergefilter-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-158">At the publisher on the publication database, execute [sp_addmergefilter](/sql/relational-databases/system-stored-procedures/sp-addmergefilter-transact-sql).</span></span> <span data-ttu-id="6ca6a-159">Especifique **@publication** , el nombre de un artículo en la relación para **@article** , el nombre del segundo artículo para **@join_articlename** , un nombre para la relación para **@filtername** , una cláusula que define la relación entre los dos artículos para **@join_filterclause** , el tipo de combinación para **@join_unique_key** y uno de los siguientes valores para **@filter_type** :</span><span class="sxs-lookup"><span data-stu-id="6ca6a-159">Specify **@publication**, the name of one article in the relationship for **@article**, the name of the second article for **@join_articlename**, a name for the relationship for **@filtername**, a clause that defines the relationship between the two articles for **@join_filterclause**, the type of join for **@join_unique_key** and one of the following values for **@filter_type**:</span></span>  
  
    -   <span data-ttu-id="6ca6a-160">**2** : define una relación lógica.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-160">**2** - Defines a logical relationship.</span></span>  
  
    -   <span data-ttu-id="6ca6a-161">**3** : define una relación lógica con un filtro de combinación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-161">**3** - Defines a logical relationship with a join filter.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6ca6a-162">Si no se usa un filtro de combinación, la dirección de la relación entre los dos artículos no es importante.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-162">If a join filter is not used, the direction of the relationship between the two articles is not important.</span></span>  
  
5.  <span data-ttu-id="6ca6a-163">Repita el paso 2 para cada una de las demás relaciones de registros lógicos de la publicación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-163">Repeat step 2 for each remaining logical record relationship in the publication.</span></span>  
  
#### <a name="to-change-conflict-detection-and-resolution-for-logical-records"></a><span data-ttu-id="6ca6a-164">Para cambiar la detección y resolución de conflictos para los registros lógicos</span><span class="sxs-lookup"><span data-stu-id="6ca6a-164">To change conflict detection and resolution for logical records</span></span>  
  
1.  <span data-ttu-id="6ca6a-165">Para detectar y solucionar conflictos que se producen dentro de las filas relacionadas en el registro lógico:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-165">To detect and resolve conflicts that occur within related rows in the logical record:</span></span>  
  
    -   <span data-ttu-id="6ca6a-166">En la base de datos de publicación del publicador, ejecute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-166">At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="6ca6a-167">Especifique un valor de **logical_record_level_conflict_detection** para **@property** y un valor de **true** para **@value**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-167">Specify a value of **logical_record_level_conflict_detection** for **@property** and a value of **true** for **@value**.</span></span> <span data-ttu-id="6ca6a-168">Especifique un valor de **1** para **@force_invalidate_snapshot** y **@force_reinit_subscription**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-168">Specify a value of **1** for **@force_invalidate_snapshot** and **@force_reinit_subscription**.</span></span>  
  
    -   <span data-ttu-id="6ca6a-169">En la base de datos de publicación del publicador, ejecute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-169">At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="6ca6a-170">Especifique un valor de **logical_record_level_conflict_resolution** para **@property** y un valor de **true** para **@value**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-170">Specify a value of **logical_record_level_conflict_resolution** for **@property** and a value of **true** for **@value**.</span></span> <span data-ttu-id="6ca6a-171">Especifique un valor de **1** para **@force_invalidate_snapshot** y **@force_reinit_subscription**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-171">Specify a value of **1** for **@force_invalidate_snapshot** and **@force_reinit_subscription**.</span></span>  
  
2.  <span data-ttu-id="6ca6a-172">Para usar la detección y resolución de conflictos de nivel de columna y de fila estándar:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-172">To use the standard row-level or column-level conflict detection and resolution:</span></span>  
  
    -   <span data-ttu-id="6ca6a-173">En la base de datos de publicación del publicador, ejecute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-173">At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="6ca6a-174">Especifique un valor de **logical_record_level_conflict_detection** para **@property** y un valor de `false` para **@value** .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-174">Specify a value of **logical_record_level_conflict_detection** for **@property** and a value of `false` for **@value**.</span></span> <span data-ttu-id="6ca6a-175">Especifique un valor de **1** para **@force_invalidate_snapshot** y **@force_reinit_subscription**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-175">Specify a value of **1** for **@force_invalidate_snapshot** and **@force_reinit_subscription**.</span></span>  
  
    -   <span data-ttu-id="6ca6a-176">En la base de datos de publicación del publicador, ejecute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-176">At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="6ca6a-177">Especifique un valor de **logical_record_level_conflict_resolution** para **@property** y un valor de `false` para **@value** .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-177">Specify a value of **logical_record_level_conflict_resolution** for **@property** and a value of `false` for **@value**.</span></span> <span data-ttu-id="6ca6a-178">Especifique un valor de **1** para **@force_invalidate_snapshot** y **@force_reinit_subscription**.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-178">Specify a value of **1** for **@force_invalidate_snapshot** and **@force_reinit_subscription**.</span></span>  
  
#### <a name="to-remove-a-logical-record-relationship"></a><span data-ttu-id="6ca6a-179">Para quitar una relación de registros lógicos</span><span class="sxs-lookup"><span data-stu-id="6ca6a-179">To remove a logical record relationship</span></span>  
  
1.  <span data-ttu-id="6ca6a-180">En el Publicador de la base de datos de publicación, ejecute la consulta siguiente para devolver información sobre todas las relaciones de registros lógicos definidas para la publicación especificada:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-180">At the Publisher on the publication database, execute the following query to return information about all logical record relationships defined for the specified publication:</span></span>  
  
     [!code-sql[HowTo#sp_ReturnMergeLogicalRecords](../../../snippets/tsql/SQL15/replication/howto/tsql/createlogicalrecordpub.sql#sp_returnmergelogicalrecords)]  
  
     <span data-ttu-id="6ca6a-181">Tenga en cuenta el nombre de la relación de registros lógicos que se está quitando en la columna `filtername` del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-181">Note the name of the logical record relationship being removed in the `filtername` column in the result set.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6ca6a-182">Esta consulta devuelve la misma información que [sp_helpmergefilter](/sql/relational-databases/system-stored-procedures/sp-helpmergefilter-transact-sql); sin embargo, este procedimiento almacenado del sistema solamente devuelve información sobre las relaciones de registros lógicos que también son filtros de combinación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-182">This query returns the same information as [sp_helpmergefilter](/sql/relational-databases/system-stored-procedures/sp-helpmergefilter-transact-sql); however, this system stored procedure only returns information about logical record relationships that are also join filters.</span></span>  
  
2.  <span data-ttu-id="6ca6a-183">En la base de datos de publicación del publicador, ejecute [sp_dropmergefilter](/sql/relational-databases/system-stored-procedures/sp-dropmergefilter-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-183">At the Publisher on the publication database, execute [sp_dropmergefilter](/sql/relational-databases/system-stored-procedures/sp-dropmergefilter-transact-sql).</span></span> <span data-ttu-id="6ca6a-184">Especifique **@publication** , el nombre de uno de los artículos de la relación para **@article** y el nombre de la relación del paso 1 para **@filtername** .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-184">Specify **@publication**, the name of one of the articles in the relationship for **@article**, and the name of the relationship from step 1 for **@filtername**.</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="6ca6a-185">Ejemplo (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="6ca6a-185">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="6ca6a-186">En este ejemplo se habilitan las particiones calculadas previamente en una publicación existente y se crea un registro lógico que comprende los dos artículos nuevos para las tablas `SalesOrderHeader` y `SalesOrderDetail` .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-186">This example enables precomputed partitions on an existing publication, and creates a logical record comprising the two new articles for the `SalesOrderHeader` and `SalesOrderDetail` tables.</span></span>  
  
 [!code-sql[HowTo#sp_AddMergeLogicalRecord](../../../snippets/tsql/SQL15/replication/howto/tsql/createlogicalrecordpub.sql#sp_addmergelogicalrecord)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="6ca6a-187">Uso de Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="6ca6a-187">Using Replication Management Objects (RMO)</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6ca6a-188">La replicación de mezcla le permite especificar que se realice un seguimiento de los conflictos y se resuelvan en el nivel de registro lógico, pero dichas opciones no se pueden establecer usando RMO.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-188">Merge replication allows you to specify that conflicts be tracked and resolved at the logical record level, but these options cannot be set using RMO.</span></span>  
  
#### <a name="to-define-a-logical-record-relationship-without-an-associated-join-filter"></a><span data-ttu-id="6ca6a-189">Para definir una relación de registros lógicos sin un filtro de combinación asociado</span><span class="sxs-lookup"><span data-stu-id="6ca6a-189">To define a logical record relationship without an associated join filter</span></span>  
  
1.  <span data-ttu-id="6ca6a-190">Cree una conexión al publicador mediante la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-190">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6ca6a-191">Cree una instancia de la clase <xref:Microsoft.SqlServer.Replication.MergePublication> , establezca las propiedades <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> y <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> para la publicación y establezca la propiedad <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> en la conexión creada en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-191">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class, set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="6ca6a-192">Llame al método <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> para obtener las propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-192">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6ca6a-193">Si este método devuelve `false`, significa que las propiedades de publicación del paso 2 se definieron incorrectamente, o bien que la publicación no existe.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-193">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="6ca6a-194">Si la propiedad <xref:Microsoft.SqlServer.Replication.MergePublication.PartitionGroupsOption%2A> está establecida en <xref:Microsoft.SqlServer.Replication.PartitionGroupsOption.False>, cámbiela a <xref:Microsoft.SqlServer.Replication.PartitionGroupsOption.True>.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-194">If the <xref:Microsoft.SqlServer.Replication.MergePublication.PartitionGroupsOption%2A> property is set to <xref:Microsoft.SqlServer.Replication.PartitionGroupsOption.False>, set it to <xref:Microsoft.SqlServer.Replication.PartitionGroupsOption.True>.</span></span>  
  
5.  <span data-ttu-id="6ca6a-195">Si los artículos que van a componer el registro lógico no existen, cree una instancia de la clase <xref:Microsoft.SqlServer.Replication.MergeArticle> y establezca las propiedades siguientes:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-195">If the articles that are to comprise the logical record do not exist, create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class, and set the following properties:</span></span>  
  
    -   <span data-ttu-id="6ca6a-196">El nombre del artículo para <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-196">The name of the article for <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="6ca6a-197">El nombre de la publicación para <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-197">The name of the publication for <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="6ca6a-198">(Opcional) Si se filtra el artículo horizontalmente, especifique la cláusula de filtro de filas para la propiedad <xref:Microsoft.SqlServer.Replication.MergeArticle.FilterClause%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-198">(Optional) If the article is horizontally filtered, specify the row filter clause for the <xref:Microsoft.SqlServer.Replication.MergeArticle.FilterClause%2A> property.</span></span> <span data-ttu-id="6ca6a-199">Utilice esta propiedad para especificar un filtro de fila estático o con parámetros.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-199">Use this property to specify a static or parameterized row filter.</span></span> <span data-ttu-id="6ca6a-200">Para obtener más información, consulte [Filtros de fila con parámetros](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-200">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
     <span data-ttu-id="6ca6a-201">Para más información, consulte [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-201">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
6.  <span data-ttu-id="6ca6a-202">Llame al método <xref:Microsoft.SqlServer.Replication.Article.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-202">Call the <xref:Microsoft.SqlServer.Replication.Article.Create%2A> method.</span></span>  
  
7.  <span data-ttu-id="6ca6a-203">Repita los pasos 5 y 6 para cada artículo que comprende el registro lógico.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-203">Repeat steps 5 and 6 for each article comprising the logical record.</span></span>  
  
8.  <span data-ttu-id="6ca6a-204">Cree una instancia de la clase <xref:Microsoft.SqlServer.Replication.MergeJoinFilter> para definir la relación de registros lógicos entre los artículos.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter> class to define the logical record relationship between articles.</span></span> <span data-ttu-id="6ca6a-205">A continuación, establezca las siguientes propiedades:</span><span class="sxs-lookup"><span data-stu-id="6ca6a-205">Then, set the following properties:</span></span>  
  
    -   <span data-ttu-id="6ca6a-206">El nombre del artículo secundario en la relación de registros lógicos para la propiedad <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.ArticleName%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-206">The name of the child article in the logical record relationship for the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.ArticleName%2A> property.</span></span>  
  
    -   <span data-ttu-id="6ca6a-207">El nombre del artículo primario, ya existente, en la relación de registros lógicos para la propiedad <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.JoinArticleName%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-207">The name of the existing, parent article in the logical record relationship for the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.JoinArticleName%2A> property.</span></span>  
  
    -   <span data-ttu-id="6ca6a-208">Un nombre para la relación de registros lógicos para la propiedad <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.FilterName%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-208">A name for the logical record relationship for the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.FilterName%2A> property.</span></span>  
  
    -   <span data-ttu-id="6ca6a-209">La expresión que define la relación para la propiedad <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.JoinFilterClause%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-209">The expression that defines the relationship for the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.JoinFilterClause%2A> property.</span></span>  
  
    -   <span data-ttu-id="6ca6a-210">El valor <xref:Microsoft.SqlServer.Replication.FilterTypes.LogicalRecordLink> para la propiedad <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.FilterTypes%2A> .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-210">A value of <xref:Microsoft.SqlServer.Replication.FilterTypes.LogicalRecordLink> for the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter.FilterTypes%2A> property.</span></span> <span data-ttu-id="6ca6a-211">Si la relación de registros lógicos también es un filtro de combinación, especifique el valor <xref:Microsoft.SqlServer.Replication.FilterTypes.JoinFilterAndLogicalRecordLink> para esta propiedad.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-211">If the logical record relationship is also a join filter, specify a value of <xref:Microsoft.SqlServer.Replication.FilterTypes.JoinFilterAndLogicalRecordLink> for this property.</span></span> <span data-ttu-id="6ca6a-212">Para más información, vea [Agrupar cambios en filas relacionadas con registros lógicos](../merge/group-changes-to-related-rows-with-logical-records.md).</span><span class="sxs-lookup"><span data-stu-id="6ca6a-212">For more information, see [Group Changes to Related Rows with Logical Records](../merge/group-changes-to-related-rows-with-logical-records.md).</span></span>  
  
9. <span data-ttu-id="6ca6a-213">Llame al método <xref:Microsoft.SqlServer.Replication.MergeArticle.AddMergeJoinFilter%2A> en el objeto que representa el artículo secundario en la relación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-213">Call the <xref:Microsoft.SqlServer.Replication.MergeArticle.AddMergeJoinFilter%2A> method on the object that represents the child article in the relationship.</span></span> <span data-ttu-id="6ca6a-214">Pase el objeto <xref:Microsoft.SqlServer.Replication.MergeJoinFilter> del paso 8 para definir la relación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-214">Pass the <xref:Microsoft.SqlServer.Replication.MergeJoinFilter> object from step 8 to define the relationship.</span></span>  
  
10. <span data-ttu-id="6ca6a-215">Repita los pasos 8 y 9 para cada una de las demás relaciones de registros lógicos de la publicación.</span><span class="sxs-lookup"><span data-stu-id="6ca6a-215">Repeat steps 8 and 9 for each remaining logical record relationship in the publication.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="6ca6a-216">Ejemplo (RMO)</span><span class="sxs-lookup"><span data-stu-id="6ca6a-216">Example (RMO)</span></span>  
 <span data-ttu-id="6ca6a-217">En este ejemplo se crea un registro lógico que incluye los dos artículos nuevos para las tablas `SalesOrderHeader` y `SalesOrderDetail` .</span><span class="sxs-lookup"><span data-stu-id="6ca6a-217">This example creates a logical record comprising the two new articles for the `SalesOrderHeader` and `SalesOrderDetail` tables.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateLogicalRecord](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createlogicalrecord)]  
  
 [!code-vb[HowTo#rmo_vb_CreateLogicalRecord](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createlogicalrecord)]  
  
## <a name="see-also"></a><span data-ttu-id="6ca6a-218">Consulte también</span><span class="sxs-lookup"><span data-stu-id="6ca6a-218">See Also</span></span>  
 <span data-ttu-id="6ca6a-219">[Definir y modificar un filtro de combinación entre artículos de mezcla](define-and-modify-a-join-filter-between-merge-articles.md) </span><span class="sxs-lookup"><span data-stu-id="6ca6a-219">[Define and Modify a Join Filter Between Merge Articles](define-and-modify-a-join-filter-between-merge-articles.md) </span></span>  
 <span data-ttu-id="6ca6a-220">[Definición y modificación de un filtro de fila con parámetros para un artículo de mezcla](define-and-modify-a-parameterized-row-filter-for-a-merge-article.md) </span><span class="sxs-lookup"><span data-stu-id="6ca6a-220">[Define and Modify a Parameterized Row Filter for a Merge Article](define-and-modify-a-parameterized-row-filter-for-a-merge-article.md) </span></span>  
 <span data-ttu-id="6ca6a-221">[Definir y modificar un filtro de fila estático](define-and-modify-a-static-row-filter.md) </span><span class="sxs-lookup"><span data-stu-id="6ca6a-221">[Define and Modify a Static Row Filter](define-and-modify-a-static-row-filter.md) </span></span>  
 <span data-ttu-id="6ca6a-222">[Agrupar cambios en filas relacionadas con registros lógicos](../merge/group-changes-to-related-rows-with-logical-records.md) </span><span class="sxs-lookup"><span data-stu-id="6ca6a-222">[Group Changes to Related Rows with Logical Records](../merge/group-changes-to-related-rows-with-logical-records.md) </span></span>  
 <span data-ttu-id="6ca6a-223">[Optimizar el rendimiento de los filtros con parámetros con particiones calculadas previamente](../merge/parameterized-filters-optimize-for-precomputed-partitions.md) </span><span class="sxs-lookup"><span data-stu-id="6ca6a-223">[Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md) </span></span>  
 [<span data-ttu-id="6ca6a-224">Agrupar cambios en filas relacionadas con registros lógicos</span><span class="sxs-lookup"><span data-stu-id="6ca6a-224">Group Changes to Related Rows with Logical Records</span></span>](../merge/group-changes-to-related-rows-with-logical-records.md)  
  
  
