---
title: Aumentar el rendimiento de la replicación de mezcla | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], design and performance
- designing databases [SQL Server], replication performance
- Merge Agent, performance
- snapshots [SQL Server replication], performance considerations
- merge replication performance [SQL Server replication]
- subscriptions [SQL Server replication], performance considerations
- performance [SQL Server replication], merge replication
- agents [SQL Server replication], performance
ms.assetid: f929226f-b83d-4900-a07c-a62f64527c7f
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 41dc258e9b45e9839ad142e73cb145999d02986c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750778"
---
# <a name="enhance-merge-replication-performance"></a><span data-ttu-id="aed60-102">Aumentar el rendimiento de la replicación de mezcla</span><span class="sxs-lookup"><span data-stu-id="aed60-102">Enhance Merge Replication Performance</span></span>
  <span data-ttu-id="aed60-103">Tras considerar las sugerencias generales de rendimiento que se describen en [Aumentar el rendimiento general de la replicación](enhance-general-replication-performance.md), tenga en cuenta estas otras áreas específicas de la replicación de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-103">After considering the general performance tips described in [Enhancing General Replication Performance](enhance-general-replication-performance.md), consider these additional areas specific to merge replication.</span></span>  
  
## <a name="database-design"></a><span data-ttu-id="aed60-104">Diseño de la base de datos</span><span class="sxs-lookup"><span data-stu-id="aed60-104">Database Design</span></span>  
  
-   <span data-ttu-id="aed60-105">Indice las columnas utilizadas en filtros de fila y de combinación.</span><span class="sxs-lookup"><span data-stu-id="aed60-105">Index columns used in row filters and join filters.</span></span>  
  
     <span data-ttu-id="aed60-106">Cuando utilice un filtro de fila en un artículo publicado, cree un índice en cada una de las columnas utilizadas en la cláusula WHERE del filtro.</span><span class="sxs-lookup"><span data-stu-id="aed60-106">When you use a row filter on a published article, create an index on each of the columns that is used in the filter's WHERE clause.</span></span> <span data-ttu-id="aed60-107">Sin un índice, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tiene que leer todas las filas de la tabla para determinar si la fila debe incluirse en la partición.</span><span class="sxs-lookup"><span data-stu-id="aed60-107">Without an index, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has to read each row in the table to determine whether the row should be included in the partition.</span></span> <span data-ttu-id="aed60-108">Con los índices, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede encontrar rápidamente qué filas se deben incluir.</span><span class="sxs-lookup"><span data-stu-id="aed60-108">With an index, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can quickly locate which rows should be included.</span></span> <span data-ttu-id="aed60-109">El procesamiento es más rápido si la replicación puede resolver completamente la cláusula WHERE del filtro solamente a partir del índice.</span><span class="sxs-lookup"><span data-stu-id="aed60-109">The fastest processing takes place if replication can fully resolve the WHERE clause of the filter from the index alone.</span></span>  
  
     <span data-ttu-id="aed60-110">La indización de todas las columnas utilizadas en los filtros de combinación también es importante.</span><span class="sxs-lookup"><span data-stu-id="aed60-110">Indexing all the columns used in join filters is also important.</span></span> <span data-ttu-id="aed60-111">Cada vez que se ejecuta el Agente de mezcla, busca la tabla base para determinar qué filas de la tabla principal y qué filas de las tablas relacionadas están incluidas en la partición.</span><span class="sxs-lookup"><span data-stu-id="aed60-111">Each time the Merge Agent runs, it searches the base table to determine which rows in a parent table and which rows in related tables are included in a partition.</span></span> <span data-ttu-id="aed60-112">La creación de un índice en las columnas de combinación evita que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] lea todas las filas de la tabla cada vez que se ejecute el Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-112">Creating an index on the joined columns avoids having [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] read each row in the table every time the Merge Agent runs.</span></span>  
  
     <span data-ttu-id="aed60-113">Para obtener más información sobre el filtrado, consulte [Filtrar datos publicados para la replicación de mezcla](../merge/filter-published-data-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-113">For more information on filtering, see [Filter Published Data for Merge Replication](../merge/filter-published-data-for-merge-replication.md).</span></span>  
  
-   <span data-ttu-id="aed60-114">Considere la posibilidad de aplicar una normalización excesiva a las tablas que incluyan tipos de datos de objetos grandes (LOB).</span><span class="sxs-lookup"><span data-stu-id="aed60-114">Consider overnormalizing tables that include Large Object (LOB) data types.</span></span>  
  
     <span data-ttu-id="aed60-115">Cuando se produce la sincronización, el Agente de mezcla puede tener que leer y transferir todas las filas de datos de un publicador o un suscriptor.</span><span class="sxs-lookup"><span data-stu-id="aed60-115">When synchronization occurs, the Merge Agent might need to read and transfer the entire data row from a Publisher or Subscriber.</span></span> <span data-ttu-id="aed60-116">Si la fila contiene columnas que utilizan LOB, este proceso puede requerir una asignación de memoria adicional y causar un impacto negativo en el rendimiento aunque no se hayan actualizado estas columnas.</span><span class="sxs-lookup"><span data-stu-id="aed60-116">If the row contains columns that use LOBs, this process can require additional memory allocation and negatively impact performance even though these columns may not have been updated.</span></span> <span data-ttu-id="aed60-117">Para reducir la probabilidad de que se produzca este impacto en el rendimiento, considere colocar las columnas LOB en una tabla independiente con una relación de uno a uno al resto de datos de las filas.</span><span class="sxs-lookup"><span data-stu-id="aed60-117">To reduce the likelihood that this performance impact occurs, consider putting LOB columns in a separate table using a one-to-one relationship to the rest of the row data.</span></span> <span data-ttu-id="aed60-118">Los tipos de datos `text`, `ntext` y `image` han quedado desusados.</span><span class="sxs-lookup"><span data-stu-id="aed60-118">The data types `text`, `ntext`, and `image` are deprecated.</span></span> <span data-ttu-id="aed60-119">Si incluye LOB, se recomienda que utilice los tipos de datos `varchar(max)`, `nvarchar(max)` y `varbinary(max)`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="aed60-119">If you do include LOBs, we recommend that you use the data types `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, respectively.</span></span>  
  
## <a name="publication-design"></a><span data-ttu-id="aed60-120">Diseño de la publicación</span><span class="sxs-lookup"><span data-stu-id="aed60-120">Publication Design</span></span>  
  
-   <span data-ttu-id="aed60-121">Use un nivel de compatibilidad de la publicación de 90RTM ([!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o una versión posterior).</span><span class="sxs-lookup"><span data-stu-id="aed60-121">Use a publication compatibility level of 90RTM ([!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version).</span></span>  
  
     <span data-ttu-id="aed60-122">A menos que uno o varios suscriptores usen una versión diferente de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], especifique que la publicación admita únicamente [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o una versión posterior.</span><span class="sxs-lookup"><span data-stu-id="aed60-122">Unless one or more Subscribers use a different version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], specify that the publication must support only [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version.</span></span> <span data-ttu-id="aed60-123">Esto permite que la publicación aproveche las nuevas características y optimizaciones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="aed60-123">This allows the publication to take advantage of new features and performance optimizations.</span></span>  
  
-   <span data-ttu-id="aed60-124">Use la configuración correcta de retención de la publicación.</span><span class="sxs-lookup"><span data-stu-id="aed60-124">Use appropriate publication retention settings.</span></span>  
  
     <span data-ttu-id="aed60-125">El período de retención de la publicación, que es la cantidad máxima de tiempo que debe transcurrir antes de que una suscripción se deba sincronizar, determina el tiempo de almacenamiento del seguimiento de metadatos.</span><span class="sxs-lookup"><span data-stu-id="aed60-125">The publication retention period, which is the maximum amount of time before a subscription must be synchronized, determines how long tracking metadata is stored.</span></span> <span data-ttu-id="aed60-126">Un valor alto puede afectar el rendimiento de almacenamiento y procesamiento.</span><span class="sxs-lookup"><span data-stu-id="aed60-126">A high value can affect storage and processing performance.</span></span> <span data-ttu-id="aed60-127">Para obtener más información acerca de cómo configurar el período de retención de la publicación, vea [Subscription Expiration and Deactivation](../subscription-expiration-and-deactivation.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-127">For more information about setting the publication retention period, see [Subscription Expiration and Deactivation](../subscription-expiration-and-deactivation.md).</span></span>  
  
-   <span data-ttu-id="aed60-128">Utilice los artículos de solo descarga en las tablas que únicamente se cambian en el publicador.</span><span class="sxs-lookup"><span data-stu-id="aed60-128">Use download-only articles on those tables that are only changed at the Publisher.</span></span> <span data-ttu-id="aed60-129">Para más información, vea [Optimizar el rendimiento de la replicación de mezcla con artículos de solo descarga](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-129">For more information, see [Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span></span>  
  
### <a name="filter-design-and-use"></a><span data-ttu-id="aed60-130">Diseño y uso de filtros</span><span class="sxs-lookup"><span data-stu-id="aed60-130">Filter Design and Use</span></span>  
  
-   <span data-ttu-id="aed60-131">Limite la complejidad de las cláusulas de filtros de fila.</span><span class="sxs-lookup"><span data-stu-id="aed60-131">Limit the complexity of row filter clauses.</span></span>  
  
     <span data-ttu-id="aed60-132">Limitar la complejidad del criterio de filtro ayuda a mejorar el rendimiento cuando el Agente de mezcla calcula los cambios de filas que se van a enviar a los suscriptores.</span><span class="sxs-lookup"><span data-stu-id="aed60-132">Limiting the complexity of the filtering criteria helps improve performance when the Merge Agent is evaluating row changes to send to Subscribers.</span></span> <span data-ttu-id="aed60-133">Evite el uso de subselecciones dentro de las cláusulas de filtros de fila de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-133">Avoid using sub-selects within merge row filter clauses.</span></span> <span data-ttu-id="aed60-134">En su lugar, considere el uso de filtros de combinación, que normalmente son más eficaces cuando se utilizan para crear particiones de datos de una tabla en función de la cláusula de filtro de fila de otra tabla.</span><span class="sxs-lookup"><span data-stu-id="aed60-134">Instead, consider using join filters, which are generally more efficient when used to partition data in one table based on the row filter clause in another table.</span></span> <span data-ttu-id="aed60-135">Para obtener más información sobre el filtrado, consulte [Filtrar datos publicados para la replicación de mezcla](../merge/filter-published-data-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-135">For more information about filtering, see [Filter Published Data for Merge Replication](../merge/filter-published-data-for-merge-replication.md).</span></span>  
  
-   <span data-ttu-id="aed60-136">Utilice particiones precalculadas con filtros con parámetros (esta característica se usa de manera predeterminada).</span><span class="sxs-lookup"><span data-stu-id="aed60-136">Use precomputed partitions with parameterized filters (this feature is used by default).</span></span> <span data-ttu-id="aed60-137">Para obtener más información, vea [Optimización del rendimiento de los filtros con parámetros con particiones calculadas previamente](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-137">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>  
  
     <span data-ttu-id="aed60-138">Las particiones precalculadas imponen una serie de limitaciones en el comportamiento de los filtros.</span><span class="sxs-lookup"><span data-stu-id="aed60-138">Precomputed partitions impose a number of limits on filtering behavior.</span></span> <span data-ttu-id="aed60-139">Si la aplicación no puede respetar estas limitaciones, establezca la opción **keep_partition_changes** en **True**, y así obtendrá ventajas de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="aed60-139">If your application cannot adhere to these limitations, set the **keep_partition_changes** option to **True**, which provides a performance benefit.</span></span> <span data-ttu-id="aed60-140">Para obtener más información, consulte [Filtros de fila con parámetros](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-140">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
-   <span data-ttu-id="aed60-141">Utilice particiones que no se superpongan si los datos se filtran pero no se comparten entre usuarios.</span><span class="sxs-lookup"><span data-stu-id="aed60-141">Use nonoverlapping partitions if data is filtered but not shared among users.</span></span>  
  
     <span data-ttu-id="aed60-142">La replicación puede optimizar el rendimiento de los datos que no se comparten entre particiones o suscripciones.</span><span class="sxs-lookup"><span data-stu-id="aed60-142">Replication can optimize performance for data that is not shared between partitions or subscriptions.</span></span> <span data-ttu-id="aed60-143">Para obtener más información, consulte [Filtros de fila con parámetros](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-143">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
-   <span data-ttu-id="aed60-144">No cree jerarquías complejas de filtros de combinación.</span><span class="sxs-lookup"><span data-stu-id="aed60-144">Do not create complex join filter hierarchies.</span></span>  
  
     <span data-ttu-id="aed60-145">Los filtros de combinación con cinco tablas o más pueden producir un efecto significativo en el rendimiento durante el proceso de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-145">Join filters with five or more tables can significantly impact performance during merge processing.</span></span> <span data-ttu-id="aed60-146">Se recomienda que considere otras soluciones si va a generar filtros de combinación de cinco o más tablas:</span><span class="sxs-lookup"><span data-stu-id="aed60-146">We recommend that if you are generating join filters of five or more tables that you consider other solutions:</span></span>  
  
    -   <span data-ttu-id="aed60-147">Evite el filtro de tablas que básicamente son tablas de búsqueda, tablas pequeñas y tablas que no están sujetas a cambios.</span><span class="sxs-lookup"><span data-stu-id="aed60-147">Avoid filtering tables that are primarily lookup tables, smaller tables, and tables that are not subject to change.</span></span> <span data-ttu-id="aed60-148">Haga que estas tablas formen parte de la publicación en su totalidad.</span><span class="sxs-lookup"><span data-stu-id="aed60-148">Make those tables part of the publication in their entirety.</span></span> <span data-ttu-id="aed60-149">Se recomienda que utilice los filtros de combinación solamente entre tablas que se deben partir entre suscriptores.</span><span class="sxs-lookup"><span data-stu-id="aed60-149">We recommend that you use join filters only between tables that must be partitioned among Subscribers.</span></span> <span data-ttu-id="aed60-150">Para obtener más información, consulte [Join Filters](../merge/join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-150">For more information, see [Join Filters](../merge/join-filters.md).</span></span>  
  
    -   <span data-ttu-id="aed60-151">Considere la posibilidad de eliminar la normalización del diseño de la base de datos o la utilización de una tabla de asignaciones si hay un gran número de tablas en una combinación.</span><span class="sxs-lookup"><span data-stu-id="aed60-151">Consider denormalizing the database design or using a mapping table if there are a large number of tables in a join.</span></span> <span data-ttu-id="aed60-152">Por ejemplo, si un vendedor solamente necesita los datos de sus clientes, pero se requieren seis combinaciones para asociar un cliente con un vendedor, considere la posibilidad de agregar una columna a la tabla de clientes que identifique al vendedor.</span><span class="sxs-lookup"><span data-stu-id="aed60-152">For example, if a sales person needs only the data for her customers, but it requires six joins to associate a customer with a sales person, consider adding a column to the customer table that identifies the sales person.</span></span> <span data-ttu-id="aed60-153">Los datos del vendedor son redundantes, pero los costos de eliminar la normalización de las tablas pueden ser en cierto modo compensados por los beneficios en el rendimiento de la partición de replicación.</span><span class="sxs-lookup"><span data-stu-id="aed60-153">The sales person data is redundant, but the costs of denormalizing the tables somewhat might be outweighed by the performance benefits for replication partitioning.</span></span>  
  
    -   <span data-ttu-id="aed60-154">Para aumentar el rendimiento de las particiones precalculadas cuando los lotes incluyen numerosos cambios de datos, diseñe su aplicación con cuidado.</span><span class="sxs-lookup"><span data-stu-id="aed60-154">To improve the performance of precomputed partitions when batches contain lots of data changes, design your application with care.</span></span> <span data-ttu-id="aed60-155">Asegúrese de que los cambios en los datos de la tabla primaria de un filtro de combinación se realicen antes que los cambios correspondientes de las tablas secundarias.</span><span class="sxs-lookup"><span data-stu-id="aed60-155">Make sure that changes to data in the parent table in a join filter are made before corresponding changes in the child tables.</span></span>  
  
-   <span data-ttu-id="aed60-156">Establezca la opción **join_unique_key** en **1** si lo permite la lógica.</span><span class="sxs-lookup"><span data-stu-id="aed60-156">Set the **join_unique_key** option to **1** if logic allows.</span></span>  
  
     <span data-ttu-id="aed60-157">Al establecer este parámetro en **1** , se indica que la relación entre la tabla principal y la secundaria de un filtro de combinación es de uno a uno o de uno a varios.</span><span class="sxs-lookup"><span data-stu-id="aed60-157">Setting this parameter to **1** indicates that the relationship between the child and parent tables in a join filter is one to one or one to many.</span></span> <span data-ttu-id="aed60-158">Configure este parámetro en **1** únicamente si tiene una restricción en la columna de combinación de la tabla secundaria que garantiza la exclusividad.</span><span class="sxs-lookup"><span data-stu-id="aed60-158">Only set this parameter to **1** if you have a constraint on the joining column in the child table that guarantees uniqueness.</span></span> <span data-ttu-id="aed60-159">Si el parámetro se establece en **1** de forma incorrecta, se podría producir la no convergencia de los datos.</span><span class="sxs-lookup"><span data-stu-id="aed60-159">If the parameter is set to **1** incorrectly, non-convergence of data can occur.</span></span> <span data-ttu-id="aed60-160">Para obtener más información, consulte [Join Filters](../merge/join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-160">For more information, see [Join Filters](../merge/join-filters.md).</span></span>  
  
-   <span data-ttu-id="aed60-161">Evite la ejecución de lotes con muchos cambios cuando use particiones precalculadas.</span><span class="sxs-lookup"><span data-stu-id="aed60-161">Avoid executing batches with lots of changes when you use precomputed partitions.</span></span>  
  
     <span data-ttu-id="aed60-162">Cuando el Agente de mezcla se ejecute tras la ejecución de un lote que contenga numerosos cambios de datos, el agente intentará dividir este lote de gran tamaño en lotes más pequeños.</span><span class="sxs-lookup"><span data-stu-id="aed60-162">When the Merge Agent is run after you run a batch that contains lots of data changes, the agent tries to divide the large batch into smaller batches.</span></span> <span data-ttu-id="aed60-163">Durante este tiempo, pueden bloquearse otros procesos del Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-163">During this time, other Merge Agent processes may be blocked.</span></span> <span data-ttu-id="aed60-164">Considere la posibilidad de reducir el número de cambios de un lote y ejecutar el Agente de mezcla entre los distintos lotes.</span><span class="sxs-lookup"><span data-stu-id="aed60-164">Consider reducing the number of changes in a batch and run the Merge Agent between batches.</span></span> <span data-ttu-id="aed60-165">Si esto último no es posible, aumente el valor de **generation_leveling_threshold** para la publicación.</span><span class="sxs-lookup"><span data-stu-id="aed60-165">If this cannot be done, increase the value of **generation_leveling_threshold** for the publication.</span></span>  
  
## <a name="subscription-considerations"></a><span data-ttu-id="aed60-166">Consideraciones acerca de las suscripciones</span><span class="sxs-lookup"><span data-stu-id="aed60-166">Subscription Considerations</span></span>  
  
-   <span data-ttu-id="aed60-167">Establezca programaciones para sincronizar las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="aed60-167">Stagger subscription synchronization schedules.</span></span>  
  
     <span data-ttu-id="aed60-168">Si un gran número de suscriptores se sincronizan con un publicador, considere la posibilidad de escalonar las programaciones con el fin de que el Agente de mezcla se ejecute en distintos momentos.</span><span class="sxs-lookup"><span data-stu-id="aed60-168">If a large number of Subscribers synchronize with a Publisher, consider staggering the schedules so that Merge Agents run at different times.</span></span> <span data-ttu-id="aed60-169">Para obtener más información, consulte [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-169">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span>  
  
## <a name="merge-agent-parameters"></a><span data-ttu-id="aed60-170">Parámetros del Agente de mezcla</span><span class="sxs-lookup"><span data-stu-id="aed60-170">Merge Agent Parameters</span></span>  
 <span data-ttu-id="aed60-171">Para obtener información sobre el Agente de mezcla y sus parámetros, vea [Replication Merge Agent](../agents/replication-merge-agent.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-171">For information about the Merge Agent and its parameters, see [Replication Merge Agent](../agents/replication-merge-agent.md).</span></span>  
  
-   <span data-ttu-id="aed60-172">Actualice todos los suscriptores de suscripciones de extracción a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o una versión posterior.</span><span class="sxs-lookup"><span data-stu-id="aed60-172">Upgrade all Subscribers for pull subscriptions to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version.</span></span>  
  
     <span data-ttu-id="aed60-173">Al actualizar el suscriptor a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o una versión posterior se actualiza el Agente de mezcla que usan las suscripciones en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="aed60-173">Upgrading the Subscriber to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version upgrades the Merge Agent used by the subscriptions at that Subscriber.</span></span> <span data-ttu-id="aed60-174">Para aprovechar muchas de las nuevas características y optimizaciones de rendimiento, se requiere el Agente de mezcla de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o una versión posterior.</span><span class="sxs-lookup"><span data-stu-id="aed60-174">To take advantage of many of the new features and performance optimizations, the Merge Agent from [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version is required.</span></span>  
  
-   <span data-ttu-id="aed60-175">Si una suscripción se sincroniza mediante una conexión rápida y los cambios se envían desde el publicador y el suscriptor, use el parámetro **-ParallelUploadDownload** en el Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-175">If a subscription is synchronized over a fast connection and changes are sent from the Publisher and Subscriber, use the **-ParallelUploadDownload** parameter for the Merge Agent.</span></span>  
  
     <span data-ttu-id="aed60-176">En [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] se introdujo un nuevo parámetro del Agente de mezcla: **-ParallelUploadDownload**.</span><span class="sxs-lookup"><span data-stu-id="aed60-176">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduced a new Merge Agent parameter: **-ParallelUploadDownload**.</span></span> <span data-ttu-id="aed60-177">Establecer este parámetro permite al Agente de mezcla procesar en paralelo los cambios cargados en el publicador y los descargados en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="aed60-177">Setting this parameter allows the Merge Agent to process in parallel the changes uploaded to the Publisher and those downloaded to the Subscriber.</span></span> <span data-ttu-id="aed60-178">Esto resulta útil en entornos de grandes volúmenes con gran ancho de banda de red.</span><span class="sxs-lookup"><span data-stu-id="aed60-178">This is useful in high volume environments with high network bandwidth.</span></span> <span data-ttu-id="aed60-179">Los parámetros del agente se pueden especificar en los perfiles del agente y en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="aed60-179">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="aed60-180">Para más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="aed60-180">For more information, see:</span></span>  
  
    -   [<span data-ttu-id="aed60-181">Trabajar con perfiles del Agente de replicación</span><span class="sxs-lookup"><span data-stu-id="aed60-181">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
    -   [<span data-ttu-id="aed60-182">Ver y modificar parámetros del símbolo del sistema de los agentes de replicación &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="aed60-182">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
    -   [<span data-ttu-id="aed60-183">Conceptos de los ejecutables del Agente de replicación</span><span class="sxs-lookup"><span data-stu-id="aed60-183">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
-   <span data-ttu-id="aed60-184">Considere aumentar el valor del parámetro **-MakeGenerationInterval** , especialmente si la sincronización implica más cargas de suscriptores que descargas a suscriptores.</span><span class="sxs-lookup"><span data-stu-id="aed60-184">Consider increasing the value of the **-MakeGenerationInterval** parameter, especially if synchronization involves more uploads from Subscribers than downloads to Subscribers.</span></span>  
  
-   <span data-ttu-id="aed60-185">Cuando se sincronizan filas de datos con una gran cantidad de datos, como las filas que contienen columnas LOB, la sincronización web puede requerir la asignación de memoria adicional y afectar al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="aed60-185">When you synchronize data rows with a large amount of data, such as rows with LOB columns, Web synchronization can require additional memory allocation and hurt performance.</span></span> <span data-ttu-id="aed60-186">Esto sucede cuando el Agente de mezcla genera un mensaje XML que contiene demasiadas filas de datos con grandes cantidades de datos.</span><span class="sxs-lookup"><span data-stu-id="aed60-186">This occurs when the Merge Agent generates an XML message that contains too many data rows with large amounts of data.</span></span> <span data-ttu-id="aed60-187">Si el Agente de mezcla consume demasiados recursos durante la sincronización web, se recomienda reducir el número de filas que se envían en un mismo mensaje mediante alguno de los siguientes procedimientos:</span><span class="sxs-lookup"><span data-stu-id="aed60-187">If the Merge Agent is consuming too many resources during Web synchronization, reduce the number of rows sent in a single message in one of the following ways:</span></span>  
  
    -   <span data-ttu-id="aed60-188">Usar el perfil de agente de conexión lenta para el Agente de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-188">Use the slow link agent profile for the Merge Agent.</span></span> <span data-ttu-id="aed60-189">Para obtener más información, consulte [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-189">For more information, see [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span></span>  
  
    -   <span data-ttu-id="aed60-190">Reduzca los parámetros **-DownloadGenerationsPerBatch** y **-UploadGenerationsPerBatch** del Agente de mezcla a un valor de 10 o menos.</span><span class="sxs-lookup"><span data-stu-id="aed60-190">Decrease the **-DownloadGenerationsPerBatch** and **-UploadGenerationsPerBatch** parameters for the Merge Agent to a value of 10 or less.</span></span> <span data-ttu-id="aed60-191">El valor predeterminado de esos parámetros es 50.</span><span class="sxs-lookup"><span data-stu-id="aed60-191">The default value of these parameters is 50.</span></span>  
  
## <a name="snapshot-considerations"></a><span data-ttu-id="aed60-192">Consideraciones acerca de las instantáneas</span><span class="sxs-lookup"><span data-stu-id="aed60-192">Snapshot Considerations</span></span>  
  
-   <span data-ttu-id="aed60-193">Cree una columna ROWGUIDCOL en tablas grandes antes de generar la instantánea inicial.</span><span class="sxs-lookup"><span data-stu-id="aed60-193">Create a ROWGUIDCOL column on large tables prior to generating the initial snapshot.</span></span>  
  
     <span data-ttu-id="aed60-194">La replicación de mezcla requiere que todas las tablas publicadas tengan una columna ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="aed60-194">Merge replication requires that each published table have a ROWGUIDCOL column.</span></span> <span data-ttu-id="aed60-195">Si no existe una columna ROWGUIDCOL en la tabla antes de que el Agente de instantáneas cree los archivos de instantánea iniciales, el agente debe agregar y llenar primero la columna ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="aed60-195">If a ROWGUIDCOL column does not exist in the table before the Snapshot Agent creates the initial snapshot files, the agent must first add and populate the ROWGUIDCOL column.</span></span> <span data-ttu-id="aed60-196">Para mejorar el rendimiento cuando se generan instantáneas durante la replicación de mezcla, puede crear una columna ROWGUIDCOL en cada una de las tablas antes de publicar.</span><span class="sxs-lookup"><span data-stu-id="aed60-196">To gain a performance advantage when generating snapshots during merge replication, create the ROWGUIDCOL column on each table before publishing.</span></span> <span data-ttu-id="aed60-197">La columna puede tener cualquier nombre (de forma predeterminada, el Agente de instantáneas utiliza**rowguid** ), pero debe tener las siguientes características de tipo de datos:</span><span class="sxs-lookup"><span data-stu-id="aed60-197">The column can have any name (**rowguid** is used by the Snapshot Agent by default), but must have the following data type characteristics:</span></span>  
  
    -   <span data-ttu-id="aed60-198">Un tipo de datos de UNIQUEIDENTIFIER.</span><span class="sxs-lookup"><span data-stu-id="aed60-198">A data type of UNIQUEIDENTIFIER.</span></span>  
  
    -   <span data-ttu-id="aed60-199">Un valor predeterminado de NEWSEQUENTIALID() o NEWID().</span><span class="sxs-lookup"><span data-stu-id="aed60-199">A default of NEWSEQUENTIALID() or NEWID().</span></span> <span data-ttu-id="aed60-200">Se recomienda NEWSEQUENTIALID() porque puede proporcionar un mayor rendimiento al efectuar cambios y realizar un seguimiento de los mismos.</span><span class="sxs-lookup"><span data-stu-id="aed60-200">NEWSEQUENTIALID() is recommended because it can provide increased performance when making and tracking changes.</span></span>  
  
    -   <span data-ttu-id="aed60-201">El conjunto de propiedades ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="aed60-201">The ROWGUIDCOL property set.</span></span>  
  
    -   <span data-ttu-id="aed60-202">Un índice único en la columna.</span><span class="sxs-lookup"><span data-stu-id="aed60-202">A unique index on the column.</span></span>  
  
-   <span data-ttu-id="aed60-203">Genere instantáneas previamente y/o permita a los suscriptores que soliciten la generación y aplicación de instantáneas la primera vez que se sincronizan.</span><span class="sxs-lookup"><span data-stu-id="aed60-203">Pre-generate snapshots and/or allow Subscribers to request snapshot generation and application the first time they synchronize.</span></span>  
  
     <span data-ttu-id="aed60-204">Utilice una de estas opciones o las dos para proporcionar instantáneas para publicaciones que utilicen filtros con parámetros.</span><span class="sxs-lookup"><span data-stu-id="aed60-204">Use one or both of these options to provide snapshots for publications that use parameterized filters.</span></span> <span data-ttu-id="aed60-205">Si no especifica una de estas opciones, las suscripciones se inicializan utilizando una serie de instrucciones SELECT e INSERT, en lugar de la utilidad **bcp** ; este proceso es mucho más lento.</span><span class="sxs-lookup"><span data-stu-id="aed60-205">If you do not specify one of these options, subscriptions are initialized using a series of SELECT and INSERT statements, rather than using the **bcp** utility; this process is much slower.</span></span> <span data-ttu-id="aed60-206">Para más información, consulte [Instantáneas para publicaciones de combinación con filtros con parámetros](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-206">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
## <a name="maintenance-and-monitoring-considerations"></a><span data-ttu-id="aed60-207">Consideraciones acerca del mantenimiento y la supervisión</span><span class="sxs-lookup"><span data-stu-id="aed60-207">Maintenance and Monitoring Considerations</span></span>  
  
-   <span data-ttu-id="aed60-208">De vez en cuando, vuelva a crear los índices de tablas del sistema de la replicación de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-208">Occasionally re-index merge replication system tables.</span></span>  
  
     <span data-ttu-id="aed60-209">Como parte del mantenimiento de la replicación de mezcla, compruebe ocasionalmente el crecimiento de las tablas del sistema asociadas con la replicación de mezcla: **MSmerge_contents**, **MSmerge_genhistory**, **MSmerge_tombstone**, **MSmerge_current_partition_mappings**y **MSmerge_past_partition_mappings**.</span><span class="sxs-lookup"><span data-stu-id="aed60-209">As part of maintenance for merge replication, occasionally check the growth of the system tables associated with merge replication: **MSmerge_contents**, **MSmerge_genhistory**, and **MSmerge_tombstone**, **MSmerge_current_partition_mappings**, and **MSmerge_past_partition_mappings**.</span></span> <span data-ttu-id="aed60-210">Vuelva a indizar estas tablas periódicamente.</span><span class="sxs-lookup"><span data-stu-id="aed60-210">Periodically re-index these tables.</span></span> <span data-ttu-id="aed60-211">Para obtener más información, vea [Reorganizar y volver a generar índices](../../indexes/reorganize-and-rebuild-indexes.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-211">For more information, see [Reorganize and Rebuild Indexes](../../indexes/reorganize-and-rebuild-indexes.md).</span></span>  
  
-   <span data-ttu-id="aed60-212">Supervise el rendimiento de la sincronización utilizando la pestaña **Historial de sincronizaciones** del Monitor de replicación.</span><span class="sxs-lookup"><span data-stu-id="aed60-212">Monitor synchronization performance using the **Synchronization History** tab in Replication Monitor.</span></span>  
  
     <span data-ttu-id="aed60-213">En la replicación de mezcla, el Monitor de replicación muestra en la pestaña **Historial de sincronizaciones** estadísticas detalladas de cada artículo que se procesa durante la sincronización, incluida la cantidad de tiempo de cada fase del proceso (carga de cambios, descarga de cambios, etc.).</span><span class="sxs-lookup"><span data-stu-id="aed60-213">For merge replication, Replication Monitor displays detailed statistics in the **Synchronization History** tab for each article processed during synchronization, including the amount of time spent in each processing phase (uploading changes, downloading changes, and so on).</span></span> <span data-ttu-id="aed60-214">Esto puede ayudar a identificar las tablas específicas que están causando una reducción de la velocidad y es el mejor lugar para solucionar problemas de rendimiento con las suscripciones de mezcla.</span><span class="sxs-lookup"><span data-stu-id="aed60-214">It can help pinpoint specific tables that are causing slow downs and is the best place to troubleshoot performance issues with merge subscriptions.</span></span> <span data-ttu-id="aed60-215">Para más información sobre cómo ver estadísticas detalladas, vea [Visualización de información y realización de tareas mediante el Monitor de replicación](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="aed60-215">For more information on viewing detailed statistics, see [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
  
