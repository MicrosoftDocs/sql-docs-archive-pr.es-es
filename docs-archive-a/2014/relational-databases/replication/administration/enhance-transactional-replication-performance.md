---
title: Aumentar el rendimiento de la replicación transaccional | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], design and performance
- performance [SQL Server replication], transactional replication
- designing databases [SQL Server], replication performance
- performance [SQL Server replication], snapshot replication
- snapshot replication [SQL Server], performance
- subscriptions [SQL Server replication], performance considerations
- agents [SQL Server replication], performance
- Distribution Agent, performance
- transactional replication, performance
- Log Reader Agent, performance
ms.assetid: 67084a67-43ff-4065-987a-3b16d1841565
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: fe802796b129ff9bdb50e5dea13e1fe98beee269
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750770"
---
# <a name="enhance-transactional-replication-performance"></a><span data-ttu-id="39812-102">Aumentar el rendimiento de la replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="39812-102">Enhance Transactional Replication Performance</span></span>
  <span data-ttu-id="39812-103">Una vez que haya considerado las sugerencias generales sobre el rendimiento que se describen en [Aumentar el rendimiento general de la replicación](enhance-general-replication-performance.md), tenga en cuenta estas áreas adicionales específicas de la replicación transaccional.</span><span class="sxs-lookup"><span data-stu-id="39812-103">After considering the general performance tips described in [Enhancing General Replication Performance](enhance-general-replication-performance.md), consider these additional areas specific to transactional replication.</span></span>  
  
## <a name="database-design"></a><span data-ttu-id="39812-104">Diseño de la base de datos</span><span class="sxs-lookup"><span data-stu-id="39812-104">Database Design</span></span>  
  
-   <span data-ttu-id="39812-105">Minimice el tamaño de la transacción en el diseño de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="39812-105">Minimize transaction size in your application design.</span></span>  
  
     <span data-ttu-id="39812-106">De manera predeterminada, la replicación transaccional propaga los cambios en función de los límites de las transacciones.</span><span class="sxs-lookup"><span data-stu-id="39812-106">By default, transactional replication propagates changes according to transaction boundaries.</span></span> <span data-ttu-id="39812-107">Si las transacciones son más pequeñas, es menos probable que el Agente de distribución tenga que volver a enviar una transacción debido a problemas de red.</span><span class="sxs-lookup"><span data-stu-id="39812-107">If transactions are smaller, it is less likely that the Distribution Agent will have to resend a transaction due to network issues.</span></span> <span data-ttu-id="39812-108">Si el agente tiene que volver a enviar una transacción, la cantidad de datos que se enviarán será menor.</span><span class="sxs-lookup"><span data-stu-id="39812-108">If the agent is required to resend a transaction, the amount of data sent is smaller.</span></span>  
  
## <a name="distributor-configuration"></a><span data-ttu-id="39812-109">Configuración del distribuidor</span><span class="sxs-lookup"><span data-stu-id="39812-109">Distributor Configuration</span></span>  
  
-   <span data-ttu-id="39812-110">Configure el distribuidor en un servidor dedicado.</span><span class="sxs-lookup"><span data-stu-id="39812-110">Configure the Distributor on a dedicated server.</span></span>  
  
     <span data-ttu-id="39812-111">Puede reducir la carga de procesamiento en el publicador configurando un distribuidor remoto.</span><span class="sxs-lookup"><span data-stu-id="39812-111">You can reduce processing overhead on the Publisher by configuring a remote Distributor.</span></span> <span data-ttu-id="39812-112">Para más información, consulte [Configure Distribution](../configure-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="39812-112">For more information, see [Configure Distribution](../configure-distribution.md).</span></span>  
  
-   <span data-ttu-id="39812-113">Ajustar la base de datos de distribución a un tamaño apropiado.</span><span class="sxs-lookup"><span data-stu-id="39812-113">Size the distribution database appropriately.</span></span>  
  
     <span data-ttu-id="39812-114">Pruebe la replicación con una carga típica para el sistema con el fin de determinar cuánto espacio se necesita para almacenar comandos.</span><span class="sxs-lookup"><span data-stu-id="39812-114">Test replication with a typical load for your system to determine how much space is required to store commands.</span></span> <span data-ttu-id="39812-115">Asegúrese de que la base de datos es lo suficientemente grande para almacenar comandos sin recurrir al crecimiento automático con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="39812-115">Ensure the database is large enough to store commands without having to auto-grow frequently.</span></span> <span data-ttu-id="39812-116">Para más información sobre cómo cambiar el tamaño de una base de datos, vea [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="39812-116">For more information about changing the size of a database, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
## <a name="publication-design"></a><span data-ttu-id="39812-117">Diseño de la publicación</span><span class="sxs-lookup"><span data-stu-id="39812-117">Publication Design</span></span>  
  
-   <span data-ttu-id="39812-118">Replique la ejecución de los procedimientos almacenados al realizar actualizaciones por lotes en las tablas publicadas.</span><span class="sxs-lookup"><span data-stu-id="39812-118">Replicate stored procedure execution when making batch updates to published tables.</span></span>  
  
     <span data-ttu-id="39812-119">Si tiene actualizaciones por lotes que afectan ocasionalmente a un gran número de filas en el suscriptor, considere la posibilidad de actualizar la tabla publicada mediante un procedimiento almacenado y publique la ejecución del procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="39812-119">If you have batch updates that occasionally affect a large number of rows at the Subscriber, you should consider updating the published table using a stored procedure and publish the execution of the stored procedure.</span></span> <span data-ttu-id="39812-120">En vez de enviar una actualización o eliminación para cada fila afectada, el Agente de distribución ejecutará el mismo procedimiento en el suscriptor con los mismos valores de parámetros.</span><span class="sxs-lookup"><span data-stu-id="39812-120">Instead of sending an update or delete for every row affected, the Distribution Agent executes the same procedure at the Subscriber with the same parameter values.</span></span> <span data-ttu-id="39812-121">Para más información, vea [Publishing Stored Procedure Execution in Transactional Replication](../transactional/publishing-stored-procedure-execution-in-transactional-replication.md).</span><span class="sxs-lookup"><span data-stu-id="39812-121">For more information, see [Publishing Stored Procedure Execution in Transactional Replication](../transactional/publishing-stored-procedure-execution-in-transactional-replication.md).</span></span>  
  
-   <span data-ttu-id="39812-122">Reparta los artículos entre varias publicaciones.</span><span class="sxs-lookup"><span data-stu-id="39812-122">Spread articles across multiple publications.</span></span>  
  
     <span data-ttu-id="39812-123">Si no puede utilizar el parámetro **-SubscriptionStreams** que se describe más adelante en este tema, considere la posibilidad de crear varias publicaciones.</span><span class="sxs-lookup"><span data-stu-id="39812-123">If you cannot use the **-SubscriptionStreams** parameter (described later in this topic), consider creating multiple publications.</span></span> <span data-ttu-id="39812-124">Repartir artículos entre dichas publicaciones permite que la replicación aplique en paralelo los cambios a los suscriptores.</span><span class="sxs-lookup"><span data-stu-id="39812-124">Spreading articles across these publications allows replication to apply changes in parallel to Subscribers.</span></span>  
  
## <a name="subscription-considerations"></a><span data-ttu-id="39812-125">Consideraciones acerca de las suscripciones</span><span class="sxs-lookup"><span data-stu-id="39812-125">Subscription Considerations</span></span>  
  
-   <span data-ttu-id="39812-126">Utilice agentes independientes en lugar de agentes compartidos si tiene varias publicaciones en el mismo publicador (este es el valor predeterminado del Asistente para nueva publicación).</span><span class="sxs-lookup"><span data-stu-id="39812-126">Use independent agents rather than shared agents if you have multiple publications on the same Publisher (this is the default for the New Publication Wizard).</span></span>  
  
-   <span data-ttu-id="39812-127">Ejecute los agentes continuamente en lugar de utilizar programaciones muy frecuentes.</span><span class="sxs-lookup"><span data-stu-id="39812-127">Run agents continuously instead of on very frequent schedules.</span></span>  
  
     <span data-ttu-id="39812-128">Configurar los agentes para que se ejecuten continuamente en vez de crear programaciones frecuentes (por ejemplo, cada minuto) mejora el rendimiento de la replicación, ya que el agente no tiene que iniciarse y detenerse.</span><span class="sxs-lookup"><span data-stu-id="39812-128">Setting the agents to run continuously rather than creating frequent schedules (such as every minute) improves replication performance, because the agent does not have to start and stop.</span></span> <span data-ttu-id="39812-129">Si configura el Agente de distribución para que se ejecute continuamente, los cambios se propagan con latencia baja a los demás servidores conectados en la topología.</span><span class="sxs-lookup"><span data-stu-id="39812-129">When you set the Distribution Agent to run continuously, changes are propagated with low latency to the other servers that are connected in the topology.</span></span> <span data-ttu-id="39812-130">Para más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="39812-130">For more information, see:</span></span>  
  
    -   [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]<span data-ttu-id="39812-131">: [Especificar programaciones de sincronización](../specify-synchronization-schedules.md)</span><span class="sxs-lookup"><span data-stu-id="39812-131">: [Specify Synchronization Schedules](../specify-synchronization-schedules.md)</span></span>  
  
## <a name="distribution-agent-and-log-reader-agent-parameters"></a><span data-ttu-id="39812-132">Parámetros del Agente de distribución y del Agente de registro del LOG</span><span class="sxs-lookup"><span data-stu-id="39812-132">Distribution Agent and Log Reader Agent Parameters</span></span>  
  
-   <span data-ttu-id="39812-133">Para resolver cuellos de botella accidentales de una vez, use el parámetro **-MaxCmdsInTran** para el agente de registro del log.</span><span class="sxs-lookup"><span data-stu-id="39812-133">To resolve accidental, one-time bottlenecks use the **-MaxCmdsInTran** parameter for the Log Reader Agent.</span></span>  
  
     <span data-ttu-id="39812-134">El parámetro **-MaxCmdsInTran** especifica el número máximo de instrucciones agrupadas en una transacción cuando el lector del registro escribe comandos en la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="39812-134">The **-MaxCmdsInTran** parameter specifies the maximum number of statements grouped into a transaction as the Log Reader writes commands to the distribution database.</span></span> <span data-ttu-id="39812-135">El uso de este parámetro permite al Agente de registro del LOG y al Agente de distribución dividir las transacciones grandes (compuestas por muchos comandos) del publicador en varias transacciones más pequeñas cuando se aplican comandos en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="39812-135">Using this parameter allows the Log Reader Agent and Distribution Agent to divide large transactions (consisting of many commands) at the Publisher into several smaller transactions when applying commands at the Subscriber.</span></span> <span data-ttu-id="39812-136">Especificando este parámetro se puede reducir la contención en el distribuidor y la latencia entre el publicador y el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="39812-136">Specifying this parameter can reduce contention at the Distributor and reduce latency between the Publisher and Subscriber.</span></span> <span data-ttu-id="39812-137">Puesto que la transacción original se aplica en unidades más pequeñas, el suscriptor puede obtener acceso a las filas de una transacción lógica del publicador de gran tamaño antes de que finalice la transacción original, lo que interrumpe la estricta atomicidad transaccional.</span><span class="sxs-lookup"><span data-stu-id="39812-137">Because the original transaction is applied in smaller units, the Subscriber can access rows of a large logical Publisher transaction prior to the end of the original transaction, breaking strict transactional atomicity.</span></span> <span data-ttu-id="39812-138">El valor predeterminado es **0**, que conserva los límites de la transacción del publicador.</span><span class="sxs-lookup"><span data-stu-id="39812-138">The default is **0**, which preserves the transaction boundaries of the Publisher.</span></span> <span data-ttu-id="39812-139">Este parámetro no se aplica a los publicadores de Oracle.</span><span class="sxs-lookup"><span data-stu-id="39812-139">This parameter does not apply to Oracle Publishers.</span></span>  
  
    > [!WARNING]  
    >  <span data-ttu-id="39812-140">`MaxCmdsInTran` no se ha diseñado para estar siempre activado.</span><span class="sxs-lookup"><span data-stu-id="39812-140">`MaxCmdsInTran` was not designed to be always turned on.</span></span> <span data-ttu-id="39812-141">Su función es evitar los casos en los que alguien ha realizado accidentalmente un gran número de operaciones DML en una sola transacción (lo que produce un retraso en la distribución de comandos hasta que toda la transacción está en la base de datos de distribución, se establecen los bloqueos, etc.).</span><span class="sxs-lookup"><span data-stu-id="39812-141">It exists to work around cases where someone accidentally performed a large number of DML operations in a single transaction (causing delay in distribution of commands until the entire transaction is in distribution database, locks being held, etc.).</span></span> <span data-ttu-id="39812-142">Si se encuentra habitualmente esta situación, debe revisar las aplicaciones y buscar formas de reducir el tamaño de las transacciones.</span><span class="sxs-lookup"><span data-stu-id="39812-142">If you routinely fall into this situation, you should review your applications and find ways to reduce the transaction size.</span></span>  
  
-   <span data-ttu-id="39812-143">Use el parámetro **-SubscriptionStreams** para el agente de distribución.</span><span class="sxs-lookup"><span data-stu-id="39812-143">Use the **-SubscriptionStreams** parameter for the Distribution Agent.</span></span>  
  
     <span data-ttu-id="39812-144">El parámetro-SubscriptionStreams puede mejorar considerablemente el rendimiento **de la** replicación agregada.</span><span class="sxs-lookup"><span data-stu-id="39812-144">The **-SubscriptionStreams** parameter can greatly improve aggregate replication throughput.</span></span> <span data-ttu-id="39812-145">Permite establecer varias conexiones con un suscriptor para aplicar lotes de cambios en paralelo, al tiempo que mantiene muchas de las características transaccionales presentes cuando se usa un solo subproceso.</span><span class="sxs-lookup"><span data-stu-id="39812-145">It allows multiple connections to a Subscriber to apply batches of changes in parallel, while maintaining many of the transactional characteristics present when using a single thread.</span></span> <span data-ttu-id="39812-146">Si una de las conexiones no se puede ejecutar o confirmar, todas las conexiones anularán el lote actual y el agente utilizará un solo flujo para volver a intentar los lotes con errores.</span><span class="sxs-lookup"><span data-stu-id="39812-146">If one of the connections fails to execute or commit, all connections will abort the current batch, and the agent will use a single stream to retry the failed batches.</span></span> <span data-ttu-id="39812-147">Antes de que finalice esta fase de reintento, pueden aparecer incoherencias transaccionales temporales en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="39812-147">Before this retry phase completes, there can be temporary transactional inconsistencies at the Subscriber.</span></span> <span data-ttu-id="39812-148">Una vez que se han confirmado correctamente los lotes con errores, el suscriptor vuelve al estado de coherencia transaccional.</span><span class="sxs-lookup"><span data-stu-id="39812-148">After the failed batches are successfully committed, the Subscriber is brought back to a state of transactional consistency.</span></span>  
  
     <span data-ttu-id="39812-149">Se puede especificar un valor para este parámetro de agente mediante el \*\* \@ subscriptionstreams\*\* de [Sp_addsubscription &#40;&#41;de Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="39812-149">A value for this agent parameter can be specified using the **\@subscriptionstreams** of [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span>  
  
-   <span data-ttu-id="39812-150">Aumente el valor del parámetro **-ReadBatchSize** del Agente de registro del LOG.</span><span class="sxs-lookup"><span data-stu-id="39812-150">Increase the value of the **-ReadBatchSize** parameter for the Log Reader Agent.</span></span>  
  
     <span data-ttu-id="39812-151">El Agente de registro del LOG y el Agente de distribución aceptan tamaños de lotes en las operaciones de lectura y confirmación de transacciones.</span><span class="sxs-lookup"><span data-stu-id="39812-151">The Log Reader Agent and Distribution Agent support batch sizes for transaction read and commit operations.</span></span> <span data-ttu-id="39812-152">Los lotes contienen, de forma predeterminada, 500 transacciones.</span><span class="sxs-lookup"><span data-stu-id="39812-152">Batch sizes default to 500 transactions.</span></span> <span data-ttu-id="39812-153">El Agente de lectura del LOG lee el número de transacciones especificado en el registro, estén o no marcadas para la replicación.</span><span class="sxs-lookup"><span data-stu-id="39812-153">The Log Reader Agent reads the specific number of transactions from the log, whether or not they are marked for replication.</span></span> <span data-ttu-id="39812-154">Cuando se escribe un gran número de transacciones en una base de datos de publicación, pero solo un pequeño subconjunto de ellas está marcado para replicación, deberá utilizar el parámetro **-ReadBatchSize** para aumentar el tamaño del lote leído del Agente de registro del LOG.</span><span class="sxs-lookup"><span data-stu-id="39812-154">When a large number of transactions is written to a publication database, but only a small subset of those are marked for replication, you should use the **-ReadBatchSize** parameter to increase the read batch size of the Log Reader Agent.</span></span> <span data-ttu-id="39812-155">Este parámetro no se aplica a los publicadores de Oracle.</span><span class="sxs-lookup"><span data-stu-id="39812-155">This parameter does not apply to Oracle Publishers.</span></span>  
  
-   <span data-ttu-id="39812-156">Aumente el valor del parámetro **-CommitBatchSize** del Agente de distribución.</span><span class="sxs-lookup"><span data-stu-id="39812-156">Increase the value of the **-CommitBatchSize** parameter for the Distribution Agent.</span></span>  
  
     <span data-ttu-id="39812-157">Confirmar un conjunto de transacciones tiene una sobrecarga fija; al confirmar un número mayor de transacciones con menos frecuencia, la sobrecarga se reparte entre un mayor volumen de datos.</span><span class="sxs-lookup"><span data-stu-id="39812-157">Committing a set of transactions has a fixed overhead; by committing a larger number of transactions less frequently, the overhead is spread across a larger volume of data.</span></span> <span data-ttu-id="39812-158">No obstante, las ventajas de aumentar este parámetro disminuyen ya que el costo de aplicar los cambios está determinado por otros factores, como la E/S máxima del disco que contiene el registro.</span><span class="sxs-lookup"><span data-stu-id="39812-158">However, the benefit of increasing this parameter drops off as the cost of applying changes is gated by other factors, such as the maximum I/O of the disk that contains the log.</span></span> <span data-ttu-id="39812-159">Además, existe un desequilibrio que hay que tener en cuenta: cualquier error que provoque que el Agente de distribución vuelva a comenzar debe revertir y volver a aplicar un mayor número de transacciones.</span><span class="sxs-lookup"><span data-stu-id="39812-159">Additionally, there is a trade off to be considered: any failure that causes the Distribution Agent to start over must rollback and reapply a larger number of transactions.</span></span> <span data-ttu-id="39812-160">En las redes no confiables, un valor más reducido puede provocar menos errores y que sea necesario revertir y volver a aplicar un menor número de transacciones en caso de producirse un error.</span><span class="sxs-lookup"><span data-stu-id="39812-160">For unreliable networks, a lower value can result in less failures and a smaller number of transactions to rollback and reapply if a failure occurs.</span></span>  
  
-   <span data-ttu-id="39812-161">Reduzca el valor del parámetro **-PollingInterval** del Agente de registro del LOG.</span><span class="sxs-lookup"><span data-stu-id="39812-161">Decrease the value of the **-PollingInterval** parameter for the Log Reader Agent.</span></span>  
  
     <span data-ttu-id="39812-162">El parámetro **-PollingInterval** especifica con qué frecuencia se consulta el registro de transacciones de una base de datos publicada para que las transacciones se repliquen.</span><span class="sxs-lookup"><span data-stu-id="39812-162">The **-PollingInterval** parameter specifies how often the transaction log of a published database is queried for transactions to replicate.</span></span> <span data-ttu-id="39812-163">El valor predeterminado es 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="39812-163">The default is 5 seconds.</span></span> <span data-ttu-id="39812-164">Si reduce este valor, el registro se sondea más a menudo, lo que puede dar lugar a una menor latencia para el envío de transacciones de la base de datos de publicaciones a la de distribución.</span><span class="sxs-lookup"><span data-stu-id="39812-164">If you decrease this value, the log is polled more frequently, which can result in lower latency for the delivery of transactions from the publication database to the distribution database.</span></span> <span data-ttu-id="39812-165">No obstante, debe equilibrar la necesidad de una menor latencia frente al aumento de carga en el servidor debido a sondeos más frecuentes.</span><span class="sxs-lookup"><span data-stu-id="39812-165">However, you should balance the need for lower latency against the increased load on the server from polling more frequently.</span></span>  
  
 <span data-ttu-id="39812-166">Los parámetros del agente se pueden especificar en los perfiles del agente y en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="39812-166">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="39812-167">Para más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="39812-167">For more information, see:</span></span>  
  
-   [<span data-ttu-id="39812-168">Trabajar con perfiles del Agente de replicación</span><span class="sxs-lookup"><span data-stu-id="39812-168">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
-   [<span data-ttu-id="39812-169">Ver y modificar parámetros del símbolo del sistema de los agentes de replicación &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="39812-169">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
-   [<span data-ttu-id="39812-170">Conceptos de los ejecutables del Agente de replicación</span><span class="sxs-lookup"><span data-stu-id="39812-170">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
  
