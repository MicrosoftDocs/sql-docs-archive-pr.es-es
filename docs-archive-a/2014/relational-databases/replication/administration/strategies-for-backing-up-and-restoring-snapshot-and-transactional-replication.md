---
title: Estrategias para hacer copias de seguridad y restaurar replicación de instantáneas o replicación transaccional | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- backups [SQL Server replication], snapshot replication
- restoring [SQL Server replication], transactional replication
- snapshot replication [SQL Server], backup and restore
- restoring [SQL Server replication], snapshot replication
- recovery [SQL Server replication], transactional replication
- transactional replication, backup and restore
- recovery [SQL Server replication], snapshot replication
- sync with backup [SQL Server replication]
- backups [SQL Server replication], transactional replication
ms.assetid: a8afcdbc-55db-4916-a219-19454f561f9e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e26f6cf1a61e4df9db79bc5fd90429f86d70a99f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87678174"
---
# <a name="strategies-for-backing-up-and-restoring-snapshot-and-transactional-replication"></a><span data-ttu-id="2b06d-102">Estrategias para hacer copias de seguridad y restaurar replicación de instantáneas o replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="2b06d-102">Strategies for Backing Up and Restoring Snapshot and Transactional Replication</span></span>
  <span data-ttu-id="2b06d-103">Hay tres áreas que hay que considerar al diseñar una estrategia de copias de seguridad y restauración para la replicación de instantáneas o transaccional:</span><span class="sxs-lookup"><span data-stu-id="2b06d-103">When you design a backup and restore strategy for snapshot and transactional replication, there are three areas to consider:</span></span>  
  
-   <span data-ttu-id="2b06d-104">Qué bases de datos se incluirán en la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2b06d-104">Which databases to back up.</span></span>  
  
-   <span data-ttu-id="2b06d-105">Configuración de la copia de seguridad para la replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="2b06d-105">Backup settings for transactional replication.</span></span>  
  
-   <span data-ttu-id="2b06d-106">Los pasos necesarios para restaurar una base de datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-106">The steps that are required to restore a database.</span></span> <span data-ttu-id="2b06d-107">Éstos dependen del tipo de replicación y de las opciones elegidas.</span><span class="sxs-lookup"><span data-stu-id="2b06d-107">These depend on the type of replication and options chosen.</span></span>  
  
 <span data-ttu-id="2b06d-108">En este tema se tratan cada una de estas áreas en las tres secciones siguientes.</span><span class="sxs-lookup"><span data-stu-id="2b06d-108">This topic covers each of these areas in the next three sections.</span></span> <span data-ttu-id="2b06d-109">Para información sobre las copias de seguridad y restauración para la publicación de Oracle, vea [Backup and Restore for Oracle Publishers](../non-sql/backup-and-restore-for-oracle-publishers.md) (Copias de seguridad y restauración de publicadores de Oracle).</span><span class="sxs-lookup"><span data-stu-id="2b06d-109">For information about backup and restore for Oracle publishing, see [Backup and Restore for Oracle Publishers](../non-sql/backup-and-restore-for-oracle-publishers.md).</span></span>  
  
## <a name="backing-up-databases"></a><span data-ttu-id="2b06d-110">Realizar copias de seguridad de bases de datos</span><span class="sxs-lookup"><span data-stu-id="2b06d-110">Backing up Databases</span></span>  
 <span data-ttu-id="2b06d-111">Para la replicación de instantáneas y la replicación transaccional, debe crear de forma periódica una copia de seguridad de las siguientes bases de datos:</span><span class="sxs-lookup"><span data-stu-id="2b06d-111">For snapshot and transactional replication, you should regularly back up the following databases:</span></span>  
  
-   <span data-ttu-id="2b06d-112">La base de datos de publicaciones en el publicador.</span><span class="sxs-lookup"><span data-stu-id="2b06d-112">The publication database at the Publisher.</span></span>  
  
-   <span data-ttu-id="2b06d-113">La base de datos de distribución en el distribuidor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-113">The distribution database at the Distributor.</span></span>  
  
-   <span data-ttu-id="2b06d-114">La base de datos de suscripciones en el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-114">The subscription database at each Subscriber.</span></span>  
  
-   <span data-ttu-id="2b06d-115">Las bases de datos del sistema **maestra** y **msdb** en el publicador, el distribuidor y todos los suscriptores.</span><span class="sxs-lookup"><span data-stu-id="2b06d-115">The **master** and **msdb** system databases at the Publisher, Distributor and all Subscribers.</span></span> <span data-ttu-id="2b06d-116">La copia de seguridad de cada una de estas bases de datos debe realizarse al mismo tiempo que la de las otras y la base de datos de replicación correspondiente.</span><span class="sxs-lookup"><span data-stu-id="2b06d-116">These databases should be backed up at the same time as each other and the relevant replication database.</span></span> <span data-ttu-id="2b06d-117">Por ejemplo, cree la copia de seguridad de las bases de datos **master** y **msdb** en el publicador al mismo tiempo que crea la copia de seguridad de la base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-117">For example, back up the **master** and **msdb** databases at the Publisher at the same time that you back up the publication database.</span></span> <span data-ttu-id="2b06d-118">Al restaurar la base de datos de publicación, asegúrese de que las bases de datos **maestra** y **msdb** sean coherentes con la base de datos de publicación en términos de configuración general y configuración de la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-118">If the publication database is restored, make sure that the **master** and **msdb** databases are consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
 <span data-ttu-id="2b06d-119">Si realiza regularmente copias de seguridad de registros, éstas deben capturar todos los cambios relacionados con la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-119">If you perform regular log backups, any replication-related changes should be captured in the log backups.</span></span> <span data-ttu-id="2b06d-120">Si no se realizan copias de seguridad de registros, debe realizarse una copia de seguridad siempre que se cambie un valor importante en la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-120">If you do not perform log backups, a backup should be performed whenever a setting relevant to replication is changed.</span></span> <span data-ttu-id="2b06d-121">Para más información, vea [Common Actions Requiring an Updated Backup](common-actions-requiring-an-updated-backup.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-121">For more information, see [Common Actions Requiring an Updated Backup](common-actions-requiring-an-updated-backup.md).</span></span>  
  
## <a name="backup-settings-for-transactional-replication"></a><span data-ttu-id="2b06d-122">Configuración de la copia de seguridad para la replicación transaccional</span><span class="sxs-lookup"><span data-stu-id="2b06d-122">Backup Settings for Transactional Replication</span></span>  
 <span data-ttu-id="2b06d-123">La replicación transaccional incluye el uso de la opción **sync with backup** , que se puede establecer en las bases de datos de distribución y de publicación:</span><span class="sxs-lookup"><span data-stu-id="2b06d-123">Transactional replication includes using the **sync with backup** option, which can be set on the distribution database and the publication database:</span></span>  
  
-   <span data-ttu-id="2b06d-124">Se recomienda establecer siempre esta opción en la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-124">We recommend that you always set this option on the distribution database.</span></span>  
  
     <span data-ttu-id="2b06d-125">Establecer esta opción en la base de datos de distribución garantiza que las transacciones en el registro de la base de datos de publicaciones no se trunquen hasta que se hayan incluido en una copia de seguridad en la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-125">Setting this option on the distribution database ensures that transactions in the log of the publication database will not be truncated until they have been backed up at the distribution database.</span></span> <span data-ttu-id="2b06d-126">La base de datos de distribución se puede restaurar hasta la última copia de seguridad y todas las transacciones que falten se entregan de la base de datos de publicación a la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-126">The distribution database can be restored to the last backup, and any missing transactions are delivered from the publication database to the distribution database.</span></span> <span data-ttu-id="2b06d-127">La replicación continúa sin ninguna variación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-127">Replication continues unaffected.</span></span>  
  
     <span data-ttu-id="2b06d-128">Establecer esta opción en la base de datos de distribución no afecta a la latencia de replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-128">Setting this option on the distribution database does not affect replication latency.</span></span> <span data-ttu-id="2b06d-129">Sin embargo, la opción retrasará el truncamiento del registro en la base de datos de publicación hasta que se haya hecho copia de seguridad de las transacciones correspondientes en la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-129">However, the option will delay the truncation of the log on the publication database until the corresponding transactions in the distribution database have been backed up.</span></span> <span data-ttu-id="2b06d-130">Esto puede crear un registro de transacciones mayor en la base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-130">(This can create a larger transaction log in the publication database.)</span></span>  
  
-   <span data-ttu-id="2b06d-131">Se recomienda establecer esta opción en la base de datos de publicación si su aplicación tolera latencia adicional.</span><span class="sxs-lookup"><span data-stu-id="2b06d-131">We recommend that you set this option on the publication database if your application can tolerate additional latency.</span></span>  
  
     <span data-ttu-id="2b06d-132">Establecer esta opción en la base de datos de publicaciones garantiza que las transacciones no se enviarán a la base de datos de distribución hasta que se hayan incluido en la copia de seguridad en la base de datos de publicaciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-132">Setting this option on the publication database ensures that transactions are not delivered to the distribution database until they are backed up at the publication database.</span></span> <span data-ttu-id="2b06d-133">Se puede restaurar la última copia de seguridad de la base de datos de publicación en el publicador, sin que exista ninguna posibilidad de que la base de datos de distribución contenga transacciones que la base de datos de publicación restaurada no tenga.</span><span class="sxs-lookup"><span data-stu-id="2b06d-133">The last publication database backup can then be restored at the Publisher without any chance of the distribution database having transactions that the restored publication database does not have.</span></span>  
  
     <span data-ttu-id="2b06d-134">La latencia y el rendimiento se ven afectados, ya que las transacciones no se pueden enviar a la base de datos de publicaciones hasta que no se hayan incluido en la copia de seguridad del publicador.</span><span class="sxs-lookup"><span data-stu-id="2b06d-134">Latency and throughput are affected because transactions cannot be delivered to the distribution database until they have been backed up at the Publisher.</span></span> <span data-ttu-id="2b06d-135">Por ejemplo, si se crea una copia de seguridad del registro de transacciones cada cinco minutos, habrá cinco minutos más de latencia entre que una transacción se confirma en el publicador y el momento en que la transacción enviada a la base de datos de distribución y posteriormente al suscriptor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-135">For example, if the transaction log is backed up every five minutes, there is an additional five minutes of latency between when a transaction is committed at the Publisher and when the transaction is delivered to the distribution database, and subsequently the Subscriber.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2b06d-136">La opción **sync with backup** garantiza la coherencia entre la base de datos de publicación y la base de datos de distribución, pero la opción no garantiza que no se pierdan datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-136">The **sync with backup** option ensures consistency between the publication database and the distribution database, but the option does not guarantee against data loss.</span></span> <span data-ttu-id="2b06d-137">Por ejemplo, si se pierde el registro de transacciones, las transacciones confirmadas desde la última copia de seguridad del registro de transacciones no estarán disponibles en la base de datos de publicación ni en la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-137">For example, if the transaction log is lost, transactions that have been committed since the last transaction log backup will not be available in the publication database or the distribution database.</span></span> <span data-ttu-id="2b06d-138">Éste es el mismo comportamiento que tiene una base de datos no replicada.</span><span class="sxs-lookup"><span data-stu-id="2b06d-138">This is the same behavior as a nonreplicated database.</span></span>  
  
 <span data-ttu-id="2b06d-139">**Para establecer la opción sync with backup**</span><span class="sxs-lookup"><span data-stu-id="2b06d-139">**To set the sync with backup option**</span></span>  
  
-   <span data-ttu-id="2b06d-140">Programación [!INCLUDE[tsql](../../../includes/tsql-md.md)] de la replicación: [Habilitar copias de seguridad coordinadas para la replicación transaccional &#40;programación de la replicación con Transact-SQL&#41;](enable-coordinated-backups-for-transactional-replication.md)</span><span class="sxs-lookup"><span data-stu-id="2b06d-140">Replication [!INCLUDE[tsql](../../../includes/tsql-md.md)] programming: [Enable Coordinated Backups for Transactional Replication &#40;Replication Transact-SQL Programming&#41;](enable-coordinated-backups-for-transactional-replication.md)</span></span>  
  
## <a name="restoring-databases-involved-in-replication"></a><span data-ttu-id="2b06d-141">Restaurar bases de datos que participan en la replicación</span><span class="sxs-lookup"><span data-stu-id="2b06d-141">Restoring Databases Involved in Replication</span></span>  
 <span data-ttu-id="2b06d-142">Puede restaurar todas las bases de datos de una topología de replicación si hay copias de seguridad recientes disponibles y se siguen los pasos correctos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-142">You can restore all databases in a replication topology if recent backups are available and the appropriate steps are followed.</span></span> <span data-ttu-id="2b06d-143">Los pasos de restauración de la base de datos de publicación dependen del tipo de replicación y de las opciones utilizadas. No obstante, los pasos de restauración de todas las demás bases de datos son independientes del tipo y de las opciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-143">The restore steps for the publication database depend on the type of replication and options that are used; however, the restore steps for all other databases are independent of the type and options.</span></span>  
  
 <span data-ttu-id="2b06d-144">La replicación permite restaurar las bases de datos replicadas en el mismo servidor y base de datos de los que se creó la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2b06d-144">Replication supports restoring replicated databases to the same server and database from which the backup was created.</span></span> <span data-ttu-id="2b06d-145">Si restaura una copia de seguridad de una base de datos replicada en otro servidor o base de datos, no se conservará la configuración de la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-145">If you restore a backup of a replicated database to another server or database, replication settings cannot be preserved.</span></span> <span data-ttu-id="2b06d-146">En este caso, deberá volver a crear todas las publicaciones y suscripciones después de restaurar las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2b06d-146">In this case, you must re-create all publications and subscriptions after backups are restored.</span></span>  
  
### <a name="publisher"></a><span data-ttu-id="2b06d-147">Publicador</span><span class="sxs-lookup"><span data-stu-id="2b06d-147">Publisher</span></span>  
 <span data-ttu-id="2b06d-148">Se proporcionan los pasos de restauración para los siguientes tipos de replicación:</span><span class="sxs-lookup"><span data-stu-id="2b06d-148">There are restore steps provided for the following types of replication:</span></span>  
  
-   <span data-ttu-id="2b06d-149">Replicación de instantáneas</span><span class="sxs-lookup"><span data-stu-id="2b06d-149">Snapshot replication</span></span>  
  
-   <span data-ttu-id="2b06d-150">Replicación transaccional de solo lectura</span><span class="sxs-lookup"><span data-stu-id="2b06d-150">Read-only transactional replication</span></span>  
  
-   <span data-ttu-id="2b06d-151">Replicación transaccional con suscripciones de actualización</span><span class="sxs-lookup"><span data-stu-id="2b06d-151">Transactional replication with updating subscriptions</span></span>  
  
-   <span data-ttu-id="2b06d-152">Replicación transaccional punto a punto</span><span class="sxs-lookup"><span data-stu-id="2b06d-152">Peer-to-peer transactional replication</span></span>  
  
 <span data-ttu-id="2b06d-153">La restauración de las bases de datos **msdb** y **maestra** , que también se tratan en esta sección, es igual para los cuatro tipos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-153">The restore of the **msdb** and **master** databases, which are also covered in this section, is the same for all four types.</span></span>  
  
#### <a name="publication-database-snapshot-replication"></a><span data-ttu-id="2b06d-154">Base de datos de publicación: Replicación de instantáneas</span><span class="sxs-lookup"><span data-stu-id="2b06d-154">Publication Database: Snapshot Replication</span></span>  
  
1.  <span data-ttu-id="2b06d-155">Restaure la última copia de seguridad de la base de datos de publicaciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-155">Restore the latest backup of the publication database.</span></span> <span data-ttu-id="2b06d-156">Vaya al paso 2.</span><span class="sxs-lookup"><span data-stu-id="2b06d-156">Go to step 2.</span></span>  
  
2.  <span data-ttu-id="2b06d-157">¿La base de datos de publicaciones contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-157">Does the publication database backup contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-158">En caso afirmativo, la restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-158">If yes, the restore is completed.</span></span> <span data-ttu-id="2b06d-159">En caso contrario, continúe en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-159">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="2b06d-160">Quite la configuración de replicación del publicador, el distribuidor y los suscriptores, y vuelva a crear la configuración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-160">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="2b06d-161">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-161">Restore is completed.</span></span>  
  
     <span data-ttu-id="2b06d-162">Para más información sobre cómo quitar la replicación, vea [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b06d-162">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
#### <a name="publication-database-read-only-transactional-replication"></a><span data-ttu-id="2b06d-163">Base de datos de publicación: Replicación transaccional de solo lectura</span><span class="sxs-lookup"><span data-stu-id="2b06d-163">Publication Database: Read-Only Transactional Replication</span></span>  
  
1.  <span data-ttu-id="2b06d-164">Restaure la última copia de seguridad de la base de datos de publicaciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-164">Restore the latest backup of the publication database.</span></span> <span data-ttu-id="2b06d-165">Vaya al paso 2.</span><span class="sxs-lookup"><span data-stu-id="2b06d-165">Go to step 2.</span></span>  
  
2.  <span data-ttu-id="2b06d-166">¿Estaba habilitada la opción **sync with backup** en la base de datos de publicación antes del error?</span><span class="sxs-lookup"><span data-stu-id="2b06d-166">Was the **sync with backup** setting enabled on the publication database before the failure?</span></span> <span data-ttu-id="2b06d-167">En caso afirmativo, vaya al paso 3; de lo contrario, continúe en el paso 5.</span><span class="sxs-lookup"><span data-stu-id="2b06d-167">If yes, go to step 3; if no, go to step 5.</span></span>  
  
     <span data-ttu-id="2b06d-168">Si la opción está habilitada, la consulta `SELECT DATABASEPROPERTYEX('<PublicationDatabaseName>', 'IsSyncWithBackup')` devuelve '1'.</span><span class="sxs-lookup"><span data-stu-id="2b06d-168">If the setting is enabled, the query `SELECT DATABASEPROPERTYEX('<PublicationDatabaseName>', 'IsSyncWithBackup')` returns '1'.</span></span>  
  
3.  <span data-ttu-id="2b06d-169">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-169">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-170">¿Contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-170">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-171">En caso afirmativo, la restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-171">If yes, the restore is completed.</span></span> <span data-ttu-id="2b06d-172">De lo contrario, continúe en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-172">If no, go to step 4.</span></span>  
  
4.  <span data-ttu-id="2b06d-173">La información de configuración de la base de datos de publicación restaurada no es actualizada.</span><span class="sxs-lookup"><span data-stu-id="2b06d-173">The configuration information in the restored publication database is not up-to-date.</span></span> <span data-ttu-id="2b06d-174">Por consiguiente, debe asegurarse de que los suscriptores tienen todos los comandos pendientes en la base de datos de distribución, y, a continuación, quitar y volver a crear la configuración de replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-174">Therefore, you must make sure that the Subscribers have all outstanding commands in the distribution database, and then drop and re-create the replication configuration.</span></span>  
  
    1.  <span data-ttu-id="2b06d-175">Ejecute el Agente de distribución hasta que todos los suscriptores estén sincronizados con los comandos pendientes de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-175">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="2b06d-176">Asegúrese de que todos los comandos se envíen a los suscriptores utilizando la pestaña **Comandos sin distribuir** del Monitor de replicación o ejecutando una consulta en la vista [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-176">Verify that all commands are delivered to Subscribers by using the **Undistributed Commands** tab in Replication Monitor or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="2b06d-177">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-177">Go to step b.</span></span>  
  
         <span data-ttu-id="2b06d-178">Para más información sobre cómo ejecutar el Agente de distribución, vea [Iniciar y detener un agente de replicación &#40;SQL Server Management Studio#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) y [Conceptos de los ejecutables del Agente de replicación](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-178">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
         <span data-ttu-id="2b06d-179">Para obtener más información acerca de cómo comprobar comandos, vea [ver comandos replicados y otra información en la base de datos de distribución &#40;programación de la replicación con Transact-SQL&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) y [ver información y realizar tareas mediante el monitor de replicación](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-179">For more information about how to verify commands, see [View Replicated Commands and Other Information in the Distribution Database &#40;Replication Transact-SQL Programming&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) and [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
    2.  <span data-ttu-id="2b06d-180">Quite la configuración de replicación del publicador, el distribuidor y los suscriptores, y vuelva a crear la configuración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-180">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="2b06d-181">Al volver a crear las suscripciones, especifique que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-181">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-182">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-182">The restore is completed.</span></span>  
  
         <span data-ttu-id="2b06d-183">Para más información sobre cómo quitar la replicación, vea [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b06d-183">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="2b06d-184">Para obtener más información acerca de cómo especificar que el suscriptor ya tiene los datos, vea [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-184">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
5.  <span data-ttu-id="2b06d-185">La opción **sync with backup** no estaba activada en la base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-185">The **sync with backup** option was not set on the publication database.</span></span> <span data-ttu-id="2b06d-186">Por consiguiente, las transacciones que no se incluyeron en la copia de seguridad restaurada se podrían haber entregado al distribuidor y suscriptores.</span><span class="sxs-lookup"><span data-stu-id="2b06d-186">Therefore, transactions that were not included in the restored backup might have been delivered to the Distributor and Subscribers.</span></span> <span data-ttu-id="2b06d-187">Ahora, debe asegurarse de que los suscriptores tengan todos los comandos pendientes de la base de datos de distribución y, después, debe aplicar manualmente a la base de datos de publicación todas las transacciones no incluidas en la copia de seguridad restaurada.</span><span class="sxs-lookup"><span data-stu-id="2b06d-187">You must now make sure that Subscribers have all outstanding commands in the distribution database, and then manually apply to the publication database any transactions that are not included in the restored backup.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="2b06d-188">Este proceso puede dar lugar a que se restauren las tablas publicadas hasta un momento más reciente que el de otras tablas no publicadas restauradas a partir de la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2b06d-188">Performing this process can cause published tables to be restored to a point in time that is more recent than the point in time of other nonpublished tables that are restored from the backup.</span></span>  
  
    1.  <span data-ttu-id="2b06d-189">Ejecute el Agente de distribución hasta que todos los suscriptores estén sincronizados con los comandos pendientes de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-189">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="2b06d-190">Asegúrese de que todos los comandos se envíen a los suscriptores utilizando la pestaña **Comandos sin distribuir** del Monitor de replicación o ejecutando una consulta en la vista [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-190">Verify that all commands are delivered to Subscribers by using the **Undistributed Commands** tab in Replication Monitor or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="2b06d-191">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-191">Go to step b.</span></span>  
  
         <span data-ttu-id="2b06d-192">Para más información sobre cómo ejecutar el Agente de distribución, vea [Iniciar y detener un agente de replicación &#40;SQL Server Management Studio#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) y [Conceptos de los ejecutables del Agente de replicación](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-192">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
         <span data-ttu-id="2b06d-193">Para obtener más información acerca de cómo comprobar comandos, vea [ver comandos replicados y otra información en la base de datos de distribución &#40;programación de la replicación con Transact-SQL&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) y [ver información y realizar tareas mediante el monitor de replicación](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-193">For more information about how to verify commands, see [View Replicated Commands and Other Information in the Distribution Database &#40;Replication Transact-SQL Programming&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) and [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
    2.  <span data-ttu-id="2b06d-194">Utilice la [tablediff utility](../../../tools/tablediff-utility.md) u otra herramienta para sincronizar manualmente el publicador con el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-194">Use the [tablediff utility](../../../tools/tablediff-utility.md) or another tool to manually synchronize the Publisher with the Subscriber.</span></span> <span data-ttu-id="2b06d-195">Esto le permite recuperar los datos de la base de datos de suscripciones que no estaban incluidos en la copia de seguridad de base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-195">This enables you to recover data from the subscription database that was not contained in the publication database backup.</span></span> <span data-ttu-id="2b06d-196">Continúe en el paso c.</span><span class="sxs-lookup"><span data-stu-id="2b06d-196">Go to step c.</span></span>  
  
         <span data-ttu-id="2b06d-197">Para más información sobre el uso de la utilidad **tablediff**, vea [Comparar tablas replicadas para buscar diferencias &#40;programación de la replicación&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-197">For more information about the **tablediff** utility, see [Compare Replicated Tables for Differences &#40;Replication Programming&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span></span>  
  
    3.  <span data-ttu-id="2b06d-198">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-198">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-199">¿Contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-199">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-200">En caso afirmativo, ejecute el procedimiento almacenado [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) para volver a sincronizar los metadatos del publicador con los del distribuidor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-200">If yes, execute the [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) stored procedure to resynchronize the Publisher metadata with the Distributor metadata.</span></span> <span data-ttu-id="2b06d-201">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-201">The restore is completed.</span></span> <span data-ttu-id="2b06d-202">En caso contrario, continúe en el paso d.</span><span class="sxs-lookup"><span data-stu-id="2b06d-202">If no, go to step d.</span></span>  
  
    4.  <span data-ttu-id="2b06d-203">Quite la configuración de replicación del publicador, el distribuidor y los suscriptores, y vuelva a crear la configuración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-203">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="2b06d-204">Al volver a crear las suscripciones, especifique que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-204">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-205">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-205">The restore is completed.</span></span>  
  
         <span data-ttu-id="2b06d-206">Para más información sobre cómo quitar la replicación, vea [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b06d-206">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="2b06d-207">Para obtener más información acerca de cómo especificar que el suscriptor ya tiene los datos, vea [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-207">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
#### <a name="publication-database-transactional-replication-with-updating-subscriptions"></a><span data-ttu-id="2b06d-208">Base de datos de publicación: Replicación transaccional con suscripciones de actualización</span><span class="sxs-lookup"><span data-stu-id="2b06d-208">Publication Database: Transactional Replication with Updating Subscriptions</span></span>  
  
1.  <span data-ttu-id="2b06d-209">Restaure la última copia de seguridad de la base de datos de publicaciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-209">Restore the latest backup of the publication database.</span></span> <span data-ttu-id="2b06d-210">Vaya al paso 2.</span><span class="sxs-lookup"><span data-stu-id="2b06d-210">Go to step 2.</span></span>  
  
2.  <span data-ttu-id="2b06d-211">Ejecute el Agente de distribución hasta que todos los suscriptores estén sincronizados con los comandos pendientes de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-211">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="2b06d-212">Asegúrese de que todos los comandos se envíen a los suscriptores utilizando la pestaña **Comandos sin distribuir** del Monitor de replicación o ejecutando una consulta en la vista [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-212">Verify that all commands are delivered to Subscribers by using the **Undistributed Commands** tab in Replication Monitor, or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="2b06d-213">Vaya al paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-213">Go to step 3.</span></span>  
  
     <span data-ttu-id="2b06d-214">Para más información sobre cómo ejecutar el Agente de distribución, vea [Iniciar y detener un agente de replicación &#40;SQL Server Management Studio#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) y [Conceptos de los ejecutables del Agente de replicación](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-214">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
     <span data-ttu-id="2b06d-215">Para obtener más información acerca de cómo comprobar comandos, vea [ver comandos replicados y otra información en la base de datos de distribución &#40;programación de la replicación con Transact-SQL&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) y [ver información y realizar tareas mediante el monitor de replicación](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-215">For more information about how to verify commands, see [View Replicated Commands and Other Information in the Distribution Database &#40;Replication Transact-SQL Programming&#41;](../monitor/view-replicated-commands-and-information-in-distribution-database.md) and [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
3.  <span data-ttu-id="2b06d-216">Si está utilizando suscripciones de actualización en cola, conéctese a cada suscriptor y elimine todas las filas de la tabla [MSreplication_queue &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/msreplication-queue-transact-sql) en la base de datos de suscripciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-216">If you are using queued updating subscriptions, connect to each Subscriber and delete all rows from the [MSreplication_queue &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/msreplication-queue-transact-sql) table in the subscription database.</span></span> <span data-ttu-id="2b06d-217">Vaya al paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-217">Go to step 4.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2b06d-218">Si está utilizando suscripciones de actualización en cola y hay tablas que contienen columnas de identidad, debe asegurarse de que se asignen los intervalos de identidad correctos después de la restauración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-218">If you are using queued updating subscriptions and any tables contain identity columns, you must make sure that the correct identity ranges are assigned after a restore.</span></span> <span data-ttu-id="2b06d-219">Para más información, vea [Replicar columnas de identidad](../publish/replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-219">For more information, see [Replicate Identity Columns](../publish/replicate-identity-columns.md).</span></span>  
  
4.  <span data-ttu-id="2b06d-220">Ahora, debe asegurarse de que los suscriptores tengan todos los comandos pendientes de la base de datos de distribución y, después, debe aplicar manualmente a la base de datos de publicación todas las transacciones no incluidas en la copia de seguridad restaurada.</span><span class="sxs-lookup"><span data-stu-id="2b06d-220">You must now make sure that Subscribers have all outstanding commands in the distribution database, and then manually apply to the publication database any transactions that are not included in the restored backup.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="2b06d-221">Este proceso puede dar lugar a que se restauren las tablas publicadas hasta un momento más reciente que el de otras tablas no publicadas restauradas a partir de la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2b06d-221">Performing this process can cause published tables to be restored to a point in time that is more recent than the point in time of other nonpublished tables that are restored from the backup.</span></span>  
  
    1.  <span data-ttu-id="2b06d-222">Ejecute el Agente de distribución hasta que todos los suscriptores estén sincronizados con los comandos pendientes de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-222">Run the Distribution Agent until all Subscribers are synchronized with the outstanding commands in the distribution database.</span></span> <span data-ttu-id="2b06d-223">Asegúrese de que todos los comandos se envíen a los suscriptores, utilizando el Monitor de replicación o ejecutando una consulta en la vista [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-223">Verify that all commands are delivered to Subscribers by using Replication Monitor or by querying the [MSdistribution_status](/sql/relational-databases/system-views/msdistribution-status-transact-sql) view in the distribution database.</span></span> <span data-ttu-id="2b06d-224">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-224">Go to step b.</span></span>  
  
    2.  <span data-ttu-id="2b06d-225">Utilice la [tablediff Utility](../../../tools/tablediff-utility.md) u otra herramienta para sincronizar manualmente el publicador con el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-225">Use the [tablediff Utility](../../../tools/tablediff-utility.md) or another tool to manually synchronize the Publisher with the Subscriber.</span></span> <span data-ttu-id="2b06d-226">Esto le permite recuperar los datos de la base de datos de suscripciones que no estaban incluidos en la copia de seguridad de base de datos de publicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-226">This enables you to recover data from the subscription database that was not contained in the publication database backup.</span></span> <span data-ttu-id="2b06d-227">Continúe en el paso c.</span><span class="sxs-lookup"><span data-stu-id="2b06d-227">Go to step c.</span></span>  
  
         <span data-ttu-id="2b06d-228">Para más información sobre el uso de la utilidad **tablediff**, vea [Comparar tablas replicadas para buscar diferencias &#40;programación de la replicación&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-228">For more information about the **tablediff** utility, see [Compare Replicated Tables for Differences &#40;Replication Programming&#41;](compare-replicated-tables-for-differences-replication-programming.md).</span></span>  
  
    3.  <span data-ttu-id="2b06d-229">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-229">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-230">¿Contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-230">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-231">En caso afirmativo, ejecute el procedimiento almacenado [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) para volver a sincronizar los metadatos del publicador con los del distribuidor.</span><span class="sxs-lookup"><span data-stu-id="2b06d-231">If yes, execute the [sp_replrestart](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql) stored procedure to resynchronize the Publisher metadata with the Distributor metadata.</span></span> <span data-ttu-id="2b06d-232">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-232">The restore is completed.</span></span> <span data-ttu-id="2b06d-233">En caso contrario, continúe en el paso d.</span><span class="sxs-lookup"><span data-stu-id="2b06d-233">If no, go to step d.</span></span>  
  
    4.  <span data-ttu-id="2b06d-234">Quite la configuración de replicación del publicador, el distribuidor y los suscriptores, y vuelva a crear la configuración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-234">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="2b06d-235">Al volver a crear las suscripciones, especifique que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-235">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-236">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-236">The restore is completed.</span></span>  
  
         <span data-ttu-id="2b06d-237">Para más información sobre cómo quitar la replicación, vea [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b06d-237">For more information about how to remove replication, see and [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="2b06d-238">Para obtener más información acerca de cómo especificar que el suscriptor ya tiene los datos, vea [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-238">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
#### <a name="publication-database-peer-to-peer-transactional-replication"></a><span data-ttu-id="2b06d-239">Base de datos de publicación: Peer-to-Peer Transactional Replication</span><span class="sxs-lookup"><span data-stu-id="2b06d-239">Publication Database: Peer-to-Peer Transactional Replication</span></span>  
 <span data-ttu-id="2b06d-240">En los pasos siguientes, las bases de datos de publicación **A**, **B**y **C** están en una topología de replicación transaccional punto a punto.</span><span class="sxs-lookup"><span data-stu-id="2b06d-240">In the following steps, publication databases **A**, **B**, and **C** are in a peer-to-peer transactional replication topology.</span></span> <span data-ttu-id="2b06d-241">Las bases de datos **A** y **C** están en línea y funcionan correctamente; la base de datos **B** es la que se desea restaurar.</span><span class="sxs-lookup"><span data-stu-id="2b06d-241">Databases **A** and **C** are online and functioning properly; database **B** is the database to be restored.</span></span> <span data-ttu-id="2b06d-242">El proceso descrito aquí, sobre todo los pasos 7, 10 y 11, son muy similares al proceso que se requiere para agregar un nodo a una topología punto a punto.</span><span class="sxs-lookup"><span data-stu-id="2b06d-242">The process described here, especially steps 7, 10, and 11, is very similar to the process required to add a node to a peer-to-peer topology.</span></span> <span data-ttu-id="2b06d-243">La forma más directa de llevar a cabo estos pasos es mediante el Asistente de configuración de la topología punto a punto, pero también puede usar procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="2b06d-243">The most straightforward way to perform these steps is to use the Configure Peer-to-Peer Topology Wizard, but you can also use stored procedures.</span></span>  
  
1.  <span data-ttu-id="2b06d-244">Ejecute los agentes de distribución para sincronizar las suscripciones de las bases de datos **A** y **C**. Vaya al paso 2.</span><span class="sxs-lookup"><span data-stu-id="2b06d-244">Run the Distribution Agents to synchronize the subscriptions at databases **A** and **C**. Go to step 2.</span></span>  
  
     <span data-ttu-id="2b06d-245">Para más información sobre cómo ejecutar el Agente de distribución, vea [Iniciar y detener un agente de replicación &#40;SQL Server Management Studio#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) y [Conceptos de los ejecutables del Agente de replicación](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-245">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
2.  <span data-ttu-id="2b06d-246">Si la base de datos de distribución que utiliza **B** aún está disponible, ejecute los agentes de distribución para sincronizar las suscripciones entre las bases de datos **B** y **A** y B y **C**. Vaya al paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-246">If the distribution database that **B** uses is still available, run Distribution Agents to synchronize subscriptions between databases **B** and **A** and databases and B and **C**. Go to step 3.</span></span>  
  
3.  <span data-ttu-id="2b06d-247">Quite los metadatos de la base de datos de distribución que utiliza **B** ejecutando [sp_removedistpublisherdbreplication](/sql/relational-databases/system-stored-procedures/sp-removedistpublisherdbreplication-transact-sql) en la base de datos de distribución para **B**. Vaya al paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-247">Remove metadata from the distribution database that **B** uses by executing [sp_removedistpublisherdbreplication](/sql/relational-databases/system-stored-procedures/sp-removedistpublisherdbreplication-transact-sql) at the distribution database for **B**. Go to step 4.</span></span>  
  
4.  <span data-ttu-id="2b06d-248">En las bases de datos **A** y **C**, quite las suscripciones a la publicación de la base de datos **B**. Vaya al paso 5.</span><span class="sxs-lookup"><span data-stu-id="2b06d-248">At databases **A** and **C**, drop the subscriptions to the publication at database **B**. Go to step 5.</span></span>  
  
     <span data-ttu-id="2b06d-249">Para obtener más información acerca de cómo quitar suscripciones, vea [Subscribe to Publications](../subscribe-to-publications.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-249">For more information about how to drop subscriptions, see [Subscribe to Publications](../subscribe-to-publications.md).</span></span>  
  
5.  <span data-ttu-id="2b06d-250">Realice una copia de seguridad de registros o una copia de seguridad completa de la base de datos **A**. Vaya al paso 6.</span><span class="sxs-lookup"><span data-stu-id="2b06d-250">Perform a log backup or full backup of database **A**. Go to step 6.</span></span>  
  
6.  <span data-ttu-id="2b06d-251">Restaure la última copia de seguridad de la base de datos **A** en la base de datos **B**. Ahora, la base de datos **B** tienen los datos de la base de datos **A**, pero no la configuración de replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-251">Restore the backup of database **A** at database **B**. Database **B** now has the data from database **A**, but not the replication configuration.</span></span> <span data-ttu-id="2b06d-252">Al restaurar una copia de seguridad en otro servidor, se quita la replicación; esto significa que se ha quitado la replicación de la base de datos **B**. Vaya al paso 7.</span><span class="sxs-lookup"><span data-stu-id="2b06d-252">When you restore a backup to another server, replication is removed; therefore, replication has been removed from database **B**. Go to step 7.</span></span>  
  
7.  <span data-ttu-id="2b06d-253">Vuelva a crear la publicación en la base de datos de publicación **B**, y luego vuelva a crear suscripciones entre las bases de datos **A** y **B** (las suscripciones que afectan a la base de datos **C** se administran en una fase posterior).</span><span class="sxs-lookup"><span data-stu-id="2b06d-253">Re-create the publication at database **B**, and then re-create subscriptions between databases **A** and **B**. (Subscriptions that involve database **C** are handled at a later stage.).</span></span>  
  
    1.  <span data-ttu-id="2b06d-254">Vuelva a crear la publicación en la base de datos **B**. Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-254">Re-create the publication at database **B**. Go to step b.</span></span>  
  
    2.  <span data-ttu-id="2b06d-255">Vuelva a crear la suscripción de la base de datos **B** a la publicación de la base **de**datos a, especificando que la suscripción debe inicializarse con una copia de seguridad (el valor **Initialize with backup** para el **@sync_type** parámetro de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="2b06d-255">Re-create the subscription at database **B** to the publication at database **A**, specifying that the subscription should be initialized with a backup (a value of **initialize with backup** for the **@sync_type** parameter of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span></span> <span data-ttu-id="2b06d-256">Continúe en el paso c.</span><span class="sxs-lookup"><span data-stu-id="2b06d-256">Go to step c.</span></span>  
  
    3.  <span data-ttu-id="2b06d-257">Vuelva a crear la suscripción de la base **de** datos a a la publicación de la base de datos **B**, especificando que el suscriptor ya tiene los datos (un valor de **Replication support only** para el **@sync_type** parámetro de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="2b06d-257">Re-create the subscription at database **A** to the publication at database **B**, specifying that the Subscriber already has the data (a value of **replication support only** for the **@sync_type** parameter of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span></span> <span data-ttu-id="2b06d-258">Vaya al paso 8.</span><span class="sxs-lookup"><span data-stu-id="2b06d-258">Go to step 8.</span></span>  
  
8.  <span data-ttu-id="2b06d-259">Ejecute los agentes de distribución para sincronizar las suscripciones de las bases de datos **A** y **B**. Si hay columnas de identidad en las tablas publicadas, vaya al paso 9.</span><span class="sxs-lookup"><span data-stu-id="2b06d-259">Run the Distribution Agents to synchronize the subscriptions at databases **A** and **B**. If there are any identity columns in published tables, go to step 9.</span></span> <span data-ttu-id="2b06d-260">En caso contrario, continúe en el paso 10.</span><span class="sxs-lookup"><span data-stu-id="2b06d-260">If not, go to step 10.</span></span>  
  
9. <span data-ttu-id="2b06d-261">Después de la restauración, el intervalo de identidad asignado a cada tabla en la base de datos **A** también se utilizará en la base de datos **B**. Asegúrese de que la base de datos restaurada **B** haya recibido todos los cambios de la base de datos **B** que se propagaron a las bases de datos **A** y **C** y luego reinicie el intervalo de identidad para cada tabla.</span><span class="sxs-lookup"><span data-stu-id="2b06d-261">After the restore, the identity range that you assigned for each table in database **A** would also be used in database **B**. Make sure that the restored database **B** has received all changes from the failed database **B** that were propagated to database **A** and database **C**; and then reseed the identity range for each table.</span></span>  
  
    1.  <span data-ttu-id="2b06d-262">Ejecute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) en la base de datos **B** y recupere el parámetro de salida **@request_id** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-262">Execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) at database **B** and retrieve the output parameter **@request_id**.</span></span> <span data-ttu-id="2b06d-263">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-263">Go to step b.</span></span>  
  
    2.  <span data-ttu-id="2b06d-264">De forma predeterminada, el Agente de distribución está configurado para ejecutarse de forma continua, por lo que los tokens deben enviarse automáticamente a todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-264">By default, the Distribution Agent is set to run continuously; therefore, tokens should be sent to all nodes automatically.</span></span> <span data-ttu-id="2b06d-265">Si el Agente de distribución no se está ejecutando de forma continua, ejecútelo.</span><span class="sxs-lookup"><span data-stu-id="2b06d-265">If the Distribution Agent is not running in continuous mode, run the agent.</span></span> <span data-ttu-id="2b06d-266">Para más información, vea [Conceptos de los ejecutables del Agente de replicación](../concepts/replication-agent-executables-concepts.md) o [Iniciar y detener un Agente de replicación &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-266">For more information, see [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md) or [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md).</span></span> <span data-ttu-id="2b06d-267">Continúe en el paso c.</span><span class="sxs-lookup"><span data-stu-id="2b06d-267">Go to step c.</span></span>  
  
    3.  <span data-ttu-id="2b06d-268">Ejecute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), proporcionando el **@request_id** valor recuperado en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-268">Execute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), providing the **@request_id** value retrieved in step b.</span></span> <span data-ttu-id="2b06d-269">Espere hasta que todos los nodos indiquen que han recibido la solicitud del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="2b06d-269">Wait until all nodes indicate they have received the peer request.</span></span> <span data-ttu-id="2b06d-270">Continúe en el paso d.</span><span class="sxs-lookup"><span data-stu-id="2b06d-270">Go to step d.</span></span>  
  
    4.  <span data-ttu-id="2b06d-271">Use [DBCC CHECKIDENT](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) para reinicializar cada tabla de la base de datos **B** con el fin de asegurarse de que se utiliza un intervalo apropiado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-271">Use [DBCC CHECKIDENT](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) to reseed each table in database **B** to make sure that an appropriate range is used.</span></span> <span data-ttu-id="2b06d-272">Vaya al paso 10.</span><span class="sxs-lookup"><span data-stu-id="2b06d-272">Go to step 10.</span></span>  
  
     <span data-ttu-id="2b06d-273">Para más información sobre la administración de los intervalos de identidad, vea la sección “Asignar intervalos para la administración manual del intervalo de identidad” en el tema [Replicar columnas de identidad](../publish/replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-273">For more information about how to manage identity ranges, see the "Assigning ranges for manual identity range management" section of [Replicate Identity Columns](../publish/replicate-identity-columns.md).</span></span>  
  
10. <span data-ttu-id="2b06d-274">En este punto, las bases de datos **B** y **C** no están conectadas directamente, pero reciben los cambios a través de la base de datos **A**. Si la topología contiene cualquier nodo que está ejecutando [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], continúe en el paso 11; en caso contrario, continúe en el paso 12.</span><span class="sxs-lookup"><span data-stu-id="2b06d-274">At this point, database **B** and database **C** are not directly connected, but they will receive changes through database **A**. If the topology contains any nodes that are running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], go to step 11; otherwise, go to step 12.</span></span>  
  
11. <span data-ttu-id="2b06d-275">Detenga el sistema y luego vuelva a crear la suscripción entre las bases de datos **B** y **C**. Para detener el sistema, hay que detener la actividad de las tablas publicadas en todos los nodos y asegurarse de que cada nodo haya recibido todos los cambios de los demás nodos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-275">Quiesce the system, and then re-create the subscription between databases **B** and **C**. Quiescing a system involves stopping activity on published tables at all nodes and making sure of that each node has received all changes from all other nodes.</span></span>  
  
    1.  <span data-ttu-id="2b06d-276">Detenga toda la actividad en las tablas publicadas de la topología punto a punto.</span><span class="sxs-lookup"><span data-stu-id="2b06d-276">Stop all activity on published tables in the peer-to-peer topology.</span></span> <span data-ttu-id="2b06d-277">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-277">Go to step b.</span></span>  
  
    2.  <span data-ttu-id="2b06d-278">Ejecute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) en la base de datos **B** y recupere el parámetro de salida **@request_id** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-278">Execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) at database **B** and retrieve the output parameter **@request_id**.</span></span> <span data-ttu-id="2b06d-279">Continúe en el paso c.</span><span class="sxs-lookup"><span data-stu-id="2b06d-279">Go to step c.</span></span>  
  
    3.  <span data-ttu-id="2b06d-280">De forma predeterminada, el Agente de distribución está configurado para ejecutarse de forma continua, por lo que los tokens deben enviarse automáticamente a todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-280">By default, the Distribution Agent is set to run continuously; therefore, tokens should be sent to all nodes automatically.</span></span> <span data-ttu-id="2b06d-281">Si el Agente de distribución no se está ejecutando de forma continua, ejecútelo.</span><span class="sxs-lookup"><span data-stu-id="2b06d-281">If the Distribution Agent is not running in continuous mode, run the agent.</span></span> <span data-ttu-id="2b06d-282">Continúe en el paso d.</span><span class="sxs-lookup"><span data-stu-id="2b06d-282">Go to step d.</span></span>  
  
    4.  <span data-ttu-id="2b06d-283">Ejecute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), proporcionando el **@request_id** valor recuperado en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-283">Execute [sp_helppeerresponses](/sql/relational-databases/system-stored-procedures/sp-helppeerresponses-transact-sql), providing the **@request_id** value retrieved in step b.</span></span> <span data-ttu-id="2b06d-284">Espere hasta que todos los nodos indiquen que han recibido la solicitud del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="2b06d-284">Wait until all nodes indicate they have received the peer request.</span></span> <span data-ttu-id="2b06d-285">Continúe en el paso e.</span><span class="sxs-lookup"><span data-stu-id="2b06d-285">Go to step e.</span></span>  
  
    5.  <span data-ttu-id="2b06d-286">Vuelva a crear la suscripción en la base de datos **B** a la publicación de la base de datos **C**, especificando que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-286">Re-create the subscription at database **B** to the publication at database **C**, specifying that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-287">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-287">Go to step b.</span></span>  
  
    6.  <span data-ttu-id="2b06d-288">Vuelva a crear la suscripción en la base de datos **C** a la publicación de la base de datos **B**, especificando que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-288">Re-create the subscription at database **C** to the publication at database **B**, specifying that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-289">Vaya al paso 13.</span><span class="sxs-lookup"><span data-stu-id="2b06d-289">Go to step 13.</span></span>  
  
12. <span data-ttu-id="2b06d-290">Vuelva a crear la suscripción entre las bases de datos **B** y **C**:</span><span class="sxs-lookup"><span data-stu-id="2b06d-290">Re-create the subscription between databases **B** and **C**:</span></span>  
  
    1.  <span data-ttu-id="2b06d-291">En la base de datos **B**, consulte la tabla [MSpeer_lsns](/sql/relational-databases/system-tables/mspeer-lsns-transact-sql) para recuperar el número de secuencia de registro (LSN) de la más reciente transacción que ha recibido la base de datos **B** de la base de datos **C**.</span><span class="sxs-lookup"><span data-stu-id="2b06d-291">At database **B**, query the [MSpeer_lsns](/sql/relational-databases/system-tables/mspeer-lsns-transact-sql) table to retrieve the log sequence number (LSN) of the most recent transaction that database **B** has received from database **C**.</span></span>  
  
    2.  <span data-ttu-id="2b06d-292">Vuelva a crear la suscripción de la base de datos **B** a la publicación de la base de datos **C**, especificando que la suscripción debe inicializarse basándose en LSN (el valor **Initialize from lsn** para el **@sync_type** parámetro de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="2b06d-292">Re-create the subscription at database **B** to the publication at database **C**, specifying that the subscription should be initialized based on LSN (a value of **initialize from lsn** for the **@sync_type** parameter of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)).</span></span> <span data-ttu-id="2b06d-293">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-293">Go to step b.</span></span>  
  
    3.  <span data-ttu-id="2b06d-294">Vuelva a crear la suscripción en la base de datos **C** a la publicación de la base de datos **B**, especificando que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-294">Re-create the subscription at database **C** to the publication at database **B**, specifying that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-295">Vaya al paso 13.</span><span class="sxs-lookup"><span data-stu-id="2b06d-295">Go to step 13.</span></span>  
  
13. <span data-ttu-id="2b06d-296">Ejecute los agentes de distribución para sincronizar las suscripciones en las bases de datos **B** y **C**. La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-296">Run the Distribution Agents to synchronize the subscriptions at databases **B** and **C**. The restore is completed.</span></span>  
  
#### <a name="msdb-database-publisher"></a><span data-ttu-id="2b06d-297">Base de datos msdb (publicador)</span><span class="sxs-lookup"><span data-stu-id="2b06d-297">msdb Database (Publisher)</span></span>  
  
1.  <span data-ttu-id="2b06d-298">Restaure la última copia de seguridad de la base de datos **msdb** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-298">Restore the latest backup of the **msdb** database.</span></span>  
  
2.  <span data-ttu-id="2b06d-299">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-299">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-300">¿Contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-300">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-301">En caso afirmativo, la recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-301">If yes, recovery is completed.</span></span> <span data-ttu-id="2b06d-302">En caso contrario, continúe en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-302">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="2b06d-303">Vuelva a crear el trabajo de limpieza de suscripción a partir de los scripts de replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-303">Re-create the subscription cleanup job from your replication scripts.</span></span> <span data-ttu-id="2b06d-304">La recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-304">Recovery is completed.</span></span>  
  
#### <a name="master-database-publisher"></a><span data-ttu-id="2b06d-305">Base de datos maestra (publicador)</span><span class="sxs-lookup"><span data-stu-id="2b06d-305">master Database (Publisher)</span></span>  
  
1.  <span data-ttu-id="2b06d-306">Restaure la última copia de seguridad de la base de datos **master** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-306">Restore the latest backup of the **master** database.</span></span>  
  
2.  <span data-ttu-id="2b06d-307">Asegúrese de que la base de datos sea coherente con la base de datos de publicación en términos de configuración general y configuración de la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-307">Make sure that the database is consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
### <a name="databases-at-the-distributor"></a><span data-ttu-id="2b06d-308">Bases de datos del distribuidor</span><span class="sxs-lookup"><span data-stu-id="2b06d-308">Databases at the Distributor</span></span>  
  
#### <a name="distribution-database"></a><span data-ttu-id="2b06d-309">Base de datos de distribución</span><span class="sxs-lookup"><span data-stu-id="2b06d-309">Distribution Database</span></span>  
  
1.  <span data-ttu-id="2b06d-310">Restaure la última copia de seguridad de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-310">Restore the latest backup of the distribution database.</span></span>  
  
2.  <span data-ttu-id="2b06d-311">¿Estaba habilitada la opción **sync with backup** en la base de datos de distribución antes del error?</span><span class="sxs-lookup"><span data-stu-id="2b06d-311">Was the **sync with backup** setting enabled on the distribution database before the failure?</span></span> <span data-ttu-id="2b06d-312">En caso afirmativo, vaya al paso 3; de lo contrario, continúe en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-312">If yes, go to step 3; if no, go to step 4.</span></span>  
  
     <span data-ttu-id="2b06d-313">Si la opción está habilitada, la consulta `SELECT DATABASEPROPERTYEX('<DistributionDatabaseName>', 'IsSyncWithBackup')` devuelve '1'.</span><span class="sxs-lookup"><span data-stu-id="2b06d-313">If the setting is enabled, the query `SELECT DATABASEPROPERTYEX('<DistributionDatabaseName>', 'IsSyncWithBackup')` returns '1'.</span></span>  
  
3.  <span data-ttu-id="2b06d-314">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-314">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-315">¿Contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-315">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-316">En caso afirmativo, la recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-316">If yes, recovery is completed.</span></span> <span data-ttu-id="2b06d-317">De lo contrario, continúe en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-317">If no, go to step 4.</span></span>  
  
4.  <span data-ttu-id="2b06d-318">O bien la información de configuración en la base de datos de distribución restaurada no está actualizada o la opción **sync with backup** no se estableció en la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-318">Either the configuration information in the restored distribution database is not up-to-date, or the **sync with backup** option was not set on the distribution database.</span></span> <span data-ttu-id="2b06d-319">(Después de la restauración, a la base de datos de distribución le podrían faltar transacciones que se confirmaron en el publicador pero no se entregaron todavía a suscriptores.) Quite y vuelva a crear la replicación y después, ejecute la validación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-319">(After the restore, the distribution database might be missing transactions that were committed at the Publisher but have not yet been delivered to Subscribers.) Drop and re-create replication, and then run validation.</span></span>  
  
    1.  <span data-ttu-id="2b06d-320">Quite la configuración de replicación del publicador, el distribuidor y los suscriptores, y vuelva a crear la configuración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-320">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="2b06d-321">Al volver a crear las suscripciones, especifique que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-321">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-322">Continúe en el paso b.</span><span class="sxs-lookup"><span data-stu-id="2b06d-322">Go to step b.</span></span>  
  
         <span data-ttu-id="2b06d-323">Para más información sobre cómo quitar la replicación, vea [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b06d-323">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
         <span data-ttu-id="2b06d-324">Para obtener más información acerca de cómo especificar que el suscriptor ya tiene los datos, vea [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-324">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
    2.  <span data-ttu-id="2b06d-325">Marque todas las publicaciones para validación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-325">Mark all publications for validation.</span></span> <span data-ttu-id="2b06d-326">Reinicialice todas las suscripciones que no superen la validación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-326">Reinitialize any subscriptions that fail validation.</span></span> <span data-ttu-id="2b06d-327">La recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-327">Recovery is completed.</span></span>  
  
         <span data-ttu-id="2b06d-328">Para obtener más información acerca de la validación, consulte [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-328">For more information about validation, see [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span></span> <span data-ttu-id="2b06d-329">Para más información sobre la reinicialización, vea [Reinicializar suscripciones](../reinitialize-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-329">For more information about reinitialization, see [Reinitialize Subscriptions](../reinitialize-subscriptions.md).</span></span>  
  
#### <a name="msdb-database-distributor"></a><span data-ttu-id="2b06d-330">Base de datos msdb (distribuidor)</span><span class="sxs-lookup"><span data-stu-id="2b06d-330">msdb Database (Distributor)</span></span>  
  
1.  <span data-ttu-id="2b06d-331">Restaure la última copia de seguridad de la base de datos **msdb** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-331">Restore the latest backup of the **msdb** database.</span></span>  
  
2.  <span data-ttu-id="2b06d-332">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-332">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-333">¿Contiene la configuración más reciente de todas las publicaciones y suscripciones?</span><span class="sxs-lookup"><span data-stu-id="2b06d-333">Does it contain the latest configuration for all publications and subscriptions?</span></span> <span data-ttu-id="2b06d-334">En caso afirmativo, la recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-334">If yes, recovery is completed.</span></span> <span data-ttu-id="2b06d-335">En caso contrario, continúe en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-335">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="2b06d-336">Quite la configuración de replicación del publicador, el distribuidor y los suscriptores, y vuelva a crear la configuración.</span><span class="sxs-lookup"><span data-stu-id="2b06d-336">Remove the replication configuration from the Publisher, Distributor and Subscribers, and then re-create the configuration.</span></span> <span data-ttu-id="2b06d-337">Al volver a crear las suscripciones, especifique que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-337">When you re-create subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-338">Vaya al paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-338">Go to step 4.</span></span>  
  
     <span data-ttu-id="2b06d-339">Para más información sobre cómo quitar la replicación, vea [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b06d-339">For more information about how to remove replication, see [sp_removedbreplication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-removedbreplication-transact-sql).</span></span>  
  
     <span data-ttu-id="2b06d-340">Para obtener más información acerca de cómo especificar que el suscriptor ya tiene los datos, vea [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-340">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
4.  <span data-ttu-id="2b06d-341">Marque todas las publicaciones para validación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-341">Mark all publications for validation.</span></span> <span data-ttu-id="2b06d-342">Reinicialice todas las suscripciones que no superen la validación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-342">Reinitialize any subscriptions that fail validation.</span></span> <span data-ttu-id="2b06d-343">La recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-343">Recovery is completed.</span></span>  
  
     <span data-ttu-id="2b06d-344">Para obtener más información acerca de la validación, consulte [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-344">For more information about validation, see [Validate Replicated Data](../validate-data-at-the-subscriber.md).</span></span> <span data-ttu-id="2b06d-345">Para más información sobre la reinicialización, vea [Reinicializar suscripciones](../reinitialize-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-345">For more information about reinitialization, see [Reinitialize Subscriptions](../reinitialize-subscriptions.md).</span></span>  
  
#### <a name="master-database-distributor"></a><span data-ttu-id="2b06d-346">Base de datos maestra (distribuidor)</span><span class="sxs-lookup"><span data-stu-id="2b06d-346">master Database (Distributor)</span></span>  
  
1.  <span data-ttu-id="2b06d-347">Restaure la última copia de seguridad de la base de datos **master** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-347">Restore the latest backup of the **master** database.</span></span>  
  
2.  <span data-ttu-id="2b06d-348">Asegúrese de que la base de datos sea coherente con la base de datos de publicación en términos de configuración general y configuración de la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-348">Make sure that the database is consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
### <a name="databases-at-the-subscriber"></a><span data-ttu-id="2b06d-349">Bases de datos del suscriptor</span><span class="sxs-lookup"><span data-stu-id="2b06d-349">Databases at the Subscriber</span></span>  
  
#### <a name="subscription-database"></a><span data-ttu-id="2b06d-350">Base de datos de suscripciones</span><span class="sxs-lookup"><span data-stu-id="2b06d-350">Subscription Database</span></span>  
  
1.  <span data-ttu-id="2b06d-351">¿La última copia de seguridad de la base de datos de suscripciones es más reciente que el período mínimo de retención de distribución en la base de datos de distribución?</span><span class="sxs-lookup"><span data-stu-id="2b06d-351">Is the latest subscription database backup more recent than the minimum distribution retention setting on the distribution database?</span></span> <span data-ttu-id="2b06d-352">(Esto determina si el distribuidor sigue teniendo todos los comandos que se exigen para actualizar el suscriptor). En caso afirmativo, continúe en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="2b06d-352">(This determines whether the Distributor still has all the commands that are required to bring the Subscriber up-to-date.) If yes, go to step 2.</span></span> <span data-ttu-id="2b06d-353">En caso contrario, reinicialice la suscripción.</span><span class="sxs-lookup"><span data-stu-id="2b06d-353">If no, reinitialize the subscription.</span></span> <span data-ttu-id="2b06d-354">La recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-354">Recovery is completed.</span></span>  
  
     <span data-ttu-id="2b06d-355">Para determinar el período máximo de retención de la distribución, ejecute [sp_helpdistributiondb](/sql/relational-databases/system-stored-procedures/sp-helpdistributiondb-transact-sql) y recupere el valor de la columna **max_distretention** (este valor está en horas).</span><span class="sxs-lookup"><span data-stu-id="2b06d-355">To determine the maximum distribution retention setting, execute [sp_helpdistributiondb](/sql/relational-databases/system-stored-procedures/sp-helpdistributiondb-transact-sql) and retrieve the value from the **max_distretention** column (this value is in hours).</span></span>  
  
     <span data-ttu-id="2b06d-356">Para obtener más información acerca de cómo reinicializar una suscripción, vea [Reinitialize a Subscription](../reinitialize-a-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-356">For more information about how to reinitialize a subscription, see [Reinitialize a Subscription](../reinitialize-a-subscription.md).</span></span>  
  
2.  <span data-ttu-id="2b06d-357">Restaure la última copia de seguridad de la base de datos de suscripciones.</span><span class="sxs-lookup"><span data-stu-id="2b06d-357">Restore the latest subscription database backup.</span></span> <span data-ttu-id="2b06d-358">Vaya al paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-358">Go to step 3.</span></span>  
  
3.  <span data-ttu-id="2b06d-359">Si la base de datos de suscripciones solo contiene las suscripciones de inserción, vaya al paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-359">If the subscription database contains only push subscriptions, go to step 4.</span></span> <span data-ttu-id="2b06d-360">Si la base de datos de suscripciones contiene cualquier suscripción de extracción, hágase las preguntas siguientes: ¿Está actualizada la información de suscripción?</span><span class="sxs-lookup"><span data-stu-id="2b06d-360">If the subscription database contains any pull subscriptions, ask the following questions: Is the subscription information current?</span></span> <span data-ttu-id="2b06d-361">¿La base de datos incluye todas las tablas y opciones que se establecieron en el momento del error?</span><span class="sxs-lookup"><span data-stu-id="2b06d-361">Does the database include all tables and options that were set at the time of failure.</span></span> <span data-ttu-id="2b06d-362">En caso afirmativo, continúe en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="2b06d-362">If yes, go to step 4.</span></span> <span data-ttu-id="2b06d-363">En caso contrario, reinicialice la suscripción.</span><span class="sxs-lookup"><span data-stu-id="2b06d-363">If no, reinitialize the subscription.</span></span> <span data-ttu-id="2b06d-364">La recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-364">Recovery is completed.</span></span>  
  
4.  <span data-ttu-id="2b06d-365">Para sincronizar el suscriptor, ejecute el Agente de distribución.</span><span class="sxs-lookup"><span data-stu-id="2b06d-365">To synchronize the Subscriber, run the Distribution Agent.</span></span> <span data-ttu-id="2b06d-366">La recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-366">Recovery is completed.</span></span>  
  
     <span data-ttu-id="2b06d-367">Para más información sobre cómo ejecutar el Agente de distribución, vea [Iniciar y detener un agente de replicación &#40;SQL Server Management Studio#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) y [Conceptos de los ejecutables del Agente de replicación](../concepts/replication-agent-executables-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-367">For more information about how to run the Distribution Agent, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../agents/start-and-stop-a-replication-agent-sql-server-management-studio.md) and [Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md).</span></span>  
  
#### <a name="msdb-database-subscriber"></a><span data-ttu-id="2b06d-368">Base de datos msdb (suscriptor)</span><span class="sxs-lookup"><span data-stu-id="2b06d-368">msdb Database (Subscriber)</span></span>  
  
1.  <span data-ttu-id="2b06d-369">Restaure la última copia de seguridad de la base de datos **msdb** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-369">Restore the latest backup of the **msdb** database.</span></span> <span data-ttu-id="2b06d-370">¿Se utilizan suscripciones de extracción en este suscriptor?</span><span class="sxs-lookup"><span data-stu-id="2b06d-370">Are pull subscriptions used at this Subscriber?</span></span> <span data-ttu-id="2b06d-371">Si no es así, la restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-371">If no, the restore is completed.</span></span> <span data-ttu-id="2b06d-372">En caso afirmativo, continúe en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="2b06d-372">If yes, go to step 2.</span></span>  
  
2.  <span data-ttu-id="2b06d-373">¿Está completa y actualizada la copia de seguridad restaurada?</span><span class="sxs-lookup"><span data-stu-id="2b06d-373">Is the restored backup complete and up-to-date?</span></span> <span data-ttu-id="2b06d-374">¿Contiene la configuración más reciente de todas las suscripciones de extracción?</span><span class="sxs-lookup"><span data-stu-id="2b06d-374">Does it contain the latest configuration for all pull subscriptions?</span></span> <span data-ttu-id="2b06d-375">En caso afirmativo, la recuperación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-375">If yes, recovery is completed.</span></span> <span data-ttu-id="2b06d-376">En caso contrario, continúe en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="2b06d-376">If no, go to step 3.</span></span>  
  
3.  <span data-ttu-id="2b06d-377">Quite y vuelva a crear todas las suscripciones de extracción.</span><span class="sxs-lookup"><span data-stu-id="2b06d-377">Drop and re-create the pull subscriptions.</span></span> <span data-ttu-id="2b06d-378">Al volver a crear las suscripciones, especifique que el suscriptor ya tiene los datos.</span><span class="sxs-lookup"><span data-stu-id="2b06d-378">When you re-create the subscriptions, specify that the Subscriber already has the data.</span></span> <span data-ttu-id="2b06d-379">La restauración se ha completado.</span><span class="sxs-lookup"><span data-stu-id="2b06d-379">The restore is completed.</span></span>  
  
     <span data-ttu-id="2b06d-380">Para obtener más información acerca de cómo quitar suscripciones, vea [Subscribe to Publications](../subscribe-to-publications.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-380">For more information about how to drop subscriptions, see [Subscribe to Publications](../subscribe-to-publications.md).</span></span>  
  
     <span data-ttu-id="2b06d-381">Para obtener más información acerca de cómo especificar que el suscriptor ya tiene los datos, vea [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="2b06d-381">For more information about how to specify that the Subscriber already has the data, see [Initialize a Subscription Manually](../initialize-a-subscription-manually.md).</span></span>  
  
#### <a name="master-database-subscriber"></a><span data-ttu-id="2b06d-382">Base de datos maestra (suscriptor)</span><span class="sxs-lookup"><span data-stu-id="2b06d-382">master Database (Subscriber)</span></span>  
  
1.  <span data-ttu-id="2b06d-383">Restaure la última copia de seguridad de la base de datos **master** .</span><span class="sxs-lookup"><span data-stu-id="2b06d-383">Restore the latest backup of the **master** database.</span></span>  
  
2.  <span data-ttu-id="2b06d-384">Asegúrese de que la base de datos sea coherente con la base de datos de publicación en términos de configuración general y configuración de la replicación.</span><span class="sxs-lookup"><span data-stu-id="2b06d-384">Make sure that the database is consistent with the publication database with regard to replication configuration and settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2b06d-385">Consulte también</span><span class="sxs-lookup"><span data-stu-id="2b06d-385">See Also</span></span>  
 <span data-ttu-id="2b06d-386">[Realizar copias de seguridad y restaurar bases de datos de SQL Server](../../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="2b06d-386">[Back Up and Restore of SQL Server Databases](../../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span></span>  
 <span data-ttu-id="2b06d-387">[Hacer copias de seguridad y restaurar bases de datos replicadas](back-up-and-restore-replicated-databases.md) </span><span class="sxs-lookup"><span data-stu-id="2b06d-387">[Back Up and Restore Replicated Databases](back-up-and-restore-replicated-databases.md) </span></span>  
 <span data-ttu-id="2b06d-388">[Configurar distribución](../configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="2b06d-388">[Configure Distribution](../configure-distribution.md) </span></span>  
 <span data-ttu-id="2b06d-389">[Publicar datos y objetos de base de datos](../publish/publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="2b06d-389">[Publish Data and Database Objects](../publish/publish-data-and-database-objects.md) </span></span>  
 <span data-ttu-id="2b06d-390">[Subscribe to Publications](../subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="2b06d-390">[Subscribe to Publications](../subscribe-to-publications.md) </span></span>  
 <span data-ttu-id="2b06d-391">[Initialize a Subscription](../initialize-a-subscription.md)  (Inicializar una suscripción)</span><span class="sxs-lookup"><span data-stu-id="2b06d-391">[Initialize a Subscription](../initialize-a-subscription.md) </span></span>  
 [<span data-ttu-id="2b06d-392">Sincronizar datos</span><span class="sxs-lookup"><span data-stu-id="2b06d-392">Synchronize Data</span></span>](../synchronize-data.md)  
  
  
