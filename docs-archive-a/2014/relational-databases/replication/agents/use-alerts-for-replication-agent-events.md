---
title: Usar alertas para eventos del Agente de replicación | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- viewing alerts
- Queue Reader Agent, alerts
- alerts [SQL Server replication]
- predefined replication alerts [SQL Server replication]
- Log Reader Agent, alerts
- Distribution Agent, alerts
- Merge Agent, alerts
- agents [SQL Server replication], alerts
- displaying alerts
- Snapshot Agent, alerts
ms.assetid: 8c42e523-7020-471d-8977-a0bd044b9471
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 9d3e30c0a8768a872dc86745ef986faec509c3c6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87663412"
---
# <a name="use-alerts-for-replication-agent-events"></a><span data-ttu-id="19a37-102">Usar alertas para eventos del Agente de replicación</span><span class="sxs-lookup"><span data-stu-id="19a37-102">Use Alerts for Replication Agent Events</span></span>
  [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="19a37-103">y el Agente [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proporcionan un modo de supervisar eventos, como eventos del agente de replicación, mediante alertas.</span><span class="sxs-lookup"><span data-stu-id="19a37-103">and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent provide a way to monitor events, such as replication agent events, using alerts.</span></span> <span data-ttu-id="19a37-104">El Agente[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] supervisa el registro de aplicación de Windows en busca de eventos que se asocian con alertas.</span><span class="sxs-lookup"><span data-stu-id="19a37-104">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent monitors the Windows application log for events that are associated with alerts.</span></span> <span data-ttu-id="19a37-105">Si se produce uno de esos eventos, el Agente [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] responde automáticamente, mediante la ejecución de una tarea que haya sido definida y/o el envío de un mensaje de correo electrónico o de buscapersonas a un operador especificado.</span><span class="sxs-lookup"><span data-stu-id="19a37-105">If such an event occurs, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent responds automatically, by executing a task that you have defined and/or sending e-mail or a pager message to a specified operator.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="19a37-106">incluye un conjunto de alertas predefinidas para los agentes de replicación que puede configurar para ejecutar una tarea y/o notificar a un operador.</span><span class="sxs-lookup"><span data-stu-id="19a37-106">includes a set of predefined alerts for replication agents that you can configure to execute a task and/or notify an operator.</span></span> <span data-ttu-id="19a37-107">Para obtener más información sobre cómo definir la ejecución de una tarea, vea la sección "Automatizar la respuesta a una alerta" en este tema.</span><span class="sxs-lookup"><span data-stu-id="19a37-107">For more information about defining a task to execute, see the section "Automating a Response to an Alert" in this topic.</span></span>  
  
 <span data-ttu-id="19a37-108">Las siguientes alertas se instalan cuando un equipo se configura como distribuidor:</span><span class="sxs-lookup"><span data-stu-id="19a37-108">The following alerts are installed when a computer is configured as a Distributor:</span></span>  
  
|<span data-ttu-id="19a37-109">Id. del mensaje</span><span class="sxs-lookup"><span data-stu-id="19a37-109">Message ID</span></span>|<span data-ttu-id="19a37-110">Alerta predefinida</span><span class="sxs-lookup"><span data-stu-id="19a37-110">Predefined alert</span></span>|<span data-ttu-id="19a37-111">Condición que desencadena la alerta</span><span class="sxs-lookup"><span data-stu-id="19a37-111">Condition causing the alert to fire</span></span>|<span data-ttu-id="19a37-112">Especifica información adicional en msdb..sysreplicationalerts</span><span class="sxs-lookup"><span data-stu-id="19a37-112">Enters additional information in msdb..sysreplicationalerts</span></span>|  
|----------------|----------------------|-----------------------------------------|-----------------------------------------------------------------|  
|<span data-ttu-id="19a37-113">14150</span><span class="sxs-lookup"><span data-stu-id="19a37-113">14150</span></span>|<span data-ttu-id="19a37-114">**Replicación: éxito de agente**</span><span class="sxs-lookup"><span data-stu-id="19a37-114">**Replication: agent success**</span></span>|<span data-ttu-id="19a37-115">Un agente termina correctamente.</span><span class="sxs-lookup"><span data-stu-id="19a37-115">Agent shuts down successfully.</span></span>|<span data-ttu-id="19a37-116">Sí</span><span class="sxs-lookup"><span data-stu-id="19a37-116">Yes</span></span>|  
|<span data-ttu-id="19a37-117">14151</span><span class="sxs-lookup"><span data-stu-id="19a37-117">14151</span></span>|<span data-ttu-id="19a37-118">**Replicación: error de agente**</span><span class="sxs-lookup"><span data-stu-id="19a37-118">**Replication: agent failure**</span></span>|<span data-ttu-id="19a37-119">Un agente termina con un error.</span><span class="sxs-lookup"><span data-stu-id="19a37-119">Agent shuts down with an error.</span></span>|<span data-ttu-id="19a37-120">Sí</span><span class="sxs-lookup"><span data-stu-id="19a37-120">Yes</span></span>|  
|<span data-ttu-id="19a37-121">14152</span><span class="sxs-lookup"><span data-stu-id="19a37-121">14152</span></span>|<span data-ttu-id="19a37-122">**Replicación: reintento de agente**</span><span class="sxs-lookup"><span data-stu-id="19a37-122">**Replication: agent retry**</span></span>|<span data-ttu-id="19a37-123">El agente termina después de volver a intentar sin éxito una operación (el agente encuentra un error, por ejemplo que el servidor no está disponible, interbloqueo, error en la conexión o error de tiempo de espera).</span><span class="sxs-lookup"><span data-stu-id="19a37-123">Agent shuts down after unsuccessfully retrying an operation (agent encounters an error such as server not available, deadlock, connection failure, or time-out failure).</span></span>|<span data-ttu-id="19a37-124">Sí</span><span class="sxs-lookup"><span data-stu-id="19a37-124">Yes</span></span>|  
|<span data-ttu-id="19a37-125">14157</span><span class="sxs-lookup"><span data-stu-id="19a37-125">14157</span></span>|<span data-ttu-id="19a37-126">**Replicación: suscripción expirada quitada**</span><span class="sxs-lookup"><span data-stu-id="19a37-126">**Replication: expired subscription dropped**</span></span>|<span data-ttu-id="19a37-127">Se quitó la suscripción expirada.</span><span class="sxs-lookup"><span data-stu-id="19a37-127">Expired subscription was dropped.</span></span>|<span data-ttu-id="19a37-128">No</span><span class="sxs-lookup"><span data-stu-id="19a37-128">No</span></span>|  
|<span data-ttu-id="19a37-129">20572</span><span class="sxs-lookup"><span data-stu-id="19a37-129">20572</span></span>|<span data-ttu-id="19a37-130">**Replicación: Suscripción reinicializada por no pasar la validación**</span><span class="sxs-lookup"><span data-stu-id="19a37-130">**Replication: Subscription reinitialized after validation failure**</span></span>|<span data-ttu-id="19a37-131">El trabajo de respuesta "Reinicializar suscripciones con errores de validación de datos" reinicializa correctamente una suscripción.</span><span class="sxs-lookup"><span data-stu-id="19a37-131">Response job 'Reinitialize subscriptions on data validation failure' reinitializes a subscription successfully.</span></span>|<span data-ttu-id="19a37-132">No</span><span class="sxs-lookup"><span data-stu-id="19a37-132">No</span></span>|  
|<span data-ttu-id="19a37-133">20574</span><span class="sxs-lookup"><span data-stu-id="19a37-133">20574</span></span>|<span data-ttu-id="19a37-134">**Replicación: el suscriptor no ha superado la validación de datos**</span><span class="sxs-lookup"><span data-stu-id="19a37-134">**Replication: Subscriber has failed data validation**</span></span>|<span data-ttu-id="19a37-135">Un agente de distribución o de mezcla no puede validar los datos.</span><span class="sxs-lookup"><span data-stu-id="19a37-135">Distribution or Merge Agent fails data validation.</span></span>|<span data-ttu-id="19a37-136">Sí</span><span class="sxs-lookup"><span data-stu-id="19a37-136">Yes</span></span>|  
|<span data-ttu-id="19a37-137">20575</span><span class="sxs-lookup"><span data-stu-id="19a37-137">20575</span></span>|<span data-ttu-id="19a37-138">**Replicación: El suscriptor ha pasado la validación de datos**</span><span class="sxs-lookup"><span data-stu-id="19a37-138">**Replication: Subscriber has passed data validation**</span></span>|<span data-ttu-id="19a37-139">Un agente de distribución o de mezcla pasa la validación de los datos.</span><span class="sxs-lookup"><span data-stu-id="19a37-139">Distribution or Merge Agent passes data validation.</span></span>|<span data-ttu-id="19a37-140">Sí</span><span class="sxs-lookup"><span data-stu-id="19a37-140">Yes</span></span>|  
|<span data-ttu-id="19a37-141">20578</span><span class="sxs-lookup"><span data-stu-id="19a37-141">20578</span></span>|<span data-ttu-id="19a37-142">**Replicación: cierre personalizado del agente**</span><span class="sxs-lookup"><span data-stu-id="19a37-142">**Replication: agent custom shutdown**</span></span>|||  
|<span data-ttu-id="19a37-143">22815</span><span class="sxs-lookup"><span data-stu-id="19a37-143">22815</span></span>|<span data-ttu-id="19a37-144">**Alerta de detección de conflictos punto a punto**</span><span class="sxs-lookup"><span data-stu-id="19a37-144">**Peer-to-peer conflict detection alert**</span></span>|<span data-ttu-id="19a37-145">El Agente de distribución detecta un conflicto cuando intenta aplicar un cambio en un nodo punto a punto.</span><span class="sxs-lookup"><span data-stu-id="19a37-145">Distribution Agent detected a conflict when it tries to apply a change at a peer-to-peer node.</span></span>|<span data-ttu-id="19a37-146">Sí</span><span class="sxs-lookup"><span data-stu-id="19a37-146">Yes</span></span>|  
  
 <span data-ttu-id="19a37-147">Además de estas alertas, el Monitor de replicación proporciona una serie de advertencias y alertas relacionadas con el estado y el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="19a37-147">In addition to these alerts, Replication Monitor provides a set of warnings and alerts related to status and performance.</span></span> <span data-ttu-id="19a37-148">Para obtener más información, vea [establecer umbrales y advertencias en la infraestructura de alertas del monitor de replicación](../monitor/set-thresholds-and-warnings-in-replication-monitor.md) .</span><span class="sxs-lookup"><span data-stu-id="19a37-148">For more information, see [Set Thresholds and Warnings in Replication Monitor](../monitor/set-thresholds-and-warnings-in-replication-monitor.md) alerts infrastructure.</span></span> <span data-ttu-id="19a37-149">Para obtener más información, consulte [Create a User-Defined Event](../../../ssms/agent/create-a-user-defined-event.md) (Crear un evento definido por el usuario).</span><span class="sxs-lookup"><span data-stu-id="19a37-149">For more information, see [Create a User-Defined Event](../../../ssms/agent/create-a-user-defined-event.md).</span></span>  
  
 <span data-ttu-id="19a37-150">**Para configurar las alertas de replicación predefinidas**</span><span class="sxs-lookup"><span data-stu-id="19a37-150">**To configure predefined replication alerts**</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]<span data-ttu-id="19a37-151">: [Configurar alertas de replicación predefinidas &#40;SQL Server Management Studio&#41;](../administration/configure-predefined-replication-alerts-sql-server-management-studio.md)</span><span class="sxs-lookup"><span data-stu-id="19a37-151">: [Configure Predefined Replication Alerts &#40;SQL Server Management Studio&#41;](../administration/configure-predefined-replication-alerts-sql-server-management-studio.md)</span></span>  
  
## <a name="viewing-the-application-log-directly"></a><span data-ttu-id="19a37-152">Ver directamente el registro de aplicación</span><span class="sxs-lookup"><span data-stu-id="19a37-152">Viewing the Application Log Directly</span></span>  
 <span data-ttu-id="19a37-153">Para ver el registro de aplicación Windows, utilice el Visor de eventos de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows.</span><span class="sxs-lookup"><span data-stu-id="19a37-153">To view the Windows application log, use the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Event Viewer.</span></span> <span data-ttu-id="19a37-154">El registro de aplicación contiene mensajes de error de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] así como mensajes de muchas otras actividades del equipo.</span><span class="sxs-lookup"><span data-stu-id="19a37-154">The application log contains [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] error messages as well as messages for many other activities on the computer.</span></span> <span data-ttu-id="19a37-155">A diferencia del registro de errores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , no se crea un nuevo registro de aplicación cada vez que se inicia [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (cada sesión de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] escribe nuevos eventos en un registro de aplicación existente); no obstante, puede especificar durante cuánto tiempo desea mantener los eventos registrados.</span><span class="sxs-lookup"><span data-stu-id="19a37-155">Unlike the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] error log, a new application log is not created each time you start [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] session writes new events to an existing application log); however, you can specify how long logged events will be retained.</span></span> <span data-ttu-id="19a37-156">Al ver un registro de aplicación Windows, puede filtrar el registro en busca de eventos específicos.</span><span class="sxs-lookup"><span data-stu-id="19a37-156">When you view the Windows application log, you can filter the log for specific events.</span></span> <span data-ttu-id="19a37-157">Para obtener más información, consulte la documentación de Windows.</span><span class="sxs-lookup"><span data-stu-id="19a37-157">For more information, see the Windows documentation.</span></span>  
  
## <a name="automating-a-response-to-an-alert"></a><span data-ttu-id="19a37-158">Automatizar la respuesta a una alerta</span><span class="sxs-lookup"><span data-stu-id="19a37-158">Automating a Response to an Alert</span></span>  
 <span data-ttu-id="19a37-159">La replicación proporciona un trabajo de respuesta para las suscripciones que no pueden validar los datos y también proporciona un marco de trabajo para la creación de respuestas automatizadas adicionales a las alertas.</span><span class="sxs-lookup"><span data-stu-id="19a37-159">Replication provides a response job for subscriptions that fail data validation, and also provides a framework for creating additional automated responses to alerts.</span></span> <span data-ttu-id="19a37-160">El trabajo de respuesta se llama **Reinicializar suscripciones con errores de validación de datos** y se almacena en la carpeta [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Trabajos **del Agente** en [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="19a37-160">The response job is titled **Reinitialize subscriptions on data validation failure** and is stored in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent **Jobs** folder in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="19a37-161">Para obtener información sobre cómo habilitar este trabajo de respuesta, consulte [Configure Predefined Replication Alerts &#40;SQL Server Management Studio&#41;](../administration/configure-predefined-replication-alerts-sql-server-management-studio.md) (Configurar alertas predefinidas de replicación [SQL Server Management Studio]).</span><span class="sxs-lookup"><span data-stu-id="19a37-161">For information about enabling this response job, see [Configure Predefined Replication Alerts &#40;SQL Server Management Studio&#41;](../administration/configure-predefined-replication-alerts-sql-server-management-studio.md).</span></span> <span data-ttu-id="19a37-162">Si se produce un error en la validación de los artículos de una publicación transacional, el trabajo de respuesta reinicializa únicamente aquellos artículos que no se hayan validado.</span><span class="sxs-lookup"><span data-stu-id="19a37-162">If articles in a transactional publication fail validation, the response job reinitializes only those articles that failed.</span></span> <span data-ttu-id="19a37-163">Si se produce un error en la validación de los artículos de una publicación de combinación, el trabajo de respuesta reinicializa todos los artículos de la publicación.</span><span class="sxs-lookup"><span data-stu-id="19a37-163">If articles in a merge publication fail validation, the response job reinitializes all articles in the publication.</span></span>  
  
### <a name="framework-for-automating-responses"></a><span data-ttu-id="19a37-164">Marco de trabajo para la automatización de respuestas</span><span class="sxs-lookup"><span data-stu-id="19a37-164">Framework for Automating Responses</span></span>  
 <span data-ttu-id="19a37-165">Normalmente, cuando se produce una alerta, la única información de que dispone para comprender qué la ha provocado y la acción más apropiada que puede llevar a cabo está contenida en el propio mensaje de la alerta.</span><span class="sxs-lookup"><span data-stu-id="19a37-165">Usually, when an alert occurs, the only information you have to help you understand what caused the alert and the appropriate action to take is contained in the alert message itself.</span></span> <span data-ttu-id="19a37-166">El análisis de esta información puede estar sujeta a errores y lleva mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="19a37-166">Parsing this information can be error-prone and time-consuming.</span></span> <span data-ttu-id="19a37-167">La replicación facilita la automatización de respuestas al proporcionar información adicional sobre la alerta en la tabla del sistema **sysreplicationalerts** ; la información que se proporciona ya está analizada de una forma que los programas personalizados pueden utilizar fácilmente.</span><span class="sxs-lookup"><span data-stu-id="19a37-167">Replication makes automating responses easier by providing additional information about the alert in the **sysreplicationalerts** system table; the information provided is already parsed in a form easily used by customized programs.</span></span>  
  
 <span data-ttu-id="19a37-168">Por ejemplo, si se produce un error al validar los datos de la tabla **Sales.SalesOrderHeader** en el suscriptor A, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede desencadenar el mensaje 20574, que le notifica dicho error.</span><span class="sxs-lookup"><span data-stu-id="19a37-168">For example, if the data in the **Sales.SalesOrderHeader** table at Subscriber A fails validation, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can trigger message 20574, notifying you of that failure.</span></span> <span data-ttu-id="19a37-169">El mensaje que reciba será: "La suscripción del suscriptor 'A' al artículo 'SalesOrderHeader' de la publicación 'MyPublication', no pasó la validación de datos."</span><span class="sxs-lookup"><span data-stu-id="19a37-169">The message you receive will be: "Subscriber 'A', subscription to article 'SalesOrderHeader' in publication 'MyPublication' failed data validation."</span></span>  
  
 <span data-ttu-id="19a37-170">Si crea un trabajo de respuesta basado en el mensaje, debe analizar manualmente el nombre del suscriptor, el nombre del artículo, el nombre de la publicación y el error del mensaje.</span><span class="sxs-lookup"><span data-stu-id="19a37-170">If you create a response based on the message, you must manually parse the Subscriber name, article name, publication name, and error from the message.</span></span> <span data-ttu-id="19a37-171">Sin embargo, como el Agente de distribución y el Agente de mezcla escriben la misma información en **sysreplicationalerts** (junto con detalles como el tipo de agente, la hora de la alerta, la base de datos de publicaciones, la base de datos del suscriptor y el tipo de publicación), el trabajo de respuesta puede consultar directamente la información relevante en dicha tabla.</span><span class="sxs-lookup"><span data-stu-id="19a37-171">However, because the Distribution Agent and Merge Agent write that same information to **sysreplicationalerts** (along with details such as the type of agent, time of the alert, publication database, Subscriber database, and type of publication) the response job can directly query the relevant information from the table.</span></span> <span data-ttu-id="19a37-172">Aunque la fila exacta no puede asociarse con una instancia específica de la alerta, la tabla tiene una columna **status** que se puede utilizar para realizar un seguimiento de las entradas atendidas.</span><span class="sxs-lookup"><span data-stu-id="19a37-172">Although the exact row cannot be associated with a specific instance of the alert, the table has a **status** column, which can be used to keep track of serviced entries.</span></span> <span data-ttu-id="19a37-173">Las entradas de esta tabla se mantienen durante el período de retención del historial.</span><span class="sxs-lookup"><span data-stu-id="19a37-173">The entries in this table are maintained for the history retention period.</span></span>  
  
 <span data-ttu-id="19a37-174">Por ejemplo, si creara un trabajo de respuesta en [!INCLUDE[tsql](../../../includes/tsql-md.md)] para dar servicio al mensaje de alerta 20574, podría utilizar la lógica siguiente:</span><span class="sxs-lookup"><span data-stu-id="19a37-174">For example, if you were to create a response job in [!INCLUDE[tsql](../../../includes/tsql-md.md)] that services alert message 20574, you might use the following logic:</span></span>  
  
```  
declare @publisher sysname, @publisher_db sysname, @publication sysname, @publication_type int, @article sysname, @subscriber sysname, @subscriber_db sysname, @alert_id int  
declare hc cursor local for select publisher, publisher_db, publication, publication_type, article, subscriber,   
  subscriber_db, alert_id from   
  msdb..sysreplicationalerts where  
  alert_error_code = 20574 and status = 0  
  for read only  
open hc  
fetch hc into  @publisher, @publisher_db, @publication, @publication_type, @article, @subscriber, @subscriber_db, @alert_id  
while (@@fetch_status <> -1)  
begin  
/* Do custom work  */  
/* Update status to 1, which means the alert has been serviced. This prevents subsequent runs of this job from doing this again */  
update msdb..sysreplicationalerts set status = 1 where alert_id = @alert_id  
 fetch hc into  @publisher, @publisher_db, @publication, @publication_type, @article, @subscriber, @subscriber_db, @alert_id  
end  
close hc  
deallocate hc  
```  
  
## <a name="see-also"></a><span data-ttu-id="19a37-175">Consulte también</span><span class="sxs-lookup"><span data-stu-id="19a37-175">See Also</span></span>  
 <span data-ttu-id="19a37-176">[Administración del Agente de replicación](replication-agent-administration.md) </span><span class="sxs-lookup"><span data-stu-id="19a37-176">[Replication Agent Administration](replication-agent-administration.md) </span></span>  
 <span data-ttu-id="19a37-177">[Prácticas recomendadas para la administración de replicación](../administration/best-practices-for-replication-administration.md) </span><span class="sxs-lookup"><span data-stu-id="19a37-177">[Best Practices for Replication Administration](../administration/best-practices-for-replication-administration.md) </span></span>  
 [<span data-ttu-id="19a37-178">Supervisar (replicación)</span><span class="sxs-lookup"><span data-stu-id="19a37-178">Monitoring &#40;Replication&#41;</span></span>](../monitoring-replication.md)  
  
  
