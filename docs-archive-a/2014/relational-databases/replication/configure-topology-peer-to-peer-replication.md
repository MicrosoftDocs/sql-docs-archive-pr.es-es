---
title: Configuración de topología (replicación punto a punto) | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql12.rep.p2pwizard.peers.f1
ms.assetid: 5377c59f-2e25-4852-a306-c87ae3dca9fd
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2dfc09f5ae7f488afd46f29c301d11b7687e0a4b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87662845"
---
# <a name="configure-topology-peer-to-peer-replication"></a><span data-ttu-id="a9653-102">Configurar topología (replicación punto a punto)</span><span class="sxs-lookup"><span data-stu-id="a9653-102">Configure Topology (Peer-to-Peer Replication)</span></span>
  <span data-ttu-id="a9653-103">Utilice la página **Configurar topología** para realizar las tareas de configuración comunes, como agregar nuevos nodos, eliminando nodos y agregar las nuevas conexiones entre los nodos existentes.</span><span class="sxs-lookup"><span data-stu-id="a9653-103">Use the **Configure topology** page to perform common configuration tasks, such as adding new nodes, deleting nodes, and adding new connections between existing nodes.</span></span> <span data-ttu-id="a9653-104">El nodo que seleccionó en la página **Publicación** de este asistente se muestra en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-104">The node you selected on the **Publication** page of this wizard is displayed on the design surface.</span></span> <span data-ttu-id="a9653-105">Para especificar las opciones de configuración, haga clic con el botón secundario en un nodo, una conexión o la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-105">To specify configuration options, right-click a node, a connection, or the design surface.</span></span>

> [!NOTE]
>  <span data-ttu-id="a9653-106">El Asistente de configuración de la topología punto a punto solicita información de la topología cuando se cierra el asistente.</span><span class="sxs-lookup"><span data-stu-id="a9653-106">The Configure Peer to Peer Topology Wizard requests topology information when the wizard is closed.</span></span> <span data-ttu-id="a9653-107">Si el asistente se cierra y se vuelve a abrir antes de que todos los nodos respondan a la solicitud de información, el asistente puede mostrar una red parcial.</span><span class="sxs-lookup"><span data-stu-id="a9653-107">If the wizard is closed and reopened before all nodes respond to the request for information, the wizard might show a partial network.</span></span>

## <a name="options"></a><span data-ttu-id="a9653-108">Opciones</span><span class="sxs-lookup"><span data-stu-id="a9653-108">Options</span></span>
 <span data-ttu-id="a9653-109">La página **Configurar topología** contiene los elementos de interfaz y las opciones que están disponibles al hacer clic con el botón secundario en un elemento.</span><span class="sxs-lookup"><span data-stu-id="a9653-109">The **Configure topology** page contains interface elements and options that are available when you right-click an element.</span></span> <span data-ttu-id="a9653-110">En la tabla siguiente se describe cada elemento de interfaz.</span><span class="sxs-lookup"><span data-stu-id="a9653-110">The following table describes each interface element.</span></span>

|<span data-ttu-id="a9653-111">Elemento de interfaz.</span><span class="sxs-lookup"><span data-stu-id="a9653-111">Interface Element</span></span>|<span data-ttu-id="a9653-112">Descripción</span><span class="sxs-lookup"><span data-stu-id="a9653-112">Description</span></span>|
|-----------------------|-----------------|
|<span data-ttu-id="a9653-113">Superficie de diseño</span><span class="sxs-lookup"><span data-stu-id="a9653-113">Design surface</span></span>|<span data-ttu-id="a9653-114">Muestra otros elementos de interfaz.</span><span class="sxs-lookup"><span data-stu-id="a9653-114">Displays other interface elements.</span></span> <span data-ttu-id="a9653-115">Para agregar elementos, haga clic con el botón secundario en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-115">To add elements, right-click the design surface.</span></span>|
|<span data-ttu-id="a9653-116">![El primer nodo de una topología](media/p2pwizard-firstnode.gif "El primer nodo de una topología")</span><span class="sxs-lookup"><span data-stu-id="a9653-116">![The first node in a topology](media/p2pwizard-firstnode.gif "The first node in a topology")</span></span>|<span data-ttu-id="a9653-117">El nodo original en la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-117">The original node in the topology.</span></span> <span data-ttu-id="a9653-118">Los nodos nuevos se inicializan utilizando una copia de la base de datos de publicación del nodo original.</span><span class="sxs-lookup"><span data-stu-id="a9653-118">New nodes are initialized by using a copy of the publication database from the original node.</span></span>|
|<span data-ttu-id="a9653-119">![Un nodo para el que se ha completado la información](media/p2pwizard-complete.gif "Un nodo sobre el que se dispone de información completa") o una versión posterior, para la que la replicación tiene información completa.</span><span class="sxs-lookup"><span data-stu-id="a9653-119">![A node for which we have complete information](media/p2pwizard-complete.gif "A node for which we have complete information") or a later version, for which replication has complete information.</span></span> <span data-ttu-id="a9653-120">Para especificar las opciones de configuración, haga clic con el botón secundario en el nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-120">To specify configuration options, right-click the node.</span></span>|
|<span data-ttu-id="a9653-121">![Un nodo sobre el que se dispone de información incompleta](media/p2pwizard-incomplete.gif "Un nodo sobre el que se dispone de información incompleta")</span><span class="sxs-lookup"><span data-stu-id="a9653-121">![A node for which we have incomplete information](media/p2pwizard-incomplete.gif "A node for which we have incomplete information")</span></span>|<span data-ttu-id="a9653-122">Un nodo para el que la replicación tiene información incompleta.</span><span class="sxs-lookup"><span data-stu-id="a9653-122">A node for which replication has incomplete information.</span></span> <span data-ttu-id="a9653-123">Para especificar las opciones de configuración, haga clic con el botón secundario en el nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-123">To specify configuration options, right-click the node.</span></span> <span data-ttu-id="a9653-124">La replicación tiene información incompleta debido a una de las razones siguientes:</span><span class="sxs-lookup"><span data-stu-id="a9653-124">Replication has incomplete information because of one of the following reasons:</span></span><br /><br /> <span data-ttu-id="a9653-125">El nodo está ejecutando una instancia de [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], que no almacena todos los metadatos requerida por el asistente.</span><span class="sxs-lookup"><span data-stu-id="a9653-125">The node is running an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], which does not store all the metadata required by the wizard.</span></span><br /><br /> <span data-ttu-id="a9653-126">El nodo está ejecutando una versión posterior de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], pero la replicación no puede recuperar información de la suscripción del nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-126">The node is running a later version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but replication cannot retrieve subscription information from the node.</span></span> <span data-ttu-id="a9653-127">Para solucionar esta situación:</span><span class="sxs-lookup"><span data-stu-id="a9653-127">To troubleshoot this situation:</span></span><br /><span data-ttu-id="a9653-128">-Asegúrese de que la base de datos del nodo está en línea y de que puede conectarse a ella con las mismas credenciales que los agentes de distribución que se conectan al nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-128">-Make sure that the database at the node is online and that you can connect to it by using the same credentials as the Distribution Agents that connect to the node.</span></span><br /><span data-ttu-id="a9653-129">-Asegúrese de que se estén ejecutando el Agente de registro del LOG y todos los agentes de distribución que se conectan al nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-129">-Make sure that the Log Reader Agent and all Distribution Agents that connect to the node are running.</span></span><br /><span data-ttu-id="a9653-130">-Asegúrese de que el tiempo de espera de actualización esté establecido en el valor suficientemente alto para recopilar toda la información de la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-130">-Make sure that the refresh timeout is set high enough to gather all topology information.</span></span> <span data-ttu-id="a9653-131">Para establecer el tiempo de espera, haga clic con el botón secundario en la superficie de diseño y haga clic en **Establecer tiempo de espera de la actualización**.</span><span class="sxs-lookup"><span data-stu-id="a9653-131">To set the time-out, right-click the design surface, and click **Set Refresh Timeout**.</span></span>|
|<span data-ttu-id="a9653-132">Línea gris con flechas</span><span class="sxs-lookup"><span data-stu-id="a9653-132">Gray line with arrows</span></span>|<span data-ttu-id="a9653-133">La conexión entre dos nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-133">The connection between two nodes.</span></span> <span data-ttu-id="a9653-134">Para agregar una conexión, haga clic con el botón secundario en uno de los nodos que desea conectar.</span><span class="sxs-lookup"><span data-stu-id="a9653-134">To add a connection, right-click one of the nodes that you want to connect.</span></span> <span data-ttu-id="a9653-135">Para quitar una conexión, haga clic con el botón secundario en la conexión.</span><span class="sxs-lookup"><span data-stu-id="a9653-135">To remove a connection, right-click the connection.</span></span><br /><br /> <span data-ttu-id="a9653-136">Si la línea tiene una flecha única, la replicación tiene información incompleta para uno de los nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-136">If the line has a single arrow, replication has incomplete information for one of the nodes.</span></span>|

### <a name="options-for-the-design-surface"></a><span data-ttu-id="a9653-137">Opciones para la superficie de diseño</span><span class="sxs-lookup"><span data-stu-id="a9653-137">Options for the Design Surface</span></span>
 <span data-ttu-id="a9653-138">**Volver a dibujar el gráfico** Actualiza los objetos en la superficie de diseño sin actualizar la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-138">**Redraw Graph** Redraw the objects on the design surface without refreshing the topology.</span></span> <span data-ttu-id="a9653-139">Al actualizar, se podría proporcionar una mejor vista de la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-139">Redrawing might provide a better view of the topology.</span></span>

 <span data-ttu-id="a9653-140">**Actualizar la topología** Consulta cada nodo en la topología y muestra la información actualizada sobre cada nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-140">**Refresh Topology** Query each node in the topology, and display updated information about each node.</span></span> <span data-ttu-id="a9653-141">Con muchos nodos, este proceso puede tardar varios minutos.</span><span class="sxs-lookup"><span data-stu-id="a9653-141">With many nodes, this process can take several minutes.</span></span>

 <span data-ttu-id="a9653-142">Si el asistente solicita información de la topología y a continuación se cierra y se vuelve a abrir antes de que todos los nodos respondan a la solicitud, esta página podría no mostrar todos los nodos en la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-142">If the wizard requests topology information, and then you close and reopen the wizard before all nodes respond to the request, this page might not display all nodes in the topology.</span></span>

 <span data-ttu-id="a9653-143">**Agregar un nuevo nodo del mismo nivel** Agregue una instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a la topología punto a punto.</span><span class="sxs-lookup"><span data-stu-id="a9653-143">**Add a New Peer Node** Add an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the peer-to-peer topology.</span></span> <span data-ttu-id="a9653-144">Agregar una instancia como nodo crea una publicación en esa instancia después de que el asistente se complete.</span><span class="sxs-lookup"><span data-stu-id="a9653-144">Adding an instance as a node creates a publication at that instance after the wizard completes.</span></span> <span data-ttu-id="a9653-145">Tras agregar el nodo, haga clic con el botón secundario en él para agregar una conexión entre el nuevo nodo y un nodo existente.</span><span class="sxs-lookup"><span data-stu-id="a9653-145">After you add the node, right-click it to add a connection between the new node and an existing node.</span></span>

 <span data-ttu-id="a9653-146">Para participar en una topología punto a punto, la instancia debe cumplir los requisitos siguientes:</span><span class="sxs-lookup"><span data-stu-id="a9653-146">To participate in a peer-to-peer topology, the instance must meet the following requirements:</span></span>

-   <span data-ttu-id="a9653-147">Debe estar configurada como Distribuidor o estar asociada con un Distribuidor remoto.</span><span class="sxs-lookup"><span data-stu-id="a9653-147">It must already be configured as a Distributor or be associated with a remote Distributor.</span></span>

-   <span data-ttu-id="a9653-148">Debe contener una copia de la base de datos implicada en replicación.</span><span class="sxs-lookup"><span data-stu-id="a9653-148">It must contain a copy of the database involved in replication.</span></span> <span data-ttu-id="a9653-149">Esta copia es normalmente una copia de seguridad restaurada de la base de datos de publicación original.</span><span class="sxs-lookup"><span data-stu-id="a9653-149">This copy is typically a restored backup of the original publication database.</span></span>

 <span data-ttu-id="a9653-150">**Seleccionar nodos para ver** Seleccione los nodos que desea ver en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-150">**Select Node(s) to View** Select which nodes to view on the design surface.</span></span> <span data-ttu-id="a9653-151">Esta opción es útil si la topología tiene un gran número de nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-151">This option is useful if the topology has a large number of nodes.</span></span> <span data-ttu-id="a9653-152">Sea consciente de que solamente puede agregar conexiones entre nodos que están visibles en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-152">Be aware that you can add connections only between nodes that are visible on the design surface.</span></span>

 <span data-ttu-id="a9653-153">**Establecer tiempo de espera de la actualización** Especifica cuánto tiempo se puede ejecutar el proceso de la actualización antes de que se supere el tiempo de espera de la operación.</span><span class="sxs-lookup"><span data-stu-id="a9653-153">**Set Refresh Timeout** Specify how long the refresh process can run before the operation times out.</span></span>

### <a name="options-for-each-node"></a><span data-ttu-id="a9653-154">Opciones para cada nodo</span><span class="sxs-lookup"><span data-stu-id="a9653-154">Options for Each Node</span></span>
 <span data-ttu-id="a9653-155">**Agregar una nueva conexión del mismo nivel** Agrega una conexión entre dos nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-155">**Add a New Peer Connection** Add a connection between two nodes.</span></span> <span data-ttu-id="a9653-156">Por ejemplo, si agrega una conexión entre el Nodo A y el Nodo B, la replicación agrega dos suscripciones: la primera habilita el Nodo A para recibir los cambios de la publicación en el Nodo B y la segunda permite al Nodo B recibir cambios de la publicación en el Nodo A.</span><span class="sxs-lookup"><span data-stu-id="a9653-156">For example, if you add a connection between Node A and Node B, replication adds two subscriptions: The first enables Node A to receive changes from the publication at Node B, and the second enables Node B to receive changes from the publication at Node A.</span></span>

 <span data-ttu-id="a9653-157">**Eliminar nodo del mismo nivel** Quita un nodo de la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-157">**Delete Peer Node** Removes a node from the topology.</span></span> <span data-ttu-id="a9653-158">Por ejemplo, si quita el Nodo C, se quita la publicación en ese nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-158">For example, if you remove Node C, the publication at that node is removed.</span></span> <span data-ttu-id="a9653-159">También se quitan las suscripciones entre el Nodo A y el Nodo C, y el Nodo B y el Nodo C.</span><span class="sxs-lookup"><span data-stu-id="a9653-159">Subscriptions between Node A and Node C, and Node B and Node C are also removed.</span></span> <span data-ttu-id="a9653-160">No se elimina la base de datos del Nodo C y no se deshabilitan la publicación y la distribución.</span><span class="sxs-lookup"><span data-stu-id="a9653-160">The database at Node C is not deleted, and publishing and distribution are not disabled.</span></span>

> [!NOTE]
>  <span data-ttu-id="a9653-161">Al configurar la replicación punto a punto, se especifica un identificador para cada nodo.</span><span class="sxs-lookup"><span data-stu-id="a9653-161">When you configure peer-to-peer replication, you specify an ID for each node.</span></span> <span data-ttu-id="a9653-162">Este identificador, que debe ser único en todos los nodos de la topología, se almacena en la columna originator_id de la tabla del sistema [MSpeer_originatorid_history](/sql/relational-databases/system-tables/mspeer-originatorid-history-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="a9653-162">This ID, which must be unique across all nodes in the topology, is stored in the originator_id column in the [MSpeer_originatorid_history](/sql/relational-databases/system-tables/mspeer-originatorid-history-transact-sql) system table.</span></span> <span data-ttu-id="a9653-163">Si un nodo se quita de la topología, el identificador se sigue conservando en la tabla de historial.</span><span class="sxs-lookup"><span data-stu-id="a9653-163">If a node is removed from the topology, the ID is still retained in the history table.</span></span> <span data-ttu-id="a9653-164">El identificador se conserva para evitar que se produzcan falsos conflictos si hay cambios procedentes del nodo quitado que todavía se están replicando en la topología.</span><span class="sxs-lookup"><span data-stu-id="a9653-164">The ID is retained to prevent false conflicts from occurring if there are changes from the removed node that are still being replicated across the topology.</span></span> <span data-ttu-id="a9653-165">Si desea volver a usar el identificador para un nuevo nodo, primero deberá eliminarlo manualmente de la tabla MSpeer_originatorid_history en todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-165">If you want to reuse the ID for a new node, you must first manually delete the ID from the MSpeer_originatorid_history table at all nodes.</span></span> <span data-ttu-id="a9653-166">Antes de eliminar un identificador de un nodo, ejecute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) para comprobar que todos los cambios que se originaron desde ese nodo se han replicado.</span><span class="sxs-lookup"><span data-stu-id="a9653-166">Before you delete an ID for a node, execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) to verify that all changes that originated from that node have been replicated.</span></span>

 <span data-ttu-id="a9653-167">**Conectar a todos los nodos mostrados** Agrega conexiones entre el nodo seleccionado y todos los otros nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-167">**Connect to ALL Displayed Nodes** Adds connections between the selected node and all other nodes.</span></span> <span data-ttu-id="a9653-168">Por ejemplo, si ha seleccionado esta opción para el Nodo C en una topología de tres nodos, la replicación agrega cuatro suscripciones: dos que habilitan el Nodo A y el Nodo B para recibir los cambios de la publicación en el Nodo C y dos que permiten que el Nodo C reciba cambios de las publicaciones en el Nodo A y el Nodo B.</span><span class="sxs-lookup"><span data-stu-id="a9653-168">For example, if you selected this option for Node C in a three node topology, replication adds four subscriptions: two that enable Node A and Node B to receive changes from the publication at Node C, and two that enable Node C to receive changes from the publications at Node A and Node B.</span></span>

 <span data-ttu-id="a9653-169">**Seleccionar nodos para ver** Seleccione los nodos que desea ver en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-169">**Select Node(s) to View** Select which nodes to view on the design surface.</span></span> <span data-ttu-id="a9653-170">Esta opción es útil si la topología tiene un gran número de nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-170">This option is useful if the topology has a large number of nodes.</span></span> <span data-ttu-id="a9653-171">Sea consciente de que solamente puede agregar conexiones entre nodos que están visibles en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="a9653-171">Be aware that you can add connections only between nodes that are visible on the design surface.</span></span>

### <a name="options-for-the-connection-arrows"></a><span data-ttu-id="a9653-172">Opciones de las flechas de conexión</span><span class="sxs-lookup"><span data-stu-id="a9653-172">Options for the Connection Arrows</span></span>
 <span data-ttu-id="a9653-173">**Quitar conexión del mismo nivel** Quita una conexión entre dos nodos.</span><span class="sxs-lookup"><span data-stu-id="a9653-173">**Remove Peer Connection** Remove a connection between two nodes.</span></span> <span data-ttu-id="a9653-174">Por ejemplo, si quita una conexión entre el Nodo A y el Nodo B, la replicación elimina dos suscripciones: la que habilita el Nodo A para recibir los cambios de la publicación en el Nodo B y la que permite al Nodo B recibir cambios de la publicación en el Nodo A.</span><span class="sxs-lookup"><span data-stu-id="a9653-174">For example, if you remove a connection between Node A and Node B, replication drops two subscriptions: the one that enables Node A to receive changes from the publication at Node B, and the one that enables Node B to receive changes from the publication at Node A.</span></span>

## <a name="see-also"></a><span data-ttu-id="a9653-175">Consulte también</span><span class="sxs-lookup"><span data-stu-id="a9653-175">See Also</span></span>
 <span data-ttu-id="a9653-176">[Configurar la publicación y distribución](configure-publishing-and-distribution.md) [administrar una topología punto a punto &#40;la programación de la replicación con Transact-SQL&#41;](administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) [replicación transaccional punto a punto](transactional/peer-to-peer-transactional-replication.md)</span><span class="sxs-lookup"><span data-stu-id="a9653-176">[Configure Publishing and Distribution](configure-publishing-and-distribution.md) [Administer a Peer-to-Peer Topology &#40;Replication Transact-SQL Programming&#41;](administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) [Peer-to-Peer Transactional Replication](transactional/peer-to-peer-transactional-replication.md)</span></span>


