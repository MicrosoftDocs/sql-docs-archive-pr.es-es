---
title: Conceptos de los Replication Management Objects (RMO) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: reference
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- replication [SQL Server], RMO
- programming interfaces [SQL Server replication]
- replication [SQL Server], how-to topics
- RMO [SQL Server]
- Replication Management Objects
- programming [SQL Server replication], RMO
ms.assetid: 37476d50-fb47-49e3-9504-3b163ac381d8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0dc41416e0fb585db376c6b72f28f7c30cfff052
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672914"
---
# <a name="replication-management-objects-concepts"></a><span data-ttu-id="afd59-102">Replication Management Objects Concepts</span><span class="sxs-lookup"><span data-stu-id="afd59-102">Replication Management Objects Concepts</span></span>
  <span data-ttu-id="afd59-103">Replication Management Objects (RMO) es un ensamblado de código administrado que encapsula las funcionalidades de replicación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="afd59-103">Replication Management Objects (RMO) is a managed code assembly that encapsulates replication functionalities for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="afd59-104">RMO se implementa mediante el espacio de nombres <xref:Microsoft.SqlServer.Replication>.</span><span class="sxs-lookup"><span data-stu-id="afd59-104">RMO is implemented by the <xref:Microsoft.SqlServer.Replication> namespace.</span></span>  
  
 <span data-ttu-id="afd59-105">En los temas de las secciones siguientes se describe cómo puede utilizar RMO para controlar mediante programación las tareas de replicación:</span><span class="sxs-lookup"><span data-stu-id="afd59-105">The topics in the following sections describe how you can use RMO to programmatically control replication tasks:</span></span>  
  
 [<span data-ttu-id="afd59-106">Configurar distribución</span><span class="sxs-lookup"><span data-stu-id="afd59-106">Configure Distribution</span></span>](../configure-distribution.md)  
 <span data-ttu-id="afd59-107">Los temas de esta sección muestran cómo utilizar RMO para configurar la publicación y la distribución.</span><span class="sxs-lookup"><span data-stu-id="afd59-107">Topics in this section show how to use RMO to configure publishing and distribution.</span></span>  
  
 <span data-ttu-id="afd59-108">[Create a Publication](../publish/create-a-publication.md) (Creación de una publicación)</span><span class="sxs-lookup"><span data-stu-id="afd59-108">[Create a Publication](../publish/create-a-publication.md)</span></span>  
 <span data-ttu-id="afd59-109">Los temas de esta sección muestran cómo utilizar RMO para crear, eliminar y modificar las publicaciones y los artículos.</span><span class="sxs-lookup"><span data-stu-id="afd59-109">Topics in this section show how to use RMO to create, delete, and modify publications and articles.</span></span>  
  
 [<span data-ttu-id="afd59-110">Suscribirse a publicaciones</span><span class="sxs-lookup"><span data-stu-id="afd59-110">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
 <span data-ttu-id="afd59-111">Los temas de esta sección muestran cómo utilizar RMO para crear, eliminar y modificar las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="afd59-111">Topics in this section show how to use RMO to create, delete, and modify subscriptions.</span></span>  
  
 [<span data-ttu-id="afd59-112">Proteger una topología de replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-112">Secure a Replication Topology</span></span>](../security/view-and-modify-replication-security-settings.md)  
 <span data-ttu-id="afd59-113">Los temas de esta sección muestran cómo utilizar RMO para ver y modificar la configuración de seguridad.</span><span class="sxs-lookup"><span data-stu-id="afd59-113">Topics in this section show how to use RMO to view and modify security settings.</span></span>  
  
 [<span data-ttu-id="afd59-114">Sincronizar suscripciones &#40;replicación&#41;</span><span class="sxs-lookup"><span data-stu-id="afd59-114">Synchronize Subscriptions &#40;Replication&#41;</span></span>](../synchronize-data.md)  
 <span data-ttu-id="afd59-115">Los temas de esta sección muestran cómo sincronizar las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="afd59-115">Topics in this section show how to synchronize subscriptions.</span></span>  
  
 [<span data-ttu-id="afd59-116">Supervisar la replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-116">Monitoring Replication</span></span>](../monitoring-replication.md)  
 <span data-ttu-id="afd59-117">Los temas de esta sección muestran cómo supervisar mediante programación una topología de replicación.</span><span class="sxs-lookup"><span data-stu-id="afd59-117">Topics in this section show how to programmatically monitor a replication topology.</span></span>  
  
## <a name="introduction-to-rmo-programming"></a><span data-ttu-id="afd59-118">Introducción a la programación de RMO</span><span class="sxs-lookup"><span data-stu-id="afd59-118">Introduction to RMO Programming</span></span>  
 <span data-ttu-id="afd59-119">RMO está diseñado para programar todos los aspectos de la replicación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="afd59-119">RMO is designed for programming all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="afd59-120">El espacio de nombres de RMO es <xref:Microsoft.SqlServer.Replication> y lo implementa Microsoft.SqlServer.Rmo.dll, que es un ensamblado de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="afd59-120">The RMO namespace is <xref:Microsoft.SqlServer.Replication>, and it is implemented by the Microsoft.SqlServer.Rmo.dll, which is a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework assembly.</span></span> <span data-ttu-id="afd59-121">El ensamblado Microsoft.SqlServer.Replication.dll, que también pertenece al espacio de nombres <xref:Microsoft.SqlServer.Replication>, implementa una interfaz de código administrado para programar varios agentes de replicación (Agente de instantáneas, Agente de distribución y Agente de mezcla).</span><span class="sxs-lookup"><span data-stu-id="afd59-121">The Microsoft.SqlServer.Replication.dll assembly, which also belongs to the <xref:Microsoft.SqlServer.Replication> namespace, implements a managed code interface for programming the various replication agents (Snapshot Agent, Distribution Agent, and Merge Agent).</span></span> <span data-ttu-id="afd59-122">Se puede tener acceso a sus clases desde RMO para sincronizar las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="afd59-122">Its classes can be accessed from RMO to synchronize subscriptions.</span></span> <span data-ttu-id="afd59-123">Las clases en el espacio de nombres <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>, que implementa el ensamblado Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, se utilizan para crear una lógica empresarial personalizada para la replicación de mezcla.</span><span class="sxs-lookup"><span data-stu-id="afd59-123">Classes in the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace, implemented by the Microsoft.SqlServer.Replication.BusinessLogicSupport.dll assembly, are used to create custom business logic for merge replication.</span></span> <span data-ttu-id="afd59-124">Este ensamblado es independiente de RMO.</span><span class="sxs-lookup"><span data-stu-id="afd59-124">This assembly is independent from RMO.</span></span>  
  
## <a name="deploying-applications-based-on-rmo"></a><span data-ttu-id="afd59-125">Implementar aplicaciones basadas en RMO</span><span class="sxs-lookup"><span data-stu-id="afd59-125">Deploying Applications Based on RMO</span></span>  
 <span data-ttu-id="afd59-126">RMO depende de los componentes de replicación y de conectividad de cliente que están incluidos con todas las versiones de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] excepto SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="afd59-126">RMO depends on the replication components and client connectivity components that are included with all versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] except SQL Server Compact.</span></span> <span data-ttu-id="afd59-127">Para implementar una aplicación basada en RMO, debe instalar una versión de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que incluya componentes de replicación y de conectividad de cliente en el equipo en el que se vaya a ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="afd59-127">To deploy an application based on RMO, you must install a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that includes replication components and client connectivity components on the computer on which the application will run.</span></span>  
  
## <a name="getting-started-with-rmo"></a><span data-ttu-id="afd59-128">Introducción a RMO</span><span class="sxs-lookup"><span data-stu-id="afd59-128">Getting Started with RMO</span></span>  
 <span data-ttu-id="afd59-129">En esta sección se describe cómo iniciar un proyecto RMO simple utilizando [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="afd59-129">This section describes how to start a simple RMO project using [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span></span>  
  
#### <a name="to-create-a-new-microsoft-visual-c-project"></a><span data-ttu-id="afd59-130">Para crear un proyecto nuevo de Microsoft Visual C#</span><span class="sxs-lookup"><span data-stu-id="afd59-130">To create a new Microsoft Visual C# project</span></span>  
  
1.  <span data-ttu-id="afd59-131">Inicie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="afd59-131">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="afd59-132">En el menú **Archivo**, haga clic en **Nuevo proyecto**.</span><span class="sxs-lookup"><span data-stu-id="afd59-132">On the **File** menu, click **NewProject.**</span></span> <span data-ttu-id="afd59-133">Aparecerá el cuadro de diálogo **Nuevo proyecto** .</span><span class="sxs-lookup"><span data-stu-id="afd59-133">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="afd59-134">En el cuadro de diálogo **Tipos de proyecto**, seleccione **Proyectos de Visual C#** .</span><span class="sxs-lookup"><span data-stu-id="afd59-134">In the **Project Types** dialog box, select **Visual C# Projects**.</span></span> <span data-ttu-id="afd59-135">En el panel **Plantillas**, seleccione **Aplicación para Windows**.</span><span class="sxs-lookup"><span data-stu-id="afd59-135">In the **Templates** pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="afd59-136">(Opcional) en **Nombre**, escriba el nombre de la nueva aplicación.</span><span class="sxs-lookup"><span data-stu-id="afd59-136">(Optional) In **Name**, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="afd59-137">Haga clic en **Aceptar** para cargar la plantilla de Windows de Visual C#.</span><span class="sxs-lookup"><span data-stu-id="afd59-137">Click **OK** to load the Visual C# Windows template.</span></span>  
  
6.  <span data-ttu-id="afd59-138">En el menú **Proyecto**, seleccione el elemento **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="afd59-138">On the **Project** menu, select **Add Reference** item.</span></span> <span data-ttu-id="afd59-139">Aparecerá el cuadro de diálogo **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="afd59-139">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="afd59-140">Seleccione los siguientes ensamblados de la lista de la pestaña **.NET** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="afd59-140">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="afd59-141">Interfaz de programación Microsoft.SqlServer.Replication de .NET</span><span class="sxs-lookup"><span data-stu-id="afd59-141">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="afd59-142">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="afd59-142">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="afd59-143">Biblioteca de agentes de replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-143">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="afd59-144">Utilice la tecla CTRL para seleccionar más de un archivo.</span><span class="sxs-lookup"><span data-stu-id="afd59-144">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="afd59-145">(Opcional) Repita el paso 6.</span><span class="sxs-lookup"><span data-stu-id="afd59-145">(Optional) Repeat step 6.</span></span> <span data-ttu-id="afd59-146">Haga clic en la pestaña **Examinar**, navegue a [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, seleccione Microsoft.SqlServer.Replication.BusinessLogicSupport.dll y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="afd59-146">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="afd59-147">En el menú **Ver** , haga clic en **Código**.</span><span class="sxs-lookup"><span data-stu-id="afd59-147">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="afd59-148">En el código, antes de la instrucción de espacio de nombres, escriba las instrucciones `using` siguientes para certificar los tipos en los espacios de nombres de RMO:</span><span class="sxs-lookup"><span data-stu-id="afd59-148">In the code, before the namespace statement, type the following `using` statements to qualify the types in the RMO namespaces:</span></span>  
  
    ```  
    // These namespaces are required.  
    using Microsoft.SqlServer.Replication;  
    using Microsoft.SqlServer.Management.Common;  
    // This namespace is only used when creating custom business  
    // logic for merge replication.  
    using Microsoft.SqlServer.Replication.BusinessLogicSupport;   
    ```  
  
#### <a name="to-create-a-new-microsoft-visual-basic-net-project"></a><span data-ttu-id="afd59-149">Para crear un nuevo proyecto de Microsoft Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="afd59-149">To create a new Microsoft Visual Basic .NET project</span></span>  
  
1.  <span data-ttu-id="afd59-150">Inicie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="afd59-150">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="afd59-151">En el menú **Archivo**, seleccione **Nuevo proyecto**.</span><span class="sxs-lookup"><span data-stu-id="afd59-151">On the **File** menu, select **New Project**.</span></span> <span data-ttu-id="afd59-152">Aparecerá el cuadro de diálogo **Nuevo proyecto** .</span><span class="sxs-lookup"><span data-stu-id="afd59-152">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="afd59-153">En el panel Tipos de proyecto, seleccione **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="afd59-153">In the Project Types pane, select **Visual Basic**.</span></span> <span data-ttu-id="afd59-154">En el panel Plantillas, seleccione **Aplicación para Windows**.</span><span class="sxs-lookup"><span data-stu-id="afd59-154">In the Templates pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="afd59-155">(Opcional) en el cuadro **Nombre**, escriba el nombre de la nueva aplicación.</span><span class="sxs-lookup"><span data-stu-id="afd59-155">(Optional) In the **Name** box, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="afd59-156">Haga clic en **Aceptar** para cargar la plantilla de Windows de Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="afd59-156">Click **OK** to load the Visual Basic Windows template.</span></span>  
  
6.  <span data-ttu-id="afd59-157">En el menú **Proyecto**, seleccione **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="afd59-157">On the **Project** menu, select **Add Reference**.</span></span> <span data-ttu-id="afd59-158">Aparecerá el cuadro de diálogo **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="afd59-158">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="afd59-159">Seleccione los siguientes ensamblados de la lista de la pestaña **.NET** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="afd59-159">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="afd59-160">Interfaz de programación Microsoft.SqlServer.Replication de .NET</span><span class="sxs-lookup"><span data-stu-id="afd59-160">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="afd59-161">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="afd59-161">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="afd59-162">Biblioteca de agentes de replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-162">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="afd59-163">Utilice la tecla CTRL para seleccionar más de un archivo.</span><span class="sxs-lookup"><span data-stu-id="afd59-163">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="afd59-164">(Opcional) Repita el paso 6.</span><span class="sxs-lookup"><span data-stu-id="afd59-164">(Optional) Repeat step 6.</span></span> <span data-ttu-id="afd59-165">Haga clic en la pestaña **Examinar**, navegue a [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, seleccione Microsoft.SqlServer.Replication.BusinessLogicSupport.dll y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="afd59-165">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="afd59-166">En el menú **Ver** , haga clic en **Código**.</span><span class="sxs-lookup"><span data-stu-id="afd59-166">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="afd59-167">En el código, antes de ninguna declaración, escriba las instrucciones `Imports` siguientes para certificar los tipos en los espacios de nombres de RMO.</span><span class="sxs-lookup"><span data-stu-id="afd59-167">In the code, before any declarations, type the following `Imports` statements to qualify the types in the RMO namespaces.</span></span>  
  
    ```  
    ' These namespaces are required.  
    Imports Microsoft.SqlServer.Replication  
    Imports Microsoft.SqlServer.Management.Common  
    ' This namespace is only used when creating custom business  
    ' logic for merge replication.  
    Imports Microsoft.SqlServer.Replication.BusinessLogicSupport   
    ```  
  
## <a name="connecting-to-a-replication-server"></a><span data-ttu-id="afd59-168">Conectar a un servidor de replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-168">Connecting to a Replication Server</span></span>  
 <span data-ttu-id="afd59-169">Los objetos de programación de RMO requieren que se realice una conexión a una instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mediante una instancia de la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="afd59-169">RMO programming objects require that a connection to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is made by using an instance of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span> <span data-ttu-id="afd59-170">Esta conexión al servidor se efectúa independientemente de cualquier objeto de programación de RMO.</span><span class="sxs-lookup"><span data-stu-id="afd59-170">This connection to the server is made independently of any RMO programming objects.</span></span> <span data-ttu-id="afd59-171">A continuación, se pasa al objeto RMO durante la creación de la instancia o por asignación a la <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> propiedad del objeto.</span><span class="sxs-lookup"><span data-stu-id="afd59-171">It is then passed to the RMO object either during instance creation or by assignment to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the object.</span></span> <span data-ttu-id="afd59-172">De esta manera, se pueden crear y administrar los objetos de programación RMO y las instancias de objeto de conexión por separado y se puede reutilizar un objeto de conexión único con varios objetos de programación RMO.</span><span class="sxs-lookup"><span data-stu-id="afd59-172">In this manner, an RMO programming object and the connection object instances can be created and managed separately, and a single connection object can be reused with multiple RMO programming objects.</span></span> <span data-ttu-id="afd59-173">Las reglas siguientes se aplican a las conexiones a un servidor de replicación:</span><span class="sxs-lookup"><span data-stu-id="afd59-173">The following rules apply for connections to a replication server:</span></span>  
  
-   <span data-ttu-id="afd59-174">Todas las propiedades de la conexión se definen para un objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> dado.</span><span class="sxs-lookup"><span data-stu-id="afd59-174">All properties for the connection are defined for a given <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="afd59-175">Una conexión a cada instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] debe tener su propio objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="afd59-175">A connection to each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have its own <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="afd59-176">El objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> se asigna a la propiedad <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> del objeto de programación de RMO que se va a crear o al que se va a tener acceso en el servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-176">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object is assigned to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the RMO programming object being created or accessed on the server.</span></span>  
  
-   <span data-ttu-id="afd59-177">El método <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> abre la conexión al servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-177">The <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> method opens the connection to the server.</span></span> <span data-ttu-id="afd59-178">Se debe llamar a este método antes de llamar a cualquier método que tenga acceso al servidor en cualquier objeto de programación de RMO que use la conexión.</span><span class="sxs-lookup"><span data-stu-id="afd59-178">This method must be called before calling any methods that access the server on any RMO programming objects using the connection.</span></span>  
  
-   <span data-ttu-id="afd59-179">Dado que tanto RMO como Objetos de administración de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (SMO) usan la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para las conexiones a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], los objetos SMO y RMO pueden utilizar la misma conexión.</span><span class="sxs-lookup"><span data-stu-id="afd59-179">Because RMO and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) both use the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class for connections to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the same connection can be used by both RMO and SMO objects.</span></span> <span data-ttu-id="afd59-180">Para obtener más información, vea [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md) (Conectarse a una instancia de SQL Server).</span><span class="sxs-lookup"><span data-stu-id="afd59-180">For more information, see [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span></span>  
  
-   <span data-ttu-id="afd59-181">Toda la información de autenticación para realizar la conexión e iniciar sesión en el servidor correctamente se proporciona en el objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="afd59-181">All authentication information to make the connection and successfully log on to the server is supplied in the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="afd59-182">La autenticación de Windows es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="afd59-182">Windows Authentication is the default.</span></span> <span data-ttu-id="afd59-183">Para utilizar la autenticación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> debe establecerse en el valor `false` y <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> y <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> debe establecerse en un inicio de sesión y  una contraseña de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] válidos.</span><span class="sxs-lookup"><span data-stu-id="afd59-183">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> must be set to `false` and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> must be set to a valid [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logon and password.</span></span> <span data-ttu-id="afd59-184">Las credenciales de seguridad siempre deben almacenarse y administrarse de forma segura, y se deben proporcionar en tiempo de ejecución cuando sea posible.</span><span class="sxs-lookup"><span data-stu-id="afd59-184">Security credentials must always be stored and handled securely, and supplied at run-time whenever possible.</span></span>  
  
-   <span data-ttu-id="afd59-185">Para las aplicaciones multiproceso, se debe utilizar un objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> independiente en cada subproceso.</span><span class="sxs-lookup"><span data-stu-id="afd59-185">For multithreaded applications, a separate <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object should be used in each thread.</span></span>  
  
 <span data-ttu-id="afd59-186">Llame al método <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> en el objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> para cerrar las conexiones al servidor activas que usan los objetos RMO.</span><span class="sxs-lookup"><span data-stu-id="afd59-186">Call the <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> method on the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object to close active server connections used by RMO objects.</span></span>  
  
## <a name="setting-rmo-properties"></a><span data-ttu-id="afd59-187">Establecer las propiedades de RMO</span><span class="sxs-lookup"><span data-stu-id="afd59-187">Setting RMO Properties</span></span>  
 <span data-ttu-id="afd59-188">Las propiedades de los objetos de programación de RMO representan las propiedades de estos objetos de replicación en el servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-188">The properties of RMO programming objects represent the properties of these replication objects at the server.</span></span> <span data-ttu-id="afd59-189">Al crear nuevos objetos de replicación en el servidor, se utilizan las propiedades de RMO para definirlos.</span><span class="sxs-lookup"><span data-stu-id="afd59-189">When creating new replication objects at the server, RMO properties are used to define these objects.</span></span> <span data-ttu-id="afd59-190">En los objetos existentes, las propiedades de RMO representan sus propiedades, que solo se pueden modificar en el caso de que se puedan escribir o configurar.</span><span class="sxs-lookup"><span data-stu-id="afd59-190">For existing objects, the RMO properties represent the existing object's properties, which can be modified only for properties that are writable or settable.</span></span> <span data-ttu-id="afd59-191">Las propiedades se pueden establecer en los objetos nuevos o en los objetos existentes.</span><span class="sxs-lookup"><span data-stu-id="afd59-191">Properties can be set on new objects or existing objects.</span></span>  
  
### <a name="setting-properties-for-new-replication-objects"></a><span data-ttu-id="afd59-192">Establecer propiedades para los nuevos objetos de replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-192">Setting Properties for New Replication Objects</span></span>  
 <span data-ttu-id="afd59-193">Al crear un nuevo objeto de replicación en el servidor, debe especificar todas las propiedades necesarias antes de llamar al método `Create` del objeto.</span><span class="sxs-lookup"><span data-stu-id="afd59-193">When creating a new replication object at the server, you must specify all required properties before calling the `Create` method of the object.</span></span> <span data-ttu-id="afd59-194">Para obtener más información sobre cómo establecer las propiedades para un nuevo objeto de replicación, vea [Configurar la publicación y la distribución](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="afd59-194">For more information about setting properties for a new replication object, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
### <a name="setting-properties-for-existing-replication-objects"></a><span data-ttu-id="afd59-195">Establecer propiedades para los objetos de replicación existentes</span><span class="sxs-lookup"><span data-stu-id="afd59-195">Setting Properties for Existing Replication Objects</span></span>  
 <span data-ttu-id="afd59-196">Para algunos de los objetos de replicación que existen en el servidor, RMO podría admitir la capacidad de cambiar algunas o todas sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="afd59-196">For replication objects that exist at the server, depending on the object, RMO might support the ability to change some or all of its properties.</span></span> <span data-ttu-id="afd59-197">Solo es posible cambiar las propiedades que se puedan escribir o configurar.</span><span class="sxs-lookup"><span data-stu-id="afd59-197">Only writable or settable properties can be changed.</span></span> <span data-ttu-id="afd59-198">Para poder cambiar las propiedades, se debe llamar al método `Load` o <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> para recibir las propiedades actuales del servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-198">Before properties can be changed, either the `Load` or the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method must be called to get the current properties from the server.</span></span> <span data-ttu-id="afd59-199">Llamar a estos métodos indica que un objeto existente se está modificando.</span><span class="sxs-lookup"><span data-stu-id="afd59-199">Calling these methods indicates that an existing object is being modified.</span></span>  
  
 <span data-ttu-id="afd59-200">De forma predeterminada, al cambiar las propiedades del objeto, RMO confirma estos cambios en el servidor según el modo de ejecución de <xref:Microsoft.SqlServer.Management.Common.ServerConnection> que se esté usando.</span><span class="sxs-lookup"><span data-stu-id="afd59-200">By default, when changing object properties, RMO commits these changes to the server based on the execution mode of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> being used.</span></span> <span data-ttu-id="afd59-201">El método <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> se puede utilizar para comprobar que un objeto existe en el servidor antes de intentar recuperar o cambiar sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="afd59-201">The <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> method can be used to verify that an object exists at the server before attempting to retrieve or change its properties.</span></span> <span data-ttu-id="afd59-202">Para obtener más información sobre cómo cambiar las propiedades de un objeto de replicación, vea [Ver y modificar las propiedades del distribuidor y del publicador](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="afd59-202">For more information about changing the properties of a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="afd59-203">Cuando varios clientes de RMO o varias instancias de un objeto de programación de RMO están teniendo acceso al mismo objeto de replicación en el servidor, se puede llamar al método `Refresh` del objeto RMO para actualizar las propiedades según el estado actual del objeto del servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-203">When multiple RMO clients or multiple instances of an RMO programming object are accessing the same replication object at the server, the `Refresh` method of the RMO object can be called to update the properties based on the current state of the object at the server.</span></span>  
  
### <a name="caching-property-changes"></a><span data-ttu-id="afd59-204">Almacenar en memoria caché los cambios de propiedades</span><span class="sxs-lookup"><span data-stu-id="afd59-204">Caching Property Changes</span></span>  
 <span data-ttu-id="afd59-205">Cuando la propiedad <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> está establecida en <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> todas las instrucciones [!INCLUDE[tsql](../../../includes/tsql-md.md)] generadas por RMO se capturan para que se puedan ejecutar manualmente en un lote único utilizando alguno de los métodos de ejecución.</span><span class="sxs-lookup"><span data-stu-id="afd59-205">When the <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> property is set to <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> all [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements generated by RMO are captured so that they can be executed manually in a single batch by using one of the execution methods.</span></span> <span data-ttu-id="afd59-206">RMO le permite almacenar en memoria caché los cambios de las propiedades y las confirma conjuntamente en un único lote utilizando el método <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> del objeto.</span><span class="sxs-lookup"><span data-stu-id="afd59-206">RMO lets you cache property changes and commit them together in a single batch by using the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method of the object.</span></span> <span data-ttu-id="afd59-207">Para almacenar en caché los cambios de las propiedades, la propiedad <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> del objeto debe estar establecida en `true`. </span><span class="sxs-lookup"><span data-stu-id="afd59-207">To cache property changes, the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> property of the object must be set to `true`.</span></span> <span data-ttu-id="afd59-208">Al almacenar en memoria caché los cambios de las propiedades en RMO, el objeto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> todavía controla cuándo se envían los cambios al servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-208">When caching property changes in RMO, the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object still controls when changes are sent to the server.</span></span> <span data-ttu-id="afd59-209">Para obtener más información sobre cómo almacenar en caché los cambios de las propiedades de un objeto de replicación, vea [Ver y modificar las propiedades del distribuidor y del publicador](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="afd59-209">For more information about caching property changes for a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="afd59-210">Aunque la clase <xref:Microsoft.SqlServer.Management.Common.ServerConnection> permite declarar las transacciones explícitas al establecer las propiedades, tales transacciones pueden interferir con las transacciones de replicación internas, producir resultados imprevistos y no se deberían utilizar con RMO.</span><span class="sxs-lookup"><span data-stu-id="afd59-210">Although the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class supports declaring explicit transactions when setting properties, such transactions may interfere with internal replication transactions, can produce unanticipated results, and should not be used with RMO.</span></span>  
  
## <a name="example"></a><span data-ttu-id="afd59-211">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="afd59-211">Example</span></span>  
 <span data-ttu-id="afd59-212">En este ejemplo se muestra el almacenamiento en memoria caché de los cambios de las propiedades.</span><span class="sxs-lookup"><span data-stu-id="afd59-212">This example demonstrates the caching of property changes.</span></span> <span data-ttu-id="afd59-213">Los cambios realizados en los atributos de una publicación transaccional se almacenan en memoria caché hasta que se envían explícitamente al servidor.</span><span class="sxs-lookup"><span data-stu-id="afd59-213">Changes made to the attributes of a transactional publication are cached until they are explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_ChangeTranPub_cached)]  
  
## <a name="see-also"></a><span data-ttu-id="afd59-214">Consulte también</span><span class="sxs-lookup"><span data-stu-id="afd59-214">See Also</span></span>  
 <span data-ttu-id="afd59-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="afd59-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="afd59-216">Conceptos de la programación de replicación</span><span class="sxs-lookup"><span data-stu-id="afd59-216">Replication Programming Concepts</span></span>](replication-programming-concepts.md)  
  
  
