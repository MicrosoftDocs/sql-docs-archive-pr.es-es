---
title: Creación funciones CLR | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- CLR functions [SQL Server]
- user-defined functions [SQL Server], CLR
ms.assetid: a82df075-2243-4e19-bfe1-ae6d65dabd0f
author: rothja
ms.author: jroth
ms.openlocfilehash: 9741646e43d48bc9336b91538c6065c09855c87d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87744622"
---
# <a name="create-clr-functions"></a><span data-ttu-id="5cb63-102">Crear funciones CLR</span><span class="sxs-lookup"><span data-stu-id="5cb63-102">Create CLR Functions</span></span>
  <span data-ttu-id="5cb63-103">Es posible crear un objeto de base de datos dentro de una instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] programada en un ensamblado creado en Common Language Runtime (CLR) de [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5cb63-103">You can create a database object inside an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that is programmed in an assembly created in the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] common language runtime (CLR).</span></span> <span data-ttu-id="5cb63-104">Los objetos de bases de datos capaces de aprovechar el modelo enriquecido de programación suministrado por Common Language Runtime son las funciones de agregado, las funciones, los procedimientos almacenados, los desencadenadores y los tipos.</span><span class="sxs-lookup"><span data-stu-id="5cb63-104">Database objects that can leverage the rich programming model provided by the common language runtime include aggregate functions, functions, stored procedures, triggers, and types.</span></span>  
  
 <span data-ttu-id="5cb63-105">Para crear una función CLR en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] se deben seguir los pasos detallados a continuación:</span><span class="sxs-lookup"><span data-stu-id="5cb63-105">Creating a CLR function in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] involves the following steps:</span></span>  
  
-   <span data-ttu-id="5cb63-106">Definir la función como un método estático de una clase en un lenguaje admitido por [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5cb63-106">Define the function as a static method of a class in a language supported by the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="5cb63-107">Para obtener más información sobre cómo programar funciones en Common Language Runtime, vea [Funciones CLR definidas por el usuario](../clr-integration-database-objects-user-defined-functions/clr-user-defined-functions.md).</span><span class="sxs-lookup"><span data-stu-id="5cb63-107">For more information about how to program functions in the common language runtime, see [CLR User-Defined Functions](../clr-integration-database-objects-user-defined-functions/clr-user-defined-functions.md).</span></span> <span data-ttu-id="5cb63-108">A continuación, compilar la clase para generar un ensamblado en [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] mediante el compilador del lenguaje adecuado.</span><span class="sxs-lookup"><span data-stu-id="5cb63-108">Then, compile the class to build an assembly in the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] by using the appropriate language compiler.</span></span>  
  
-   <span data-ttu-id="5cb63-109">Registrar el ensamblado en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] mediante la instrucción CREATE ASSEMBLY.</span><span class="sxs-lookup"><span data-stu-id="5cb63-109">Register the assembly in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by using the CREATE ASSEMBLY statement.</span></span> <span data-ttu-id="5cb63-110">Para obtener más información sobre ensamblados en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], vea [Ensamblados &#40;motor de base de datos&#41;](../clr-integration/assemblies-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="5cb63-110">For more information about assemblies in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Assemblies &#40;Database Engine&#41;](../clr-integration/assemblies-database-engine.md).</span></span>  
  
-   <span data-ttu-id="5cb63-111">Crear la función que hace referencia al ensamblado registrado mediante la instrucción [CREATE FUNCTION](/sql/t-sql/statements/create-function-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="5cb63-111">Create the function that references the registered assembly by using the [CREATE FUNCTION](/sql/t-sql/statements/create-function-transact-sql) statement.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5cb63-112">La implementación de un proyecto de SQL Server en [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] registra un ensamblado en la base de datos especificada para el proyecto.</span><span class="sxs-lookup"><span data-stu-id="5cb63-112">Deploying a SQL Server Project in [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] registers an assembly in the database that was specified for the project.</span></span> <span data-ttu-id="5cb63-113">La implementación del proyecto también crea funciones CLR en la base de datos para todos los métodos anotados con el atributo `SqlFunction`.</span><span class="sxs-lookup"><span data-stu-id="5cb63-113">Deploying the project also creates CLR functions in the database for all methods annotated with the `SqlFunction` attribute.</span></span> <span data-ttu-id="5cb63-114">Para más información, consulte [Deploying CLR Database Objects](../clr-integration/deploying-clr-database-objects.md).</span><span class="sxs-lookup"><span data-stu-id="5cb63-114">For more information, see [Deploying CLR Database Objects](../clr-integration/deploying-clr-database-objects.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5cb63-115">La capacidad de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para ejecutar el código CLR se encuentra desactivada de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="5cb63-115">The ability of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute CLR code is off by default.</span></span> <span data-ttu-id="5cb63-116">Puede crear, modificar y quitar objetos de base de datos que hacen referencia a los módulos de códigos administrados, pero estas referencias no se ejecutarán en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a menos que se haya habilitado la opción [clr enabled Option](../../database-engine/configure-windows/clr-enabled-server-configuration-option.md) por medio de [sp_configure (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5cb63-116">You can create, alter, and drop database objects that reference managed code modules, but these references will not execute in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] unless the [clr enabled Option](../../database-engine/configure-windows/clr-enabled-server-configuration-option.md) is enabled by using [sp_configure (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql).</span></span>  
  
## <a name="accessing-external-resources"></a><span data-ttu-id="5cb63-117">Obtener acceso a recursos externos</span><span class="sxs-lookup"><span data-stu-id="5cb63-117">Accessing External Resources</span></span>  
 <span data-ttu-id="5cb63-118">Las funciones CLR se pueden utilizar para obtener acceso a recursos externos tales como archivos, recursos de red, servicios web y otras bases de datos (incluidas las instancias remotas de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="5cb63-118">CLR functions can be used to access external resources such as files, network resources, Web Services, other databases (including remote instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]).</span></span> <span data-ttu-id="5cb63-119">Para ello, es posible utilizar diversas clases en [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)], como por ejemplo `System.IO`, `System.WebServices`, `System.Sql`, etc.</span><span class="sxs-lookup"><span data-stu-id="5cb63-119">This can be achieved by using various classes in the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)], such as `System.IO`, `System.WebServices`, `System.Sql`, and so on.</span></span> <span data-ttu-id="5cb63-120">El ensamblado que contiene estas funciones debe estar configurado por lo menos con el conjunto de permisos EXTERNAL_ACCESS que tiene este objetivo.</span><span class="sxs-lookup"><span data-stu-id="5cb63-120">The assembly that contains such functions should at least be configured with the EXTERNAL_ACCESS permission set for this purpose.</span></span> <span data-ttu-id="5cb63-121">Para más información, consulte [CREATE ASSEMBLY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-assembly-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5cb63-121">For more information, see [CREATE ASSEMBLY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-assembly-transact-sql).</span></span> <span data-ttu-id="5cb63-122">El proveedor administrado cliente SQL se puede utilizar para obtener acceso a instancias remotas de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5cb63-122">The SQL Client Managed Provider can be used to access remote instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="5cb63-123">No obstante, las conexiones vinculadas en bucles de retorno con el servidor de origen no están admitidas en las funciones CLR.</span><span class="sxs-lookup"><span data-stu-id="5cb63-123">However, loopback connections to the originating server are not supported in CLR functions.</span></span>  
  
 <span data-ttu-id="5cb63-124">**Para crear, modificar o quitar ensamblados de SQL Server**</span><span class="sxs-lookup"><span data-stu-id="5cb63-124">**To create, modify, or drop assemblies in SQL Server**</span></span>  
  
-   [<span data-ttu-id="5cb63-125">CREATE ASSEMBLY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="5cb63-125">CREATE ASSEMBLY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-assembly-transact-sql)  
  
-   [<span data-ttu-id="5cb63-126">ALTER ASSEMBLY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="5cb63-126">ALTER ASSEMBLY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-assembly-transact-sql)  
  
-   [<span data-ttu-id="5cb63-127">DROP ASSEMBLY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="5cb63-127">DROP ASSEMBLY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/drop-assembly-transact-sql)  
  
 <span data-ttu-id="5cb63-128">**Para crear una función CLR**</span><span class="sxs-lookup"><span data-stu-id="5cb63-128">**To create a CLR function**</span></span>  
  
-   [<span data-ttu-id="5cb63-129">CREATE FUNCTION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="5cb63-129">CREATE FUNCTION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-function-transact-sql)  
  
## <a name="accessing-native-code"></a><span data-ttu-id="5cb63-130">Acceso a código nativo</span><span class="sxs-lookup"><span data-stu-id="5cb63-130">Accessing Native Code</span></span>  
 <span data-ttu-id="5cb63-131">Las funciones CLR se pueden usar para tener acceso a código nativo (no administrado), como el código escrito en C o C++, a través del uso de PInvoke desde código administrado (vea [Llamar a funciones nativas desde código administrado](https://go.microsoft.com/fwlink/?LinkID=181929) para obtener detalles).</span><span class="sxs-lookup"><span data-stu-id="5cb63-131">CLR functions can be used to access native (unmanaged) code, such as code written in C or C++, via the use of PInvoke from managed code (see [Calling Native Functions from Managed Code](https://go.microsoft.com/fwlink/?LinkID=181929) for details).</span></span> <span data-ttu-id="5cb63-132">Así, puede reutilizar el código heredado como las UDF de CLR, o escribir UDF esenciales para el rendimiento en código nativo.</span><span class="sxs-lookup"><span data-stu-id="5cb63-132">This can allow you to re-use legacy code as CLR UDFs, or write performance-critical UDFs in native code.</span></span> <span data-ttu-id="5cb63-133">Esto requiere usar un ensamblado UNSAFE.</span><span class="sxs-lookup"><span data-stu-id="5cb63-133">This requires using an UNSAFE assembly.</span></span> <span data-ttu-id="5cb63-134">Vea [CLR Integration Code Access Security](../clr-integration/security/clr-integration-code-access-security.md) para conocer advertencias acerca del uso de ensamblados UNSAFE.</span><span class="sxs-lookup"><span data-stu-id="5cb63-134">See [CLR Integration Code Access Security](../clr-integration/security/clr-integration-code-access-security.md) for cautions about use of UNSAFE assemblies.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5cb63-135">Consulte también</span><span class="sxs-lookup"><span data-stu-id="5cb63-135">See Also</span></span>  
 <span data-ttu-id="5cb63-136">[Crear funciones definidas por el usuario &#40;motor de base de datos&#41;](create-user-defined-functions-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="5cb63-136">[Create User-defined Functions &#40;Database Engine&#41;](create-user-defined-functions-database-engine.md) </span></span>  
 <span data-ttu-id="5cb63-137">[Crear funciones de agregado definidas por el usuario](create-user-defined-aggregates.md) </span><span class="sxs-lookup"><span data-stu-id="5cb63-137">[Create User-defined Aggregates](create-user-defined-aggregates.md) </span></span>  
 <span data-ttu-id="5cb63-138">[Ejecutar funciones definidas por el usuario](execute-user-defined-functions.md) </span><span class="sxs-lookup"><span data-stu-id="5cb63-138">[Execute User-defined Functions](execute-user-defined-functions.md) </span></span>  
 <span data-ttu-id="5cb63-139">[Ver funciones definidas por el usuario](view-user-defined-functions.md) </span><span class="sxs-lookup"><span data-stu-id="5cb63-139">[View User-defined Functions](view-user-defined-functions.md) </span></span>  
 [<span data-ttu-id="5cb63-140">Conceptos de programación en el ámbito de la integración de Common Language Runtime &#40;CLR&#41;</span><span class="sxs-lookup"><span data-stu-id="5cb63-140">Common Language Runtime &#40;CLR&#41; Integration Programming Concepts</span></span>](../clr-integration/common-language-runtime-clr-integration-programming-concepts.md)  
  
  
