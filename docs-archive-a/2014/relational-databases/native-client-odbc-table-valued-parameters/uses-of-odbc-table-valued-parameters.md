---
title: Usos de los parámetros con valores de tabla de ODBC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), scenarios
- ODBC, table-valued parameters
ms.assetid: f1b73932-4570-4a8a-baa0-0f229d9c32ee
author: rothja
ms.author: jroth
ms.openlocfilehash: 2b128246f7c4ed9a9cec5e28698c743877f9873d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87749785"
---
# <a name="uses-of-odbc-table-valued-parameters"></a><span data-ttu-id="f7fa9-102">Usos de parámetros con valores de tabla de ODBC</span><span class="sxs-lookup"><span data-stu-id="f7fa9-102">Uses of ODBC Table-Valued Parameters</span></span>
  <span data-ttu-id="f7fa9-103">En este tema se describen los principales escenarios de usuario para usar parámetros con valores de tabla con ODBC:</span><span class="sxs-lookup"><span data-stu-id="f7fa9-103">This topic discusses the primary user scenarios for using table-valued parameters with ODBC:</span></span>  
  
-   <span data-ttu-id="f7fa9-104">Parámetro con valores de tabla con búferes con varias filas completamente enlazados (enviar datos como un TVP con todos los valores de la memoria)</span><span class="sxs-lookup"><span data-stu-id="f7fa9-104">Table-Valued Parameter with Fully Bound Multirow Buffers (Send Data as a TVP with All Values in Memory)</span></span>  
  
-   <span data-ttu-id="f7fa9-105">Parámetro con valores de tabla con transmisión de filas por secuencias (enviar datos como un TVP usando datos en ejecución)</span><span class="sxs-lookup"><span data-stu-id="f7fa9-105">Table-Valued Parameter with Row Streaming (Send Data as a TVP Using Data-At-Execution)</span></span>  
  
-   <span data-ttu-id="f7fa9-106">Recuperar metadatos de parámetros con valores de tabla desde el catálogo del sistema</span><span class="sxs-lookup"><span data-stu-id="f7fa9-106">Retrieving Table-Valued Parameter Metadata from the System Catalog</span></span>  
  
-   <span data-ttu-id="f7fa9-107">Recuperar metadatos de parámetros con valores de tabla para una instrucción preparada</span><span class="sxs-lookup"><span data-stu-id="f7fa9-107">Retrieving Table-Valued Parameter Metadata for a Prepared Statement</span></span>  
  
## <a name="table-valued-parameter-with-fully-bound-multirow-buffers-send-data-as-a-tvp-with-all-values-in-memory"></a><span data-ttu-id="f7fa9-108">Parámetro con valores de tabla con búferes con varias filas completamente enlazados (enviar datos como un TVP con todos los valores de la memoria)</span><span class="sxs-lookup"><span data-stu-id="f7fa9-108">Table-Valued Parameter with Fully Bound Multirow Buffers (Send Data as a TVP with All Values in Memory)</span></span>  
 <span data-ttu-id="f7fa9-109">Cuando se utilizan con búferes con varias filas completamente enlazados, todos los valores de parámetro están disponibles en la memoria.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-109">When used with fully bound multirow buffers, all parameter values are available in memory.</span></span> <span data-ttu-id="f7fa9-110">Esto es típico, por ejemplo, de una transacción OLTP, en la que los parámetros con valores de tabla pueden empaquetarse en un único procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-110">This is typical, for example, of an OLTP transaction, in which table-valued parameters can be packaged into a single stored procedure.</span></span> <span data-ttu-id="f7fa9-111">Sin parámetros con valores de tabla, esto implicaría generar dinámicamente un lote complejo de varias instrucciones o realizar varias llamadas al servidor.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-111">Without table-valued parameters, this would involve either generating a complex multi-statement batch dynamically, or making multiple calls to the server.</span></span>  
  
 <span data-ttu-id="f7fa9-112">El propio parámetro con valores de tabla se enlaza mediante [SQLBindParameter](https://go.microsoft.com/fwlink/?LinkId=59328) junto con los demás parámetros.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-112">The table-valued parameter itself is bound by using [SQLBindParameter](https://go.microsoft.com/fwlink/?LinkId=59328) along with the other parameters.</span></span> <span data-ttu-id="f7fa9-113">Una vez enlazados todos los parámetros, la aplicación establece el atributo de foco de parámetro, SQL_SOPT_SS_PARAM_FOCUS, en cada parámetro con valores de tabla y llama a SQLBindParameter para las columnas del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-113">After all parameters have been bound, the application sets the parameter focus attribute, SQL_SOPT_SS_PARAM_FOCUS, on each table-valued parameter and calls SQLBindParameter for the columns of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="f7fa9-114">El tipo de servidor de un parámetro con valores de tabla es un tipo nuevo específico de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], SQL_SS_TABLE.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-114">The server type for a table-valued parameter is a new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific type, SQL_SS_TABLE.</span></span> <span data-ttu-id="f7fa9-115">El tipo C de enlace para SQL_SS_TABLE debe ser siempre SQL_C_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-115">The binding C type for SQL_SS_TABLE must always be SQL_C_DEFAULT.</span></span> <span data-ttu-id="f7fa9-116">No se transfiere ningún dato para el parámetro enlazado al parámetro con valores de tabla; se usa para pasar metadatos de tabla y controlar la forma de pasar datos en las columnas constituyentes del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-116">No data is transferred for the table-valued parameter bound parameter; it is used to pass table metadata and to control how to pass data in the constituent columns of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="f7fa9-117">La longitud del parámetro con valores de tabla se establece en el número de filas que se envían al servidor.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-117">The length of the table-valued parameter is set to the number of rows being sent to the server.</span></span> <span data-ttu-id="f7fa9-118">El parámetro *columnas* de SQLBindParameter para un parámetro con valores de tabla especifica el número máximo de filas que se pueden enviar; es el tamaño de la matriz de los búferes de columna.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-118">The *ColumnSize* parameter of SQLBindParameter for a table-valued parameter specifies the maximum number of rows that can be sent; this is the array size of the column buffers.</span></span> <span data-ttu-id="f7fa9-119">*ParameterValuePtr* es el búfer de parámetros para un parámetro con valores de tabla en SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-119">*ParameterValuePtr* is the parameter buffer,for a table-valued parameter in SQLBindParameter.</span></span> <span data-ttu-id="f7fa9-120">*ParameterValuePtr* y sus *BufferLength* asociadas se utilizan para pasar el nombre de tipo del parámetro con valores de tabla cuando es necesario.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-120">*ParameterValuePtr* and its associated *BufferLength* are used to pass the type name of the table-valued parameter when required.</span></span> <span data-ttu-id="f7fa9-121">El nombre de tipo no es necesario para las llamadas a procedimientos almacenados, pero sí para las instrucciones SQL.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-121">The type name is not required for stored procedure calls, but it is required for SQL statements.</span></span>  
  
 <span data-ttu-id="f7fa9-122">Cuando se especifica un nombre de tipo de parámetro con valores de tabla en una llamada a SQLBindParameter, siempre debe especificarse como un valor Unicode, incluso en aplicaciones compiladas como aplicaciones ANSI.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-122">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="f7fa9-123">Cuando se especifica un nombre de tipo de parámetro con valores de tabla mediante SQLSetDescField, se puede utilizar un literal que se ajuste a la manera en que se compila la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-123">When you specify a table-valued parameter type name by using SQLSetDescField, you can use a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="f7fa9-124">El administrador de controladores ODBC realizará cualquier conversión Unicode que sea necesaria.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-124">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>  
  
 <span data-ttu-id="f7fa9-125">Los metadatos de los parámetros con valores de tabla y las columnas de parámetros con valores de tabla se pueden manipular de forma individual y explícita mediante SQLGetDescRec, SQLSetDescRec, SQLGetDescField y SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-125">Metadata for table-valued parameters and table-valued parameter columns can be manipulated individually and explicitly by using SQLGetDescRec, SQLSetDescRec, SQLGetDescField, and SQLSetDescField.</span></span> <span data-ttu-id="f7fa9-126">Sin embargo, la sobrecarga de SQLBindParameter suele ser más cómoda y no requiere acceso explícito al descriptor en la mayoría de los casos.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-126">However, overloading SQLBindParameter is usually more convenient and does not require explicit descriptor access in most cases.</span></span> <span data-ttu-id="f7fa9-127">Este enfoque es coherente con la definición de SQLBindParameter para otros tipos de datos, salvo que para un parámetro con valores de tabla, los campos de descriptor afectados son ligeramente diferentes.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-127">This approach is consistent with the definition of SQLBindParameter for other data types, except that for a table-valued parameter the affected descriptor fields are slightly different.</span></span>  
  
 <span data-ttu-id="f7fa9-128">A veces, una aplicación usa un parámetro con valores de tabla con SQL dinámico y debe proporcionarse el nombre de tipo del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-128">Sometimes, an application uses a table-valued parameter with dynamic SQL and the type name of the table-valued parameter must be supplied.</span></span> <span data-ttu-id="f7fa9-129">Si este es el caso y el parámetro con valores de tabla no está definido en el esquema predeterminado actual para la conexión, SQL_CA_SS_TYPE_CATALOG_NAME y SQL_CA_SS_TYPE_SCHEMA_NAME debe establecerse mediante SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-129">If this is the case and the table-valued parameter is not defined in the current default schema for the connection, SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME must be set by using SQLSetDescField.</span></span> <span data-ttu-id="f7fa9-130">Dado que las definiciones de tipo de tabla y los parámetros con valores de tabla deben estar en la misma base de datos, no debe establecerse SQL_CA_SS_TYPE_CATALOG_NAME si la aplicación utiliza parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-130">Because table type definitions and table-valued parameters must be in the same database, SQL_CA_SS_TYPE_CATALOG_NAME must not be set if the application uses table-valued parameters.</span></span> <span data-ttu-id="f7fa9-131">De lo contrario, SQLSetDescField notificará un error.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-131">Otherwise, SQLSetDescField will report an error.</span></span>  
  
 <span data-ttu-id="f7fa9-132">El código de ejemplo de este escenario se encuentra en el procedimiento `demo_fixed_TVP_binding` de [uso de parámetros con valores de tabla &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="f7fa9-132">Sample code for this scenario is in the procedure `demo_fixed_TVP_binding` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="table-valued-parameter-with-row-streaming-send-data-as-a-tvp-using-data-at-execution"></a><span data-ttu-id="f7fa9-133">Parámetro con valores de tabla con transmisión de filas por secuencias (enviar datos como un TVP usando datos en ejecución)</span><span class="sxs-lookup"><span data-stu-id="f7fa9-133">Table-Valued Parameter with Row Streaming (Send Data as a TVP Using Data-At-Execution)</span></span>  
 <span data-ttu-id="f7fa9-134">En este escenario, la aplicación proporciona filas al controlador a medida que éste las solicita y se transmiten por secuencias al servidor.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-134">In this scenario, the application supplies rows to the driver as it requests them and they are streamed to the server.</span></span> <span data-ttu-id="f7fa9-135">Esto evita tener que almacenar en el búfer todas las filas de la memoria.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-135">This avoids having to buffer all rows in memory.</span></span> <span data-ttu-id="f7fa9-136">Es representativo de los escenarios de inserción/actualización masiva.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-136">This is representative of bulk insert/update scenarios.</span></span> <span data-ttu-id="f7fa9-137">Los parámetros con valores de tabla proporcionan un punto de rendimiento en algún lugar entre las matrices de parámetros y la copia masiva.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-137">Table-valued parameters provide a performance point somewhere between parameter arrays and bulk copy.</span></span> <span data-ttu-id="f7fa9-138">Es decir, los parámetros con valores de tabla son casi tan fáciles de programar como las matrices de parámetros, pero proporcionan mayor flexibilidad en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-138">That is, table-valued parameters are about as easy to program as parameter arrays, but they provide greater flexibility at the server.</span></span>  
  
 <span data-ttu-id="f7fa9-139">El parámetro con valores de tabla y sus columnas se enlazan tal y como se explicó en la sección anterior, Parámetro con valores de tabla con búferes con varias filas completamente enlazados, pero el indicador de longitud del propio parámetro con valores de tabla se establece en SQL_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-139">The table-valued parameter and its columns are bound as discussed in the previous section, Table-Valued Parameter with Fully Bound Multirow Buffers, but the length indicator of the table-valued parameter itself is set to SQL_DATA_AT_EXEC.</span></span> <span data-ttu-id="f7fa9-140">El controlador responde a SQLExecute o SQLExecuteDirect de la forma habitual para los parámetros de datos en ejecución, es decir, devolviendo SQL_NEED_DATA.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-140">The driver responds to SQLExecute or SQLExecuteDirect in the usual way for data-at-execution parameters-that is, by returning SQL_NEED_DATA.</span></span> <span data-ttu-id="f7fa9-141">Cuando el controlador está listo para aceptar los datos de un parámetro con valores de tabla, SQLParamData devuelve el valor de *ParameterValuePtr* en SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-141">When the driver is ready to accept data for a table-valued parameter, SQLParamData returns the value of *ParameterValuePtr* in SQLBindParameter.</span></span>  
  
 <span data-ttu-id="f7fa9-142">Una aplicación utiliza SQLPutData para un parámetro con valores de tabla para indicar la disponibilidad de los datos para las columnas de componentes de parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-142">An application uses SQLPutData for a table-valued parameter to indicate the availability of data for table-valued parameter constituent columns.</span></span> <span data-ttu-id="f7fa9-143">Cuando se llama a SQLPutData para un parámetro con valores de tabla, *DataPtr* siempre debe ser null y *StrLen_or_Ind* debe ser 0 o un número menor o igual que el tamaño de la matriz especificado para los búferes de parámetros con valores de tabla (el parámetro *columnas* de SQLBindParameter).</span><span class="sxs-lookup"><span data-stu-id="f7fa9-143">When SQLPutData is called for a table-valued parameter, *DataPtr* must always be null and *StrLen_or_Ind* must be either 0 or a number less than or equal to the array size specified for table-valued parameter buffers (the *ColumnSize* parameter of SQLBindParameter).</span></span> <span data-ttu-id="f7fa9-144">0 significa que no hay más filas para el parámetro con valores de tabla y que el controlador pasará a procesar el siguiente parámetro de procedimiento real.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-144">0 signifies that there are no more rows for the table-valued parameter, and the driver will proceed to process to the next actual procedure parameter.</span></span> <span data-ttu-id="f7fa9-145">Cuando *StrLen_or_Ind* no es 0, el controlador procesará las columnas constitutivas de parámetro con valores de tabla del mismo modo que los parámetros enlazados de parámetros con valores de tabla: cada columna de parámetro con valores de tabla puede especificar su longitud de datos real, SQL_NULL_DATA o puede especificar datos en ejecución a través de su búfer de longitud/indicador.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-145">When *StrLen_or_Ind* is not 0, the driver will process the table-valued parameter constituent columns in the same way as non-table-valued parameter bound parameters: Each table-valued parameter column can specify its actual data length, SQL_NULL_DATA, or it can specify data at execution via its length/indicator buffer.</span></span> <span data-ttu-id="f7fa9-146">Los valores de columna de parámetro con valores de tabla se pueden pasar mediante llamadas repetidas a SQLPutData como de costumbre cuando se va a pasar un carácter o un valor binario en partes.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-146">Table-valued parameter column values can be passed by repeated calls to SQLPutData as usual when a character or binary value is to be passed in pieces.</span></span>  
  
 <span data-ttu-id="f7fa9-147">Cuando se han procesado todas las columnas de parámetro con valores de tabla, el controlador regresa al parámetro con valores de tabla para procesar más filas de datos de parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-147">When all table-valued parameter columns have been processed, the driver returns to the table-valued parameter to process further rows of table-valued parameter data.</span></span> <span data-ttu-id="f7fa9-148">Por lo tanto, para los parámetros con valores de tabla de datos en ejecución, el controlador no sigue el examen secuencial habitual de los parámetros enlazados.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-148">Therefore, for data-at-execution table-valued parameters, the driver does not follow the usual sequential scan of bound parameters.</span></span> <span data-ttu-id="f7fa9-149">Se sondeará un parámetro con valores de tabla enlazado hasta que se llame a SQLPutData con *StrLen_Or_IndPtr* igual a 0, momento en el que el controlador omite las columnas de parámetro con valores de tabla y se mueve al siguiente parámetro de procedimiento almacenado real.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-149">A bound table-valued parameter will be polled until SQLPutData is called with *StrLen_Or_IndPtr* equal to 0, at which time the driver skips table-valued parameter columns and moves to the next actual stored procedure parameter.</span></span>  <span data-ttu-id="f7fa9-150">Cuando SQLPutData pasa un valor de indicador mayor o igual que 1, el controlador procesa las filas y columnas de parámetros con valores de tabla secuencialmente hasta que tenga valores para todas las filas y columnas enlazadas.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-150">When SQLPutData passes an indicator value greater than or equal to 1, the driver processes table-valued parameter columns and rows sequentially until it has values for all bound rows and columns.</span></span> <span data-ttu-id="f7fa9-151">A continuación, el controlador regresa al parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-151">Then the driver returns to the table-valued parameter.</span></span> <span data-ttu-id="f7fa9-152">Entre la recepción del token para el parámetro con valores de tabla de SQLParamData y la llamada a SQLPutData (hstmt, NULL, n) para un parámetro con valores de tabla, la aplicación debe establecer los datos de las columnas de los componentes del parámetro con valores de tabla y el contenido del búfer del indicador para la siguiente fila o filas que se van a pasar al servidor.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-152">Between receiving the token for the table-valued parameter from SQLParamData and calling SQLPutData(hstmt, NULL, n) for a table-valued parameter, the application must set table-valued parameter constituent column data and indicator buffer contents for the next row or rows to be passed to the server.</span></span>  
  
 <span data-ttu-id="f7fa9-153">El código de ejemplo de este escenario se encuentra en la rutina `demo_variable_TVP_binding` de [usar parámetros con valores de tabla &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="f7fa9-153">Sample code for this scenario is in the routine `demo_variable_TVP_binding` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="retrieving-table-valued-parameter-metadata-from-the-system-catalog"></a><span data-ttu-id="f7fa9-154">Recuperar metadatos de parámetros con valores de tabla desde el catálogo del sistema</span><span class="sxs-lookup"><span data-stu-id="f7fa9-154">Retrieving Table-Valued Parameter Metadata from the System Catalog</span></span>  
 <span data-ttu-id="f7fa9-155">Cuando una aplicación llama a SQLProcedureColumns para un procedimiento que tiene parámetros de parámetro con valores de tabla, DATA_TYPE se devuelve como SQL_SS_TABLE y TYPE_NAME es el nombre del tipo de tabla para el parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-155">When an application calls SQLProcedureColumns for a procedure that has table-valued parameter parameters, DATA_TYPE is returned as SQL_SS_TABLE and TYPE_NAME is the name of the table type for the table-valued parameter.</span></span> <span data-ttu-id="f7fa9-156">Se agregan dos columnas adicionales al conjunto de resultados devuelto por SQLProcedureColumns: SS_TYPE_CATALOG_NAME devuelve el nombre del catálogo donde se define el tipo de tabla del parámetro de valor de tabla y SS_TYPE_SCHEMA_NAME devuelve el nombre del esquema donde se define el tipo de tabla del parámetro de valor de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-156">Two additional columns are added to the result set returned by SQLProcedureColumns: SS_TYPE_CATALOG_NAME returns the name of the catalog where the table type of the table-value parameter is defined, and SS_TYPE_SCHEMA_NAME returns the name of the schema where the where the table type of the table-value parameter is defined.</span></span> <span data-ttu-id="f7fa9-157">De acuerdo con la especificación ODBC, SS_TYPE_CATALOG_NAME y SS_TYPE_SCHEMA_NAME aparecen antes que todas las columnas específicas del controlador agregadas en versiones anteriores de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] y después de todas las columnas asignadas por el propio ODBC.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-157">In conformance with the ODBC specification, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME appear before all driver specific columns that were added in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and after all columns mandated by ODBC itself.</span></span>  
  
 <span data-ttu-id="f7fa9-158">Las nuevas columnas no solo se rellenarán para los parámetros con valores de tabla, sino también para los parámetros de tipo definidos por el usuario CLR.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-158">The new columns will be populated not only for table-valued parameters, but also for CLR user-defined type parameters.</span></span> <span data-ttu-id="f7fa9-159">El esquema y las columnas de catálogo existentes de los parámetros UDT también se rellenarán, pero al tener un esquema y columnas de catálogo comunes para los tipos de datos que los requieren, se simplificará el desarrollo futuro de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-159">The existing schema and catalog columns of UDT parameters will still be populated, but having common schema and catalog columns for data types that require them will simplify application development in the future.</span></span> <span data-ttu-id="f7fa9-160">(Tenga en cuenta que las colecciones de esquemas XML son algo diferentes y no se incluyen en este cambio.)</span><span class="sxs-lookup"><span data-stu-id="f7fa9-160">(Note that XML schema collections are somewhat different and are not included in this change.)</span></span>  
  
 <span data-ttu-id="f7fa9-161">Una aplicación utiliza SQLTables para determinar los nombres de los tipos de tabla de la misma manera que lo hace para las tablas persistentes, las tablas del sistema y las vistas.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-161">An application uses SQLTables to determine the names of table types the same way it does for persistent tables, system tables, and views.</span></span> <span data-ttu-id="f7fa9-162">Se ha introducido un nuevo tipo de tabla, TABLE TYPE, para permitir que una aplicación identifique los tipos de tabla asociados a parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-162">A new table type, TABLE TYPE, is introduced to enable an application to identify table types associated with table-valued parameters.</span></span> <span data-ttu-id="f7fa9-163">Los tipos de tabla y las tablas normales usan espacios de nombres diferentes.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-163">Table types and regular tables use different namespaces.</span></span> <span data-ttu-id="f7fa9-164">Esto significa que puede utilizarse el mismo nombre tanto para un tipo de tabla como para una tabla real.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-164">This means that you can use the same name for both a table type and an actual table.</span></span> <span data-ttu-id="f7fa9-165">Para administrar esto, se ha introducido un nuevo atributo de instrucción, SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-165">To handle this, a new statement attribute, SQL_SOPT_SS_NAME_SCOPE, has been introduced.</span></span> <span data-ttu-id="f7fa9-166">Este atributo especifica si SQLTables y otras funciones de catálogo que toman un nombre de tabla como parámetro deben interpretar el nombre de la tabla como el nombre de una tabla real o el nombre de un tipo de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-166">This attribute specifies whether SQLTables and other catalog functions that take a table name as a parameter should interpret the table name as the name of an actual table or the name of a table type.</span></span>  
  
 <span data-ttu-id="f7fa9-167">Una aplicación utiliza SQLColumns para determinar las columnas de un tipo de tabla del mismo modo que lo hace para las tablas persistentes, pero debe establecer primero SQL_SOPT_SS_NAME_SCOPE para indicar que está trabajando con tipos de tabla en lugar de tablas reales.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-167">An application uses SQLColumns to determine the columns for a table type in the same way it does for persistent tables, but must first set SQL_SOPT_SS_NAME_SCOPE to indicate that it is working with table types rather than actual tables.</span></span> <span data-ttu-id="f7fa9-168">SQLPrimaryKeys también se puede usar con tipos de tabla, de nuevo con SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-168">SQLPrimaryKeys can also be used with table types, again using SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="f7fa9-169">El código de ejemplo de este escenario se encuentra en la rutina `demo_metadata_from_catalog_APIs` de [usar parámetros con valores de tabla &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="f7fa9-169">Sample code for this scenario is in the routine `demo_metadata_from_catalog_APIs` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="retrieving-table-valued-parameter-metadata-for-a-prepared-statement"></a><span data-ttu-id="f7fa9-170">Recuperar metadatos de parámetros con valores de tabla para una instrucción preparada</span><span class="sxs-lookup"><span data-stu-id="f7fa9-170">Retrieving Table-Valued Parameter Metadata for a Prepared Statement</span></span>  
 <span data-ttu-id="f7fa9-171">En este escenario, una aplicación usa SQLNumParameters y SQLDescribeParam para recuperar los metadatos de los parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-171">In this scenario, an application uses SQLNumParameters and SQLDescribeParam to retrieve metadata for table-valued parameters.</span></span>  
  
 <span data-ttu-id="f7fa9-172">El campo IPD SQL_CA_SS_TYPE_NAME se usa para recuperar el nombre de tipo del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-172">The IPD field SQL_CA_SS_TYPE_NAME is used to retrieve the type name for the table-valued parameter.</span></span> <span data-ttu-id="f7fa9-173">Los campos IPD SQL_CA_SS_TYPE_SCHEMA_NAME y SQL_CA_SS_TYPE_CATALOG_NAME se usan para recuperar su catálogo y su esquema, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-173">The IPD fields SQL_CA_SS_TYPE_SCHEMA_NAME and SQL_CA_SS_TYPE_CATALOG_NAME are used to retrieve its catalog and schema, respectively.</span></span>  
  
 <span data-ttu-id="f7fa9-174">Las definiciones de tipo de tabla y los parámetros con valores de tabla deben estar en la misma base de datos.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-174">Table type definitions and table-valued parameters must be in the same database.</span></span> <span data-ttu-id="f7fa9-175">SQLSetDescField notificará un error si una aplicación establece SQL_CA_SS_TYPE_CATALOG_NAME cuando se usan parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-175">SQLSetDescField will report an error if an application sets SQL_CA_SS_TYPE_CATALOG_NAME when using table-valued parameters.</span></span>  
  
 <span data-ttu-id="f7fa9-176">SQL_CA_SS_TYPE_CATALOG_NAME y SQL_CA_SS_TYPE_SCHEMA_NAME también pueden utilizarse para recuperar el catálogo y el esquema asociados a parámetros de tipo definidos por el usuario CLR.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-176">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="f7fa9-177">SQL_CA_SS_TYPE_CATALOG_NAME y SQL_CA_SS_TYPE_SCHEMA_NAME son alternativas a los atributos existentes de esquema de catálogo específicos del tipo para tipos UDT CLR.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-177">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME are alternatives to the existing type specific catalog schema attributes for CLR UDT types.</span></span>  
  
 <span data-ttu-id="f7fa9-178">Una aplicación utiliza SQLColumns para recuperar metadatos de columna para un parámetro con valores de tabla en este escenario, porque SQLDescribeParam no devuelve metadatos para las columnas de una columna de parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="f7fa9-178">An application uses SQLColumns to retrieve column metadata for a table-valued parameter in this scenario, too, because SQLDescribeParam does not return metadata for the columns of a table-valued parameter column.</span></span>  
  
 <span data-ttu-id="f7fa9-179">El código de ejemplo de este caso de uso se encuentra en la rutina `demo_metadata_from_prepared_statement` de [usar parámetros con valores de tabla &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="f7fa9-179">Sample code for this use case is in the routine `demo_metadata_from_prepared_statement` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7fa9-180">Consulte también</span><span class="sxs-lookup"><span data-stu-id="f7fa9-180">See Also</span></span>  
 [<span data-ttu-id="f7fa9-181">Parámetros con valores de tabla &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="f7fa9-181">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
