---
title: Enlace y Transferencia de datos de parámetros con valores de tabla y valores de columna | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), binding and data transfer
ms.assetid: 0a2ea462-d613-42b6-870f-c7fa086a6b42
author: rothja
ms.author: jroth
ms.openlocfilehash: 2e9e30e22a69b2d500990cc1481506b4edbda99b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87675855"
---
# <a name="binding-and-data-transfer-of-table-valued-parameters-and-column-values"></a><span data-ttu-id="8135a-102">Enlace y transferencia de datos de valores de columnas y parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="8135a-102">Binding and Data Transfer of Table-Valued Parameters and Column Values</span></span>
  <span data-ttu-id="8135a-103">Los parámetros con valores de tabla, al igual que otros parámetros, deben enlazarse antes de pasarse al servidor.</span><span class="sxs-lookup"><span data-stu-id="8135a-103">Table-valued parameters, like other parameters, must be bound before they are passed to the server.</span></span> <span data-ttu-id="8135a-104">La aplicación enlaza los parámetros con valores de tabla del mismo modo que enlaza otros parámetros: mediante SQLBindParameter o llamadas equivalentes a SQLSetDescField o SQLSetDescRec.</span><span class="sxs-lookup"><span data-stu-id="8135a-104">The application binds table-valued parameters the same way it binds other parameters: by using SQLBindParameter or equivalent calls to SQLSetDescField or SQLSetDescRec.</span></span> <span data-ttu-id="8135a-105">El tipo de datos del servidor para un parámetro con valores de tabla es SQL_SS_TABLE.</span><span class="sxs-lookup"><span data-stu-id="8135a-105">The server data type for a table-valued parameter is SQL_SS_TABLE.</span></span> <span data-ttu-id="8135a-106">El tipo de C puede especificarse como SQL_C_DEFAULT o SQL_C_BINARY.</span><span class="sxs-lookup"><span data-stu-id="8135a-106">The C type can be specified either as SQL_C_DEFAULT or SQL_C_BINARY.</span></span>  
  
 <span data-ttu-id="8135a-107">En [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] o posterior, solo se admiten parámetros con valores de tabla de entrada.</span><span class="sxs-lookup"><span data-stu-id="8135a-107">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or later, only input table-valued parameters are supported.</span></span> <span data-ttu-id="8135a-108">Por lo tanto, cualquier intento de establecer SQL_DESC_PARAMETER_TYPE en un valor distinto de SQL_PARAM_INPUT devolverá SQL_ERROR con SQLSTATE = HY105 y el mensaje "Tipo de parámetro no válido".</span><span class="sxs-lookup"><span data-stu-id="8135a-108">Therefore, any attempt to set SQL_DESC_PARAMETER_TYPE to a value other than SQL_PARAM_INPUT will return SQL_ERROR with SQLSTATE = HY105 and the message "Invalid parameter type".</span></span>  
  
 <span data-ttu-id="8135a-109">Es posible asignar valores predeterminados a columnas completas de parámetros con valores de tabla mediante el atributo SQL_CA_SS_COL_HAS_DEFAULT_VALUE.</span><span class="sxs-lookup"><span data-stu-id="8135a-109">Entire table-valued parameter columns can be assigned default values by using the attribute SQL_CA_SS_COL_HAS_DEFAULT_VALUE.</span></span> <span data-ttu-id="8135a-110">No obstante, los valores de columna de parámetros con valores de tabla individuales no pueden tener asignados valores predeterminados mediante SQL_DEFAULT_PARAM en *StrLen_or_IndPtr* con SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="8135a-110">Individual table-valued parameter column values, however, cannot be assigned default values by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="8135a-111">Los parámetros con valores de tabla como un conjunto no se pueden establecer en un valor predeterminado mediante SQL_DEFAULT_PARAM en *StrLen_or_IndPtr* con SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="8135a-111">Table-valued parameters as a whole cannot be set to a default value by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="8135a-112">Si no se siguen estas reglas, SQLExecute o SQLExecDirect devolverán SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="8135a-112">If these rules are not followed, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="8135a-113">Se generará un registro de diagnóstico con SQLSTATE = 07S01 y el mensaje "uso no válido de parámetro predeterminado para \<p> el parámetro", donde \<p> es el ordinal de TVP en la instrucción de consulta.</span><span class="sxs-lookup"><span data-stu-id="8135a-113">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>", where \<p> is the ordinal of the TVP in the query statement.</span></span>  
  
 <span data-ttu-id="8135a-114">Después de enlazar el parámetro con valores de tabla, la aplicación debe enlazar cada una de las columnas de parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-114">After binding the table-valued parameter, the application must then bind each table-valued parameter column.</span></span> <span data-ttu-id="8135a-115">Para ello, la aplicación llama primero a SQLSetStmtAttr para establecer SQL_SOPT_SS_PARAM_FOCUS en el ordinal de un parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-115">To do this, the application first calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a table-valued parameter.</span></span> <span data-ttu-id="8135a-116">A continuación, la aplicación enlaza las columnas del parámetro con valores de tabla mediante llamadas a las siguientes rutinas: SQLBindParameter, SQLSetDescRec y SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="8135a-116">Then the application binds the columns of the table-valued parameter by calls to the following routines: SQLBindParameter, SQLSetDescRec, and SQLSetDescField.</span></span> <span data-ttu-id="8135a-117">Si se establece SQL_SOPT_SS_PARAM_FOCUS en 0, se restaura el efecto habitual de SQLBindParameter, SQLSetDescRec y SQLSetDescField en el funcionamiento de los parámetros de nivel superior normales.</span><span class="sxs-lookup"><span data-stu-id="8135a-117">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores the usual effect of SQLBindParameter, SQLSetDescRec, and SQLSetDescField in operating on regular top-level parameters.</span></span>  
  
 <span data-ttu-id="8135a-118">No se envían ni se reciben datos reales para el propio parámetro con valores de tabla, sino que los datos se envían y se reciben para cada una de sus columnas constitutivas.</span><span class="sxs-lookup"><span data-stu-id="8135a-118">No actual data is sent or received for the table-valued parameter itself, but data is sent and received for each of its constituent columns.</span></span> <span data-ttu-id="8135a-119">Dado que el parámetro con valores de tabla es una pseudo columna, los parámetros de SQLBindParameter se usan para hacer referencia a atributos diferentes a los de otros tipos de datos, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="8135a-119">Because the table-valued parameter is a pseudo column, the parameters for SQLBindParameter are used to refer to different attributes than other data types, as follows:</span></span>  
  
|<span data-ttu-id="8135a-120">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8135a-120">Parameter</span></span>|<span data-ttu-id="8135a-121">Atributo relacionado para tipos de parámetros que no son valores de tabla, incluidas columnas</span><span class="sxs-lookup"><span data-stu-id="8135a-121">Related attribute for non-table-valued parameter types, including columns</span></span>|<span data-ttu-id="8135a-122">Atributo relacionado para parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="8135a-122">Related attribute for table-valued parameters</span></span>|  
|---------------|--------------------------------------------------------------------------------|----------------------------------------------------|  
|<span data-ttu-id="8135a-123">*InputOutputType*</span><span class="sxs-lookup"><span data-stu-id="8135a-123">*InputOutputType*</span></span>|<span data-ttu-id="8135a-124">SQL_DESC_PARAMETER_TYPE en IPD.</span><span class="sxs-lookup"><span data-stu-id="8135a-124">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="8135a-125">En el caso de las columnas de parámetros con valores de tabla, debe ser igual que el valor del propio parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-125">For table-valued parameter columns, this must be the same as the setting for the table-valued parameter itself.</span></span>|<span data-ttu-id="8135a-126">SQL_DESC_PARAMETER_TYPE en IPD.</span><span class="sxs-lookup"><span data-stu-id="8135a-126">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="8135a-127">Debe ser SQL_PARAM_INPUT.</span><span class="sxs-lookup"><span data-stu-id="8135a-127">This must be SQL_PARAM_INPUT.</span></span>|  
|<span data-ttu-id="8135a-128">*ValueType*</span><span class="sxs-lookup"><span data-stu-id="8135a-128">*ValueType*</span></span>|<span data-ttu-id="8135a-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE en APD.</span><span class="sxs-lookup"><span data-stu-id="8135a-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span>|<span data-ttu-id="8135a-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE en APD.</span><span class="sxs-lookup"><span data-stu-id="8135a-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span><br /><br /> <span data-ttu-id="8135a-131">Debe ser SQL_C_DEFAULT o SQL_C_BINARY.</span><span class="sxs-lookup"><span data-stu-id="8135a-131">This must be SQL_C_DEFAULT or SQL_C_BINARY.</span></span>|  
|<span data-ttu-id="8135a-132">*ParameterType*</span><span class="sxs-lookup"><span data-stu-id="8135a-132">*ParameterType*</span></span>|<span data-ttu-id="8135a-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE en IPD.</span><span class="sxs-lookup"><span data-stu-id="8135a-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span>|<span data-ttu-id="8135a-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE en IPD.</span><span class="sxs-lookup"><span data-stu-id="8135a-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="8135a-135">Debe ser SQL_SS_TABLE.</span><span class="sxs-lookup"><span data-stu-id="8135a-135">This must be SQL_SS_TABLE.</span></span>|  
|<span data-ttu-id="8135a-136">*ColumnSize*</span><span class="sxs-lookup"><span data-stu-id="8135a-136">*ColumnSize*</span></span>|<span data-ttu-id="8135a-137">SQL_DESC_LENGTH o SQL_DESC_PRECISION en IPD.</span><span class="sxs-lookup"><span data-stu-id="8135a-137">SQL_DESC_LENGTH or SQL_DESC_PRECISION in IPD.</span></span><br /><br /> <span data-ttu-id="8135a-138">Esto depende del valor de *ParameterType*.</span><span class="sxs-lookup"><span data-stu-id="8135a-138">This depends on the value of *ParameterType*.</span></span>|<span data-ttu-id="8135a-139">SQL_DESC_ARRAY_SIZE</span><span class="sxs-lookup"><span data-stu-id="8135a-139">SQL_DESC_ARRAY_SIZE</span></span><br /><br /> <span data-ttu-id="8135a-140">También puede establecerse mediante el uso de SQL_ATTR_PARAM_SET_SIZE cuando el foco del parámetro está establecido en el parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-140">Can also be set using SQL_ATTR_PARAM_SET_SIZE when the parameter focus is set to the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="8135a-141">En el caso de un parámetro con valores de tabla, se trata del número de filas de los búferes de columna del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-141">For a table-valued parameter, this is the number of rows in the table-valued parameter column buffers.</span></span>|  
|<span data-ttu-id="8135a-142">*DecimalDigits*</span><span class="sxs-lookup"><span data-stu-id="8135a-142">*DecimalDigits*</span></span>|<span data-ttu-id="8135a-143">SQL_DESC_PRECISION o SQL_DESC_SCALE en IPD.</span><span class="sxs-lookup"><span data-stu-id="8135a-143">SQL_DESC_PRECISION or SQL_DESC_SCALE in IPD.</span></span>|<span data-ttu-id="8135a-144">Sin usar.</span><span class="sxs-lookup"><span data-stu-id="8135a-144">Unused.</span></span> <span data-ttu-id="8135a-145">Debe ser 0.</span><span class="sxs-lookup"><span data-stu-id="8135a-145">This must be 0.</span></span><br /><br /> <span data-ttu-id="8135a-146">Si este parámetro no es 0, SQLBindParameter devolverá SQL_ERROR y se generará un registro de diagnóstico con SQLSTATE = HY104 y el mensaje "precisión o escala no válida".</span><span class="sxs-lookup"><span data-stu-id="8135a-146">If this parameter is not 0, SQLBindParameter will return SQL_ERROR, and a diagnostic record will be generated with SQLSTATE= HY104 and the message "Invalid precision or scale".</span></span>|  
|<span data-ttu-id="8135a-147">*ParameterValuePtr*</span><span class="sxs-lookup"><span data-stu-id="8135a-147">*ParameterValuePtr*</span></span>|<span data-ttu-id="8135a-148">SQL_DESC_DATA_PTR en APD.</span><span class="sxs-lookup"><span data-stu-id="8135a-148">SQL_DESC_DATA_PTR in APD.</span></span>|<span data-ttu-id="8135a-149">SQL_CA_SS_TYPE_NAME.</span><span class="sxs-lookup"><span data-stu-id="8135a-149">SQL_CA_SS_TYPE_NAME.</span></span><br /><br /> <span data-ttu-id="8135a-150">Es opcional para las llamadas a procedimientos almacenados y puede especificarse NULL si no se requiere.</span><span class="sxs-lookup"><span data-stu-id="8135a-150">This is optional for stored procedure calls, and NULL can be specified if it is not required.</span></span> <span data-ttu-id="8135a-151">Debe especificarse para las instrucciones SQL que no sean llamadas a procedimientos.</span><span class="sxs-lookup"><span data-stu-id="8135a-151">It must be specified for SQL statements that are not procedure calls.</span></span><br /><br /> <span data-ttu-id="8135a-152">Este parámetro también actúa como un valor único que la aplicación puede usar para identificar este parámetro con valores de tabla cuando se usa el enlace de filas variable.</span><span class="sxs-lookup"><span data-stu-id="8135a-152">This parameter also serves as a unique value that the application can use to identify this table-valued parameter when variable row binding is used.</span></span> <span data-ttu-id="8135a-153">Para obtener más información, consulte la sección "Enlace de filas variable de parámetros con valores de tabla" más adelante en este mismo tema.</span><span class="sxs-lookup"><span data-stu-id="8135a-153">For more information, see the "Variable Table-Valued Parameter Row Binding" section, later in this topic.</span></span><br /><br /> <span data-ttu-id="8135a-154">Cuando se especifica un nombre de tipo de parámetro con valores de tabla en una llamada a SQLBindParameter, debe especificarse como un valor Unicode, incluso en aplicaciones compiladas como aplicaciones ANSI.</span><span class="sxs-lookup"><span data-stu-id="8135a-154">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="8135a-155">El valor usado para el parámetro *StrLen_or_IndPtr* debe ser SQL_NTS o la longitud de la cadena del nombre multiplicado por SIZEOF (WCHAR).</span><span class="sxs-lookup"><span data-stu-id="8135a-155">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span>|  
|<span data-ttu-id="8135a-156">*BufferLength*</span><span class="sxs-lookup"><span data-stu-id="8135a-156">*BufferLength*</span></span>|<span data-ttu-id="8135a-157">SQL_DESC_OCTET_LENGTH en APD.</span><span class="sxs-lookup"><span data-stu-id="8135a-157">SQL_DESC_OCTET_LENGTH in APD.</span></span>|<span data-ttu-id="8135a-158">Longitud en bytes del nombre de tipo de parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-158">The length of the table-valued parameter type name in bytes.</span></span><br /><br /> <span data-ttu-id="8135a-159">Puede ser SQL_NTS si el nombre de tipo termina en NULL, o 0 si no se requiere el nombre de tipo de parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-159">This can be SQL_NTS if the type name is null terminated, or 0 if the table-valued parameter type name is not required.</span></span>|  
|<span data-ttu-id="8135a-160">*StrLen_or_IndPtr*</span><span class="sxs-lookup"><span data-stu-id="8135a-160">*StrLen_or_IndPtr*</span></span>|<span data-ttu-id="8135a-161">SQL_DESC_OCTET_LENGTH_PTR en APD.</span><span class="sxs-lookup"><span data-stu-id="8135a-161">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span>|<span data-ttu-id="8135a-162">SQL_DESC_OCTET_LENGTH_PTR en APD.</span><span class="sxs-lookup"><span data-stu-id="8135a-162">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span><br /><br /> <span data-ttu-id="8135a-163">En el caso de los parámetros con valores de tabla, es un recuento de filas en lugar de una longitud de datos.</span><span class="sxs-lookup"><span data-stu-id="8135a-163">For table-valued parameters, this is a row count rather than a data length.</span></span>|  
  
 <span data-ttu-id="8135a-164">Se admiten dos modos de transferencia de datos para los parámetros con valores de tabla: enlace de filas fijo y enlace de filas variable.</span><span class="sxs-lookup"><span data-stu-id="8135a-164">Two data transfer modes are supported for table-valued parameters: fixed row binding and variable row binding.</span></span>  
  
## <a name="fixed-table-valued-parameter-row-binding"></a><span data-ttu-id="8135a-165">Enlace de filas fijo de parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="8135a-165">Fixed Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="8135a-166">En el caso del enlace de filas fijo, una aplicación asigna búferes (o matrices de búferes) suficientemente grandes para todos los valores posibles de columnas de entrada.</span><span class="sxs-lookup"><span data-stu-id="8135a-166">For fixed row binding, an application allocates buffers (or buffer arrays) large enough for all possible input column values.</span></span> <span data-ttu-id="8135a-167">La aplicación hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8135a-167">The application does the following:</span></span>  
  
1.  <span data-ttu-id="8135a-168">Enlaza todos los parámetros mediante llamadas a SQLBindParameter, SQLSetDescRec o SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="8135a-168">Binds all parameters by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    1.  <span data-ttu-id="8135a-169">Establece SQL_DESC_ARRAY_SIZE en el número máximo de filas que pueden transferirse para cada parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-169">Sets SQL_DESC_ARRAY_SIZE to the maximum number of rows that can be transferred for each table-valued parameter.</span></span> <span data-ttu-id="8135a-170">Esto puede realizarse en la llamada SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="8135a-170">This can be done in the SQLBindParameter call.</span></span>  
  
2.  <span data-ttu-id="8135a-171">Llama a SQLSetStmtAttr para establecer SQL_SOPT_SS_PARAM_FOCUS en el ordinal de cada parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="8135a-171">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of each table-valued parameter.</span></span>  
  
    1.  <span data-ttu-id="8135a-172">Para cada parámetro con valores de tabla, enlaza las columnas de parámetro con valores de tabla mediante las llamadas SQLBindParameter, SQLSetDescRec o SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="8135a-172">For each table-valued parameter, binds table-valued parameter columns by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    2.  <span data-ttu-id="8135a-173">Para cada columna de parámetro con valores de tabla que va a tener valores predeterminados, llama a SQLSetDescField para establecer SQL_CA_SS_COL_HAS_DEFAULT_VALUE en 1.</span><span class="sxs-lookup"><span data-stu-id="8135a-173">For each table-valued parameter column that is to have default values, calls SQLSetDescField to set SQL_CA_SS_COL_HAS_DEFAULT_VALUE to 1.</span></span>  
  
3.  <span data-ttu-id="8135a-174">Llama a SQLSetStmtAttr para establecer SQL_SOPT_SS_PARAM_FOCUS en 0.</span><span class="sxs-lookup"><span data-stu-id="8135a-174">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to 0.</span></span> <span data-ttu-id="8135a-175">Esto debe hacerse antes de llamar a SQLExecute o SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="8135a-175">This must be done before SQLExecute or SQLExecDirect is called.</span></span> <span data-ttu-id="8135a-176">De lo contrario, se devuelve SQL_ERROR y se genera un registro de diagnóstico con SQLSTATE=HY024 y el mensaje "Valor de atributo no válido, SQL_SOPT_SS_PARAM_FOCUS (debe ser cero en el tiempo de ejecución)".</span><span class="sxs-lookup"><span data-stu-id="8135a-176">Otherwise, SQL_ERROR is be returned and a diagnostic record is generated with SQLSTATE=HY024 and the message "Invalid attribute value, SQL_SOPT_SS_PARAM_FOCUS (must be zero at execution time)".</span></span>  
  
4.  <span data-ttu-id="8135a-177">Establece *StrLen_or_IndPtr* o SQL_DESC_OCTET_LENGTH_PTR en SQL_DEFAULT_PARAM para un parámetro con valores de tabla sin filas, o el número de filas que se van a transferir en la siguiente llamada a SQLExecute o SQLExecDirect si el parámetro con valores de tabla tiene filas.</span><span class="sxs-lookup"><span data-stu-id="8135a-177">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR to SQL_DEFAULT_PARAM for a table-valued parameter with no rows, or the number of rows to be transferred on the next call of SQLExecute or SQLExecDirect if the table-valued parameter has rows.</span></span> <span data-ttu-id="8135a-178">*StrLen_or_IndPtr* o SQL_DESC_OCTET_LENGTH_PTR no se pueden establecer en SQL_NULL_DATA para un parámetro con valores de tabla, ya que los parámetros con valores de tabla no admiten valores NULL (aunque las columnas de componentes de parámetro con valores de tabla pueden aceptar valores NULL).</span><span class="sxs-lookup"><span data-stu-id="8135a-178">*StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR cannot be set to SQL_NULL_DATA for a table-valued parameter as table-valued parameters are not nullable (though table-valued parameter constituent columns may be nullable).</span></span> <span data-ttu-id="8135a-179">Si se establece en un valor no válido, SQLExecute o SQLExecDirect devuelve SQL_ERROR, y se genera un registro de diagnóstico con SQLSTATE = HY090 y el mensaje "longitud de búfer o cadena no válida para el parámetro \<p> ", donde p es el número de parámetro.</span><span class="sxs-lookup"><span data-stu-id="8135a-179">If this is set to an invalid value, SQLExecute or SQLExecDirect returns SQL_ERROR, and a diagnostic record is generated with SQLSTATE=HY090 and the message "Invalid string or buffer length for parameter \<p>", where p is the parameter number.</span></span>  
  
5.  <span data-ttu-id="8135a-180">Llama a SQLExecute o SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="8135a-180">Calls SQLExecute or SQLExecDirect.</span></span>  
  
 <span data-ttu-id="8135a-181">Los valores de columna de parámetro con valores de tabla de entrada se pueden pasar en partes si *StrLen_or_IndPtr* está establecido en SQL_LEN_DATA_AT_EXEC (*longitud*) o SQL_DATA_AT_EXEC para la columna.</span><span class="sxs-lookup"><span data-stu-id="8135a-181">Input table-valued parameter column values can be passed in pieces if *StrLen_or_IndPtr* is set to SQL_LEN_DATA_AT_EXEC(*length*) or SQL_DATA_AT_EXEC for the column.</span></span> <span data-ttu-id="8135a-182">Es similar a pasar valores por partes cuando se utilizan matrices de parámetros.</span><span class="sxs-lookup"><span data-stu-id="8135a-182">This is similar to passing values in pieces when arrays of parameters are used.</span></span> <span data-ttu-id="8135a-183">Al igual que con todos los parámetros de datos en ejecución, SQLParamData no indica la fila de la matriz para la que el controlador solicita datos; la aplicación debe encargarse de ello.</span><span class="sxs-lookup"><span data-stu-id="8135a-183">As with all data-at-execution parameters, SQLParamData does not indicate which row of the array the driver is requesting data for; the application must take care of this.</span></span> <span data-ttu-id="8135a-184">La aplicación no puede hacer ninguna suposición sobre el orden en que el controlador solicitará los valores.</span><span class="sxs-lookup"><span data-stu-id="8135a-184">The application cannot make any assumptions about the order in which the driver will request values.</span></span>  
  
## <a name="variable-table-valued-parameter-row-binding"></a><span data-ttu-id="8135a-185">Enlace de filas variable de parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="8135a-185">Variable Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="8135a-186">En el caso del enlace de filas variable, las filas se transfieren en lotes en tiempo de ejecución y la aplicación pasa las filas al controlador a petición.</span><span class="sxs-lookup"><span data-stu-id="8135a-186">For variable row binding, rows are transferred in batches at execution time and the application passes rows to the driver on demand.</span></span> <span data-ttu-id="8135a-187">Es similar a los datos en ejecución para los valores de parámetro individuales.</span><span class="sxs-lookup"><span data-stu-id="8135a-187">This is similar to data-at-execution for individual parameter values.</span></span> <span data-ttu-id="8135a-188">En el caso del enlace de filas variable, la aplicación hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8135a-188">For variable row binding, the application does the following:</span></span>  
  
1.  <span data-ttu-id="8135a-189">Enlaza parámetros y columnas de parámetros con valores de tabla tal y como se ha descrito en la sección anterior, "Enlace de filas fijo de parámetros con valores de tabla", en los pasos del 1 al 3.</span><span class="sxs-lookup"><span data-stu-id="8135a-189">Binds parameters and table-valued parameter columns as described in steps 1 to 3 of the previous section, "Fixed Table-Valued Parameter Row Binding".</span></span>  
  
2.  <span data-ttu-id="8135a-190">Establece *StrLen_or_IndPtr* o SQL_DESC_OCTET_LENGTH_PTR para los parámetros con valores de tabla que se van a pasar en el tiempo de ejecución a SQL_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="8135a-190">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR for any table-valued parameters that are to be passed at execution time to SQL_DATA_AT_EXEC.</span></span> <span data-ttu-id="8135a-191">Si no se establece ninguno de estos valores, el parámetro se procesará tal y como se describe en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="8135a-191">If neither is set, the parameter will be processed as described in the previous section.</span></span>  
  
3.  <span data-ttu-id="8135a-192">Llama a SQLExecute o SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="8135a-192">Calls SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="8135a-193">Esto devolverá SQL_NEED_DATA si hay algún parámetro SQL_PARAM_INPUT_OUTPUT o SQL_PARAM_INPUT que deba controlarse como parámetro de datos en ejecución.</span><span class="sxs-lookup"><span data-stu-id="8135a-193">This will return SQL_NEED_DATA if there are any SQL_PARAM_INPUT or SQL_PARAM_INPUT_OUTPUT parameters to be handled as data-at-execution parameters.</span></span> <span data-ttu-id="8135a-194">En este caso, la aplicación hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8135a-194">In this case, the application does the following:</span></span>  
  
    -   <span data-ttu-id="8135a-195">Llama a SQLParamData.</span><span class="sxs-lookup"><span data-stu-id="8135a-195">Calls SQLParamData.</span></span> <span data-ttu-id="8135a-196">Esto devuelve el valor de *ParameterValuePtr* para un parámetro de datos en ejecución y un código de retorno de SQL_NEED_DATA.</span><span class="sxs-lookup"><span data-stu-id="8135a-196">This returns the *ParameterValuePtr* value for a data-at-execution parameter and a return code of SQL_NEED_DATA.</span></span> <span data-ttu-id="8135a-197">Cuando todos los datos de parámetro se han pasado al controlador, SQLParamData devuelve SQL_SUCCESS, SQL_SUCCESS_WITH_INFO o SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="8135a-197">When all parameter data has been passed to the driver, SQLParamData returns SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, or SQL_ERROR.</span></span> <span data-ttu-id="8135a-198">En el caso de los parámetros de datos en ejecución, *ParameterValuePtr*, que es el mismo que el campo descriptor SQL_DESC_DATA_PTR, se puede considerar como un token para identificar de forma única un parámetro para el que se requiere un valor.</span><span class="sxs-lookup"><span data-stu-id="8135a-198">For data-at-execution parameters, *ParameterValuePtr*, which is the same as the descriptor field SQL_DESC_DATA_PTR, can be regarded as a token to uniquely identify a parameter for which a value is required.</span></span> <span data-ttu-id="8135a-199">Este "token" se pasa de la aplicación al controlador en el momento del enlace y, después, vuelve a pasarse a la aplicación en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="8135a-199">This "token" is passed from the application to the driver at bind time, then passed back to the application at execution time.</span></span>  
  
4.  <span data-ttu-id="8135a-200">Para enviar datos de fila de parámetro con valores de tabla para los parámetros con valores de tabla null, si el parámetro con valores de tabla no tiene filas, una aplicación llama a SQLPutData con *StrLen_or_Ind* establecida en SQL_DEFAULT_PARAM.</span><span class="sxs-lookup"><span data-stu-id="8135a-200">To send table-valued parameter row data for null table-valued parameters, if the table-valued parameter has no rows, an application calls SQLPutData with *StrLen_or_Ind* set to SQL_DEFAULT_PARAM.</span></span>  
  
     <span data-ttu-id="8135a-201">Para los TVP que no son NULL, una aplicación hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8135a-201">For non-NULL TVPs, an application:</span></span>  
  
    -   <span data-ttu-id="8135a-202">Establece *Str_Len_or_Ind* para todas las columnas de parámetro con valores de tabla en los valores adecuados y rellena los búferes de datos de las columnas de parámetros con valores de tabla que no son parámetros de datos en ejecución.</span><span class="sxs-lookup"><span data-stu-id="8135a-202">Sets *Str_Len_or_Ind* for all the table-valued parameter columns to appropriate values, and populates data buffers for table-valued parameter columns that are not to be data-at-execution parameters.</span></span> <span data-ttu-id="8135a-203">Puede usar los datos en ejecución para las columnas de parámetros con valores de tabla de forma similar al modo en que los parámetros ordinarios pueden pasarse por partes al controlador.</span><span class="sxs-lookup"><span data-stu-id="8135a-203">You can use data-at-execution for table-valued parameter columns in a similar way to that in which ordinary parameters can be passed to the driver in pieces.</span></span>  
  
    -   <span data-ttu-id="8135a-204">Llama a SQLPutData con *Str_Len_or_Ind* establecido en el número de filas que se van a enviar al servidor.</span><span class="sxs-lookup"><span data-stu-id="8135a-204">Calls SQLPutData with *Str_Len_or_Ind* set to the number of rows to be sent to the server.</span></span> <span data-ttu-id="8135a-205">Cualquier valor que se encuentre fuera del intervalo de 0 a SQL_DESC_ARRAY_SIZE o SQL_DEFAULT_PARAM es un error y devolverá SQLSTATE HY090 con el mensaje "Longitud de búfer o cadena no válida".</span><span class="sxs-lookup"><span data-stu-id="8135a-205">Any value outside the range 0 to SQL_DESC_ARRAY_SIZE or SQL_DEFAULT_PARAM is an error, and will return SQLSTATE HY090, with the message "Invalid string or buffer length".</span></span> <span data-ttu-id="8135a-206">0 indica que todas las filas se han enviado y que no hay más datos para un parámetro con valores de tabla (tal y como se indica en el segundo elemento de viñeta de esta lista).</span><span class="sxs-lookup"><span data-stu-id="8135a-206">0 indicates that all rows have been sent and there is no more data for a table-valued parameter (as noted in the second bullet item in this list).</span></span> <span data-ttu-id="8135a-207">SQL_DEFAULT_PARAM solamente puede utilizarse la primera vez que el controlador solicita datos para un parámetro con valores de tabla (tal y como se describe en el primer elemento de viñeta de esta lista).</span><span class="sxs-lookup"><span data-stu-id="8135a-207">SQL_DEFAULT_PARAM can only be used the first time the driver requests data for a table-valued parameter (as described in the first bullet item in this list).</span></span>  
  
5.  <span data-ttu-id="8135a-208">Cuando se han enviado todas las filas, llama a SQLPutData para el parámetro con valores de tabla con un valor *Str_Len_or_Ind* de 0 y, a continuación, continúa con el paso 3A anterior.</span><span class="sxs-lookup"><span data-stu-id="8135a-208">When all rows have been sent, calls SQLPutData for the table-valued parameter with a *Str_Len_or_Ind* value of 0, then proceeds to step 3a above.</span></span>  
  
6.  <span data-ttu-id="8135a-209">Llama de nuevo a SQLParamData.</span><span class="sxs-lookup"><span data-stu-id="8135a-209">Calls SQLParamData again.</span></span> <span data-ttu-id="8135a-210">Si hay parámetros de datos en ejecución entre las columnas de parámetro con valores de tabla, se identificarán con el valor *ValuePtrPtr* devuelto por SQLParamData.</span><span class="sxs-lookup"><span data-stu-id="8135a-210">If there are any data-at-execution parameters among the table-valued parameter columns, these will be identified by the value *ValuePtrPtr* returned by SQLParamData.</span></span> <span data-ttu-id="8135a-211">Cuando todos los valores de columna están disponibles, SQLParamData devolverá de nuevo el valor de *ParameterValuePtr* para el parámetro con valores de tabla y la aplicación se iniciará de nuevo.</span><span class="sxs-lookup"><span data-stu-id="8135a-211">When all column values are available, SQLParamData will again return the *ParameterValuePtr* value for the table-valued parameter, and the application begins again.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8135a-212">Consulte también</span><span class="sxs-lookup"><span data-stu-id="8135a-212">See Also</span></span>  
 [<span data-ttu-id="8135a-213">Parámetros con valores de tabla &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="8135a-213">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
