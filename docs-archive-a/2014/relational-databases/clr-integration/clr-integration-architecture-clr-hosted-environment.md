---
title: Entorno hospedado de CLR | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- type-safe code [CLR integration]
- UNSAFE permission set
- run-time environments [CLR integration]
- common language runtime [SQL Server], about CLR integration
- application domains [CLR integration]
- host protection attributes [CLR integration]
- managed code [SQL Server], common language runtime
- permission sets [CLR integration]
- reliability [CLR integration]
- SAFE permission set
- code access security [CLR integration]
- EXTERNAL_ACCESS permission set
- verifying type safety
- scalability [CLR integration]
- hosted environments [CLR integration]
- HPAs [CLR integration]
ms.assetid: d280d359-08f0-47b5-a07e-67dd2a58ad73
author: rothja
ms.author: jroth
ms.openlocfilehash: bd04536d1dfb8a4657fbe116cdfd38a6639a6327
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87747621"
---
# <a name="clr-hosted-environment"></a><span data-ttu-id="100c4-102">Entorno hospedado CLR</span><span class="sxs-lookup"><span data-stu-id="100c4-102">CLR Hosted Environment</span></span>
  <span data-ttu-id="100c4-103">[!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework Common Language Runtime (CLR) es un entorno que ejecuta muchos lenguajes de programación modernos, incluidos [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic y [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="100c4-103">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework common language runtime (CLR) is an environment that executes many modern programming languages, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic, and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="100c4-104">CLR presenta memoria de recopilación de elementos no utilizados, subprocesamiento preferente, servicios de metadatos (reflexión de tipos), capacidad de comprobar el código y seguridad de acceso del código.</span><span class="sxs-lookup"><span data-stu-id="100c4-104">The CLR features garbage-collected memory, pre-emptive threading, metadata services (type reflection), code verifiability, and code access security.</span></span> <span data-ttu-id="100c4-105">CLR usa metadatos para localizar y cargar clases, colocar instancias en memoria, resolver invocaciones a métodos, generar código nativo, exigir mecanismos de seguridad y establecer los límites del contexto en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="100c4-105">The CLR uses metadata to locate and load classes, lay out instances in memory, resolve method invocations, generate native code, enforce security, and set run-time context boundaries.</span></span>  
  
 <span data-ttu-id="100c4-106">CLR y [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], como entornos de tiempo de ejecución, se diferencian en el modo en que administran la memoria, los subprocesos y la sincronización.</span><span class="sxs-lookup"><span data-stu-id="100c4-106">The CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] differ as run-time environments in the way they handle memory, threads, and synchronization.</span></span> <span data-ttu-id="100c4-107">En este tema se describe el modo en que estos dos tiempos de ejecución se integran para que todos los recursos del sistema se administren uniformemente.</span><span class="sxs-lookup"><span data-stu-id="100c4-107">This topic describes the way in which these two run times are integrated so that all system resources are managed uniformly.</span></span> <span data-ttu-id="100c4-108">En este tema también se describe el modo en que la seguridad de acceso del código (CAS) de CLR y la seguridad de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] se integran para proporcionar un entorno de ejecución confiable y seguro para el código de usuario.</span><span class="sxs-lookup"><span data-stu-id="100c4-108">This topic also covers the way in which CLR code access security (CAS) and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security are integrated to provide a reliable and secure execution environment for user code.</span></span>  
  
## <a name="basic-concepts-of-clr-architecture"></a><span data-ttu-id="100c4-109">Conceptos básicos de la arquitectura CLR</span><span class="sxs-lookup"><span data-stu-id="100c4-109">Basic Concepts of CLR Architecture</span></span>  
 <span data-ttu-id="100c4-110">En .NET Framework, un programador escribe un lenguaje de alto nivel que implementa una clase que define su estructura (por ejemplo, los campos o las propiedades de la clase) y sus métodos.</span><span class="sxs-lookup"><span data-stu-id="100c4-110">In the .NET Framework, a programmer writes in a high-level language that implements a class defining its structure (for example, the fields or properties of the class) and methods.</span></span> <span data-ttu-id="100c4-111">Algunos de estos métodos pueden ser funciones estáticas.</span><span class="sxs-lookup"><span data-stu-id="100c4-111">Some of these methods can be static functions.</span></span> <span data-ttu-id="100c4-112">La compilación del programa genera un archivo denominado ensamblado que contiene el código compilado en el lenguaje intermedio de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] (MSIL) y un manifiesto que contiene todas las referencias a ensamblados dependientes.</span><span class="sxs-lookup"><span data-stu-id="100c4-112">The compilation of the program produces a file called an assembly that contains the compiled code in the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] intermediate language (MSIL), and a manifest that contains all references to dependent assemblies.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="100c4-113">Los ensamblados constituyen un elemento vital para la arquitectura CLR;</span><span class="sxs-lookup"><span data-stu-id="100c4-113">Assemblies are a vital element in the architecture of the CLR.</span></span> <span data-ttu-id="100c4-114">son las unidades de empaquetado, implementación y control de versiones del código de aplicación de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="100c4-114">They are the units of packaging, deployment, and versioning of application code in the .NET Framework.</span></span> <span data-ttu-id="100c4-115">El uso de ensamblados permite implementar el código de aplicación dentro de la base de datos y proporciona un modo uniforme de administrar, realizar copias de seguridad y restaurar aplicaciones de base de datos completas.</span><span class="sxs-lookup"><span data-stu-id="100c4-115">Using assemblies, you can deploy application code inside the database and provide a uniform way to administer, back up, and restore complete database applications.</span></span>  
  
 <span data-ttu-id="100c4-116">El manifiesto de ensamblado contiene metadatos sobre el ensamblado, que describen todas las estructuras, campos, propiedades, clases, relaciones de herencia, funciones y métodos definidos en el programa.</span><span class="sxs-lookup"><span data-stu-id="100c4-116">The assembly manifest contains metadata about the assembly, describing all of the structures, fields, properties, classes, inheritance relationships, functions, and methods defined in the program.</span></span> <span data-ttu-id="100c4-117">El manifiesto establece la identidad del ensamblado, especifica los archivos que componen la implementación del ensamblado, especifica los tipos y los recursos que forman el ensamblado, desglosa en elementos las dependencias en tiempo de compilación de otros ensamblados y especifica el conjunto de permisos necesarios para que el ensamblado se ejecute correctamente.</span><span class="sxs-lookup"><span data-stu-id="100c4-117">The manifest establishes the assembly identity, specifies the files that make up the assembly implementation, specifies the types and resources that make up the assembly, itemizes the compile-time dependencies on other assemblies, and specifies the set of permissions required for the assembly to run properly.</span></span> <span data-ttu-id="100c4-118">Esta información se usa en tiempo de compilación para resolver referencias, exigir el cumplimiento de las directivas de enlace de versión y validar la integridad de los ensamblados cargados.</span><span class="sxs-lookup"><span data-stu-id="100c4-118">This information is used at run time to resolve references, enforce version binding policy, and validate the integrity of loaded assemblies.</span></span>  
  
 <span data-ttu-id="100c4-119">.NET Framework admite atributos personalizados para anotar clases, propiedades, funciones y métodos con información adicional que la aplicación puede capturar en metadatos.</span><span class="sxs-lookup"><span data-stu-id="100c4-119">The .NET Framework supports custom attributes for annotating classes, properties, functions, and methods with additional information the application may capture in metadata.</span></span> <span data-ttu-id="100c4-120">Todos los compiladores de .NET Framework usan estas anotaciones sin interpretarlas y las almacenan como metadatos de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="100c4-120">All .NET Framework compilers consume these annotations without interpretation and store them as assembly metadata.</span></span> <span data-ttu-id="100c4-121">Estas anotaciones pueden examinarse del mismo modo que cualquier otro metadato.</span><span class="sxs-lookup"><span data-stu-id="100c4-121">These annotations can be examined in the same way as any other metadata.</span></span>  
  
 <span data-ttu-id="100c4-122">MSIL ejecuta el código administrado en CLR, en lugar ejecutarlo directamente el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="100c4-122">Managed code is MSIL executed in the CLR, rather than directly by the operating system.</span></span> <span data-ttu-id="100c4-123">Las aplicaciones de código administrado adquieren servicios de CLR, como la recolección automática de elementos no utilizados, la comprobación de tipos en tiempo de ejecución y la compatibilidad con la seguridad.</span><span class="sxs-lookup"><span data-stu-id="100c4-123">Managed code applications acquire CLR services, such as automatic garbage collection, run-time type checking, and security support.</span></span> <span data-ttu-id="100c4-124">Estos servicios ayudan a proporcionar un comportamiento uniforme independiente de la plataforma y del lenguaje a las aplicaciones de código administrado.</span><span class="sxs-lookup"><span data-stu-id="100c4-124">These services help provide uniform platform- and language-independent behavior of managed code applications.</span></span>  
  
## <a name="design-goals-of-clr-integration"></a><span data-ttu-id="100c4-125">Diseñar objetivos de integración CLR</span><span class="sxs-lookup"><span data-stu-id="100c4-125">Design Goals of CLR Integration</span></span>  
 <span data-ttu-id="100c4-126">Cuando el código de usuario se ejecuta dentro del entorno CLR hospedado en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (que recibe el nombre de integración CLR), se aplican los siguientes objetivos de diseño:</span><span class="sxs-lookup"><span data-stu-id="100c4-126">When user code runs inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (called CLR integration), the following design goals apply:</span></span>  
  
###### <a name="reliability-safety"></a><span data-ttu-id="100c4-127">Confiabilidad (seguridad)</span><span class="sxs-lookup"><span data-stu-id="100c4-127">Reliability (Safety)</span></span>  
 <span data-ttu-id="100c4-128">El código de usuario no debería tener permiso para llevar a cabo operaciones que pongan en peligro la integridad del proceso del motor de base de datos, como mostrar un cuadro de mensaje que solicite una respuesta por parte del usuario o salir del proceso.</span><span class="sxs-lookup"><span data-stu-id="100c4-128">User code should not be allowed to perform operations that compromise the integrity of the Database Engine process, such as popping a message box requesting a user response or exiting the process.</span></span> <span data-ttu-id="100c4-129">El código de usuario no debería poder sobrescribir los búferes de memoria del motor de base de datos o las estructuras de datos internas.</span><span class="sxs-lookup"><span data-stu-id="100c4-129">User code should not be able to overwrite Database Engine memory buffers or internal data structures.</span></span>  
  
###### <a name="scalability"></a><span data-ttu-id="100c4-130">Escalabilidad</span><span class="sxs-lookup"><span data-stu-id="100c4-130">Scalability</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-131">y CLR tienen distintos modelos internos de programación y administración de memoria.</span><span class="sxs-lookup"><span data-stu-id="100c4-131">and the CLR have different internal models for scheduling and memory management.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-132">admite un modelo de subprocesos cooperativo, no preferente, en el que los subprocesos se ejecutan de forma voluntaria y periódica o cuando están esperando bloqueos o E/S.</span><span class="sxs-lookup"><span data-stu-id="100c4-132">supports a cooperative, non-preemptive threading model in which the threads voluntarily yield execution periodically, or when they are waiting on locks or I/O.</span></span> <span data-ttu-id="100c4-133">CLR admite un modelo de subprocesos preferente.</span><span class="sxs-lookup"><span data-stu-id="100c4-133">The CLR supports a preemptive threading model.</span></span> <span data-ttu-id="100c4-134">Si el código de usuario que se ejecuta dentro de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede llamar directamente a los tipos primitivos de subprocesamiento del sistema operativo, significa que no se integra bien en el programador de tareas de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y que puede degradar la escalabilidad del sistema.</span><span class="sxs-lookup"><span data-stu-id="100c4-134">If user code running inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can directly call the operating system threading primitives, then it does not integrate well into the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] task scheduler and can degrade the scalability of the system.</span></span> <span data-ttu-id="100c4-135">CLR no distingue entre la memoria virtual y física, pero [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] administra la memoria física directamente y se le exige que use la memoria física dentro de un límite configurable.</span><span class="sxs-lookup"><span data-stu-id="100c4-135">The CLR does not distinguish between virtual and physical memory, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] directly manages physical memory and is required to use physical memory within a configurable limit.</span></span>  
  
 <span data-ttu-id="100c4-136">Los distintos modelos de subprocesamiento, programación y administración de memoria presentan un desafío de integración para un sistema de administración de bases de datos relacionales (RDBMS) que se escala con objeto de admitir miles de sesiones de usuarios simultáneas.</span><span class="sxs-lookup"><span data-stu-id="100c4-136">The different models for threading, scheduling, and memory management present an integration challenge for a relational database management system (RDBMS) that scales to support thousands of concurrent user sessions.</span></span> <span data-ttu-id="100c4-137">La arquitectura debe garantizar que la escalabilidad del sistema no se vea en peligro por el hecho de que el código de usuario llame directamente a las interfaces de programación de aplicaciones (API) para los tipos primitivos de subprocesamiento, memoria y sincronización.</span><span class="sxs-lookup"><span data-stu-id="100c4-137">The architecture should ensure that the scalability of the system is not compromised by user code calling application programming interfaces (APIs) for threading, memory, and synchronization primitives directly.</span></span>  
  
###### <a name="security"></a><span data-ttu-id="100c4-138">Seguridad</span><span class="sxs-lookup"><span data-stu-id="100c4-138">Security</span></span>  
 <span data-ttu-id="100c4-139">El código de usuario que se ejecuta en la base de datos debe cumplir las normas de autenticación y autorización de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] al obtener acceso a objetos de base de datos como tablas y columnas.</span><span class="sxs-lookup"><span data-stu-id="100c4-139">User code running in the database must follow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] authentication and authorization rules when accessing database objects such as tables and columns.</span></span> <span data-ttu-id="100c4-140">Además, los administradores de bases de datos deben ser capaces de controlar el acceso a los recursos del sistema operativo, como el acceso a archivos y a la red, desde el código de usuario que se ejecuta en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="100c4-140">In addition, database administrators should be able to control access to operating system resources, such as files and network access, from user code running in the database.</span></span> <span data-ttu-id="100c4-141">Esto adquiere importancia cuando los lenguajes de programación administrados (a diferencia de los lenguajes no administrados, como Transact-SQL) proporcionan distintas API para obtener acceso a dichos recursos.</span><span class="sxs-lookup"><span data-stu-id="100c4-141">This becomes important as managed programming languages (unlike non-managed languages such as Transact-SQL) provide APIs to access such resources.</span></span> <span data-ttu-id="100c4-142">El sistema debe proporcionar un modo seguro para que el código de usuario obtenga acceso a los recursos del equipo fuera del proceso de [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-142">The system must provide a secure way for user code to access machine resources outside the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] process.</span></span> <span data-ttu-id="100c4-143">Para más información, consulte [CLR Integration Security](security/clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="100c4-143">For more information, see [CLR Integration Security](security/clr-integration-security.md).</span></span>  
  
###### <a name="performance"></a><span data-ttu-id="100c4-144">Rendimiento</span><span class="sxs-lookup"><span data-stu-id="100c4-144">Performance</span></span>  
 <span data-ttu-id="100c4-145">El código de usuario administrado que se ejecuta en [!INCLUDE[ssDE](../../../includes/ssde-md.md)] debe tener un rendimiento de cálculo comparable a ese mismo código ejecutado fuera del servidor.</span><span class="sxs-lookup"><span data-stu-id="100c4-145">Managed user code running in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] should have computational performance comparable to the same code run outside the server.</span></span> <span data-ttu-id="100c4-146">El acceso a la base de datos desde el código de usuario administrado no es tan rápido como el [!INCLUDE[tsql](../../../includes/tsql-md.md)] nativo.</span><span class="sxs-lookup"><span data-stu-id="100c4-146">Database access from managed user code is not as fast as native [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="100c4-147">Para obtener más información, vea [rendimiento de la integración CLR](clr-integration-architecture-performance.md).</span><span class="sxs-lookup"><span data-stu-id="100c4-147">For more information, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="clr-services"></a><span data-ttu-id="100c4-148">CLR Services</span><span class="sxs-lookup"><span data-stu-id="100c4-148">CLR Services</span></span>  
 <span data-ttu-id="100c4-149">CLR ofrece varios servicios para ayudar a lograr los objetivos de diseño de la integración CLR con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-149">The CLR provides a number of services to help achieve the design goals of CLR integration with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
###### <a name="type-safety-verification"></a><span data-ttu-id="100c4-150">Comprobación de la seguridad de tipos</span><span class="sxs-lookup"><span data-stu-id="100c4-150">Type safety verification</span></span>  
 <span data-ttu-id="100c4-151">El código con seguridad de tipos es código que obtiene acceso a las estructuras de memoria siguiendo métodos perfectamente definidos.</span><span class="sxs-lookup"><span data-stu-id="100c4-151">Type-safe code is code that accesses memory structures only in well-defined ways.</span></span> <span data-ttu-id="100c4-152">Por ejemplo, dada una referencia válida a un objeto, el código con seguridad de tipos puede obtener acceso a la memoria en desplazamientos fijos que se correspondan con miembros de campo reales.</span><span class="sxs-lookup"><span data-stu-id="100c4-152">For example, given a valid object reference, type-safe code can access memory at fixed offsets corresponding to actual field members.</span></span> <span data-ttu-id="100c4-153">Sin embargo, si el código obtiene acceso a la memoria en desplazamientos arbitrarios que se encuentran dentro o fuera del intervalo de memoria perteneciente al objeto, significa que no tiene seguridad de tipos.</span><span class="sxs-lookup"><span data-stu-id="100c4-153">However, if the code accesses memory at arbitrary offsets inside or outside the range of memory that belongs to the object, then it is not type-safe.</span></span> <span data-ttu-id="100c4-154">Cuando los ensamblados se cargan en CLR, antes de que MSIL se compile mediante la compilación Just-In-Time (JIT), el tiempo de ejecución realiza una fase de comprobación que examina el código para determinar su seguridad de tipos.</span><span class="sxs-lookup"><span data-stu-id="100c4-154">When assemblies are loaded in the CLR, prior to the MSIL being compiled using just-in-time (JIT) compilation, the runtime performs a verification phase that examines code to determine its type-safety.</span></span> <span data-ttu-id="100c4-155">El código que supera correctamente esta comprobación se denomina código con seguridad de tipos comprobable.</span><span class="sxs-lookup"><span data-stu-id="100c4-155">Code that successfully passes this verification is called verifiably type-safe code.</span></span>  
  
###### <a name="application-domains"></a><span data-ttu-id="100c4-156">Dominios de aplicación</span><span class="sxs-lookup"><span data-stu-id="100c4-156">Application domains</span></span>  
 <span data-ttu-id="100c4-157">CLR admite la noción de dominios de aplicación como zonas de ejecución dentro de un proceso de host donde los ensamblados de código administrado pueden cargarse y ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="100c4-157">The CLR supports the notion of application domains as execution zones within a host process where managed code assemblies can be loaded and executed.</span></span> <span data-ttu-id="100c4-158">El límite del dominio de aplicación proporciona aislamiento entre los ensamblados.</span><span class="sxs-lookup"><span data-stu-id="100c4-158">The application domain boundary provides isolation between assemblies.</span></span> <span data-ttu-id="100c4-159">Los ensamblados se aíslan en lo que se refiere a la visibilidad de variables estáticas y miembros de datos, y a la capacidad de llamar al código de forma dinámica.</span><span class="sxs-lookup"><span data-stu-id="100c4-159">The assemblies are isolated in terms of visibility of static variables and data members and the ability to call code dynamically.</span></span> <span data-ttu-id="100c4-160">Los dominios de aplicación también constituyen el mecanismo de carga y descarga de código.</span><span class="sxs-lookup"><span data-stu-id="100c4-160">Application domains are also the mechanism for loading and unloading code.</span></span> <span data-ttu-id="100c4-161">Solo es posible descargar código de la memoria descargando el dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="100c4-161">Code can be unloaded from memory only by unloading the application domain.</span></span> <span data-ttu-id="100c4-162">Para obtener más información, vea [dominios de aplicación y seguridad de la integración CLR](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="100c4-162">For more information, see [Application Domains and CLR Integration Security](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span></span>  
  
###### <a name="code-access-security-cas"></a><span data-ttu-id="100c4-163">Seguridad de acceso del código (CAS)</span><span class="sxs-lookup"><span data-stu-id="100c4-163">Code Access Security (CAS)</span></span>  
 <span data-ttu-id="100c4-164">El sistema de seguridad de CLR proporciona un modo de controlar qué tipos de operaciones puede llevar a cabo el código administrado mediante la asignación de permisos al código.</span><span class="sxs-lookup"><span data-stu-id="100c4-164">The CLR security system provides a way to control what kinds of operations managed code can perform by assigning permissions to code.</span></span> <span data-ttu-id="100c4-165">Los permisos de acceso a código se asignan según la identidad del código (por ejemplo, la firma del ensamblado o el origen del código).</span><span class="sxs-lookup"><span data-stu-id="100c4-165">Code access permissions are assigned based on code identity (for example, the signature of the assembly or the origin of the code).</span></span>  
  
 <span data-ttu-id="100c4-166">CLR proporciona una directiva de equipos que puede establecer el administrador del equipo.</span><span class="sxs-lookup"><span data-stu-id="100c4-166">The CLR provides for a computer-wide policy that can be set by the computer administrator.</span></span> <span data-ttu-id="100c4-167">Esta directiva define las concesiones de permisos para cualquier código administrado que se ejecute en el equipo.</span><span class="sxs-lookup"><span data-stu-id="100c4-167">This policy defines the permission grants for any managed code running on the machine.</span></span> <span data-ttu-id="100c4-168">Además, hay una directiva de seguridad de nivel de host que puedan usar los hosts, como [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], para especificar restricciones adicionales en el código administrado.</span><span class="sxs-lookup"><span data-stu-id="100c4-168">In addition, there is a host-level security policy that can be used by hosts such as [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to specify additional restrictions on managed code.</span></span>  
  
 <span data-ttu-id="100c4-169">Si una API administrada de .NET Framework expone operaciones en recursos protegidos por un permiso de acceso a código, la API solicitará ese permiso antes de obtener acceso al recurso.</span><span class="sxs-lookup"><span data-stu-id="100c4-169">If a managed API in the .NET Framework exposes operations on resources that are protected by a code access permission, the API will demand that permission before accessing the resource.</span></span> <span data-ttu-id="100c4-170">Esta solicitud hace que el sistema de seguridad de CLR active una comprobación completa de cada unidad de código (ensamblado) en la pila de llamadas.</span><span class="sxs-lookup"><span data-stu-id="100c4-170">This demand causes the CLR security system to trigger a comprehensive check of every unit of code (assembly) in the call stack.</span></span> <span data-ttu-id="100c4-171">Solo si la cadena de llamadas completa tiene permiso obtendrá acceso al recurso.</span><span class="sxs-lookup"><span data-stu-id="100c4-171">Only if the entire call chain has permission will access to the resource be granted.</span></span>  
  
 <span data-ttu-id="100c4-172">Tenga en cuenta que la capacidad de generar código administrado de forma dinámica, mediante la API Reflection.Emit, no se admite dentro del entorno CLR hospedado en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-172">Note that the ability to generate managed code dynamically, using the Reflection.Emit API, is not supported inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="100c4-173">Dicho código no tendría los permisos CAS necesarios para ejecutarse y, por lo tanto, generaría un error en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="100c4-173">Such code would not have the CAS permissions to run and would therefore fail at run time.</span></span> <span data-ttu-id="100c4-174">Para obtener más información, vea [seguridad de acceso del código de integración CLR](security/clr-integration-code-access-security.md).</span><span class="sxs-lookup"><span data-stu-id="100c4-174">For more information, see [CLR Integration Code Access Security](security/clr-integration-code-access-security.md).</span></span>  
  
###### <a name="host-protection-attributes-hpas"></a><span data-ttu-id="100c4-175">Atributos de protección del host (HPA)</span><span class="sxs-lookup"><span data-stu-id="100c4-175">Host Protection Attributes (HPAs)</span></span>  
 <span data-ttu-id="100c4-176">CLR proporciona un mecanismo para anotar API administradas que forman parte de .NET Framework con determinados atributos que pueden ser de interés para un host de CLR.</span><span class="sxs-lookup"><span data-stu-id="100c4-176">The CLR provides a mechanism to annotate managed APIs that are part of the .NET Framework with certain attributes that may be of interest to a host of the CLR.</span></span> <span data-ttu-id="100c4-177">Algunos ejemplos de estos atributos son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="100c4-177">Examples of such attributes include:</span></span>  
  
-   <span data-ttu-id="100c4-178">SharedState, que indica si la API expone la capacidad de crear o administrar un estado compartido (por ejemplo, campos de clase estática).</span><span class="sxs-lookup"><span data-stu-id="100c4-178">SharedState, which indicates whether the API exposes the ability to create or manage shared state (for example, static class fields).</span></span>  
  
-   <span data-ttu-id="100c4-179">Synchronization, que indica si la API expone la capacidad de llevar a cabo una sincronización entre los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="100c4-179">Synchronization, which indicates whether the API exposes the ability to perform synchronization between threads.</span></span>  
  
-   <span data-ttu-id="100c4-180">ExternalProcessMgmt, que indica si la API expone una forma de controlar el proceso de host.</span><span class="sxs-lookup"><span data-stu-id="100c4-180">ExternalProcessMgmt, which indicates whether the API exposes a way to control the host process.</span></span>  
  
 <span data-ttu-id="100c4-181">Dados estos atributos, el host puede especificar una lista de atributos HPA, como el atributo SharedState, que no deberían permitirse en el entorno hospedado.</span><span class="sxs-lookup"><span data-stu-id="100c4-181">Given these attributes, the host can specify a list of HPAs, such as the SharedState attribute, that should be disallowed in the hosted environment.</span></span> <span data-ttu-id="100c4-182">En este caso, CLR rechaza los intentos del código de usuario de llamar a las API anotadas por los HPA en la lista de atributos prohibidos.</span><span class="sxs-lookup"><span data-stu-id="100c4-182">In this case, the CLR denies attempts by user code to call APIs that are annotated by the HPAs in the prohibited list.</span></span> <span data-ttu-id="100c4-183">Para obtener más información, vea [atributos de protección del host y programación de la integración CLR](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span><span class="sxs-lookup"><span data-stu-id="100c4-183">For more information, see [Host Protection Attributes and CLR Integration Programming](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span></span>  
  
## <a name="how-sql-server-and-the-clr-work-together"></a><span data-ttu-id="100c4-184">Cómo trabajan juntos SQL Server y CLR</span><span class="sxs-lookup"><span data-stu-id="100c4-184">How SQL Server and the CLR Work Together</span></span>  
 <span data-ttu-id="100c4-185">En esta sección se describe el modo en que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] integra los modelos de subprocesamiento, programación, sincronización y administración de memoria de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y CLR.</span><span class="sxs-lookup"><span data-stu-id="100c4-185">This section discusses how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] integrates the threading, scheduling, synchronization, and memory management models of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR.</span></span> <span data-ttu-id="100c4-186">En concreto, en esta sección se examina la integración a la luz de los objetivos de escalabilidad, confiabilidad y seguridad.</span><span class="sxs-lookup"><span data-stu-id="100c4-186">In particular, this section examines the integration in light of scalability, reliability, and security goals.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-187">actúa esencialmente como sistema operativo para CLR cuando se hospeda en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-187">essentially acts as the operating system for the CLR when it is hosted inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="100c4-188">CLR llama a las rutinas de bajo nivel implementadas por [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para el subprocesamiento, la programación, la sincronización y la administración de memoria.</span><span class="sxs-lookup"><span data-stu-id="100c4-188">The CLR calls low-level routines implemented by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] for threading, scheduling, synchronization, and memory management.</span></span> <span data-ttu-id="100c4-189">Éstos son los mismos tipos primitivos que usa el resto del motor de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-189">These are the same primitives that the rest of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine uses.</span></span> <span data-ttu-id="100c4-190">Este enfoque proporciona varias ventajas de escalabilidad, confiabilidad y seguridad.</span><span class="sxs-lookup"><span data-stu-id="100c4-190">This approach provides several scalability, reliability, and security benefits.</span></span>  
  
###### <a name="scalability-common-threading-scheduling-and-synchronization"></a><span data-ttu-id="100c4-191">Escalabilidad: subprocesamiento, programación y sincronización comunes</span><span class="sxs-lookup"><span data-stu-id="100c4-191">Scalability: Common threading, scheduling, and synchronization</span></span>  
 <span data-ttu-id="100c4-192">CLR llama a la API de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] a fin de crear subprocesos para ejecutar código de usuario y para su propio uso interno.</span><span class="sxs-lookup"><span data-stu-id="100c4-192">CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] APIs for creating threads, both for running user code and for its own internal use.</span></span> <span data-ttu-id="100c4-193">Para realizar una sincronización entre varios subprocesos, CLR llama a los objetos de sincronización de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-193">In order to synchronize between multiple threads, the CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] synchronization objects.</span></span> <span data-ttu-id="100c4-194">Esto permite al programador de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] programar otras tareas cuando un subproceso espera en un objeto de sincronización.</span><span class="sxs-lookup"><span data-stu-id="100c4-194">This allows the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler to schedule other tasks when a thread is waiting on a synchronization object.</span></span> <span data-ttu-id="100c4-195">Por ejemplo, cuando CLR inicia la recolección de elementos no utilizados, todos sus subprocesos esperan a que finalice dicha recopilación de elementos no utilizados.</span><span class="sxs-lookup"><span data-stu-id="100c4-195">For example, when the CLR initiates garbage collection, all of its threads wait for garbage collection to finish.</span></span> <span data-ttu-id="100c4-196">Puesto que el programador de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] conoce los subprocesos CLR y los objetos de sincronización que están esperando, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede programar los subprocesos que están ejecutando otras tareas de base de datos no relacionadas con CLR.</span><span class="sxs-lookup"><span data-stu-id="100c4-196">Because the CLR threads and the synchronization objects they are waiting on are known to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can schedule threads that are running other database tasks not involving the CLR.</span></span> <span data-ttu-id="100c4-197">Esto también permite a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] detectar interbloqueos que implican bloqueos tomados por los objetos de sincronización CLR y emplear técnicas tradicionales para la eliminación de los interbloqueos.</span><span class="sxs-lookup"><span data-stu-id="100c4-197">This also enables [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to detect deadlocks that involve locks taken by CLR synchronization objects and employ traditional techniques for deadlock removal.</span></span>  
  
 <span data-ttu-id="100c4-198">El código administrado se ejecuta de forma preferente en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-198">Managed code runs preemptively in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="100c4-199">El programador de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tiene capacidad para detectar y detener subprocesos que no se han producido durante mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="100c4-199">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler has the ability to detect and stop threads that have not yielded for a significant amount of time.</span></span> <span data-ttu-id="100c4-200">La capacidad de enlazar subprocesos CLR con subprocesos de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implica que el programador de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede identificar subprocesos consecutivos en CLR y administrar su prioridad.</span><span class="sxs-lookup"><span data-stu-id="100c4-200">The ability to hook CLR threads to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] threads implies that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler can identify "runaway" threads in the CLR and manage their priority.</span></span> <span data-ttu-id="100c4-201">Dichos subprocesos consecutivos se suspenden y vuelven a colocarse en la cola.</span><span class="sxs-lookup"><span data-stu-id="100c4-201">Such runaway threads are suspended and put back in the queue.</span></span> <span data-ttu-id="100c4-202">Los subprocesos que se identifican repetidamente como subprocesos consecutivos no tienen permiso para ejecutarse durante un período de tiempo determinado de manera que puedan ejecutarse otros subprocesos de trabajo en ejecución.</span><span class="sxs-lookup"><span data-stu-id="100c4-202">Threads that are repeatedly identified as runaway threads are not allowed to run for a given period of time so that other executing workers can run.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="100c4-203">El código administrado de ejecución prolongada que obtiene acceso a datos o asigna suficiente memoria para desencadenar la recolección de elementos no utilizados se producirá automáticamente.</span><span class="sxs-lookup"><span data-stu-id="100c4-203">Long-running managed code that accesses data or allocates enough memory to trigger garbage collection will yield automatically.</span></span> <span data-ttu-id="100c4-204">El código administrado de ejecución prolongada que no obtiene acceso a datos o no asigna suficiente memoria administrada para desencadenar la recolección de elementos no utilizados debe producirse explícitamente llamando a la función System.Thread.Sleep() de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="100c4-204">Long-running managed code that does not access data or allocate enough managed memory to trigger garbage collection should explicitly yield by calling the System.Thread.Sleep() function of the .NET Framework.</span></span>  
  
###### <a name="scalability-common-memory-management"></a><span data-ttu-id="100c4-205">Escalabilidad: administración de memoria común</span><span class="sxs-lookup"><span data-stu-id="100c4-205">Scalability: Common memory management</span></span>  
 <span data-ttu-id="100c4-206">CLR llama a los tipos primitivos de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para asignar y anular la asignación de su memoria.</span><span class="sxs-lookup"><span data-stu-id="100c4-206">The CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] primitives for allocating and de-allocating its memory.</span></span> <span data-ttu-id="100c4-207">Dado que la memoria usada por CLR se tiene en cuenta a efectos del uso de memoria total del sistema, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede permanecer dentro de sus límites de memoria configurados y asegurarse de que CLR y [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] no compitan entre sí por obtener más memoria.</span><span class="sxs-lookup"><span data-stu-id="100c4-207">Because the memory used by the CLR is accounted for in the total memory usage of the system, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can stay within its configured memory limits and ensure the CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are not competing with each other for memory.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-208">también puede rechazar las solicitudes de memoria de CLR cuando la memoria del sistema está restringida y solicitar a CLR que reduzca su uso de memoria cuando otras tareas necesiten memoria.</span><span class="sxs-lookup"><span data-stu-id="100c4-208">can also reject CLR memory requests when system memory is constrained, and ask CLR to reduce its memory use when other tasks need memory.</span></span>  
  
###### <a name="reliability-application-domains-and-unrecoverable-exceptions"></a><span data-ttu-id="100c4-209">Confiabilidad: dominios de aplicación y excepciones irrecuperables</span><span class="sxs-lookup"><span data-stu-id="100c4-209">Reliability: Application domains and unrecoverable exceptions</span></span>  
 <span data-ttu-id="100c4-210">Cuando el código administrado de las API de .NET Framework detecta excepciones críticas, como excepciones de memoria insuficiente o desbordamiento de pila, no siempre puede recuperarse de dichos errores y garantizar una semántica coherente y correcta para su implementación.</span><span class="sxs-lookup"><span data-stu-id="100c4-210">When managed code in the .NET Framework APIs encounters critical exceptions, such as out-of-memory or stack overflow, it is not always possible to recover from such failures and ensure consistent and correct semantics for their implementation.</span></span> <span data-ttu-id="100c4-211">Estas API generan una excepción de anulación de subprocesos en respuesta a estos errores.</span><span class="sxs-lookup"><span data-stu-id="100c4-211">These APIs raise a thread abort exception in response to these failures.</span></span>  
  
 <span data-ttu-id="100c4-212">Cuando se hospedan en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], dichas anulaciones de subprocesos se controlan de la siguiente forma: CLR detecta cualquier estado compartido en el dominio de aplicación en el que se produce la anulación del subproceso.</span><span class="sxs-lookup"><span data-stu-id="100c4-212">When hosted in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such thread aborts are handled as follows: the CLR detects any shared state in the application domain in which the thread abort occurs.</span></span> <span data-ttu-id="100c4-213">Para ello, CLR comprueba la presencia de objetos de sincronización.</span><span class="sxs-lookup"><span data-stu-id="100c4-213">The CLR does this by checking for the presence of synchronization objects.</span></span> <span data-ttu-id="100c4-214">Si hay un estado compartido en el dominio de aplicación, se descarga el propio dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="100c4-214">If there is shared state in the application domain, then the application domain itself is unloaded.</span></span> <span data-ttu-id="100c4-215">La descarga del dominio de aplicación detiene las transacciones de base de datos que se estén ejecutando en esos momentos en dicho dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="100c4-215">The unloading of the application domain stops database transactions that are currently running in that application domain.</span></span> <span data-ttu-id="100c4-216">Dado que la presencia de estado compartido puede aumentar el impacto de dichas excepciones críticas en las sesiones de usuario distintas de la que desencadena la excepción, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y CLR han dado algunos pasos para reducir la probabilidad del estado compartido.</span><span class="sxs-lookup"><span data-stu-id="100c4-216">Because the presence of shared state can widen the impact of such critical exceptions to user sessions other than the one triggering the exception, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR have taken steps to reduce the likelihood of shared state.</span></span> <span data-ttu-id="100c4-217">Para obtener más información, vea la documentación de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="100c4-217">For more information, see the .NET Framework documentation.</span></span>  
  
###### <a name="security-permission-sets"></a><span data-ttu-id="100c4-218">Seguridad: conjuntos de permisos</span><span class="sxs-lookup"><span data-stu-id="100c4-218">Security: Permission sets</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-219">permite a los usuarios especificar los requisitos de confiabilidad y seguridad para el código implementado en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="100c4-219">allows users to specify the reliability and security requirements for code deployed into the database.</span></span> <span data-ttu-id="100c4-220">Cuando los ensamblados se cargan en la base de datos, el autor del ensamblado puede especificar uno de los tres conjuntos de permisos para dicho ensamblado: SAFE, EXTERNAL_ACCESS y UNSAFE.</span><span class="sxs-lookup"><span data-stu-id="100c4-220">When assemblies are uploaded into the database, the author of the assembly can specify one of three permission sets for that assembly: SAFE, EXTERNAL_ACCESS and UNSAFE.</span></span>  
  
|||||  
|-|-|-|-|  
|<span data-ttu-id="100c4-221">Conjunto de permisos</span><span class="sxs-lookup"><span data-stu-id="100c4-221">Permission set</span></span>|<span data-ttu-id="100c4-222">SAFE</span><span class="sxs-lookup"><span data-stu-id="100c4-222">SAFE</span></span>|<span data-ttu-id="100c4-223">EXTERNAL_ACCESS</span><span class="sxs-lookup"><span data-stu-id="100c4-223">EXTERNAL_ACCESS</span></span>|<span data-ttu-id="100c4-224">UNSAFE</span><span class="sxs-lookup"><span data-stu-id="100c4-224">UNSAFE</span></span>|  
|<span data-ttu-id="100c4-225">Seguridad de acceso del código</span><span class="sxs-lookup"><span data-stu-id="100c4-225">Code Access Security</span></span>|<span data-ttu-id="100c4-226">Solo ejecución</span><span class="sxs-lookup"><span data-stu-id="100c4-226">Execute only</span></span>|<span data-ttu-id="100c4-227">Ejecución + acceso a recursos externos</span><span class="sxs-lookup"><span data-stu-id="100c4-227">Execute + access to external resources</span></span>|<span data-ttu-id="100c4-228">Sin restricciones</span><span class="sxs-lookup"><span data-stu-id="100c4-228">Unrestricted</span></span>|  
|<span data-ttu-id="100c4-229">Restricciones del modelo de programación</span><span class="sxs-lookup"><span data-stu-id="100c4-229">Programming model restrictions</span></span>|<span data-ttu-id="100c4-230">Sí</span><span class="sxs-lookup"><span data-stu-id="100c4-230">Yes</span></span>|<span data-ttu-id="100c4-231">Sí</span><span class="sxs-lookup"><span data-stu-id="100c4-231">Yes</span></span>|<span data-ttu-id="100c4-232">Sin restricciones</span><span class="sxs-lookup"><span data-stu-id="100c4-232">No restrictions</span></span>|  
|<span data-ttu-id="100c4-233">Requisito de capacidad de comprobación</span><span class="sxs-lookup"><span data-stu-id="100c4-233">Verifiability requirement</span></span>|<span data-ttu-id="100c4-234">Sí</span><span class="sxs-lookup"><span data-stu-id="100c4-234">Yes</span></span>|<span data-ttu-id="100c4-235">Sí</span><span class="sxs-lookup"><span data-stu-id="100c4-235">Yes</span></span>|<span data-ttu-id="100c4-236">No</span><span class="sxs-lookup"><span data-stu-id="100c4-236">No</span></span>|  
|<span data-ttu-id="100c4-237">Capacidad de llamar a código nativo</span><span class="sxs-lookup"><span data-stu-id="100c4-237">Ability to call native code</span></span>|<span data-ttu-id="100c4-238">No</span><span class="sxs-lookup"><span data-stu-id="100c4-238">No</span></span>|<span data-ttu-id="100c4-239">No</span><span class="sxs-lookup"><span data-stu-id="100c4-239">No</span></span>|<span data-ttu-id="100c4-240">Sí</span><span class="sxs-lookup"><span data-stu-id="100c4-240">Yes</span></span>|  
  
 <span data-ttu-id="100c4-241">SAFE es el modo más confiable y seguro, con restricciones asociadas relativas al modelo de programación permitido.</span><span class="sxs-lookup"><span data-stu-id="100c4-241">SAFE is the most reliable and secure mode with associated restrictions in terms of the allowed programming model.</span></span> <span data-ttu-id="100c4-242">Los ensamblados SAFE tienen permisos suficientes para la ejecución, realización de cálculos y obtención de acceso a la base de datos local.</span><span class="sxs-lookup"><span data-stu-id="100c4-242">SAFE assemblies are given enough permission to run, perform computations, and have access to the local database.</span></span> <span data-ttu-id="100c4-243">Los ensamblados SAFE deben tener capacidad para comprobar la seguridad de los tipos y no pueden llamar a código no administrado.</span><span class="sxs-lookup"><span data-stu-id="100c4-243">SAFE assemblies need to be verifiably type safe and are not allowed to call unmanaged code.</span></span>  
  
 <span data-ttu-id="100c4-244">UNSAFE está pensado para el código de alta confianza que solo pueden crear los administradores de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="100c4-244">UNSAFE is for highly trusted code that can only be created by database administrators.</span></span> <span data-ttu-id="100c4-245">Este código de confianza no tiene ninguna restricción de seguridad de acceso del código y puede llamar al código no administrado (nativo).</span><span class="sxs-lookup"><span data-stu-id="100c4-245">This trusted code has no code access security restrictions, and it can call unmanaged (native) code.</span></span>  
  
 <span data-ttu-id="100c4-246">EXTERNAL_ACCESS proporciona una opción de seguridad intermedia, que permite al código tener acceso a los recursos externos a la base de datos, pero manteniendo las garantías de confiabilidad de SAFE.</span><span class="sxs-lookup"><span data-stu-id="100c4-246">EXTERNAL_ACCESS provides an intermediate security option, allowing code to access resources external to the database but still having the reliability guarantees of SAFE.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-247">usa la capa de directiva CAS de nivel de host para configurar una directiva de host que concede uno de los tres conjuntos de permisos basados en el conjunto de permisos almacenado en los catálogos de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-247">uses the host-level CAS policy layer to set up a host policy that grants one of the three sets of permissions based on the permission set stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] catalogs.</span></span> <span data-ttu-id="100c4-248">El código administrado que se ejecuta dentro de la base de datos siempre obtiene uno de estos conjuntos de permisos de acceso a código.</span><span class="sxs-lookup"><span data-stu-id="100c4-248">Managed code running inside the database always gets one of these code access permission sets.</span></span>  
  
### <a name="programming-model-restrictions"></a><span data-ttu-id="100c4-249">Restricciones del modelo de programación</span><span class="sxs-lookup"><span data-stu-id="100c4-249">Programming Model Restrictions</span></span>  
 <span data-ttu-id="100c4-250">El modelo de programación para el código administrado de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implica la escritura de funciones, procedimientos y tipos que normalmente no necesitan usar el estado mantenido a lo largo de varias invocaciones o compartir el estado entre varias sesiones de usuario.</span><span class="sxs-lookup"><span data-stu-id="100c4-250">The programming model for managed code in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] involves writing functions, procedures, and types which typically do not require the use of state held across multiple invocations or the sharing of state across multiple user sessions.</span></span> <span data-ttu-id="100c4-251">Además, como se explicó antes, la presencia de estado compartido puede producir excepciones críticas que tienen un impacto en la escalabilidad y la confiabilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="100c4-251">Further, as described earlier, the presence of shared state can cause critical exceptions that impact the scalability and the reliability of the application.</span></span>  
  
 <span data-ttu-id="100c4-252">A la vista de estas consideraciones, se desaconseja el uso de variables estáticas y miembros de datos estáticos de las clases que se utilizan en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-252">Given these considerations, we discourage the use of static variables and static data members of classes used in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="100c4-253">En el caso de ensamblados SAFE y EXTERNAL_ACCESS, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examina los metadatos del ensamblado en el momento de creación del ensamblado (CREATE ASSEMBLY) y no puede crear dichos ensamblados si detecta el uso de variables y miembros de datos estáticos.</span><span class="sxs-lookup"><span data-stu-id="100c4-253">For SAFE and EXTERNAL_ACCESS assemblies, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examines the metadata of the assembly at CREATE ASSEMBLY time and fails the creation of such assemblies if it finds the use of static data members and variables.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="100c4-254">tampoco permite las llamadas a las API de .NET Framework anotadas con los atributos de protección del host `SharedState`, `Synchronization` y `ExternalProcessMgmt`.</span><span class="sxs-lookup"><span data-stu-id="100c4-254">also disallows calls to .NET Framework APIs that are annotated with the `SharedState`, `Synchronization` and `ExternalProcessMgmt` host protection attributes.</span></span> <span data-ttu-id="100c4-255">Esto impide que los ensamblados EXTERNAL_ACCESS y SAFE llamen a cualquiera de las API que habilitan el estado compartido, ejecuten la sincronización y puedan afectar a la integridad del proceso de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="100c4-255">This prevents SAFE and EXTERNAL_ACCESS assemblies from calling any APIs that enable sharing state, performing synchronization, and affecting the integrity of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="100c4-256">Para obtener más información, vea restricciones del modelo de programación de la [integración CLR](database-objects/clr-integration-programming-model-restrictions.md).</span><span class="sxs-lookup"><span data-stu-id="100c4-256">For more information, see [CLR Integration Programming Model Restrictions](database-objects/clr-integration-programming-model-restrictions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="100c4-257">Consulte también</span><span class="sxs-lookup"><span data-stu-id="100c4-257">See Also</span></span>  
 <span data-ttu-id="100c4-258">[Seguridad de la integración CLR](security/clr-integration-security.md) </span><span class="sxs-lookup"><span data-stu-id="100c4-258">[CLR Integration Security](security/clr-integration-security.md) </span></span>  
 [<span data-ttu-id="100c4-259">Rendimiento de la integración CLR</span><span class="sxs-lookup"><span data-stu-id="100c4-259">Performance of CLR Integration</span></span>](clr-integration-architecture-performance.md)  
  
  
