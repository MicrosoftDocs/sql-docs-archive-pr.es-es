---
title: Servidores vinculados (motor de base de datos) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB, linked servers
- OLE DB provider, linked servers
- server management [SQL Server], linked servers
- linked servers [SQL Server]
- distributed queries [SQL Server], linked servers
- servers [SQL Server], linked
- remote servers [SQL Server], linked servers
- linked servers [SQL Server], about linked servers
ms.assetid: 6ef578bf-8da7-46e0-88b5-e310fc908bb0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 4a1de70882cdeb87ccc0ae42aa23a9b6c8b3248e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87662902"
---
# <a name="linked-servers-database-engine"></a><span data-ttu-id="858c7-102">Servidores vinculados (motor de base de datos)</span><span class="sxs-lookup"><span data-stu-id="858c7-102">Linked Servers (Database Engine)</span></span>
  <span data-ttu-id="858c7-103">Configure un servidor vinculado para habilitar a [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] para que ejecute comandos en orígenes de datos OLE DB fuera de la instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="858c7-103">Configure a linked server to enable the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to execute commands against OLE DB data sources outside of the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="858c7-104">Los servidores vinculados normalmente se configuran para habilitar [!INCLUDE[ssDE](../../includes/ssde-md.md)] a fin de ejecutar una instrucción [!INCLUDE[tsql](../../includes/tsql-md.md)] que incluye las tablas de otra instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]u otro producto de base de datos como Oracle.</span><span class="sxs-lookup"><span data-stu-id="858c7-104">Typically linked servers are configured to enable the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that includes tables in another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], or another database product such as Oracle.</span></span> <span data-ttu-id="858c7-105">Muchos orígenes de datos OLE DB de tipos pueden configurarse como servidores vinculados, incluidos [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access y Excel.</span><span class="sxs-lookup"><span data-stu-id="858c7-105">Many types OLE DB data sources can be configured as linked servers, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access and Excel.</span></span> <span data-ttu-id="858c7-106">Los servidores vinculados ofrecen las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="858c7-106">Linked servers offer the following advantages:</span></span>

-   <span data-ttu-id="858c7-107">Capacidad de obtener acceso a datos fuera de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="858c7-107">The ability to access data from outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

-   <span data-ttu-id="858c7-108">Capacidad de ejecutar consultas distribuidas, actualizaciones, comandos y transacciones en orígenes de datos heterogéneos en toda la organización.</span><span class="sxs-lookup"><span data-stu-id="858c7-108">The ability to issue distributed queries, updates, commands, and transactions on heterogeneous data sources across the enterprise.</span></span>

-   <span data-ttu-id="858c7-109">Capacidad de tratar diferentes orígenes de datos de manera similar.</span><span class="sxs-lookup"><span data-stu-id="858c7-109">The ability to address diverse data sources similarly.</span></span>

 <span data-ttu-id="858c7-110">Puede configurar un servidor vinculado con [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] o con la instrucción [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="858c7-110">You can configure a linked server by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or by using the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) statement.</span></span> <span data-ttu-id="858c7-111">Los proveedores OLE DB varían en gran medida en el tipo y el número de parámetros necesarios.</span><span class="sxs-lookup"><span data-stu-id="858c7-111">OLE DB providers vary greatly in the type and number of parameters required.</span></span> <span data-ttu-id="858c7-112">Por ejemplo, algunos proveedores requieren que proporcione un contexto de seguridad para la conexión con [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="858c7-112">For example some providers require you to provide a security context for the connection using [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span></span> <span data-ttu-id="858c7-113">Algunos proveedores OLE DB que permiten [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] actualizar datos en el origen de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="858c7-113">Some OLE DB providers allow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to update data on the OLE DB source.</span></span> <span data-ttu-id="858c7-114">Otros solo proporcionan acceso a datos de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="858c7-114">Others provide only read-only data access.</span></span> <span data-ttu-id="858c7-115">Para obtener información acerca de cada proveedor OLE DB, consulte la documentación para dicho proveedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="858c7-115">For information about each OLE DB provider, consult documentation for that OLE DB provider.</span></span>

## <a name="linked-server-components"></a><span data-ttu-id="858c7-116">Componentes de servidores vinculados</span><span class="sxs-lookup"><span data-stu-id="858c7-116">Linked Server Components</span></span>
 <span data-ttu-id="858c7-117">Una definición de servidor vinculado especifica los siguientes objetos:</span><span class="sxs-lookup"><span data-stu-id="858c7-117">A linked server definition specifies the following objects:</span></span>

-   <span data-ttu-id="858c7-118">Un proveedor OLE DB</span><span class="sxs-lookup"><span data-stu-id="858c7-118">An OLE DB provider</span></span>

-   <span data-ttu-id="858c7-119">Un origen de datos OLE DB</span><span class="sxs-lookup"><span data-stu-id="858c7-119">An OLE DB data source</span></span>

 <span data-ttu-id="858c7-120">Un *proveedor OLE DB* es una biblioteca DLL que administra un origen de datos específico e interactúa con él.</span><span class="sxs-lookup"><span data-stu-id="858c7-120">An *OLE DB provider* is a DLL that manages and interacts with a specific data source.</span></span> <span data-ttu-id="858c7-121">Un *origen de datos OLE DB* identifica la base datos específica a la que se puede tener acceso mediante OLE DB.</span><span class="sxs-lookup"><span data-stu-id="858c7-121">An *OLE DB data source* identifies the specific database that can be accessed through OLE DB.</span></span> <span data-ttu-id="858c7-122">Aunque los orígenes de datos en los que se realizan consultas a través de definiciones de servidores vinculados son bases de datos normales, existen proveedores OLE DB para una amplia variedad de archivos y formatos de archivo.</span><span class="sxs-lookup"><span data-stu-id="858c7-122">Although data sources queried through linked server definitions are ordinarily databases, OLE DB providers exist for a variety of files and file formats.</span></span> <span data-ttu-id="858c7-123">Se trata de archivos de texto, datos de hojas de cálculo y los resultados de búsquedas de contenido de texto completo.</span><span class="sxs-lookup"><span data-stu-id="858c7-123">These include text files, spreadsheet data, and the results of full-text content searches.</span></span>

 <span data-ttu-id="858c7-124">El [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client (ProgID: SQLNCLI11) es el proveedor de OLE DB oficial para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="858c7-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (PROGID: SQLNCLI11) is the official OLE DB provider for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

> [!NOTE]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="858c7-125">están diseñadas para ser usadas con cualquier proveedor OLE DB que implemente las interfaces OLE DB requeridas.</span><span class="sxs-lookup"><span data-stu-id="858c7-125">distributed queries are designed to work with any OLE DB provider that implements the required OLE DB interfaces.</span></span> <span data-ttu-id="858c7-126">Sin embargo, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] solo se ha probado con el proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client y algunos otros.</span><span class="sxs-lookup"><span data-stu-id="858c7-126">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has been tested against only the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider and certain other providers.</span></span>

## <a name="linked-server-details"></a><span data-ttu-id="858c7-127">Detalles de servidores vinculados</span><span class="sxs-lookup"><span data-stu-id="858c7-127">Linked Server Details</span></span>
 <span data-ttu-id="858c7-128">En la siguiente ilustración se muestran los conceptos básicos de una configuración con servidores vinculados.</span><span class="sxs-lookup"><span data-stu-id="858c7-128">The following illustration shows the basics of a linked server configuration.</span></span>

 <span data-ttu-id="858c7-129">![Nivel de cliente, nivel de servidor y nivel de servidor de base de datos](../../database-engine/media/lsvr.gif "Nivel de cliente, nivel de servidor y nivel de servidor de base de datos")</span><span class="sxs-lookup"><span data-stu-id="858c7-129">![Client tier, server tier, and database server tier](../../database-engine/media/lsvr.gif "Client tier, server tier, and database server tier")</span></span>

 <span data-ttu-id="858c7-130">Normalmente, los servidores vinculados se utilizan para tratar consultas distribuidas.</span><span class="sxs-lookup"><span data-stu-id="858c7-130">Typically, linked servers are used to handle distributed queries.</span></span> <span data-ttu-id="858c7-131">Cuando una aplicación cliente ejecuta una consulta distribuida mediante un servidor vinculado, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] analiza el comando y envía solicitudes a OLE DB.</span><span class="sxs-lookup"><span data-stu-id="858c7-131">When a client application executes a distributed query through a linked server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] parses the command and sends requests to OLE DB.</span></span> <span data-ttu-id="858c7-132">La solicitud de conjuntos de filas se puede realizar como una consulta al proveedor o abriendo una tabla base del proveedor.</span><span class="sxs-lookup"><span data-stu-id="858c7-132">The rowset request may be in the form of executing a query against the provider or opening a base table from the provider.</span></span>

 <span data-ttu-id="858c7-133">Para que un origen de datos devuelva información mediante un servidor vinculado, el proveedor OLE DB (DLL) para ese origen de datos debe encontrarse en el mismo servidor que la instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="858c7-133">For a data source to return data through a linked server, the OLE DB provider (DLL) for that data source must be present on the same server as the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="858c7-134">Cuando se utiliza un proveedor OLE DB de otro fabricante, la cuenta con la que se ejecuta el servicio de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] debe tener permisos de lectura y ejecución para el directorio y todos los subdirectorios en los que esté instalado el proveedor.</span><span class="sxs-lookup"><span data-stu-id="858c7-134">When a third-party OLE DB provider is used, the account under which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service runs must have read and execute permissions for the directory, and all subdirectories, in which the provider is installed.</span></span>

## <a name="managing-providers"></a><span data-ttu-id="858c7-135">Administrar proveedores</span><span class="sxs-lookup"><span data-stu-id="858c7-135">Managing Providers</span></span>
 <span data-ttu-id="858c7-136">Existe un conjunto de opciones para controlar cómo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] carga y utiliza proveedores OLE DB que se hayan especificado en el registro.</span><span class="sxs-lookup"><span data-stu-id="858c7-136">There is a set of options that control how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] loads and uses OLE DB providers that are specified in the registry.</span></span>

## <a name="managing-linked-server-definitions"></a><span data-ttu-id="858c7-137">Administrar definiciones de servidores vinculados</span><span class="sxs-lookup"><span data-stu-id="858c7-137">Managing Linked Server Definitions</span></span>
 <span data-ttu-id="858c7-138">Cuando configure un servidor vinculado, registre la información de la conexión y del origen de datos con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="858c7-138">When you are setting up a linked server, register the connection information and data source information with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="858c7-139">Una vez realizado el registro, se puede hacer referencia a ese origen de datos con un único nombre lógico.</span><span class="sxs-lookup"><span data-stu-id="858c7-139">After registered, that data source can be referred to with a single logical name.</span></span>

 <span data-ttu-id="858c7-140">Puede utilizar procedimientos almacenados y vistas de catálogo para administrar definiciones de servidores vinculados:</span><span class="sxs-lookup"><span data-stu-id="858c7-140">You can use stored procedures and catalog views to manage linked server definitions:</span></span>

-   <span data-ttu-id="858c7-141">Cree una definición de servidor vinculado mediante la ejecución de **sp_addlinkedserver**.</span><span class="sxs-lookup"><span data-stu-id="858c7-141">Create a linked server definition by running **sp_addlinkedserver**.</span></span>

-   <span data-ttu-id="858c7-142">Vea información acerca de los servidores vinculados definidos en una instancia específica de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ejecutando una consulta en las vistas de catálogo del sistema **sys.servers** .</span><span class="sxs-lookup"><span data-stu-id="858c7-142">View information about the linked servers defined in a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by running a query against the **sys.servers** system catalog views.</span></span>

-   <span data-ttu-id="858c7-143">Elimine una definición de servidor vinculado mediante la ejecución de **sp_dropserver**.</span><span class="sxs-lookup"><span data-stu-id="858c7-143">Delete a linked server definition by running **sp_dropserver**.</span></span> <span data-ttu-id="858c7-144">También puede utilizar este procedimiento almacenado para quitar servidores remotos.</span><span class="sxs-lookup"><span data-stu-id="858c7-144">You can also use this stored procedure to remove a remote server.</span></span>

 <span data-ttu-id="858c7-145">También puede definir servidores vinculados mediante [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="858c7-145">You can also define linked servers by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="858c7-146">En el Explorador de objetos, haga clic con el botón derecho en **Objetos de servidor**, seleccione **Nuevo**y, después, **Servidor vinculado**.</span><span class="sxs-lookup"><span data-stu-id="858c7-146">In the Object Explorer, right-click **Server Objects**, select **New**, and select **Linked Server**.</span></span> <span data-ttu-id="858c7-147">Puede eliminar una definición de servidor vinculado al hacer clic con el botón derecho en el nombre del servidor vinculado y seleccionar **Eliminar**.</span><span class="sxs-lookup"><span data-stu-id="858c7-147">You can delete a linked server definition by right-clicking the linked server name and selecting **Delete**.</span></span>

 <span data-ttu-id="858c7-148">Cuando ejecute una consulta distribuida en un servidor vinculado, incluya el nombre de cuatro partes completo de una tabla para cada origen de datos en el que desee realizar la consulta.</span><span class="sxs-lookup"><span data-stu-id="858c7-148">When you execute a distributed query against a linked server, include a fully qualified, four-part table name for each data source to query.</span></span> <span data-ttu-id="858c7-149">Este nombre de cuatro partes debe tener el formato _linked_server_name. Catalog_**. _`schema`_ .** _object_name_.</span><span class="sxs-lookup"><span data-stu-id="858c7-149">This four-part name should be in the form _linked_server_name.catalog_**._`schema`_.**_object_name_.</span></span>

> [!NOTE]
>  <span data-ttu-id="858c7-150">Es posible definir servidores vinculados que señalen al servidor donde se han definido, es decir, que operen como bucle invertido.</span><span class="sxs-lookup"><span data-stu-id="858c7-150">Linked servers can be defined to point back (loop back) to the server on which they are defined.</span></span> <span data-ttu-id="858c7-151">Los servidores en bucle invertido resultan muy útiles cuando se prueba una aplicación que utiliza consultas distribuidas en una red con un único servidor.</span><span class="sxs-lookup"><span data-stu-id="858c7-151">Loopback servers are most useful when testing an application that uses distributed queries on a single server network.</span></span> <span data-ttu-id="858c7-152">Los servidores vinculados en bucle invertido están previstos para la realización de pruebas y no se admiten para muchas operaciones, como las transacciones distribuidas.</span><span class="sxs-lookup"><span data-stu-id="858c7-152">Loopback linked servers are intended for testing and are not supported for many operations, such as distributed transactions.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="858c7-153">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="858c7-153">Related Tasks</span></span>
 [<span data-ttu-id="858c7-154">Creación de servidores vinculados &#40;Motor de base de datos de SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="858c7-154">Create Linked Servers &#40;SQL Server Database Engine&#41;</span></span>](create-linked-servers-sql-server-database-engine.md)

 [<span data-ttu-id="858c7-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="858c7-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)

 [<span data-ttu-id="858c7-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="858c7-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)

 [<span data-ttu-id="858c7-157">sp_dropserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="858c7-157">sp_dropserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropserver-transact-sql)

## <a name="related-content"></a><span data-ttu-id="858c7-158">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="858c7-158">Related Content</span></span>
 [<span data-ttu-id="858c7-159">sys.servers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="858c7-159">sys.servers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-servers-transact-sql)

 [<span data-ttu-id="858c7-160">sp_linkedservers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="858c7-160">sp_linkedservers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-linkedservers-transact-sql)


