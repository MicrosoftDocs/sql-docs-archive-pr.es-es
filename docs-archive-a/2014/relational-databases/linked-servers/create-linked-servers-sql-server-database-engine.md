---
title: Creación de servidores vinculados (motor de base de datos de SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 11/20/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
f1_keywords:
- sql12.swb.linkedserver.properties.general.f1
- sql12.swb.linkedserver.properties.security.f1
- sql12.swb.linkedserver.properties.provider.f1
- sql12.swb.linkedserver.properties.options.f1
helpviewer_keywords:
- linked servers [SQL Server], creating
ms.assetid: 3228065d-de8f-4ece-a9b1-e06d3dca9310
author: stevestein
ms.author: sstein
ms.openlocfilehash: 6b28468db1024a9789364e5b6e5c115cba71fa9f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87745295"
---
# <a name="create-linked-servers-sql-server-database-engine"></a><span data-ttu-id="b0229-102">Crear servidores vinculados (motor de base de datos de SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b0229-102">Create Linked Servers (SQL Server Database Engine)</span></span>
  <span data-ttu-id="b0229-103">En este tema se muestra cómo crear un servidor vinculado y tener acceso a los datos desde otra instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] mediante [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] o [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b0229-103">This topic shows how to create a linked server and access data from another [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="b0229-104">La creación de un servidor vinculado permite trabajar con datos de varios orígenes.</span><span class="sxs-lookup"><span data-stu-id="b0229-104">By creating a linked server,  you can work with data from multiple sources.</span></span> <span data-ttu-id="b0229-105">El servidor vinculado no necesita ser otra instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], sino que es un escenario común.</span><span class="sxs-lookup"><span data-stu-id="b0229-105">The linked server does not have to be another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but that is a common scenario.</span></span>  
  
##  <a name="background"></a><a name="Background"></a> <span data-ttu-id="b0229-106">Información previa</span><span class="sxs-lookup"><span data-stu-id="b0229-106">Background</span></span>  
 <span data-ttu-id="b0229-107">Un servidor vinculado permite obtener acceso a consultas heterogéneas distribuidas en orígenes de datos OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0229-107">A linked server allows for access to distributed, heterogeneous queries against OLE DB data sources.</span></span> <span data-ttu-id="b0229-108">Después de crear un servidor vinculado, las consultas distribuidas se pueden ejecutar en este servidor. Las consultas pueden unir tablas de varios orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="b0229-108">After a linked server is created, distributed queries can be run against this server, and queries can join tables from more than one data source.</span></span> <span data-ttu-id="b0229-109">Si el servidor vinculado se define como una instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], se pueden ejecutar procedimientos almacenados remotos.</span><span class="sxs-lookup"><span data-stu-id="b0229-109">If the linked server is defined as an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], remote stored procedures can be executed.</span></span>  
  
 <span data-ttu-id="b0229-110">Las capacidades y los argumentos requeridos de los servidores vinculados pueden variar significativamente.</span><span class="sxs-lookup"><span data-stu-id="b0229-110">The capabilities and required arguments of the linked server can vary significantly.</span></span> <span data-ttu-id="b0229-111">Los ejemplos de este tema proporcionan un ejemplo típico. Sin embargo, no se describen todas las opciones.</span><span class="sxs-lookup"><span data-stu-id="b0229-111">The examples in this topic provide a typical example but all options are not described.</span></span> <span data-ttu-id="b0229-112">Para obtener más información, vea [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b0229-112">For more information, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
##  <a name="security"></a><a name="Security"></a> <span data-ttu-id="b0229-113">Seguridad</span><span class="sxs-lookup"><span data-stu-id="b0229-113">Security</span></span>  
  
### <a name="permissions"></a><span data-ttu-id="b0229-114">Permisos</span><span class="sxs-lookup"><span data-stu-id="b0229-114">Permissions</span></span>  
 <span data-ttu-id="b0229-115">Cuando se usan [!INCLUDE[tsql](../../includes/tsql-md.md)] instrucciones, requiere `ALTER ANY LINKED SERVER` el permiso en el servidor o la pertenencia al rol fijo de servidor **setupadmin** .</span><span class="sxs-lookup"><span data-stu-id="b0229-115">When using [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, requires `ALTER ANY LINKED SERVER` permission on the server or membership in the **setupadmin** fixed server role.</span></span> <span data-ttu-id="b0229-116">Cuando se usa, se [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] requiere `CONTROL SERVER` el permiso o la pertenencia al rol fijo de servidor **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="b0229-116">When using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] requires `CONTROL SERVER` permission or membership in the **sysadmin** fixed server role.</span></span>  
  
##  <a name="how-to-create-a-linked-server"></a><a name="Procedures"></a> <span data-ttu-id="b0229-117">Crear un servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b0229-117">How to Create a Linked Server</span></span>  
 <span data-ttu-id="b0229-118">Puede usar cualquiera de los elementos siguientes:</span><span class="sxs-lookup"><span data-stu-id="b0229-118">You can use any of the following:</span></span>  
  
-   [<span data-ttu-id="b0229-119">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b0229-119">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
-   [<span data-ttu-id="b0229-120">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b0229-120">Transact-SQL</span></span>](#TsqlProcedure)  
  
###  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="b0229-121">Uso de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b0229-121">Using SQL Server Management Studio</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-sql-server-management-studio"></a><span data-ttu-id="b0229-122">Para crear un servidor vinculado a otra instancia de SQL Server utilizando SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b0229-122">To create a linked server to another instance of SQL Server Using SQL Server Management Studio</span></span>  
  
1.  <span data-ttu-id="b0229-123">En [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], abra el Explorador de objetos, expanda **Objetos de servidor**, haga clic con el botón derecho en **Servidores vinculados**y, luego, haga clic en **Nuevo servidor vinculado**.</span><span class="sxs-lookup"><span data-stu-id="b0229-123">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], open Object Explorer, expand **Server Objects**, right-click **Linked Servers**, and then click **New Linked Server**.</span></span>  
  
2.  <span data-ttu-id="b0229-124">En el cuadro **Servidor vinculado** de la página **General** , escriba el nombre de la instancia de **SQL Server** al que esté vinculando.</span><span class="sxs-lookup"><span data-stu-id="b0229-124">On the **General** page, in the **Linked server** box, type the name of the instance of **SQL Server** that you area linking to.</span></span>  
  
     <span data-ttu-id="b0229-125">**SQL Server**</span><span class="sxs-lookup"><span data-stu-id="b0229-125">**SQL Server**</span></span>  
     <span data-ttu-id="b0229-126">Identifica el servidor vinculado como una instancia de [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b0229-126">Identify the linked server as an instance of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b0229-127">Si usa este método para definir un servidor vinculado de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , el nombre especificado en **Servidor vinculado** debe ser el nombre de red del servidor.</span><span class="sxs-lookup"><span data-stu-id="b0229-127">If you use this method of defining a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] linked server, the name specified in **Linked server** must be the network name of the server.</span></span> <span data-ttu-id="b0229-128">Además, cualquier tabla obtenida del servidor pertenecerá a la base de datos predeterminada definida para el inicio de sesión del servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-128">Also, any tables retrieved from the server are from the default database defined for the login on the linked server.</span></span>  
  
     <span data-ttu-id="b0229-129">**Otro origen de datos**</span><span class="sxs-lookup"><span data-stu-id="b0229-129">**Other data source**</span></span>  
     <span data-ttu-id="b0229-130">Especifique un tipo de servidor OLE DB distinto de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b0229-130">Specify an OLE DB server type other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b0229-131">Al hacer clic en esta opción, se activan las opciones que aparecen debajo.</span><span class="sxs-lookup"><span data-stu-id="b0229-131">Clicking this option activates the options below it.</span></span>  
  
     <span data-ttu-id="b0229-132">**Proveedor**</span><span class="sxs-lookup"><span data-stu-id="b0229-132">**Provider**</span></span>  
     <span data-ttu-id="b0229-133">Seleccione un origen de datos OLE DB del cuadro de lista.</span><span class="sxs-lookup"><span data-stu-id="b0229-133">Select an OLE DB data source from the list box.</span></span> <span data-ttu-id="b0229-134">El proveedor OLE DB se ha registrado con el PROGID especificado en el registro.</span><span class="sxs-lookup"><span data-stu-id="b0229-134">The OLE DB provider is registered with the given PROGID in the registry.</span></span>  
  
     <span data-ttu-id="b0229-135">**Nombre del producto**</span><span class="sxs-lookup"><span data-stu-id="b0229-135">**Product name**</span></span>  
     <span data-ttu-id="b0229-136">Escriba el nombre del producto del origen de datos OLE DB para agregarlo como servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-136">Type the product name of the OLE DB data source to add as a linked server.</span></span>  
  
     <span data-ttu-id="b0229-137">**Origen de datos**</span><span class="sxs-lookup"><span data-stu-id="b0229-137">**Data source**</span></span>  
     <span data-ttu-id="b0229-138">Escriba el nombre del origen de datos como lo interpreta el proveedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0229-138">Type the name of the data source as interpreted by the OLE DB provider.</span></span> <span data-ttu-id="b0229-139">Si se está conectando a una instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], proporcione el nombre de instancia.</span><span class="sxs-lookup"><span data-stu-id="b0229-139">If you are connecting to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], provide the instance name.</span></span>  
  
     <span data-ttu-id="b0229-140">**Cadena de proveedor**</span><span class="sxs-lookup"><span data-stu-id="b0229-140">**Provider string**</span></span>  
     <span data-ttu-id="b0229-141">Escriba el identificador de programación (PROGID) único del proveedor OLE DB que corresponde al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="b0229-141">Type the unique programmatic identifier (PROGID) of the OLE DB provider that corresponds to the data source.</span></span> <span data-ttu-id="b0229-142">Para ver ejemplos de cadenas de proveedores válidas, vea [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b0229-142">For examples of valid provider strings, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
     <span data-ttu-id="b0229-143">**Ubicación**</span><span class="sxs-lookup"><span data-stu-id="b0229-143">**Location**</span></span>  
     <span data-ttu-id="b0229-144">Escriba la ubicación de la base de datos según la interpretación del proveedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0229-144">Type the location of the database as interpreted by the OLE DB provider.</span></span>  
  
     <span data-ttu-id="b0229-145">**Catálogo**</span><span class="sxs-lookup"><span data-stu-id="b0229-145">**Catalog**</span></span>  
     <span data-ttu-id="b0229-146">Escriba el nombre del catálogo que se va a usar cuando se establezca la conexión al proveedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0229-146">Type the name of the catalog to use when making a connection to the OLE DB provider.</span></span>  
  
     <span data-ttu-id="b0229-147">Para comprobar la capacidad de conexión a un servidor vinculado, en el Explorador de objetos, haga clic con el botón derecho en el servidor vinculado y, luego, haga clic en **Probar conexión**.</span><span class="sxs-lookup"><span data-stu-id="b0229-147">To test the ability to connect to a linked server, in Object Explorer, right-click the linked server and then click **Test Connection**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b0229-148">Si la instancia de **SQL Server** es la instancia predeterminada, escriba el nombre del equipo que hospede la instancia de **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="b0229-148">If the instance of **SQL Server** is the default instance, enter the name of the computer that hosts the instance of **SQL Server**.</span></span> <span data-ttu-id="b0229-149">Si **SQL Server** es una instancia con nombre, escriba el nombre del equipo y el de la instancia, por ejemplo, **Accounting\SQLExpress**.</span><span class="sxs-lookup"><span data-stu-id="b0229-149">If the **SQL Server** is a named instance, enter the name of the computer and the name of the instance, such as **Accounting\SQLExpress**.</span></span>  
  
3.  <span data-ttu-id="b0229-150">En el área **Tipo de servidor**, seleccione **SQL Server** para indicar que el servidor vinculado es otra instancia de **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="b0229-150">In the **Server type** area, select **SQL Server** to indicate that the linked server is another instance of **SQL Server**.</span></span>  
  
4.  <span data-ttu-id="b0229-151">En la página **Seguridad** , especifique el contexto de seguridad que se usará cuando la versión original de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] se conecte con el servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-151">On the **Security** page, specify the security context that will be used when the original [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connects to the linked server.</span></span> <span data-ttu-id="b0229-152">En un entorno de dominio donde los usuarios se conectan mediante sus inicios de sesión, la selección de **Se establecerán usando el contexto de seguridad actual del inicio de sesión** suele ser la mejor opción.</span><span class="sxs-lookup"><span data-stu-id="b0229-152">In a domain environment where users are connecting by using their domain logins, selecting **Be made using the login's current security context** is often the best choice.</span></span> <span data-ttu-id="b0229-153">Cuando los usuarios se conecten a la versión original de **SQL Server** usando un inicio de sesión de **SQL Server** , la mejor opción suele ser seleccionar **Se establecerán usando este contexto de seguridad**y, a continuación, proporcionar las credenciales necesarias para la autenticación en el servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-153">When users connect to the original **SQL Server** by using a **SQL Server** login, the best choice is often to select **By using this security context**, and then providing the necessary credentials to authenticate at the linked server.</span></span>  
  
     <span data-ttu-id="b0229-154">**Inicio de sesión local**</span><span class="sxs-lookup"><span data-stu-id="b0229-154">**Local login**</span></span>  
     <span data-ttu-id="b0229-155">Permite especificar el inicio de sesión local que se puede conectar al servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-155">Specify the local login that can connect to the linked server.</span></span> <span data-ttu-id="b0229-156">El inicio de sesión local puede ser un inicio de sesión que utilice la autenticación de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] o un inicio de sesión de autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="b0229-156">The local login can be either a login using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication or a Windows Authentication login.</span></span> <span data-ttu-id="b0229-157">Utilice esta lista para restringir la conexión a inicios de sesión específicos o para permitir que algunos inicios de sesión se conecten como un inicio de sesión diferente.</span><span class="sxs-lookup"><span data-stu-id="b0229-157">Use this list to restrict the connection to specific logins, or to allow some logins to connect as a different login.</span></span>  
  
     <span data-ttu-id="b0229-158">**Impersonate**</span><span class="sxs-lookup"><span data-stu-id="b0229-158">**Impersonate**</span></span>  
     <span data-ttu-id="b0229-159">Pasa el nombre de usuario y la contraseña del inicio de sesión local al servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-159">Pass the username and password from the local login to the linked server.</span></span> <span data-ttu-id="b0229-160">En la autenticación de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , debe existir un inicio de sesión con el mismo nombre y contraseña en el servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-160">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, a login with the exact same name and password must exist on the remote server.</span></span> <span data-ttu-id="b0229-161">En los inicios de sesión de Windows, el inicio de sesión debe ser un inicio de sesión válido en el servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-161">For Windows logins, the login must be a valid login on the linked server.</span></span>  
  
     <span data-ttu-id="b0229-162">Para utilizar la suplantación, la configuración debe cumplir los requisitos de la delegación.</span><span class="sxs-lookup"><span data-stu-id="b0229-162">To use impersonation, the configuration must meet the requirement for delegation.</span></span>  
  
     <span data-ttu-id="b0229-163">**Usuario remoto**</span><span class="sxs-lookup"><span data-stu-id="b0229-163">**Remote User**</span></span>  
     <span data-ttu-id="b0229-164">Use el usuario remoto para asignar usuarios no definidos en **Inicio de sesión local**.</span><span class="sxs-lookup"><span data-stu-id="b0229-164">Use the remote user to map users not defined in **Local login**.</span></span> <span data-ttu-id="b0229-165">El **Usuario remoto** debe ser un inicio de sesión de autenticación de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en el servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-165">The **Remote User** must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
     <span data-ttu-id="b0229-166">**Contraseña remota**</span><span class="sxs-lookup"><span data-stu-id="b0229-166">**Remote Password**</span></span>  
     <span data-ttu-id="b0229-167">Permite especificar la contraseña del usuario remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-167">Specify the password of the Remote User.</span></span>  
  
     <span data-ttu-id="b0229-168">**Add**</span><span class="sxs-lookup"><span data-stu-id="b0229-168">**Add**</span></span>  
     <span data-ttu-id="b0229-169">Permite agregar un nuevo inicio de sesión local.</span><span class="sxs-lookup"><span data-stu-id="b0229-169">Add a new local login.</span></span>  
  
     <span data-ttu-id="b0229-170">**Remove**</span><span class="sxs-lookup"><span data-stu-id="b0229-170">**Remove**</span></span>  
     <span data-ttu-id="b0229-171">Quita un inicio de sesión local existente.</span><span class="sxs-lookup"><span data-stu-id="b0229-171">Remove an existing local login.</span></span>  
  
     <span data-ttu-id="b0229-172">**No se establecerán**</span><span class="sxs-lookup"><span data-stu-id="b0229-172">**Not be made**</span></span>  
     <span data-ttu-id="b0229-173">Permite especificar que no se establecerán conexiones para los inicios de sesión que no estén definidos en la lista.</span><span class="sxs-lookup"><span data-stu-id="b0229-173">Specify that a connection will not be made for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="b0229-174">**Se establecerán sin usar un contexto de seguridad**</span><span class="sxs-lookup"><span data-stu-id="b0229-174">**Be made without using a security context**</span></span>  
     <span data-ttu-id="b0229-175">Permite especificar que se establecerán conexiones sin utilizar un contexto de seguridad para los inicios de sesión no definidos en la lista.</span><span class="sxs-lookup"><span data-stu-id="b0229-175">Specify that a connection will be made without using a security context for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="b0229-176">**Se establecerán usando el contexto de seguridad actual del inicio de sesión**</span><span class="sxs-lookup"><span data-stu-id="b0229-176">**Be made using the login's current security context**</span></span>  
     <span data-ttu-id="b0229-177">Permite especificar que se establecerá una conexión con el contexto de seguridad actual del inicio de sesión para los inicios de sesión no definidos en la lista.</span><span class="sxs-lookup"><span data-stu-id="b0229-177">Specify that a connection will be made using the current security context of the login for logins not defined in the list.</span></span> <span data-ttu-id="b0229-178">Si está conectado al servidor local mediante la autenticación de Windows, las credenciales de Windows se utilizarán para conectar al servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-178">If connected to the local server using Windows Authentication, your windows credentials will be used to connect to the remote server.</span></span> <span data-ttu-id="b0229-179">Si está conectado al servidor local mediante la autenticación de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , la contraseña y el nombre de usuario de inicio de sesión se utilizarán para conectar al servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-179">If connected to the local server using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, login name and password will be used to connect to the remote server.</span></span> <span data-ttu-id="b0229-180">En este caso, debe existir un inicio de sesión con el mismo nombre y contraseña en el servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-180">In this case a login with the exact same name and password must exist on the remote server.</span></span>  
  
     <span data-ttu-id="b0229-181">**Se establecerán usando este contexto de seguridad**</span><span class="sxs-lookup"><span data-stu-id="b0229-181">**Be made using this security context**</span></span>  
     <span data-ttu-id="b0229-182">Especifique que se establecerá una conexión con el inicio de sesión y la contraseña especificados en los cuadros **Inicio de sesión remoto** y **Con contraseña** para los inicios de sesión que no estén definidos en la lista.</span><span class="sxs-lookup"><span data-stu-id="b0229-182">Specify that a connection will be made using the login and password specified in the **Remote login** and **With password** boxes for logins not defined in the list.</span></span> <span data-ttu-id="b0229-183">El inicio de sesión remoto debe ser un inicio de sesión de autenticación de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en el servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b0229-183">The remote login must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
5.  <span data-ttu-id="b0229-184">Opcionalmente, para ver o especificar opciones de servidor, haga clic en la página **Opciones del servidor**  .</span><span class="sxs-lookup"><span data-stu-id="b0229-184">Optionally, to view or specify server options, click the **Server Options**  page.</span></span>  
  
     <span data-ttu-id="b0229-185">**Compatible con la intercalación**</span><span class="sxs-lookup"><span data-stu-id="b0229-185">**Collation Compatible**</span></span>  
     <span data-ttu-id="b0229-186">Afecta a la ejecución de consultas distribuidas en los servidores vinculados.</span><span class="sxs-lookup"><span data-stu-id="b0229-186">Affects Distributed Query execution against linked servers.</span></span> <span data-ttu-id="b0229-187">Si esta opción se establece en true, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] supone asume que todos los caracteres del servidor vinculado son compatibles con el servidor local en lo que respecta a juego de caracteres y secuencia de intercalación (o criterio de ordenación).</span><span class="sxs-lookup"><span data-stu-id="b0229-187">If this option is set to true, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] assumes that all characters in the linked server are compatible with the local server, with regard to character set and collation sequence (or sort order).</span></span> <span data-ttu-id="b0229-188">Esta opción habilita a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para enviar comparaciones en columnas de caracteres al proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0229-188">This enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send comparisons on character columns to the provider.</span></span> <span data-ttu-id="b0229-189">Si no se establece esta opción, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] siempre evalúa localmente las comparaciones en las columnas de caracteres.</span><span class="sxs-lookup"><span data-stu-id="b0229-189">If this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] always evaluates comparisons on character columns locally.</span></span>  
  
     <span data-ttu-id="b0229-190">Esta opción solo se debe establecer si se tiene la certeza de que el origen de datos correspondiente al servidor vinculado tiene el mismo juego de caracteres y criterio de ordenación que el servidor local.</span><span class="sxs-lookup"><span data-stu-id="b0229-190">This option should be set only if it is certain that the data source corresponding to the linked server has the same character set and sort order as the local server.</span></span>  
  
     <span data-ttu-id="b0229-191">**Acceso a datos**</span><span class="sxs-lookup"><span data-stu-id="b0229-191">**Data Access**</span></span>  
     <span data-ttu-id="b0229-192">Habilita y deshabilita un servidor vinculado para el acceso a consultas distribuidas.</span><span class="sxs-lookup"><span data-stu-id="b0229-192">Enables and disables a linked server for distributed query access.</span></span>  
  
     <span data-ttu-id="b0229-193">**RPC**</span><span class="sxs-lookup"><span data-stu-id="b0229-193">**RPC**</span></span>  
     <span data-ttu-id="b0229-194">Habilita RPC desde el servidor especificado.</span><span class="sxs-lookup"><span data-stu-id="b0229-194">Enables RPC from the specified server.</span></span>  
  
     <span data-ttu-id="b0229-195">**RPC fuera**</span><span class="sxs-lookup"><span data-stu-id="b0229-195">**RPC Out**</span></span>  
     <span data-ttu-id="b0229-196">Habilita RPC en el servidor especificado.</span><span class="sxs-lookup"><span data-stu-id="b0229-196">Enables RPC to the specified server.</span></span>  
  
     <span data-ttu-id="b0229-197">**Usar intercalación remota**</span><span class="sxs-lookup"><span data-stu-id="b0229-197">**Use Remote Collation**</span></span>  
     <span data-ttu-id="b0229-198">Determina si se utilizará la intercalación de una columna remota o de un servidor local.</span><span class="sxs-lookup"><span data-stu-id="b0229-198">Determines whether the collation of a remote column or of a local server will be used.</span></span>  
  
     <span data-ttu-id="b0229-199">Si es true, para los orígenes de datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] se utilizará la intercalación de columnas remotas, y la intercalación especificada en el nombre de la intercalación se utilizará para los orígenes de datos que no sean de[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b0229-199">If true, the collation of remote columns is used for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources, and the collation specified in collation name is used for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources.</span></span>  
  
     <span data-ttu-id="b0229-200">Si es false, las consultas distribuidas siempre utilizarán la intercalación predeterminada del servidor local, mientras que el nombre de intercalación y la intercalación de columnas remotas se pasarán por alto.</span><span class="sxs-lookup"><span data-stu-id="b0229-200">If false, distributed queries will always use the default collation of the local server, while collation name and the collation of remote columns are ignored.</span></span> <span data-ttu-id="b0229-201">El valor predeterminado es false.</span><span class="sxs-lookup"><span data-stu-id="b0229-201">The default is false.</span></span>  
  
     <span data-ttu-id="b0229-202">**Nombre de intercalación**</span><span class="sxs-lookup"><span data-stu-id="b0229-202">**Collation Name**</span></span>  
     <span data-ttu-id="b0229-203">Especifica el nombre de la intercalación que ha utilizado el origen de datos remoto si Usar intercalación remota es true y el origen de datos no es de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b0229-203">Specifies the name of the collation used by the remote data source if use remote collation is true and the data source is not a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source.</span></span> <span data-ttu-id="b0229-204">El nombre debe pertenecer a una de las intercalaciones que [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]admite.</span><span class="sxs-lookup"><span data-stu-id="b0229-204">The name must be one of the collations supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
     <span data-ttu-id="b0229-205">Utilice esta opción cuando se obtenga acceso a un origen de datos OLE DB que no sea [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], pero que tenga una intercalación que coincida con una de las intercalaciones de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b0229-205">Use this option when accessing an OLE DB data source other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but whose collation matches one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="b0229-206">El servidor vinculado debe permitir el uso de una única intercalación para todas las columnas de ese servidor.</span><span class="sxs-lookup"><span data-stu-id="b0229-206">The linked server must support a single collation to be used for all columns in that server.</span></span> <span data-ttu-id="b0229-207">No establezca esta opción si el servidor vinculado admite varias intercalaciones dentro de un único origen de datos o si no se puede determinar si la intercalación del servidor vinculado coincide con alguna de las intercalaciones de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b0229-207">Do not set this option if the linked server supports multiple collations within a single data source, or if the linked server's collation cannot be determined to match one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="b0229-208">**Tiempo de espera de conexión**</span><span class="sxs-lookup"><span data-stu-id="b0229-208">**Connection Timeout**</span></span>  
     <span data-ttu-id="b0229-209">Valor del tiempo de espera en segundos para conectarse a un servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-209">Time-out value in seconds for connecting to a linked server.</span></span>  
  
     <span data-ttu-id="b0229-210">Si es 0, use el valor de la opción **Tiempo de espera de inicio de sesión remoto** predeterminado [sp_configure](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="b0229-210">If 0, use the **sp_configure** default [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="b0229-211">**Tiempo de espera de la consulta**</span><span class="sxs-lookup"><span data-stu-id="b0229-211">**Query Timeout**</span></span>  
     <span data-ttu-id="b0229-212">Valor del tiempo de espera en segundos para las consultas que se realizan en un servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-212">Time-out value in seconds for queries against a linked server.</span></span>  
  
     <span data-ttu-id="b0229-213">Si es 0, use el valor de la opción **Tiempo de espera de consulta remota** predeterminado [sp_configure](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="b0229-213">If 0, use the **sp_configure** default [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="b0229-214">**Habilitar promoción de transacciones distribuidas**</span><span class="sxs-lookup"><span data-stu-id="b0229-214">**Enable Promotion of Distributed Transactions**</span></span>  
     <span data-ttu-id="b0229-215">Use esta opción para proteger las acciones de un procedimiento entre servidores a través de una transacción del Coordinador de transacciones distribuidas de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] (MS DTC).</span><span class="sxs-lookup"><span data-stu-id="b0229-215">Use this option to protect the actions of a server-to-server procedure through a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) transaction.</span></span> <span data-ttu-id="b0229-216">Cuando esta opción es TRUE, al llamar a un procedimiento remoto almacenado se inicia una transacción distribuida y se da de alta en MS DTC.</span><span class="sxs-lookup"><span data-stu-id="b0229-216">When this option is TRUE, calling a remote stored procedure starts a distributed transaction and enlists the transaction with MS DTC.</span></span> <span data-ttu-id="b0229-217">Para obtener más información, vea [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b0229-217">For more information, see [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span></span>  
  
6.  <span data-ttu-id="b0229-218">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="b0229-218">Click **OK**.</span></span>  
  
##### <a name="to-view-the-provider-options"></a><span data-ttu-id="b0229-219">Para ver las opciones de proveedor</span><span class="sxs-lookup"><span data-stu-id="b0229-219">To view the provider options</span></span>  
  
-   <span data-ttu-id="b0229-220">Para ver las opciones que el proveedor pone disponibles, haga clic en la página **Opciones de proveedor** .</span><span class="sxs-lookup"><span data-stu-id="b0229-220">To view the options that the provider makes available, click the **Providers Options** page.</span></span>  
  
     <span data-ttu-id="b0229-221">Todos los proveedores no tienen las mismas opciones disponibles.</span><span class="sxs-lookup"><span data-stu-id="b0229-221">All providers do not have the same options available.</span></span> <span data-ttu-id="b0229-222">Por ejemplo, algunos tipos de datos tienen índices disponibles y otros pueden no tenerlos.</span><span class="sxs-lookup"><span data-stu-id="b0229-222">For example, some types of data have indexes available and some might not.</span></span> <span data-ttu-id="b0229-223">Utilice este cuadro de diálogo para que [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pueda conocer mejor las capacidades del proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0229-223">Use this dialog box to help [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] understand the capabilities of the provider.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b0229-224">instala algunos proveedores de datos comunes; con todo, cuando cambia el producto que proporciona los datos, el proveedor instalado por [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] podría no admitir todas las características más recientes.</span><span class="sxs-lookup"><span data-stu-id="b0229-224">installs some common data providers, however when the product providing the data changes, the provider installed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might not support all the newest features.</span></span> <span data-ttu-id="b0229-225">La mejor fuente de información sobre las capacidades del producto que proporciona los datos es la documentación del producto.</span><span class="sxs-lookup"><span data-stu-id="b0229-225">The best source of information about the capabilities of the product providing the data is the documentation for that product.</span></span>  
  
     <span data-ttu-id="b0229-226">**Parámetro dinámico**</span><span class="sxs-lookup"><span data-stu-id="b0229-226">**Dynamic parameter**</span></span>  
     <span data-ttu-id="b0229-227">Indica que el proveedor permite la sintaxis de marcador de parámetro '?' para consultas con parámetros.</span><span class="sxs-lookup"><span data-stu-id="b0229-227">Indicates that the provider allows '?' parameter marker syntax for parameterized queries.</span></span> <span data-ttu-id="b0229-228">Establezca esta opción solo si el proveedor admite la interfaz **ICommandWithParameters** y  '?’ como marcador de parámetro.</span><span class="sxs-lookup"><span data-stu-id="b0229-228">Set this option only if the provider supports the **ICommandWithParameters** interface and supports a '?' as the parameter marker.</span></span> <span data-ttu-id="b0229-229">Si establece esta opción, permitirá a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ejecutar consultas con parámetros en el proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0229-229">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute parameterized queries against the provider.</span></span> <span data-ttu-id="b0229-230">La capacidad de ejecutar consultas con parámetros en el proveedor puede mejorar el rendimiento de determinadas consultas.</span><span class="sxs-lookup"><span data-stu-id="b0229-230">The ability to execute parameterized queries against the provider can result in better performance for certain queries.</span></span>  
  
     <span data-ttu-id="b0229-231">**Consultas anidadas**</span><span class="sxs-lookup"><span data-stu-id="b0229-231">**Nested queries**</span></span>  
     <span data-ttu-id="b0229-232">Indica que el proveedor permite instrucciones  `SELECT` anidadas en la cláusula FROM.</span><span class="sxs-lookup"><span data-stu-id="b0229-232">Indicates that the provider allows nested  `SELECT` statements in the FROM clause.</span></span> <span data-ttu-id="b0229-233">Si establece esta opción, permitirá a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] delegar en el proveedor determinadas consultas que precisan anidar instrucciones SELECT en la cláusula FROM.</span><span class="sxs-lookup"><span data-stu-id="b0229-233">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to delegate certain queries to the provider that require nesting SELECT statements in the FROM clause.</span></span>  
  
     <span data-ttu-id="b0229-234">**Solo nivel cero**</span><span class="sxs-lookup"><span data-stu-id="b0229-234">**Level zero only**</span></span>  
     <span data-ttu-id="b0229-235">Solo se invocan interfaces OLE DB de nivel 0 en el proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0229-235">Only level 0 OLE DB interfaces are invoked against the provider.</span></span>  
  
     <span data-ttu-id="b0229-236">**Permitir en proceso**</span><span class="sxs-lookup"><span data-stu-id="b0229-236">**Allow inprocess**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b0229-237">permite crear una instancia del proveedor como un servidor en proceso.</span><span class="sxs-lookup"><span data-stu-id="b0229-237">allows the provider to be instantiated as an in-process server.</span></span> <span data-ttu-id="b0229-238">Si no se establece esta opción, el comportamiento predeterminado consiste en crear una instancia del proveedor fuera del proceso de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b0229-238">When this option is not set, the default behavior is to instantiate the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="b0229-239">La creación de instancias del proveedor fuera del proceso de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] protege el proceso de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de posibles errores en el proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0229-239">Instantiating the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process protects the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process from errors in the provider.</span></span> <span data-ttu-id="b0229-240">Si se crea una instancia del proveedor fuera del proceso de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], no se permitirán actualizaciones ni inserciones que hagan referencia a columnas long (`text`, `ntext` o `image`).</span><span class="sxs-lookup"><span data-stu-id="b0229-240">When the provider is instantiated outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process, updates or inserts referencing long columns (`text`, `ntext`, or `image`) are not allowed.</span></span>  
  
     <span data-ttu-id="b0229-241">**Actualizaciones no realizadas**</span><span class="sxs-lookup"><span data-stu-id="b0229-241">**Non transacted updates**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b0229-242">permite realizar actualizaciones, aunque **ITransactionLocal** no esté disponible.</span><span class="sxs-lookup"><span data-stu-id="b0229-242">allows updates, even if **ITransactionLocal** is not available.</span></span> <span data-ttu-id="b0229-243">Si esta opción está habilitada, no podrá recuperar las actualizaciones en el proveedor, ya que éste no admite transacciones.</span><span class="sxs-lookup"><span data-stu-id="b0229-243">If this option is enabled, updates against the provider are not recoverable, because the provider does not support transactions.</span></span>  
  
     <span data-ttu-id="b0229-244">**Índice como ruta de acceso**</span><span class="sxs-lookup"><span data-stu-id="b0229-244">**Index as access path**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b0229-245">tratará de usar los índices del proveedor para capturar los datos.</span><span class="sxs-lookup"><span data-stu-id="b0229-245">attempts to use indexes of the provider to fetch data.</span></span> <span data-ttu-id="b0229-246">De forma predeterminada, los índices solo se utilizan para metadatos y nunca se abren</span><span class="sxs-lookup"><span data-stu-id="b0229-246">By default, indexes are used only for metadata and are never opened</span></span>  
  
     <span data-ttu-id="b0229-247">**Denegar el acceso ad hoc**</span><span class="sxs-lookup"><span data-stu-id="b0229-247">**Disallow ad hoc access**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b0229-248">no permite el acceso ad hoc mediante las funciones OPENROWSET y OPENDATASOURCE en el proveedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0229-248">does not allow ad hoc access through the OPENROWSET and OPENDATASOURCE functions against the OLE DB provider.</span></span> <span data-ttu-id="b0229-249">Si no se establece esta opción, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tampoco permite el acceso ad hoc.</span><span class="sxs-lookup"><span data-stu-id="b0229-249">When this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] also does not allow ad hoc access.</span></span>  
  
     <span data-ttu-id="b0229-250">**Admite el operador LIKE**</span><span class="sxs-lookup"><span data-stu-id="b0229-250">**Supports 'Like' operator**</span></span>  
     <span data-ttu-id="b0229-251">Indica que el proveedor admite consultas mediante la palabra clave LIKE.</span><span class="sxs-lookup"><span data-stu-id="b0229-251">Indicates that the provider supports queries using the LIKE key word.</span></span>  
  
###  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="b0229-252">Usar Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b0229-252">Using Transact-SQL</span></span>  
 <span data-ttu-id="b0229-253">Para crear un servidor vinculado mediante [!INCLUDE[tsql](../../includes/tsql-md.md)], use las instrucciones [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), [CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) y [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b0229-253">To create a linked server by using [!INCLUDE[tsql](../../includes/tsql-md.md)], use the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) and [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql) statements.</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-transact-sql"></a><span data-ttu-id="b0229-254">Para crear un servidor vinculado a otra instancia de SQL Server con Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b0229-254">To create a linked server to another instance of SQL Server using Transact-SQL</span></span>  
  
1.  <span data-ttu-id="b0229-255">En el Editor de consultas, escriba el siguiente comando [!INCLUDE[tsql](../../includes/tsql-md.md)] para vincular a una instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] llamada `SRVR002\ACCTG`:</span><span class="sxs-lookup"><span data-stu-id="b0229-255">In Query Editor, enter the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command to link to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] named `SRVR002\ACCTG`:</span></span>  
  
    ```sql  
    USE [master]  
    GO  
    EXEC master.dbo.sp_addlinkedserver   
        @server = N'SRVR002\ACCTG',   
        @srvproduct=N'SQL Server' ;  
    GO  
  
    ```  
  
2.  <span data-ttu-id="b0229-256">Ejecute el siguiente código para configurar el servidor vinculado con el fin de que use las credenciales de dominio del inicio de sesión que usa el servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-256">Execute the following code to configure the linked server to use the domain credentials of the login that is using the linked server.</span></span>  
  
    ```sql  
    EXEC master.dbo.sp_addlinkedsrvlogin   
        @rmtsrvname = N'SRVR002\ACCTG',   
        @locallogin = NULL ,   
        @useself = N'True' ;  
    GO  
  
    ```  
  
##  <a name="follow-up-steps-to-take-after-you-create-a-linked-server"></a><a name="FollowUp"></a> <span data-ttu-id="b0229-257">Seguimiento: pasos que se deben realizar después de crear un servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b0229-257">Follow Up: Steps to take after you create a linked server</span></span>  
  
#### <a name="to-test-the-linked-server"></a><span data-ttu-id="b0229-258">Para probar el servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b0229-258">To test the linked server</span></span>  
  
-   <span data-ttu-id="b0229-259">Ejecute el siguiente código para probar la conexión al servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-259">Execute the following code to test the connection to the linked server.</span></span> <span data-ttu-id="b0229-260">En este ejemplo se devuelven los nombres de las bases de datos del servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-260">This example the returns the names of the databases on the linked server.</span></span>  
  
    ```sql  
    SELECT name FROM [SRVR002\ACCTG].master.sys.databases ;  
    GO  
  
    ```  
  
#### <a name="writing-a-query-that-joins-tables-from-a-linked-server"></a><span data-ttu-id="b0229-261">Escribir una consulta que una tablas desde un servidor vinculado</span><span class="sxs-lookup"><span data-stu-id="b0229-261">Writing a query that joins tables from a linked server</span></span>  
  
-   <span data-ttu-id="b0229-262">Use nombres de cuatro partes para hacer referencia a un objeto de un servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-262">Use four-part names to refer to an object on a linked server.</span></span> <span data-ttu-id="b0229-263">Ejecute el código siguiente para que se devuelva una lista de todos los inicios de sesión del servidor local y sus inicios de sesión coincidentes en el servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-263">Execute the following code to return a list of all logins on the local server and their matching logins on the linked server.</span></span>  
  
    ```sql  
    SELECT local.name AS LocalLogins, linked.name AS LinkedLogins  
    FROM master.sys.server_principals AS local  
    LEFT JOIN [SRVR002\ACCTG].master.sys.server_principals AS linked  
        ON local.name = linked.name ;  
    GO  
    ```  
  
     <span data-ttu-id="b0229-264">Cuando se devuelve NULL para el inicio de sesión del servidor vinculado, se indica que el inicio de sesión no existe en el servidor vinculado.</span><span class="sxs-lookup"><span data-stu-id="b0229-264">When NULL is returned for the linked server login it indicates that the login does not exist on the linked server.</span></span> <span data-ttu-id="b0229-265">Estos inicios de sesión no podrán usar el servidor vinculado a menos que este se configure para pasar un contexto de seguridad distinto o el servidor vinculado acepte conexiones anónimas.</span><span class="sxs-lookup"><span data-stu-id="b0229-265">These logins will not be able to use the linked server unless the linked server is configured to pass a different security context or the linked server accepts anonymous connections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b0229-266">Consulte también</span><span class="sxs-lookup"><span data-stu-id="b0229-266">See Also</span></span>  
 <span data-ttu-id="b0229-267">[Servidores vinculados &#40;motor de base de datos&#41;](linked-servers-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="b0229-267">[Linked Servers &#40;Database Engine&#41;](linked-servers-database-engine.md) </span></span>  
 <span data-ttu-id="b0229-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="b0229-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span></span>  
 [<span data-ttu-id="b0229-269">sp_serveroption &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b0229-269">sp_serveroption &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql)  
  
  
