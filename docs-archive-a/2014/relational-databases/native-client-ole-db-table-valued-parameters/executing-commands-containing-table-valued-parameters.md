---
title: Ejecutar comandos que contienen parámetros con valores de tabla | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, executing commands containing
ms.assetid: 7ecba6f6-fe7a-462a-9aa3-d5115b6d4529
author: rothja
ms.author: jroth
ms.openlocfilehash: e3f616b2b9f95ae558e444bcbdae50eae123fa4c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87670365"
---
# <a name="executing-commands-containing-table-valued-parameters"></a><span data-ttu-id="41bc0-102">Ejecutar comandos que contienen parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="41bc0-102">Executing Commands Containing Table-Valued Parameters</span></span>
  <span data-ttu-id="41bc0-103">La ejecución de un comando que contiene parámetros con valores de tabla consta de dos fases:</span><span class="sxs-lookup"><span data-stu-id="41bc0-103">Executing a command that contains table-valued parameters requires two phases:</span></span>  
  
1.  <span data-ttu-id="41bc0-104">Especificar los tipos de parámetros.</span><span class="sxs-lookup"><span data-stu-id="41bc0-104">Specify the parameter types.</span></span>  
  
2.  <span data-ttu-id="41bc0-105">Enlazar los datos de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="41bc0-105">Bind the parameter data.</span></span>  
  
## <a name="table-valued-parameter-specification"></a><span data-ttu-id="41bc0-106">Especificación de parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="41bc0-106">Table-Valued Parameter Specification</span></span>  
 <span data-ttu-id="41bc0-107">El consumidor puede especificar el tipo del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="41bc0-107">The consumer can specify the type of the table-valued parameter.</span></span> <span data-ttu-id="41bc0-108">Esta información incluye el nombre del tipo del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="41bc0-108">This information includes the table-valued parameter type name.</span></span> <span data-ttu-id="41bc0-109">También incluye el nombre de esquema si el tipo de tabla definido por el usuario para el parámetro con valores de tabla no está en el esquema predeterminado actual para la conexión.</span><span class="sxs-lookup"><span data-stu-id="41bc0-109">It also includes the schema name, if the user-defined table type for the table-valued parameter is not in the current default schema for the connection.</span></span> <span data-ttu-id="41bc0-110">Dependiendo de la compatibilidad del servidor, el consumidor también puede especificar información opcional sobre los metadatos, como el orden de las columnas, y puede especificar que todas las filas de ciertas columnas tengan valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="41bc0-110">Depending on server support, the consumer can also specify optional metadata information, such as ordering of columns, and can specify that all rows for particular columns have the default values.</span></span>  
  
 <span data-ttu-id="41bc0-111">Para especificar un parámetro con valores de tabla, el consumidor llama a ISSCommandWithParameter::SetParameterInfo y, opcionalmente, llama a ISSCommandWithParameters::SetParameterProperties.</span><span class="sxs-lookup"><span data-stu-id="41bc0-111">To specify a table-valued parameter, the consumer calls ISSCommandWithParameter::SetParameterInfo, and optionally calls ISSCommandWithParameters::SetParameterProperties.</span></span> <span data-ttu-id="41bc0-112">En el caso de un parámetro con valores de tabla, el campo *pwszDataSourceType* de la estructura DBPARAMBINDINFO tiene un valor de DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="41bc0-112">For a table-valued parameter, the *pwszDataSourceType* field in the DBPARAMBINDINFO structure has a value of DBTYPE_TABLE.</span></span> <span data-ttu-id="41bc0-113">El campo *ulParamSize* se establece en ~0 para indicar que no se conoce la longitud.</span><span class="sxs-lookup"><span data-stu-id="41bc0-113">The *ulParamSize* field is set to ~0 to indicate that length is unknown.</span></span> <span data-ttu-id="41bc0-114">Algunas propiedades de los parámetros con valores de tabla, como nombre de esquema, nombre de tipo, orden de columnas y columnas predeterminadas, se pueden establecer mediante ISSCommandWithParameters::SetParameterProperties.</span><span class="sxs-lookup"><span data-stu-id="41bc0-114">Particular properties for table-valued parameters, such as schema name, type name, column order, and default columns, can be set through ISSCommandWithParameters::SetParameterProperties.</span></span>  
  
## <a name="table-valued-parameter-binding"></a><span data-ttu-id="41bc0-115">Enlace de parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="41bc0-115">Table-Valued Parameter Binding</span></span>  
 <span data-ttu-id="41bc0-116">Un parámetro con valores de tabla puede ser cualquier objeto de conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="41bc0-116">A table-valued parameter can be any rowset object.</span></span> <span data-ttu-id="41bc0-117">Durante la ejecución, el proveedor lee en este objeto mientras envía los parámetros con valores de tabla al servidor.</span><span class="sxs-lookup"><span data-stu-id="41bc0-117">The provider reads from this object while sending table-valued parameters to the server during execution.</span></span>  
  
 <span data-ttu-id="41bc0-118">Para enlazar el parámetro con valores de tabla, el consumidor llama a IAccessor::CreateAccessor.</span><span class="sxs-lookup"><span data-stu-id="41bc0-118">To bind the table-valued parameter, the consumer calls IAccessor::CreateAccessor.</span></span> <span data-ttu-id="41bc0-119">El campo *wType* de la estructura DBBINDING del parámetro con valores de tabla se establece en DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="41bc0-119">The *wType* field of the DBBINDING structure for the table-valued parameter is set to DBTYPE_TABLE.</span></span> <span data-ttu-id="41bc0-120">El miembro *pObject* de la estructura DBBINDING es distinto de NULL y el miembro *iid* de *pObject* se establece en IID_IRowset o cualquier otra interfaz de objeto de conjunto de filas de parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="41bc0-120">The *pObject* member of the DBBINDING structure is non-NULL, and the *pObject*'s *iid* member is set to IID_IRowset or any other table-valued parameter rowset object interfaces.</span></span> <span data-ttu-id="41bc0-121">Los campos restantes de la estructura DBBINDING se deben establecer de la misma manera que los BLOB transmitidos.</span><span class="sxs-lookup"><span data-stu-id="41bc0-121">The remaining fields in the DBBINDING structure should be set the same way they are set for streamed BLOBs.</span></span>  
  
 <span data-ttu-id="41bc0-122">En los enlaces para el parámetro con valores de tabla y el objeto de conjunto de filas asociado a un parámetro con valores de tabla, se aplican las restricciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="41bc0-122">In the bindings for the table-valued parameter and the rowset object associated with a table-valued parameter, the following restrictions apply:</span></span>  
  
-   <span data-ttu-id="41bc0-123">Los únicos valores de estado permitidos para los datos de columnas de conjunto de filas de parámetro con valores de tabla son DBSTATUS_S_ISNULL y DBSTATUS_S_OK.</span><span class="sxs-lookup"><span data-stu-id="41bc0-123">The only status values allowed for table-valued parameter rowset column data are DBSTATUS_S_ISNULL and DBSTATUS_S_OK.</span></span> <span data-ttu-id="41bc0-124">DBSTATUS_S_DEFAULT producirá un error y el valor de estado enlazado se establecerá en DBSTATUS_E_BADSTATUS.</span><span class="sxs-lookup"><span data-stu-id="41bc0-124">DBSTATUS_S_DEFAULT will result in a failure, and the bound status value will be set to DBSTATUS_E_BADSTATUS.</span></span>  
  
-   <span data-ttu-id="41bc0-125">Un parámetro con valores de tabla se puede marcar con el estado DBSTATUS_S_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="41bc0-125">A table-valued parameter can be marked with the status DBSTATUS_S_DEFAULT.</span></span> <span data-ttu-id="41bc0-126">Los únicos valores válidos son DBSTATUS_S_DEFAULT y DBSTATUS_S_OK.</span><span class="sxs-lookup"><span data-stu-id="41bc0-126">The only valid values are DBSTATUS_S_DEFAULT and DBSTATUS_S_OK.</span></span> <span data-ttu-id="41bc0-127">Cuando el estado se establece en DBSTATUS_S_DEFAULT, el valor del parámetro con valores de tabla corresponde a una tabla vacía.</span><span class="sxs-lookup"><span data-stu-id="41bc0-127">When the status is set to DBSTATUS_S_DEFAULT, the value of the table-valued parameter corresponds to an empty table.</span></span>  
  
-   <span data-ttu-id="41bc0-128">Las columnas de solo lectura en parámetros con valores de tabla (columnas de identidad o calculadas) se deben marcar como predeterminadas utilizando la propiedad SSPROP_PARAM_TABLE_DEFAULT_COLUMNS.</span><span class="sxs-lookup"><span data-stu-id="41bc0-128">Read-only columns in table-valued parameters (identity or computed columns) must be marked as default by using the SSPROP_PARAM_TABLE_DEFAULT_COLUMNS property.</span></span> <span data-ttu-id="41bc0-129">Las columnas que tienen un valor predeterminado también se deben marcar como predeterminadas mediante la propiedad SSPROP_PARAM_TABLE_DEFAULT_COLUMNS para que se pueda utilizar el valor predeterminado para los valores de datos de la columna para un parámetro con valores de tabla determinado.</span><span class="sxs-lookup"><span data-stu-id="41bc0-129">Columns that have a default value must also be marked as default through SSPROP_PARAM_TABLE_DEFAULT_COLUMNS property to allow the default value to be used for the column's data values for a particular table-valued parameter.</span></span> <span data-ttu-id="41bc0-130">El proveedor no tendrá en cuenta los valores de datos enlazados para las columnas marcadas como predeterminadas.</span><span class="sxs-lookup"><span data-stu-id="41bc0-130">The provider will ignore the data values bound for the columns marked as default.</span></span>  
  
-   <span data-ttu-id="41bc0-131">Los datos se enviarán al servidor para las columnas con DBPROP_COL_AUTOINCREMENT o SSPROP_COL_COMPUTED, a menos que también se establezca SSPROP_PARAM_TABLE_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="41bc0-131">Data will be sent to the server for columns with DBPROP_COL_AUTOINCREMENT or SSPROP_COL_COMPUTED, unless SSPROP_PARAM_TABLE_DEFAULT is also set.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="41bc0-132">Consulte también</span><span class="sxs-lookup"><span data-stu-id="41bc0-132">See Also</span></span>  
 <span data-ttu-id="41bc0-133">[Parámetros con valores de tabla &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="41bc0-133">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="41bc0-134">Usar parámetros con valores de tabla &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="41bc0-134">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
