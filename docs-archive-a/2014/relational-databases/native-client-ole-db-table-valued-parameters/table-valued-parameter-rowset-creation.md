---
title: Creación de conjuntos de filas de parámetros con valores de tabla | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
ms.assetid: ffe213ca-cc0e-465e-b31c-a8272324c4fe
author: rothja
ms.author: jroth
ms.openlocfilehash: a22ccbd583d95c41daa0a113363985828cf1e9d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87671017"
---
# <a name="table-valued-parameter-rowset-creation"></a><span data-ttu-id="893b0-102">Creación de conjuntos de filas de parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="893b0-102">Table-Valued Parameter Rowset Creation</span></span>
  <span data-ttu-id="893b0-103">Aunque los consumidores pueden proporcionar cualquier objeto de conjunto de filas para los parámetros con valores de tabla, los objetos de conjunto de filas típicos se implementan para los almacenes de datos back-end y, por consiguiente, proporcionan un rendimiento limitado.</span><span class="sxs-lookup"><span data-stu-id="893b0-103">Although consumers can provide any rowset object for table-valued parameters, typical rowset objects are implemented against back-end data stores, and therefore provide limited performance.</span></span> <span data-ttu-id="893b0-104">Por esta razón, el proveedor OLE DB de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client permite a los consumidores crear un objeto de conjunto de filas especializado encima de los datos en memoria.</span><span class="sxs-lookup"><span data-stu-id="893b0-104">For this reason, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider enables consumers to create a specialized rowset object on top of in-memory data.</span></span> <span data-ttu-id="893b0-105">Este objeto de conjunto de filas especial en memoria es un nuevo objeto COM denominado conjunto de filas de parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="893b0-105">This special, in-memory rowset object is a new COM object called a table-valued parameter rowset .</span></span> <span data-ttu-id="893b0-106">Proporciona una funcionalidad similar a la de los conjuntos de parámetros.</span><span class="sxs-lookup"><span data-stu-id="893b0-106">It provides functionality similar to parameter sets.</span></span>  
  
 <span data-ttu-id="893b0-107">El consumidor crea explícitamente objetos de conjunto de filas de parámetros con valores de tabla para los parámetros de entrada a través de varias interfaces de nivel de sesión.</span><span class="sxs-lookup"><span data-stu-id="893b0-107">Table-valued parameter rowset objects are created explicitly by the consumer for input parameters through multiple session-level interfaces.</span></span> <span data-ttu-id="893b0-108">Hay una instancia de un objeto de conjunto de filas de parámetro con valores de tabla para cada parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="893b0-108">There is one instance of a table-valued parameter rowset object per table-valued parameter.</span></span> <span data-ttu-id="893b0-109">El consumidor puede crear los objetos de conjunto de filas de parámetros con valores de tabla proporcionando información de metadatos que ya se conoce (escenario estático) o detectando esa información a través de interfaces de proveedor (escenario dinámico).</span><span class="sxs-lookup"><span data-stu-id="893b0-109">The consumer can create the table-valued parameter rowset objects either by providing metadata information that is already known (static scenario), or by discovering it through provider interfaces (dynamic scenario).</span></span> <span data-ttu-id="893b0-110">En las secciones siguientes se describen los dos escenarios.</span><span class="sxs-lookup"><span data-stu-id="893b0-110">The following sections describe these two scenarios.</span></span>  
  
## <a name="static-scenario"></a><span data-ttu-id="893b0-111">Escenario estático</span><span class="sxs-lookup"><span data-stu-id="893b0-111">Static Scenario</span></span>  
 <span data-ttu-id="893b0-112">Cuando se conoce el tipo de información, el consumidor usa ITableDefinitionWithConstraints::CreateTableWithConstraints para crear una instancia de un objeto de conjunto de filas de parámetros con valores de tabla que corresponde a un parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="893b0-112">When the type information is known, the consumer uses ITableDefinitionWithConstraints::CreateTableWithConstraints to instantiate a table-valued parameter rowset object that corresponds to a table-valued parameter.</span></span>  
  
 <span data-ttu-id="893b0-113">El campo *guid* (parámetro *pTableID*) contiene el GUID especial (CLSID_ROWSET_TVP).</span><span class="sxs-lookup"><span data-stu-id="893b0-113">The *guid* field (*pTableID* parameter) contains the special GUID (CLSID_ROWSET_TVP).</span></span> <span data-ttu-id="893b0-114">El miembro *pwszName* contiene el nombre del tipo de parámetro con valores de tabla del que el consumidor quiere crear una instancia.</span><span class="sxs-lookup"><span data-stu-id="893b0-114">The *pwszName* member contains the name of the table-valued parameter type that the consumer wants to instantiate.</span></span> <span data-ttu-id="893b0-115">El campo *eKind* se establecerá en DBKIND_GUID_NAME.</span><span class="sxs-lookup"><span data-stu-id="893b0-115">The *eKind* field will be set to DBKIND_GUID_NAME.</span></span> <span data-ttu-id="893b0-116">Este nombre es necesario en una instrucción SQL ad hoc, pero es opcional en las llamadas a procedimientos.</span><span class="sxs-lookup"><span data-stu-id="893b0-116">This name is required when the statement is ad hoc SQL; the name is optional if it is a procedure call.</span></span>  
  
 <span data-ttu-id="893b0-117">Para la agregación, el consumidor pasa el parámetro *pUnkOuter* con el elemento IUnknown de control.</span><span class="sxs-lookup"><span data-stu-id="893b0-117">For aggregation, the consumer passes the *pUnkOuter* parameter with the controlling IUnknown.</span></span>  
  
 <span data-ttu-id="893b0-118">Las propiedades del objeto de conjunto de filas del parámetro con valores de tabla son de solo lectura, por lo que no se espera que el consumidor establezca ninguna propiedad en *rgPropertySets*.</span><span class="sxs-lookup"><span data-stu-id="893b0-118">The table-valued parameter rowset object properties are read only, so the consumer is not expected to set any properties in *rgPropertySets*.</span></span>  
  
 <span data-ttu-id="893b0-119">Para el miembro *rgPropertySets* de cada estructura DBCOLUMNDESC, el consumidor puede especificar propiedades adicionales para cada columna.</span><span class="sxs-lookup"><span data-stu-id="893b0-119">For the *rgPropertySets* member of each DBCOLUMNDESC structure, the consumer can specify additional properties for each column.</span></span> <span data-ttu-id="893b0-120">Estas propiedades pertenecen a la propiedad DBPROPSET_SQLSERVERCOLUMN establecida.</span><span class="sxs-lookup"><span data-stu-id="893b0-120">These properties belong to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span> <span data-ttu-id="893b0-121">Permiten especificar la configuración calculada y predeterminada de cada columna.</span><span class="sxs-lookup"><span data-stu-id="893b0-121">They enable you to specify computed and default settings for each column.</span></span> <span data-ttu-id="893b0-122">Admiten también propiedades de columna existentes, como la nulabilidad y la identidad.</span><span class="sxs-lookup"><span data-stu-id="893b0-122">They also support existing column properties, such as nullability and identity.</span></span>  
  
 <span data-ttu-id="893b0-123">Para recuperar la información correspondiente de un objeto de conjunto de filas de parámetros con valores de tabla, el consumidor usa IRowsetInfo::GetProperties.</span><span class="sxs-lookup"><span data-stu-id="893b0-123">To retrieve corresponding information from a table-valued parameter rowset object, the consumer uses IRowsetInfo::GetProperties.</span></span>  
  
 <span data-ttu-id="893b0-124">Para recuperar información sobre el estado null, Unique, calculado y Update de cada columna, el consumidor debe usar IColumnsRowset:: GetColumnsRowset o IColumnsInfo:: GetColumnInfo.</span><span class="sxs-lookup"><span data-stu-id="893b0-124">To retrieve information about the null, unique, computed, and update status of each column, the consumer use IColumnsRowset::GetColumnsRowset or IColumnsInfo::GetColumnInfo.</span></span> <span data-ttu-id="893b0-125">Estos métodos proporcionan información detallada sobre cada columna de conjunto de filas de parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="893b0-125">These methods provide detailed information about each table-valued parameter rowset column.</span></span>  
  
 <span data-ttu-id="893b0-126">El consumidor especifica el tipo de cada columna del parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="893b0-126">The consumer specifies the type of each column of the table-valued parameter.</span></span> <span data-ttu-id="893b0-127">Esto es similar al modo en que se especifican las columnas cuando se crea una tabla en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="893b0-127">This is similar to how columns are specified when a table is created in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="893b0-128">El consumidor obtiene un objeto de conjunto de filas de parámetros con valores de tabla del [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client a través del parámetro de salida *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="893b0-128">The consumer obtains a table-valued parameter rowset object from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider through the *ppRowset* output parameter.</span></span>  
  
## <a name="dynamic-scenario"></a><span data-ttu-id="893b0-129">Escenario dinámico</span><span class="sxs-lookup"><span data-stu-id="893b0-129">Dynamic Scenario</span></span>  
 <span data-ttu-id="893b0-130">Cuando el consumidor no tiene información de tipos, debe usar IOpenRowset:: OpenRowset para crear instancias de los objetos de conjunto de filas de parámetros con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="893b0-130">When the consumer does not have type information, it should use IOpenRowset::OpenRowset to instantiate table-valued parameter rowset objects.</span></span> <span data-ttu-id="893b0-131">Todo lo que el consumidor tiene que proporcionar al proveedor es el nombre de tipo.</span><span class="sxs-lookup"><span data-stu-id="893b0-131">All the consumer has to provide to the provider is the type name.</span></span>  
  
 <span data-ttu-id="893b0-132">En este escenario, el proveedor obtiene la información de tipo de un objeto de conjunto de filas de parámetros con valores de tabla del servidor en nombre del consumidor.</span><span class="sxs-lookup"><span data-stu-id="893b0-132">In this scenario, the provider obtains type information about a table-valued parameter rowset object from the server on behalf of the consumer.</span></span>  
  
 <span data-ttu-id="893b0-133">Los parámetros *pTableID* y *pUnkOuter* deben establecerse como en el escenario estático.</span><span class="sxs-lookup"><span data-stu-id="893b0-133">The *pTableID* and *pUnkOuter* parameters should be set as in the static scenario.</span></span> <span data-ttu-id="893b0-134">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]A continuación, el proveedor de OLE DB de Native Client obtiene la información de tipo (la información de columna y las restricciones) del servidor y devuelve un objeto de conjunto de filas de parámetros con valores de tabla a través del parámetro *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="893b0-134">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider then obtains the type information (column information and constraints) from the server, and return a table-valued parameter rowset object through the *ppRowset* parameter.</span></span> <span data-ttu-id="893b0-135">Esta operación requiere la comunicación con el servidor y, por consiguiente, su rendimiento no es tan bueno como el del escenario estático.</span><span class="sxs-lookup"><span data-stu-id="893b0-135">This operation requires communication with the server, and therefore does not perform as well as the static scenario.</span></span> <span data-ttu-id="893b0-136">El escenario dinámico solamente funciona con llamadas a procedimientos parametrizadas.</span><span class="sxs-lookup"><span data-stu-id="893b0-136">The dynamic scenario works only with parameterized procedure calls.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="893b0-137">Consulte también</span><span class="sxs-lookup"><span data-stu-id="893b0-137">See Also</span></span>  
 <span data-ttu-id="893b0-138">[Parámetros con valores de tabla &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="893b0-138">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="893b0-139">Usar parámetros con valores de tabla &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="893b0-139">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
