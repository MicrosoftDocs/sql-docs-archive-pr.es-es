---
title: Puntos de comprobación de base de datos (SQL Server)| Microsoft Docs
ms.custom: ''
ms.date: 10/13/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- automatic checkpoints
- transaction logs [SQL Server], checkpoints
- logs [SQL Server], active
- pages [SQL Server], dirty
- MinLSN
- checkpoints [SQL Server]
- pages [SQL Server], flushing
- dirty pages
- transaction logs [SQL Server], active logs
- recovery interval option [SQL Server]
- buffer cache [SQL Server]
- logs [SQL Server], checkpoints
- Minimum Recovery LSN
- flushing pages
- active logs
ms.assetid: 98a80238-7409-4708-8a7d-5defd9957185
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 5776d4a23223637c50ac40098fa44342d5cd94a9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87671537"
---
# <a name="database-checkpoints-sql-server"></a><span data-ttu-id="d2216-102">Puntos de comprobación de base de datos (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="d2216-102">Database Checkpoints (SQL Server)</span></span>
  <span data-ttu-id="d2216-103">En este tema se proporciona información general de los puntos de comprobación de base de datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d2216-103">This topic provides an overview of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database checkpoints.</span></span> <span data-ttu-id="d2216-104">Un *punto de comprobación* crea un buen punto conocido desde donde [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] puede empezar a aplicar cambios incluidos en el registro durante la recuperación después de un cierre inesperado o un bloqueo del sistema.</span><span class="sxs-lookup"><span data-stu-id="d2216-104">A *checkpoint* creates a known good point from which the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] can start applying changes contained in the log during recovery after an unexpected shutdown or crash.</span></span>  
  
  
##  <a name="overview-of-checkpoints"></a><a name="Overview"></a><span data-ttu-id="d2216-105">Información general de los puntos de control</span><span class="sxs-lookup"><span data-stu-id="d2216-105">Overview of Checkpoints</span></span>  
 <span data-ttu-id="d2216-106">Por motivos de rendimiento, [!INCLUDE[ssDE](../../includes/ssde-md.md)] realiza modificaciones en las páginas de la base de datos en memoria, en la memoria caché de búfer, y no escribe estas páginas en el disco después de cada cambio.</span><span class="sxs-lookup"><span data-stu-id="d2216-106">For performance reasons, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] performs modifications to database pages in memory-in the buffer cache-and does not write these pages to disk after every change.</span></span> <span data-ttu-id="d2216-107">En su lugar, [!INCLUDE[ssDE](../../includes/ssde-md.md)] emite periódicamente un punto de comprobación en cada base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-107">Rather, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] periodically issues a checkpoint on each database.</span></span> <span data-ttu-id="d2216-108">Un *punto de comprobación* escribe las páginas modificadas en memoria actuales (denominadas *páginas desfasadas*) y la información del registro de transacciones de la memoria en el disco y, además, registra información acerca del registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="d2216-108">A *checkpoint* writes the current in-memory modified pages (known as *dirty pages*) and transaction log information from memory to disk and, also, records information about the transaction log.</span></span>  
  
 <span data-ttu-id="d2216-109">[!INCLUDE[ssDE](../../includes/ssde-md.md)] admite varios tipos de puntos de comprobación: automáticos, indirectos, manuales e internos.</span><span class="sxs-lookup"><span data-stu-id="d2216-109">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] supports several types of checkpoints: automatic, indirect, manual, and internal.</span></span> <span data-ttu-id="d2216-110">En la tabla siguiente se resumen los tipos de puntos de control.</span><span class="sxs-lookup"><span data-stu-id="d2216-110">The following table summarizes the types of checkpoints.</span></span>  
  
|<span data-ttu-id="d2216-111">Nombre</span><span class="sxs-lookup"><span data-stu-id="d2216-111">Name</span></span>|[!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="d2216-112">Interfaz</span><span class="sxs-lookup"><span data-stu-id="d2216-112">Interface</span></span>|<span data-ttu-id="d2216-113">Descripción</span><span class="sxs-lookup"><span data-stu-id="d2216-113">Description</span></span>|  
|----------|----------------------------------|-----------------|  
|<span data-ttu-id="d2216-114">Automático</span><span class="sxs-lookup"><span data-stu-id="d2216-114">Automatic</span></span>|<span data-ttu-id="d2216-115">EXEC sp_configure **' `recovery interval` ', ' *`seconds`* '**</span><span class="sxs-lookup"><span data-stu-id="d2216-115">EXEC sp_configure **'`recovery interval`','*`seconds`*'**</span></span>|<span data-ttu-id="d2216-116">Se emite automáticamente en segundo plano para cumplir el límite de tiempo superior que sugiere la `recovery interval` opción de configuración del servidor.</span><span class="sxs-lookup"><span data-stu-id="d2216-116">Issued automatically in the background to meet the upper time limit suggested by the `recovery interval` server configuration option.</span></span> <span data-ttu-id="d2216-117">Los puntos de comprobación automáticos se ejecutan hasta completarse.</span><span class="sxs-lookup"><span data-stu-id="d2216-117">Automatic checkpoints run to completion.</span></span>  <span data-ttu-id="d2216-118">Los puntos de comprobación automáticos están limitados según el número de operaciones de escritura pendientes y en función de si [!INCLUDE[ssDE](../../includes/ssde-md.md)] detecta un aumento de la latencia de escritura superior a 20 milisegundos.</span><span class="sxs-lookup"><span data-stu-id="d2216-118">Automatic checkpoints are throttled based on the number of outstanding writes and whether the [!INCLUDE[ssDE](../../includes/ssde-md.md)] detects an increase in write latency above 20 milliseconds.</span></span><br /><br /> <span data-ttu-id="d2216-119">Para más información, consulte [Configure the recovery interval Server Configuration Option](../../database-engine/configure-windows/configure-the-recovery-interval-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="d2216-119">For more information, see [Configure the recovery interval Server Configuration Option](../../database-engine/configure-windows/configure-the-recovery-interval-server-configuration-option.md).</span></span>|  
|<span data-ttu-id="d2216-120">Indirecto</span><span class="sxs-lookup"><span data-stu-id="d2216-120">Indirect</span></span>|<span data-ttu-id="d2216-121">ALTER DATABASE... ESTABLECER TARGET_RECOVERY_TIME **=** _target_recovery_time_ {seconds &#124; minutos}</span><span class="sxs-lookup"><span data-stu-id="d2216-121">ALTER DATABASE ... SET TARGET_RECOVERY_TIME **=**_target_recovery_time_ { SECONDS &#124; MINUTES }</span></span>|<span data-ttu-id="d2216-122">Se emiten en segundo plano para cumplir un tiempo de recuperación de destino especificado por el usuario para una determinada base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-122">Issued in the background to meet a user-specified target recovery time for a given database.</span></span> <span data-ttu-id="d2216-123">El tiempo de recuperación de destino predeterminado es 0, lo que provoca que se use la heurística de puntos de comprobación automáticos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-123">The default target recovery time is 0, which causes automatic checkpoint heuristics to be used on the database.</span></span> <span data-ttu-id="d2216-124">Si ha usado ALTER DATABASE para establecer TARGET_RECOVERY_TIME en >0, se usa este valor en vez del intervalo de recuperación especificado para la instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="d2216-124">If you have used ALTER DATABASE to set TARGET_RECOVERY_TIME to >0, this value is used, rather than the recovery interval specified for the server instance.</span></span><br /><br /> <span data-ttu-id="d2216-125">Para obtener más información, vea [Cambiar el tiempo de recuperación de destino de una base de datos &#40;SQL Server&#41;](change-the-target-recovery-time-of-a-database-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="d2216-125">For more information, see [Change the Target Recovery Time of a Database &#40;SQL Server&#41;](change-the-target-recovery-time-of-a-database-sql-server.md).</span></span>|  
|<span data-ttu-id="d2216-126">Manual</span><span class="sxs-lookup"><span data-stu-id="d2216-126">Manual</span></span>|<span data-ttu-id="d2216-127">CHECKPOINT [ *checkpoint_duration* ]</span><span class="sxs-lookup"><span data-stu-id="d2216-127">CHECKPOINT [ *checkpoint_duration* ]</span></span>|<span data-ttu-id="d2216-128">Se emite cuando se ejecuta un comando CHECKPOINT de [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d2216-128">Issued when you execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] CHECKPOINT command.</span></span> <span data-ttu-id="d2216-129">El punto de comprobación manual se produce en la base de datos actual para la conexión.</span><span class="sxs-lookup"><span data-stu-id="d2216-129">The manual checkpoint occurs in the current database for your connection.</span></span> <span data-ttu-id="d2216-130">De forma predeterminada, los puntos de comprobación manuales se ejecutan hasta completarse.</span><span class="sxs-lookup"><span data-stu-id="d2216-130">By default, manual checkpoints run to completion.</span></span> <span data-ttu-id="d2216-131">La limitación funciona de la misma forma que para los puntos de comprobación automáticos.</span><span class="sxs-lookup"><span data-stu-id="d2216-131">Throttling works the same way as for automatic checkpoints.</span></span>  <span data-ttu-id="d2216-132">Opcionalmente, el parámetro *checkpoint_duration* especifica un periodo de tiempo solicitado, en segundos, para que se complete el punto de comprobación.</span><span class="sxs-lookup"><span data-stu-id="d2216-132">Optionally, the *checkpoint_duration* parameter specifies a requested amount of time, in seconds, for the checkpoint to complete.</span></span><br /><br /> <span data-ttu-id="d2216-133">Para más información, consulte [CHECKPOINT &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/checkpoint-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d2216-133">For more information, see [CHECKPOINT &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/checkpoint-transact-sql).</span></span>|  
|<span data-ttu-id="d2216-134">Interno</span><span class="sxs-lookup"><span data-stu-id="d2216-134">Internal</span></span>|<span data-ttu-id="d2216-135">Ninguno.</span><span class="sxs-lookup"><span data-stu-id="d2216-135">None.</span></span>|<span data-ttu-id="d2216-136">Se emite por varias operaciones de servidor, como la copia de seguridad y la creación de instantánea de base de datos, para garantizar que las imágenes de disco coinciden con el estado actual del registro.</span><span class="sxs-lookup"><span data-stu-id="d2216-136">Issued by various server operations such as backup and database-snapshot creation to guarantee that disk images match the current state of the log.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="d2216-137">La opción de configuración avanzada `-k`[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] habilita a un administrador de base de datos para limitar el comportamiento de E/S de los puntos de comprobación según el rendimiento de E/S para algunos tipos de puntos de comprobación.</span><span class="sxs-lookup"><span data-stu-id="d2216-137">The `-k`[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] advanced setup option enables a database administrator to throttle checkpoint I/O behavior based on the throughput of the I/O subsystem for some types of checkpoints.</span></span> <span data-ttu-id="d2216-138">La `-k` opción de configuración se aplica a los puntos de comprobación automáticos y a cualquier punto de control manual e interno no limitado.</span><span class="sxs-lookup"><span data-stu-id="d2216-138">The `-k` setup option applies to automatic checkpoints and any otherwise unthrottled manual and internal checkpoints.</span></span>  
  
 <span data-ttu-id="d2216-139">Para los puntos de comprobación automáticos, manuales e internos, solo las modificaciones efectuadas después del último punto de comprobación se deben poner al día durante la recuperación de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-139">For automatic, manual, and internal checkpoints, only modifications made after the latest checkpoint need to be rolled forward during database recovery.</span></span> <span data-ttu-id="d2216-140">De este modo se reduce el tiempo necesario para recuperar una base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-140">This reduces the time required to recover a database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="d2216-141">Las transacciones no confirmadas de larga ejecución aumentan el tiempo de recuperación para todos los tipos de puntos de comprobación.</span><span class="sxs-lookup"><span data-stu-id="d2216-141">Long-running uncommitted transactions increase recovery time for all types of checkpoints.</span></span>  
  
  
  
###  <a name="interaction-of-the-target_recovery_time-and-recovery-interval-options"></a><a name="InteractionBwnSettings"></a> <span data-ttu-id="d2216-142">Interacción de las opciones TARGET_RECOVERY_TIME y "recovery interval"</span><span class="sxs-lookup"><span data-stu-id="d2216-142">Interaction of the TARGET_RECOVERY_TIME and 'recovery interval' Options</span></span>  
 <span data-ttu-id="d2216-143">En la tabla siguiente se resume la interacción entre la configuración de sp_configure del servidor **' `recovery interval` '** y la instrucción ALTER DATABASE específica de la base de datos... TARGET_RECOVERY_TIME configuración.</span><span class="sxs-lookup"><span data-stu-id="d2216-143">The following table summarizes the interaction between the server-wide **sp_configure'`recovery interval`'** setting and the database-specific ALTER DATABASE ... TARGET_RECOVERY_TIME setting.</span></span>  
  
|<span data-ttu-id="d2216-144">target_recovery_time</span><span class="sxs-lookup"><span data-stu-id="d2216-144">TARGET_RECOVERY_TIME</span></span>|<span data-ttu-id="d2216-145">"recovery interval"</span><span class="sxs-lookup"><span data-stu-id="d2216-145">'recovery interval'</span></span>|<span data-ttu-id="d2216-146">Tipo de punto de comprobación usado</span><span class="sxs-lookup"><span data-stu-id="d2216-146">Type of Checkpoint Used</span></span>|  
|----------------------------|-------------------------|-----------------------------|  
|<span data-ttu-id="d2216-147">0</span><span class="sxs-lookup"><span data-stu-id="d2216-147">0</span></span>|<span data-ttu-id="d2216-148">0</span><span class="sxs-lookup"><span data-stu-id="d2216-148">0</span></span>|<span data-ttu-id="d2216-149">Puntos de comprobación automáticos cuyo intervalo de recuperación de destino es 1 minuto.</span><span class="sxs-lookup"><span data-stu-id="d2216-149">automatic checkpoints whose target recovery interval is 1 minute.</span></span>|  
|<span data-ttu-id="d2216-150">0</span><span class="sxs-lookup"><span data-stu-id="d2216-150">0</span></span>|<span data-ttu-id="d2216-151">>0</span><span class="sxs-lookup"><span data-stu-id="d2216-151">>0</span></span>|<span data-ttu-id="d2216-152">Puntos de comprobación automáticos cuyo intervalo de recuperación de destino lo especifica la configuración definida por el usuario de la opción **“sp_configure” recovery interval**.</span><span class="sxs-lookup"><span data-stu-id="d2216-152">Automatic checkpoints whose target recovery interval is specified by the user defined setting of the **sp_configurerecovery interval** option.</span></span>|  
|<span data-ttu-id="d2216-153">>0</span><span class="sxs-lookup"><span data-stu-id="d2216-153">>0</span></span>|<span data-ttu-id="d2216-154">No aplicable.</span><span class="sxs-lookup"><span data-stu-id="d2216-154">Not applicable.</span></span>|<span data-ttu-id="d2216-155">Puntos de comprobación indirectos cuyo tiempo de recuperación de destino lo determina la configuración TARGET_RECOVERY_TIME, expresado en segundos.</span><span class="sxs-lookup"><span data-stu-id="d2216-155">Indirect checkpoints whose target recovery time is determined by the TARGET_RECOVERY_TIME setting, expressed in seconds.</span></span>|  
  
###  <a name="automatic-checkpoints"></a><a name="AutomaticChkpt"></a><span data-ttu-id="d2216-156">Puntos de comprobación automáticos</span><span class="sxs-lookup"><span data-stu-id="d2216-156">Automatic Checkpoints</span></span>  
 <span data-ttu-id="d2216-157">Un punto de comprobación automático se produce cada vez que el número de entradas de registro alcanza el número que [!INCLUDE[ssDE](../../includes/ssde-md.md)] estima que puede procesar durante el tiempo especificado en la `recovery interval` opción de configuración del servidor.</span><span class="sxs-lookup"><span data-stu-id="d2216-157">An automatic checkpoint occurs each time that  the number of log records reaches the number the [!INCLUDE[ssDE](../../includes/ssde-md.md)] estimates it can process during the time specified in the `recovery interval` server configuration option.</span></span> <span data-ttu-id="d2216-158">En cada base de datos sin un tiempo de recuperación de destino definido por el usuario, [!INCLUDE[ssDE](../../includes/ssde-md.md)] genera puntos de comprobación automáticos.</span><span class="sxs-lookup"><span data-stu-id="d2216-158">In every database without a user-defined target recovery time, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] generates automatic checkpoints.</span></span> <span data-ttu-id="d2216-159">La frecuencia de los puntos de comprobación automáticos depende de la `recovery interval` opción de configuración avanzada del servidor, que especifica el tiempo máximo que una determinada instancia de servidor debe usar para recuperar una base de datos durante el reinicio del sistema.</span><span class="sxs-lookup"><span data-stu-id="d2216-159">The frequency of automatic checkpoints depends on the `recovery interval` advanced server configuration option, which specifies the maximum time that a given server instance should use to recover a database during a system restart.</span></span> <span data-ttu-id="d2216-160">[!INCLUDE[ssDE](../../includes/ssde-md.md)] calcula el número máximo de entradas de registro que puede procesar durante el intervalo de recuperación.</span><span class="sxs-lookup"><span data-stu-id="d2216-160">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] estimates the maximum number of log records it can process within the recovery interval.</span></span> <span data-ttu-id="d2216-161">Cuando una base de datos que usa puntos de comprobación automáticos alcanza el número máximo de entradas de registro, [!INCLUDE[ssDE](../../includes/ssde-md.md)] emite un punto de comprobación en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-161">When a database that is using automatic checkpoints reaches this maximum number of log records, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] issues an checkpoint on the database.</span></span> <span data-ttu-id="d2216-162">El intervalo de tiempo entre puntos de comprobación puede ser muy variable.</span><span class="sxs-lookup"><span data-stu-id="d2216-162">The time interval between automatic checkpoints can be highly variable.</span></span> <span data-ttu-id="d2216-163">Una base de datos con una carga de trabajo de transacciones considerable tendrá más puntos de comprobación frecuentes que otra que se usa principalmente para operaciones de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="d2216-163">A database with a substantial transaction workload will have more frequent checkpoints than a database that is used primarily for read-only operations.</span></span>  
  
 <span data-ttu-id="d2216-164">Además, según el modelo de recuperación simple, un punto de comprobación automático también se pone en cola si el registro se llena al 70%.</span><span class="sxs-lookup"><span data-stu-id="d2216-164">Also, under the simple recovery model, an automatic checkpoint is also queued if the log becomes 70 percent full.</span></span>  
  
 <span data-ttu-id="d2216-165">Según el modelo de recuperación simple, a menos que algún factor retrase el truncamiento del registro, un punto de comprobación automático trunca la sección no usada del registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="d2216-165">Under the simple recovery model, unless some factor is delaying log truncation, an automatic checkpoint truncates the unused section of the transaction log.</span></span> <span data-ttu-id="d2216-166">Por el contrario, según los modelos de recuperación completa y de registro masivo, después de que se ha establecido una cadena de copia de seguridad, los puntos de comprobación automáticos no provocan el truncamiento del registro.</span><span class="sxs-lookup"><span data-stu-id="d2216-166">In contrast, under the full and bulk-logged recovery models, once a log backup chain has been established, automatic checkpoints do not cause log truncation.</span></span> <span data-ttu-id="d2216-167">Para más información, consulte [El registro de transacciones &#40;SQL Server&#41;](the-transaction-log-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="d2216-167">For more information, see [The Transaction Log &#40;SQL Server&#41;](the-transaction-log-sql-server.md).</span></span>  
  
 <span data-ttu-id="d2216-168">Después de un bloqueo del sistema, el periodo de tiempo necesario para recuperar una determinada base de datos depende en gran medida de la cantidad de E/S necesaria para rehacer las páginas que estaban desfasadas en el momento del bloqueo.</span><span class="sxs-lookup"><span data-stu-id="d2216-168">After a system crash, the length of time required to recover a given database is largely dependent on the amount of random I/O needed to redo pages that were dirty at the time of the crash.</span></span> <span data-ttu-id="d2216-169">Esto significa que la `recovery interval` configuración no es confiable.</span><span class="sxs-lookup"><span data-stu-id="d2216-169">This means that the `recovery interval` setting is unreliable.</span></span> <span data-ttu-id="d2216-170">No puede determinar una duración de recuperación precisa.</span><span class="sxs-lookup"><span data-stu-id="d2216-170">It cannot determine an accurate recovery duration.</span></span> <span data-ttu-id="d2216-171">Además, cuando punto de comprobación automático está en curso, la actividad de E/S general de los datos aumenta considerablemente y es bastante impredecible.</span><span class="sxs-lookup"><span data-stu-id="d2216-171">Furthermore, when an automatic checkpoint is in progress, the general I/O activity for data increases significantly and quite unpredictably.</span></span>  
  
  
####  <a name="impact-of-recovery-interval-on-recovery-performance"></a><a name="PerformanceImpact"></a><span data-ttu-id="d2216-172">Impacto del intervalo de recuperación en el rendimiento de la recuperación</span><span class="sxs-lookup"><span data-stu-id="d2216-172">Impact of Recovery Interval on Recovery Performance</span></span>  
 <span data-ttu-id="d2216-173">En el caso de un sistema de procesamiento de transacciones en línea (OLTP) que usa transacciones cortas, `recovery interval` es el factor principal que determina el tiempo de recuperación.</span><span class="sxs-lookup"><span data-stu-id="d2216-173">For an online transaction processing (OLTP) system using short transactions, `recovery interval` is the primary factor determining recovery time.</span></span> <span data-ttu-id="d2216-174">Sin embargo, la `recovery interval` opción no afecta al tiempo necesario para deshacer una transacción de ejecución prolongada.</span><span class="sxs-lookup"><span data-stu-id="d2216-174">However, the `recovery interval` option does not affect the time required to undo a long-running transaction.</span></span> <span data-ttu-id="d2216-175">La recuperación de una base de datos con una transacción de ejecución prolongada puede tardar mucho más que la especificada en la `recovery interval` opción.</span><span class="sxs-lookup"><span data-stu-id="d2216-175">Recovery of a database with a long-running transaction can take much longer than the specified in the `recovery interval` option.</span></span> <span data-ttu-id="d2216-176">Por ejemplo, si una transacción de ejecución prolongada tardó dos horas en realizar actualizaciones antes de que se deshabilitara la instancia del servidor, la recuperación real tarda bastante más tiempo que el `recovery interval` valor para recuperar la transacción larga.</span><span class="sxs-lookup"><span data-stu-id="d2216-176">For example, if a long-running transaction took two hours to perform updates before the server instance became disabled, the actual recovery takes considerably longer than the `recovery interval` value to recover the long transaction.</span></span> <span data-ttu-id="d2216-177">Para obtener más información sobre la repercusión de una transacción de ejecución prolongada en el tiempo de recuperación, vea [El registro de transacciones &#40;SQL Server&#41;](the-transaction-log-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="d2216-177">For more information about the impact of a long running transaction on recovery time, see [The Transaction Log &#40;SQL Server&#41;](the-transaction-log-sql-server.md).</span></span>  
  
 <span data-ttu-id="d2216-178">Normalmente, los valores predeterminados proporciona un rendimiento de recuperación óptimo.</span><span class="sxs-lookup"><span data-stu-id="d2216-178">Typically, the default values provides optimal recovery performance.</span></span> <span data-ttu-id="d2216-179">No obstante, el cambio del intervalo de recuperación podría mejorar el rendimiento en las siguientes circunstancias:</span><span class="sxs-lookup"><span data-stu-id="d2216-179">However, changing the recovery interval might improve performance in the following circumstances:</span></span>  
  
-   <span data-ttu-id="d2216-180">Si la recuperación suele tardar considerablemente más de 1 minuto cuando no se están revirtiendo transacciones de ejecución prolongada.</span><span class="sxs-lookup"><span data-stu-id="d2216-180">If recovery routinely takes significantly longer than 1 minute when long-running transactions are not being rolled back.</span></span>  
  
-   <span data-ttu-id="d2216-181">Si observa que los puntos de comprobación frecuentes afectan negativamente al rendimiento de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-181">If you notice that frequent checkpoints are impairing performance on a database.</span></span>  
  
 <span data-ttu-id="d2216-182">Si decide aumentar la configuración `recovery interval`, es recomendable que lo haga gradualmente en pequeños incrementos y evaluando el efecto de cada aumento incremental en el rendimiento de recuperación.</span><span class="sxs-lookup"><span data-stu-id="d2216-182">If you decide to increase the `recovery interval` setting, we recommend increasing it gradually by small increments and evaluating the effect of each incremental increase on recovery performance.</span></span> <span data-ttu-id="d2216-183">Este enfoque es importante porque `recovery interval` , a medida que aumenta la configuración, la recuperación de la base de datos tarda mucho más tiempo en completarse.</span><span class="sxs-lookup"><span data-stu-id="d2216-183">This approach is important because as the `recovery interval` setting increases, database recovery takes that many times longer to complete.</span></span> <span data-ttu-id="d2216-184">Por ejemplo, si cambia `recovery interval` 10, la recuperación tarda aproximadamente 10 veces más en completarse que cuando `recovery interval` se establece en cero.</span><span class="sxs-lookup"><span data-stu-id="d2216-184">For example, if you change `recovery interval` 10, recovery takes approximately 10 times longer to complete than when `recovery interval` is set to zero.</span></span>  
  
  
###  <a name="indirect-checkpoints"></a><a name="IndirectChkpt"></a><span data-ttu-id="d2216-185">Puntos de comprobación indirectos</span><span class="sxs-lookup"><span data-stu-id="d2216-185">Indirect Checkpoints</span></span>  
 <span data-ttu-id="d2216-186">Los puntos de control indirectos, novedad de [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], proporcionan una alternativa de nivel de base de datos configurable a los puntos de comprobación automáticos.</span><span class="sxs-lookup"><span data-stu-id="d2216-186">Indirect checkpoints, new in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], provide a configurable database-level alternative to automatic checkpoints.</span></span> <span data-ttu-id="d2216-187">Si se produce un bloqueo del sistema, los puntos de comprobación indirectos proporcionan un tiempo de recuperación más rápido y predecible que los puntos de comprobación automáticos.</span><span class="sxs-lookup"><span data-stu-id="d2216-187">In the event of a system crash, indirect checkpoints provide potentially faster, more predictable recovery time than automatic checkpoints.</span></span> <span data-ttu-id="d2216-188">Los puntos de comprobación indirectos proporcionan las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="d2216-188">Indirect checkpoints offer the following advantages:</span></span>  
  
-   <span data-ttu-id="d2216-189">Una carga de trabajo transaccional en línea en una base de datos que esté configurada para puntos de comprobación indirectos podría experimentar un deterioro del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d2216-189">An online transactional workload on a database that is configured for indirect checkpoints could experience performance degradation.</span></span> <span data-ttu-id="d2216-190">Los puntos de comprobación indirectos garantizan que el número de páginas desfasadas se encuentra por debajo de un umbral determinado para que la recuperación de la base de datos finalice en el tiempo de recuperación de destino.</span><span class="sxs-lookup"><span data-stu-id="d2216-190">Indirect checkpoints make sure that the number of dirty pages are below a certain threshold so that the database recovery completes within the target recovery time.</span></span> <span data-ttu-id="d2216-191">La opción de configuración de intervalo de recuperación usa el número de transacciones para determinar el tiempo de recuperación a diferencia de los puntos de comprobación indirectos, que usan el número de páginas desfasadas.</span><span class="sxs-lookup"><span data-stu-id="d2216-191">The recovery interval configuration option uses the number of transactions to determine the recovery time as opposed to indirect checkpoints which makes use of number of dirty pages.</span></span> <span data-ttu-id="d2216-192">Cuando se habilitan los puntos de comprobación indirectos en una base de datos que recibe un gran número de operaciones de DML, el escritor en segundo plano puede iniciar agresivamente el vaciado de búferes desfasados en el disco para asegurarse de que el tiempo necesario para realizar la recuperación se encuentra dentro del tiempo de recuperación de destino establecido de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-192">When indirect checkpoints are enabled on a database receiving a large number of DML operations, the background writer can start aggressively flushing dirty buffers to disk to ensure that the time required to perform recovery is within the target recovery time set of the database.</span></span> <span data-ttu-id="d2216-193">Esto puede provocar actividad de E/S adicional en determinados sistemas que pueden contribuir a un cuello de botella de rendimiento si el subsistema del disco está funcionando por encima del umbral de E/S o cerca de él.</span><span class="sxs-lookup"><span data-stu-id="d2216-193">This can cause additional I/O activity on certain systems which can contribute to a performance bottleneck if the disk subsystem is operating above or nearing the I/O threshold.</span></span>  
  
-   <span data-ttu-id="d2216-194">Los puntos de comprobación indirectos permiten controlar el tiempo de recuperación de base de datos al tener en cuenta el costo de las E/S aleatorias durante REDO.</span><span class="sxs-lookup"><span data-stu-id="d2216-194">Indirect checkpoints enable you to reliably control database recovery time by factoring in the cost of random I/O during REDO.</span></span> <span data-ttu-id="d2216-195">Eso permite que una instancia de servidor permanezca dentro de un límite superior en los tiempos de recuperación de una determinada base de datos (excepto cuando una transacción de ejecución prolongada provoca tiempos de UNDO excesivos).</span><span class="sxs-lookup"><span data-stu-id="d2216-195">This enables a server instance to stay within an upper-bound on recovery times for a given database (except when a long-running transaction causes excessive UNDO times).</span></span>  
  
-   <span data-ttu-id="d2216-196">Los puntos de comprobación indirectos reducen los picos de E/S relacionados con los puntos de comprobación al escribir continuamente las páginas desfasadas en disco en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="d2216-196">Indirect checkpoints reduce checkpoint-related I/O spiking by continually writing dirty pages to disk in the background.</span></span>  
  
 <span data-ttu-id="d2216-197">No obstante, una carga de trabajo transaccional en línea en una base de datos que está configurada para puntos de comprobación indirectos podría experimentar un deterioro del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d2216-197">However, an online transactional workload on a database that is configured for indirect checkpoints could experience performance degradation.</span></span> <span data-ttu-id="d2216-198">Esto se debe a que el escritor en segundo plano que usa el punto de comprobación indirecto en ocasiones aumenta la carga de escritura total para una instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="d2216-198">This is because the background writer used by indirect checkpoint sometimes increases the total write load for a server instance.</span></span>  
  
  
###  <a name="internal-checkpoints"></a><a name="EventsCausingChkpt"></a><span data-ttu-id="d2216-199">Puntos de comprobación internos</span><span class="sxs-lookup"><span data-stu-id="d2216-199">Internal Checkpoints</span></span>  
 <span data-ttu-id="d2216-200">Hay distintos componentes del servidor que generan puntos de comprobación internos para garantizar que las imágenes de disco coinciden con el estado actual del registro.</span><span class="sxs-lookup"><span data-stu-id="d2216-200">Internal Checkpoints are generated by various server components to guarantee that disk images match the current state of the log.</span></span> <span data-ttu-id="d2216-201">Los puntos de comprobación internos se generan en respuesta a los siguientes eventos:</span><span class="sxs-lookup"><span data-stu-id="d2216-201">Internal checkpoint are generated in response to the following events:</span></span>  
  
-   <span data-ttu-id="d2216-202">Se han agregado o eliminado archivos de base de datos mediante ALTER DATABASE.</span><span class="sxs-lookup"><span data-stu-id="d2216-202">Database files have been added or removed by using ALTER DATABASE.</span></span>  
  
-   <span data-ttu-id="d2216-203">Se realiza una copia de seguridad de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-203">A database backup is taken.</span></span>  
  
-   <span data-ttu-id="d2216-204">Se crea una instantánea de base de datos, tanto explícita como internamente para DBCC CHECK.</span><span class="sxs-lookup"><span data-stu-id="d2216-204">A database snapshot is created, whether explicitly or internally for DBCC CHECK.</span></span>  
  
-   <span data-ttu-id="d2216-205">Se realiza una actividad que requiere cerrar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d2216-205">An activity requiring a database shutdown is performed.</span></span> <span data-ttu-id="d2216-206">Por ejemplo, el valor de AUTO_CLOSE es ON y se ha cerrado la última conexión de usuario a la base de datos, o bien se realiza una modificación de una opción de la base de datos que requiere reiniciarla.</span><span class="sxs-lookup"><span data-stu-id="d2216-206">For example, AUTO_CLOSE is ON and the last user connection to the database is closed, or a database option change is made that requires a restart of the database.</span></span>  
  
-   <span data-ttu-id="d2216-207">Se detiene una instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] deteniendo el servicio [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (MSSQLSERVER).</span><span class="sxs-lookup"><span data-stu-id="d2216-207">An instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is stopped by stopping the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (MSSQLSERVER) service .</span></span> <span data-ttu-id="d2216-208">Las dos acciones insertan un punto de comprobación en cada base de datos de la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d2216-208">Either action  causes a checkpoint in each database in the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="d2216-209">Poner fuera de línea una instancia de clúster de conmutación por error (FCI) de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d2216-209">Bringing a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance (FCI) offline.</span></span>  
  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="d2216-210">Tareas relacionadas</span><span class="sxs-lookup"><span data-stu-id="d2216-210">Related Tasks</span></span>  
 <span data-ttu-id="d2216-211">**Para cambiar el intervalo de recuperación en una instancia de servidor**</span><span class="sxs-lookup"><span data-stu-id="d2216-211">**To change the recovery interval on a server instance**</span></span>  
  
-   [<span data-ttu-id="d2216-212">Establecer la opción de configuración del servidor Intervalo de recuperación</span><span class="sxs-lookup"><span data-stu-id="d2216-212">Configure the recovery interval Server Configuration Option</span></span>](../../database-engine/configure-windows/configure-the-recovery-interval-server-configuration-option.md)  
  
 <span data-ttu-id="d2216-213">**Para configurar puntos de comprobación indirectos en una base de datos**</span><span class="sxs-lookup"><span data-stu-id="d2216-213">**To configure indirect checkpoints on a database**</span></span>  
  
-   [<span data-ttu-id="d2216-214">Cambiar el tiempo de recuperación de destino de una base de datos &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="d2216-214">Change the Target Recovery Time of a Database &#40;SQL Server&#41;</span></span>](change-the-target-recovery-time-of-a-database-sql-server.md)  
  
 <span data-ttu-id="d2216-215">**Para emitir un punto de comprobación manual en una base de datos**</span><span class="sxs-lookup"><span data-stu-id="d2216-215">**To issue a manual checkpoint on a database**</span></span>  
  
-   [<span data-ttu-id="d2216-216">CHECKPOINT &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="d2216-216">CHECKPOINT &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/language-elements/checkpoint-transact-sql)  
  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="d2216-217">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="d2216-217">Related Content</span></span>  
  
-   <span data-ttu-id="d2216-218">[Arquitectura física del registro de transacciones](https://technet.microsoft.com/library/ms179355.aspx) (en los Libros en pantalla de [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)])</span><span class="sxs-lookup"><span data-stu-id="d2216-218">[Transaction Log Physical Architecture](https://technet.microsoft.com/library/ms179355.aspx) (in [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Books Oline)</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="d2216-219">Consulte también</span><span class="sxs-lookup"><span data-stu-id="d2216-219">See Also</span></span>  
 [<span data-ttu-id="d2216-220">El registro de transacciones &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="d2216-220">The Transaction Log &#40;SQL Server&#41;</span></span>](the-transaction-log-sql-server.md)  
  
  
