---
title: Administración del tamaño del archivo de registro de transacciones | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- transaction logs [SQL Server], size management
ms.assetid: 3a70e606-303f-47a8-96d4-2456a18d4297
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 219ba0605d60bab0b13675f7f9f7ff01cace5755
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87671530"
---
# <a name="manage-the-size-of-the-transaction-log-file"></a><span data-ttu-id="40c77-102">Administrar el tamaño del archivo de registro de transacciones</span><span class="sxs-lookup"><span data-stu-id="40c77-102">Manage the Size of the Transaction Log File</span></span>
  <span data-ttu-id="40c77-103">En algunos casos, puede resultar útil reducir o expandir físicamente el archivo de registro físico del registro de transacciones de una base de datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="40c77-103">In some cases, it can be useful to physically shrink or expand the physical log file of the transaction log of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="40c77-104">Este tema contiene información acerca de cómo supervisar el tamaño de un registro de transacciones de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , reducir el registro de transacciones, agregar o ampliar un archivo de registro de transacciones, optimizar la tasa de crecimiento del registro de transacciones **tempdb** y controlar el crecimiento de un archivo de registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="40c77-104">This topic contains information about how to monitor the size of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] transaction log, shrink the transaction log, add or enlarge a transaction log file, optimize the **tempdb** transaction log growth rate, and control the growth of a transaction log file.</span></span>  
  
  
##  <a name="monitor-log-space-use"></a><a name="MonitorSpaceUse"></a><span data-ttu-id="40c77-105">Supervisar el uso del espacio del registro</span><span class="sxs-lookup"><span data-stu-id="40c77-105">Monitor Log Space Use</span></span>  
 <span data-ttu-id="40c77-106">Puede supervisar el uso del espacio del registro mediante el comando DBCC SQLPERF (LOGSPACE).</span><span class="sxs-lookup"><span data-stu-id="40c77-106">You can monitor log space use by using DBCC SQLPERF (LOGSPACE).</span></span> <span data-ttu-id="40c77-107">Este comando devuelve información sobre la cantidad de espacio del registro actualmente en uso e indica cuándo es necesario el truncamiento del registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="40c77-107">This command returns information about the amount of log space currently used and indicates when the transaction log is in need of truncation.</span></span> <span data-ttu-id="40c77-108">Para obtener más información, vea [DBCC SQLPERF &#40;Transact-SQL&#41;](/sql/t-sql/database-console-commands/dbcc-sqlperf-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="40c77-108">For more information, see [DBCC SQLPERF &#40;Transact-SQL&#41;](/sql/t-sql/database-console-commands/dbcc-sqlperf-transact-sql).</span></span> <span data-ttu-id="40c77-109">Para obtener información sobre el tamaño actual de un archivo de registro, su tamaño máximo y la opción de crecimiento automático de este archivo, también puede usar las columnas **size**, **max_size** y **growth** de ese archivo de registro en **sys.database_files**.</span><span class="sxs-lookup"><span data-stu-id="40c77-109">For information about the current size of a log file, its maximum size, and the autogrow option for the file, you can also use the **size**, **max_size**, and **growth** columns for that log file in **sys.database_files**.</span></span> <span data-ttu-id="40c77-110">Para obtener más información, vea [sys.master_files &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-files-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="40c77-110">For more information, see [sys.database_files &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-files-transact-sql).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="40c77-111">Se recomienda evitar la sobrecarga del disco del registro.</span><span class="sxs-lookup"><span data-stu-id="40c77-111">We recommend that you avoid overloading the log disk.</span></span>  
  
  
##  <a name="shrink-the-size-of-the-log-file"></a><a name="ShrinkSize"></a><span data-ttu-id="40c77-112">Reducir el tamaño del archivo de registro</span><span class="sxs-lookup"><span data-stu-id="40c77-112">Shrink the Size of the Log File</span></span>  
 <span data-ttu-id="40c77-113">Para reducir el tamaño físico de un archivo de registro físico, debe reducir el archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="40c77-113">To reduce the physical size of a physical log file, you must shrink the log file.</span></span> <span data-ttu-id="40c77-114">Esto es útil si sabe que un archivo de registro de transacciones contiene espacio no usado que no necesitará.</span><span class="sxs-lookup"><span data-stu-id="40c77-114">This is useful if you know that a transaction log file contains unused space that you will not be needing.</span></span> <span data-ttu-id="40c77-115">La reducción de un archivo de registro solo se puede realizar mientras la base de datos está en línea y existe al menos un archivo de registro virtual libre.</span><span class="sxs-lookup"><span data-stu-id="40c77-115">Shrinking a log file can occur only while the database is online and, also, at least one virtual log file is free.</span></span> <span data-ttu-id="40c77-116">En algunos casos, no será posible reducir el registro hasta el siguiente truncamiento del registro.</span><span class="sxs-lookup"><span data-stu-id="40c77-116">In some cases, shrinking the log may not be possible until after the next log truncation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="40c77-117">Los factores que mantienen activos los archivos de registro virtuales por un periodo prolongado de tiempo, como puede ser una transacción de ejecución prolongada, pueden restringir la reducción del registro o incluso impedirla completamente.</span><span class="sxs-lookup"><span data-stu-id="40c77-117">Factors, such as a long-running transaction, that keep virtual log files active for an extended period can restrict log shrinkage or even prevent the log from shrinking at all.</span></span> <span data-ttu-id="40c77-118">Para obtener información sobre los factores que pueden retrasar el truncamiento del registro, vea [Registro de transacciones &#40;SQL Server&#41;](the-transaction-log-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="40c77-118">For information about factors that can delay log truncation, see [The Transaction Log &#40;SQL Server&#41;](the-transaction-log-sql-server.md).</span></span>  
  
 <span data-ttu-id="40c77-119">Con la reducción de un archivo de registro se quitan uno o varios archivos de registro virtuales que no contienen ninguna parte del registro lógico (es decir, los *archivos de registro virtuales inactivos*).</span><span class="sxs-lookup"><span data-stu-id="40c77-119">Shrinking a log file removes one or more virtual log files that do not hold any part of the logical log (that is, *inactive virtual log files*).</span></span> <span data-ttu-id="40c77-120">Cuando se reduce un archivo de registro de transacciones, se quitan suficientes archivos de registro virtuales inactivos del final del archivo de registro como para reducirlo aproximadamente al tamaño de destino.</span><span class="sxs-lookup"><span data-stu-id="40c77-120">When a transaction log file is shrunk, enough inactive virtual log files are removed from the end of the log file to reduce the log to approximately the target size.</span></span>  
  
 <span data-ttu-id="40c77-121">**Para reducir un archivo de registro (sin reducir los archivos de base de datos)**</span><span class="sxs-lookup"><span data-stu-id="40c77-121">**To shrink a log file (without shrinking database files)**</span></span>  
  
-   [<span data-ttu-id="40c77-122">DBCC SHRINKFILE &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="40c77-122">DBCC SHRINKFILE &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-shrinkfile-transact-sql)  
  
-   [<span data-ttu-id="40c77-123">Reducir un archivo</span><span class="sxs-lookup"><span data-stu-id="40c77-123">Shrink a File</span></span>](../databases/shrink-a-file.md)  
  
 <span data-ttu-id="40c77-124">**Para supervisar los eventos de reducción de un archivo de registro**</span><span class="sxs-lookup"><span data-stu-id="40c77-124">**To monitor log-file shrink events**</span></span>  
  
-   <span data-ttu-id="40c77-125">[Log File Auto Shrink Event Class](../event-classes/log-file-auto-shrink-event-class.md).</span><span class="sxs-lookup"><span data-stu-id="40c77-125">[Log File Auto Shrink Event Class](../event-classes/log-file-auto-shrink-event-class.md).</span></span>  
  
 `To monitor log space`  
  
-   [<span data-ttu-id="40c77-126">DBCC SQLPERF &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="40c77-126">DBCC SQLPERF &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-sqlperf-transact-sql)  
  
-   <span data-ttu-id="40c77-127">[sys.database_files &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-files-transact-sql) (Vea las columnas **size**, **max_size** y **growth** de los archivos de registro).</span><span class="sxs-lookup"><span data-stu-id="40c77-127">[sys.database_files &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-files-transact-sql) (See the **size**, **max_size**, and **growth** columns for the log file or files.)</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="40c77-128">La reducción de los archivos de base de datos y registro se puede establecer para que se produzca automáticamente.</span><span class="sxs-lookup"><span data-stu-id="40c77-128">Shrinking database and log files can be set to occur automatically.</span></span> <span data-ttu-id="40c77-129">Sin embargo, no recomendamos realizar una reducción automática, y la propiedad de base de datos `autoshrink` está establecida en FALSE de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="40c77-129">However, we recommend against automatic shrinking, and the `autoshrink` database property is set to FALSE by default.</span></span> <span data-ttu-id="40c77-130">Si `autoshrink` está establecida en TRUE, el proceso de reducción automática solo reduce el tamaño de un archivo cuando más del 25% de su espacio está sin utilizar.</span><span class="sxs-lookup"><span data-stu-id="40c77-130">If `autoshrink` is set to TRUE, automatic shrinking reduces the size of a file only when more than 25 percent of its space is unused.</span></span> <span data-ttu-id="40c77-131">El tamaño del archivo se reduce hasta un tamaño en el que solo el 25% del archivo corresponde al espacio sin utilizar o hasta el tamaño original del archivo (el que sea mayor).</span><span class="sxs-lookup"><span data-stu-id="40c77-131">The file is shrunk either to the size at which only 25 percent of the file is unused space or to the original size of the file, whichever is larger.</span></span> <span data-ttu-id="40c77-132">Para obtener información sobre cómo cambiar la configuración de la `autoshrink` propiedad, vea [ver o cambiar las propiedades de una base de datos](../databases/view-or-change-the-properties-of-a-database.md): use la propiedad **reducción automática** en la página **Opciones** -o [las opciones de ALTER DATABASE Set &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-set-options): Use la opción AUTO_SHRINK.</span><span class="sxs-lookup"><span data-stu-id="40c77-132">For information about changing the setting of the `autoshrink` property, see [View or Change the Properties of a Database](../databases/view-or-change-the-properties-of-a-database.md)-use the **Auto Shrink** property on the **Options** page-or [ALTER DATABASE SET Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-set-options)-use the AUTO_SHRINK option.</span></span>  
  
  
##  <a name="add-or-enlarge-a-log-file"></a><a name="AddOrEnlarge"></a><span data-ttu-id="40c77-133">Agregar o ampliar un archivo de registro</span><span class="sxs-lookup"><span data-stu-id="40c77-133">Add or Enlarge a Log File</span></span>  
 <span data-ttu-id="40c77-134">También puede obtener espacio ampliando el archivo de registro existente (si el espacio en disco lo permite) o agregando un archivo de registro a la base de datos, normalmente en otro disco.</span><span class="sxs-lookup"><span data-stu-id="40c77-134">Alternatively, you can gain space by enlarging the existing log file (if disk space permits) or by adding a log file to the database, typically on a different disk.</span></span>  
  
-   <span data-ttu-id="40c77-135">Para agregar un archivo de registro a la base de datos, utilice la cláusula ADD LOG FILE de la instrucción ALTER DATABASE.</span><span class="sxs-lookup"><span data-stu-id="40c77-135">To add a log file to the database, use the ADD LOG FILE clause of the ALTER DATABASE statement.</span></span> <span data-ttu-id="40c77-136">El hecho de agregar un archivo de registro permite que crezca el existente.</span><span class="sxs-lookup"><span data-stu-id="40c77-136">Adding a log file allows the log to grow.</span></span>  
  
-   <span data-ttu-id="40c77-137">Para aumentar el tamaño del archivo de registro, use la cláusula MODIFY FILE de la instrucción ALTER DATABASE, especificando la sintaxis de SIZE y MAXSIZE.</span><span class="sxs-lookup"><span data-stu-id="40c77-137">To enlarge the log file, use the MODIFY FILE clause of the ALTER DATABASE statement, specifying the SIZE and MAXSIZE syntax.</span></span> <span data-ttu-id="40c77-138">Para obtener más información, vea [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="40c77-138">For more information, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
  
##  <a name="optimize-the-size-of-the-tempdb-transaction-log"></a><a name="tempdbOptimize"></a><span data-ttu-id="40c77-139">Optimizar el tamaño del registro de transacciones de tempdb</span><span class="sxs-lookup"><span data-stu-id="40c77-139">Optimize the Size of the tempdb Transaction Log</span></span>  
 <span data-ttu-id="40c77-140">Al reiniciar una instancia del servidor se devuelve el tamaño del registro de transacciones de la base de datos **tempdb** a su tamaño original, antes del crecimiento automático.</span><span class="sxs-lookup"><span data-stu-id="40c77-140">Restarting a server instance resizes the transaction log of the **tempdb** database to its original, pre-autogrow size.</span></span> <span data-ttu-id="40c77-141">Esto puede reducir el rendimiento del registro de transacciones de **tempdb** .</span><span class="sxs-lookup"><span data-stu-id="40c77-141">This can reduce the performance of the **tempdb** transaction log.</span></span> <span data-ttu-id="40c77-142">Para evitar esta sobrecarga, aumente el tamaño del registro de transacciones de **tempdb** después de iniciar o reiniciar la instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="40c77-142">You can avoid this overhead by increasing the size of the **tempdb** transaction log after starting or restarting the server instance.</span></span> <span data-ttu-id="40c77-143">Para obtener más información, consulte [tempdb Database](../databases/tempdb-database.md).</span><span class="sxs-lookup"><span data-stu-id="40c77-143">For more information, see [tempdb Database](../databases/tempdb-database.md).</span></span>  
  
  
##  <a name="control-the-growth-of-a-transaction-log-file"></a><a name="ControlGrowth"></a><span data-ttu-id="40c77-144">Controlar el crecimiento de un archivo de registro de transacciones</span><span class="sxs-lookup"><span data-stu-id="40c77-144">Control the Growth of a Transaction Log File</span></span>  
 <span data-ttu-id="40c77-145">Puede usar la instrucción [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql) para administrar el crecimiento de un archivo de registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="40c77-145">You can use the [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql) statement to manage the growth of a transaction log file.</span></span> <span data-ttu-id="40c77-146">Tenga en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="40c77-146">Note the following:</span></span>  
  
-   <span data-ttu-id="40c77-147">Para cambiar el tamaño del archivo actual en unidades de KB, MB, GB y TB, use la opción SIZE.</span><span class="sxs-lookup"><span data-stu-id="40c77-147">To change the current file size in KB, MB, GB, and TB units, use the SIZE option.</span></span>  
  
-   <span data-ttu-id="40c77-148">Para cambiar el incremento de crecimiento, use la opción FILEGROWTH.</span><span class="sxs-lookup"><span data-stu-id="40c77-148">To change the growth increment, use the FILEGROWTH option.</span></span> <span data-ttu-id="40c77-149">El valor 0 indica que el aumento automático se establece en OFF y no se permite ningún espacio adicional.</span><span class="sxs-lookup"><span data-stu-id="40c77-149">A value of 0 indicates that automatic growth is set to off and no additional space is permitted.</span></span> <span data-ttu-id="40c77-150">Un pequeño incremento del crecimiento automático de un archivo de registro puede reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="40c77-150">A small autogrowth increment on a log file can reduce performance.</span></span> <span data-ttu-id="40c77-151">El incremento del crecimiento de un archivo de registro debe ser lo suficientemente grande para evitar una expansión frecuente.</span><span class="sxs-lookup"><span data-stu-id="40c77-151">The file growth increment on a log file should be sufficiently large to avoid frequent expansion.</span></span> <span data-ttu-id="40c77-152">El incremento de crecimiento predeterminado del 10% suele resultar adecuado.</span><span class="sxs-lookup"><span data-stu-id="40c77-152">The default growth increment of 10 percent is generally suitable.</span></span>  
  
     <span data-ttu-id="40c77-153">Para obtener información sobre cómo cambiar la propiedad de crecimiento de archivos en un archivo de registro, vea [ALTER database &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="40c77-153">For information on changing the file-growth property on a log file, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
-   <span data-ttu-id="40c77-154">Para controlar el máximo el tamaño de un archivo de registro en unidades de KB, MB, GB y TB o establecer el crecimiento en UNLIMITED, use la opción MAXSIZE.</span><span class="sxs-lookup"><span data-stu-id="40c77-154">To control the maximum the size of a log file in KB, MB, GB, and TB units or to set growth to UNLIMITED, use the MAXSIZE option.</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="40c77-155">Consulte también</span><span class="sxs-lookup"><span data-stu-id="40c77-155">See Also</span></span>  
 <span data-ttu-id="40c77-156">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="40c77-156">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 [<span data-ttu-id="40c77-157">Solucionar problemas de un registro de transacciones lleno &#40;Error 9002 de SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="40c77-157">Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;</span></span>](troubleshoot-a-full-transaction-log-sql-server-error-9002.md)  
  
  
