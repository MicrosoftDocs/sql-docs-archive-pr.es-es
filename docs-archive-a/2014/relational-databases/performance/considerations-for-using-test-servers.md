---
title: Consideraciones acerca del uso de servidores de prueba | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- overhead [Database Engine Tuning Advisor]
- tuning overhead [SQL Server]
- reducing production server tuning load
- Database Engine Tuning Advisor [SQL Server], test servers
- xp_msver
- test servers [Database Engine Tuning Advisor]
- production servers [SQL Server]
- offload tuning overhead [SQL Server]
ms.assetid: 94e6c3e5-1f09-4616-9da2-4e44d066d494
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 3fe835c1e92b382e3e2fadd7e80d4b2984929cc5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87745227"
---
# <a name="considerations-for-using-test-servers"></a><span data-ttu-id="46497-102">Consideraciones acerca del uso de servidores de prueba</span><span class="sxs-lookup"><span data-stu-id="46497-102">Considerations for Using Test Servers</span></span>
  <span data-ttu-id="46497-103">El uso de un servidor de prueba para optimizar una base de datos en un servidor de producción es una ventaja importante del Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="46497-103">Using a test server to tune a database on a production server is an important benefit of [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor.</span></span> <span data-ttu-id="46497-104">Mediante esta característica se puede descargar la sobrecarga de optimización en un servidor de prueba sin copiar los datos reales del servidor de producción a ese servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-104">Using this feature, you can offload tuning overhead to a test server without copying the actual data over to the test server from the production server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="46497-105">La característica de optimización del servidor de prueba no se admite en la interfaz gráfica de usuario (GUI) del Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="46497-105">The test server tuning feature is not supported in the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor graphical user interface (GUI).</span></span>  
  
 <span data-ttu-id="46497-106">Para utilizar correctamente esta característica, revise las consideraciones enumeradas en las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="46497-106">To use this feature successfully, review the considerations listed in the following sections.</span></span>  
  
## <a name="setting-up-the-test-serverproduction-server-environment"></a><span data-ttu-id="46497-107">Configurar el entorno del servidor de prueba/servidor de producción</span><span class="sxs-lookup"><span data-stu-id="46497-107">Setting Up the Test Server/Production Server Environment</span></span>  
  
-   <span data-ttu-id="46497-108">El usuario que desea utilizar un servidor de prueba para optimizar una base de datos de un servidor de producción debe existir en ambos servidores; de lo contrario, este escenario no funcionará.</span><span class="sxs-lookup"><span data-stu-id="46497-108">The user who wants to use a test server to tune a database on a production server must exist on both servers, or this scenario will not work.</span></span>  
  
-   <span data-ttu-id="46497-109">El procedimiento almacenado extendido, **xp_msver**, debe estar habilitado para usar el escenario del servidor de prueba/servidor de producción.</span><span class="sxs-lookup"><span data-stu-id="46497-109">The extended stored procedure, **xp_msver**, must be enabled to use the test server/production server scenario.</span></span> [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-110">utiliza este procedimiento almacenado extendido para capturar el número de procesadores y la memoria disponible del servidor de producción para utilizarlos durante la optimización del servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-110">Tuning Advisor uses this extended stored procedure to fetch the number of processors and the available memory of the production server to use while tuning the test server.</span></span> <span data-ttu-id="46497-111">Si **xp_msver** no está habilitado, el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] adopta las características de hardware del equipo donde se está ejecutando el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="46497-111">If **xp_msver** is not enabled, [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor assumes the hardware characteristics of the computer where [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor is running.</span></span> <span data-ttu-id="46497-112">Si no están disponibles las características de hardware del equipo donde se está ejecutando el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] , se presupone el uso de un procesador y 1024 megabytes (MB) de memoria.</span><span class="sxs-lookup"><span data-stu-id="46497-112">If the hardware characteristics of the computer where [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor is running are not available, one processor and 1024 megabytes (MBs) of memory are assumed.</span></span> <span data-ttu-id="46497-113">Este procedimiento almacenado extendido se activa de manera predeterminada al instalar [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="46497-113">This extended stored procedure is turned on by default when you install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="46497-114">Para obtener más información, vea [Configuración de Área expuesta](../security/surface-area-configuration.md) y [xp_msver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/xp-msver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="46497-114">For more information, see [Surface Area Configuration](../security/surface-area-configuration.md) and [xp_msver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/xp-msver-transact-sql).</span></span>  
  
-   [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-115">espera que las ediciones de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sean las mismas en el servidor de prueba y el servidor de producción.</span><span class="sxs-lookup"><span data-stu-id="46497-115">Tuning Advisor expects the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to be the same on both the test server and the production server.</span></span> <span data-ttu-id="46497-116">Si hay ediciones diferentes, tiene prioridad la edición del servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-116">If there are two different editions, the edition on the test server takes precedence.</span></span> <span data-ttu-id="46497-117">Por ejemplo, si el servidor de prueba está ejecutando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Standard, el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] no incluirá vistas indizadas, particionamientos ni operaciones en línea en sus recomendaciones, aunque el servidor de producción esté ejecutando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise.</span><span class="sxs-lookup"><span data-stu-id="46497-117">For example, if the test server is running [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Standard, [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor will not include indexed views, partitioning, and online operations in its recommendations even if the production server is running [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise.</span></span>  
  
## <a name="about-test-serverproduction-server-behavior"></a><span data-ttu-id="46497-118">Comportamiento del servidor de prueba/servidor de producción</span><span class="sxs-lookup"><span data-stu-id="46497-118">About Test Server/Production Server Behavior</span></span>  
  
-   [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-119">tiene en cuenta las diferencias de hardware entre el servidor de producción y el de prueba a la hora de crear recomendaciones.</span><span class="sxs-lookup"><span data-stu-id="46497-119">Tuning Advisor takes into account hardware differences between the production and the test server when creating recommendations.</span></span> <span data-ttu-id="46497-120">La recomendación es la misma que si se hubiera realizado la optimización solo en el servidor de producción.</span><span class="sxs-lookup"><span data-stu-id="46497-120">The recommendation is the same as though the tuning was done on the production server alone.</span></span>  
  
-   [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-121">puede imponer cierta carga al servidor de producción a la hora de recopilar metadatos y crear las estadísticas necesarias para la optimización.</span><span class="sxs-lookup"><span data-stu-id="46497-121">Tuning Advisor may impose some load on the production server for gathering metadata as well as creation of statistics necessary for tuning.</span></span>  
  
-   [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-122">no copia datos reales del servidor de producción al servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-122">Tuning Advisor does not copy actual data from the production server to the test server.</span></span> <span data-ttu-id="46497-123">Solo copia los metadatos de las bases de datos y las estadísticas necesarias.</span><span class="sxs-lookup"><span data-stu-id="46497-123">It only copies the metadata of the databases and the necessary statistics.</span></span>  
  
-   <span data-ttu-id="46497-124">Toda la información de la sesión se almacena en **msdb** en el servidor de producción.</span><span class="sxs-lookup"><span data-stu-id="46497-124">All session information is stored in **msdb** on the production server.</span></span> <span data-ttu-id="46497-125">Esto permite explotar cualquier servidor de prueba disponible para la optimización, y la información sobre todas las sesiones está disponible en un mismo lugar (el servidor de producción).</span><span class="sxs-lookup"><span data-stu-id="46497-125">This allows you to exploit any available test server for tuning, and information about all sessions is available in one place (the production server).</span></span>  
  
## <a name="issues-related-to-the-shell-database"></a><span data-ttu-id="46497-126">Problemas relacionados con la base de datos de shell</span><span class="sxs-lookup"><span data-stu-id="46497-126">Issues Related to the Shell Database</span></span>  
  
-   <span data-ttu-id="46497-127">Tras la optimización, el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] debe quitar todos los metadatos que creó en el servidor de prueba durante el proceso de optimización.</span><span class="sxs-lookup"><span data-stu-id="46497-127">After tuning, [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor should remove any metadata that it created on the test server during the tuning process.</span></span> <span data-ttu-id="46497-128">Esto incluye la base de datos de shell.</span><span class="sxs-lookup"><span data-stu-id="46497-128">This includes the shell database.</span></span> <span data-ttu-id="46497-129">Si está realizando una serie de sesiones de optimización con los mismos servidores de producción y de prueba, es posible que desee mantener esta base de datos de shell para ahorrar tiempo.</span><span class="sxs-lookup"><span data-stu-id="46497-129">If you are performing a series of tuning sessions with the same production and test servers, you may want to retain this shell database to save time.</span></span> <span data-ttu-id="46497-130">En el archivo de entrada XML, especifique el subelemento **RetainShellDB** con los demás subelementos del elemento primario **TuningOptions** .</span><span class="sxs-lookup"><span data-stu-id="46497-130">In the XML input file, specify the **RetainShellDB** subelement with the other sub elements under the **TuningOptions** parent element.</span></span> <span data-ttu-id="46497-131">El uso de estas opciones hace que el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] mantenga la base de datos de shell.</span><span class="sxs-lookup"><span data-stu-id="46497-131">Using these options causes [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor to retain the shell database.</span></span> <span data-ttu-id="46497-132">Para obtener más información, vea [Referencia del archivo de entrada XML &#40;Asistente para la optimización de motor de base de datos&#41;](database-engine-tuning-advisor.md).</span><span class="sxs-lookup"><span data-stu-id="46497-132">For more information, see [XML Input File Reference &#40;Database Engine Tuning Advisor&#41;](database-engine-tuning-advisor.md).</span></span>  
  
-   <span data-ttu-id="46497-133">Después de una sesión de optimización correcta en un servidor de producción o de prueba, pueden quedar bases de datos de shell en el servidor de prueba, aunque no se haya especificado la opción **RetainShellDB** .</span><span class="sxs-lookup"><span data-stu-id="46497-133">Shell databases may be left behind on the test server after a successful test server/production server tuning session even if you have not specified the **RetainShellDB** subelement.</span></span> <span data-ttu-id="46497-134">Estas bases de datos de shell no deseadas pueden interferir con las sesiones de optimización posteriores y se deben quitar antes de ejecutar otra sesión de optimización del servidor de prueba o de producción.</span><span class="sxs-lookup"><span data-stu-id="46497-134">These unwanted shell databases may interfere with subsequent tuning sessions and should be dropped before performing another test server/production server tuning session.</span></span> <span data-ttu-id="46497-135">Además, si una sesión de optimización se cierra de forma inesperada, las bases de datos de shell en el servidor de prueba y los objetos que hay en esas bases de datos se pueden quedar en el servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-135">In addition, if a tuning session exits unexpectedly, the shell databases on the test server and the objects within those databases may be left behind on the test server.</span></span> <span data-ttu-id="46497-136">También debe eliminar estas bases de datos y objetos antes de iniciar una nueva sesión de optimización del servidor de prueba o de producción.</span><span class="sxs-lookup"><span data-stu-id="46497-136">You should also delete these databases and objects before starting a new test server/production server tuning session.</span></span>  
  
## <a name="issues-related-to-the-tuning-process"></a><span data-ttu-id="46497-137">Problemas relacionados con el proceso de optimización</span><span class="sxs-lookup"><span data-stu-id="46497-137">Issues Related to the Tuning Process</span></span>  
  
-   <span data-ttu-id="46497-138">El usuario debe comprobar si el registro de optimización contiene errores de optimización derivados de las diferencias entre los servidores de producción y de prueba, y errores derivados de copiar metadatos del servidor de producción en el de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-138">The user must check the tuning log for tuning errors that result from differences between the production and test servers, and for errors that result from copying metadata from the production to the test server.</span></span> <span data-ttu-id="46497-139">Por ejemplo, es posible que no exista ningún inicio de sesión de usuario en el servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-139">For example, a user login may not exist on the test server.</span></span> <span data-ttu-id="46497-140">Si no existe ningún inicio de sesión de usuario en el servidor de prueba, es posible que los eventos de la carga de trabajo emitidos por ese inicio de sesión de usuario no puedan optimizarse.</span><span class="sxs-lookup"><span data-stu-id="46497-140">If a user login does not exist on the test server, those events in the workload that are issued by that user login may not be tunable.</span></span> <span data-ttu-id="46497-141">Utilice la GUI del Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] para ver el registro de optimización.</span><span class="sxs-lookup"><span data-stu-id="46497-141">Use the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor GUI to view the tuning log.</span></span> <span data-ttu-id="46497-142">Para obtener más información, vea [Ver y trabajar con la salida del Asistente para la optimización de motor de base de datos](view-and-work-with-the-output-from-the-database-engine-tuning-advisor.md).</span><span class="sxs-lookup"><span data-stu-id="46497-142">For more information, see [View and Work with the Output from the Database Engine Tuning Advisor](view-and-work-with-the-output-from-the-database-engine-tuning-advisor.md)</span></span>  
  
-   <span data-ttu-id="46497-143">Si el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] no puede optimizar muchos eventos porque faltan objetos en la base de datos de shell que crea el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] en el servidor de prueba, el usuario debe comprobar el registro de optimización.</span><span class="sxs-lookup"><span data-stu-id="46497-143">If [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor cannot tune many events because objects are missing in the shell database that [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor creates on the test server, the user must check the tuning log.</span></span> <span data-ttu-id="46497-144">Los eventos que no se pueden optimizar aparecen en el registro.</span><span class="sxs-lookup"><span data-stu-id="46497-144">Events that cannot be tuned are listed in the log.</span></span> <span data-ttu-id="46497-145">Para optimizar correctamente la base de datos en el servidor de prueba, el usuario debe crear los objetos que faltan en la base de datos de shell y, a continuación, iniciar una nueva sesión de optimización.</span><span class="sxs-lookup"><span data-stu-id="46497-145">To successfully tune the database on the test server, the user must create the missing objects in the shell database, and then start a new tuning session.</span></span>  
  
-   <span data-ttu-id="46497-146">Si ya existe una base de datos con el mismo nombre en el servidor de prueba, el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] no copia los metadatos, sino que sigue optimizando y recopila las estadísticas según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="46497-146">If a database with the same name already exists on the test server, [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor does not copy metadata, but continues tuning and gathers statistics as necessary.</span></span> <span data-ttu-id="46497-147">Esto resulta útil si el usuario ya ha creado una base de datos en el servidor de prueba y ha copiado los metadatos apropiados antes de invocar al Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="46497-147">This is useful if the user has already created a database on the test server and has copied the appropriate metadata before invoking [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor.</span></span>  
  
-   <span data-ttu-id="46497-148">Si la opción DATE_CORRELATION_OPTIMIZATION está activada para una base de datos en el servidor de producción, no se genera un script completo de los metadatos y los datos asociados a esta opción durante la optimización del servidor de prueba.</span><span class="sxs-lookup"><span data-stu-id="46497-148">If the DATE_CORRELATION_OPTIMIZATION option is turned on for a database on the production server, metadata and the data associated with this option are not completely scripted while tuning the test server.</span></span> <span data-ttu-id="46497-149">Cuando se lleva a cabo la optimización para un escenario de servidor de prueba/servidor de producción, es posible que surjan los problemas siguientes:</span><span class="sxs-lookup"><span data-stu-id="46497-149">When tuning is performed for a test server/production server scenario, the following issues may apply:</span></span>  
  
    -   <span data-ttu-id="46497-150">Los usuarios pueden tener distintos planes de consulta en los servidores para las consultas que utilizan la opción DATE_CORRELATION_OPTIMIZATION.</span><span class="sxs-lookup"><span data-stu-id="46497-150">Users can have different query plans on the servers for queries that use the DATE_CORRELATION_OPTIMIZATION option.</span></span>  
  
    -   [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-151">El Asistente para la optimización puede sugerir que se quiten las vistas indexadas que fuerzan la opción DATE_CORRELATION_OPTIMIZATION en el script de recomendación.</span><span class="sxs-lookup"><span data-stu-id="46497-151">Tuning Advisor may suggest dropping indexed views that enforce the DATE_CORRELATION_OPTIMIZATION option in the recommendation script.</span></span>  
  
     <span data-ttu-id="46497-152">Por lo tanto, es posible que desee omitir las recomendaciones que haga el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] sobre las vistas indizadas que mantienen las estadísticas de correlación porque el Asistente para la optimización de [!INCLUDE[ssDE](../../includes/ssde-md.md)] conoce sus costos, pero no sus ventajas.</span><span class="sxs-lookup"><span data-stu-id="46497-152">Therefore, you may want to ignore any recommendations that [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor makes about the indexed views that hold correlation statistics because [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor knows their costs but not their benefits.</span></span> [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="46497-153">Es posible que el Asistente para la optimización no recomiende la selección de ciertos índices, como los índices agrupados en las columnas **datetime** , lo que puede ser beneficioso cuando la opción DATE_CORRELATION_OPTIMIZATION está habilitada.</span><span class="sxs-lookup"><span data-stu-id="46497-153">Tuning Advisor may not recommend selection of certain indexes such as clustered indexes on **datetime** columns, which could be beneficial when DATE_CORRELATION_OPTIMIZATION is enabled.</span></span>  
  
     <span data-ttu-id="46497-154">Para saber si una vista se basa en las estadísticas de correlación, seleccione la columna **is_date_correlation_view** de la vista de catálogo [sys.views](/sql/relational-databases/system-catalog-views/sys-views-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="46497-154">To determine if a view is based on correlation statistics, select the **is_date_correlation_view** column of the [sys.views](/sql/relational-databases/system-catalog-views/sys-views-transact-sql) catalog view.</span></span>  
  
  
