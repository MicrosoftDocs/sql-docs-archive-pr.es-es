---
title: Actualización de datos en cursores de SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- updating data [SQL Server]
- isolation levels [SQL Server]
- delayed update mode [OLE DB]
- immediate update mode [OLE DB]
- cursors [OLE DB]
- data updates [SQL Server], OLE DB
ms.assetid: 732dafee-f2d5-4aef-aad7-3a8bf3b1e876
author: rothja
ms.author: jroth
ms.openlocfilehash: 42e6221a85c30e3adb97df3a11c9cbdc49216b4d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87670366"
---
# <a name="updating-data-in-sql-server-cursors"></a><span data-ttu-id="5fff1-102">Actualizar datos en cursores de SQL Server</span><span class="sxs-lookup"><span data-stu-id="5fff1-102">Updating Data in SQL Server Cursors</span></span>
  <span data-ttu-id="5fff1-103">Al capturar y actualizar datos a través de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursores, una [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] aplicación de consumidor de proveedor de OLE DB de cliente nativa está limitada por las mismas consideraciones y restricciones que se aplican a cualquier otra aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="5fff1-103">When fetching and updating data through [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer application is bound by the same considerations and constraints that apply to any other client application.</span></span>  
  
 <span data-ttu-id="5fff1-104">Solo las filas de cursores de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] participan en el control del acceso simultáneo a datos.</span><span class="sxs-lookup"><span data-stu-id="5fff1-104">Only rows in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors participate in concurrent data-access control.</span></span> <span data-ttu-id="5fff1-105">Cuando el consumidor solicita un conjunto de filas modificable, DBPROP_LOCKMODE controla el control de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="5fff1-105">When the consumer requests a modifiable rowset, the concurrency control is controlled by DBPROP_LOCKMODE.</span></span> <span data-ttu-id="5fff1-106">Para modificar el nivel de control de acceso simultáneo, el consumidor establece la propiedad DBPROP_LOCKMODE antes de abrir el conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="5fff1-106">To modify the level of concurrent access control, the consumer sets the DBPROP_LOCKMODE property before opening the rowset.</span></span>  
  
 <span data-ttu-id="5fff1-107">Los niveles de aislamiento de las transacciones pueden producir diferencias significativas en la posición de las filas si el diseño de la aplicación cliente permite que las transacciones permanezcan abiertas durante largos períodos de tiempo.</span><span class="sxs-lookup"><span data-stu-id="5fff1-107">Transaction isolation levels can cause significant lags in row positioning if client application design lets transactions remain open for long periods of time.</span></span> <span data-ttu-id="5fff1-108">De forma predeterminada, el [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client utiliza el nivel de aislamiento de lectura confirmada especificado por DBPROPVAL_TI_READCOMMITTED.</span><span class="sxs-lookup"><span data-stu-id="5fff1-108">By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the read-committed isolation level specified by DBPROPVAL_TI_READCOMMITTED.</span></span> <span data-ttu-id="5fff1-109">El [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite el aislamiento de lectura Dirty cuando la simultaneidad del conjunto de filas es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="5fff1-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports dirty read isolation when the rowset concurrency is read-only.</span></span> <span data-ttu-id="5fff1-110">Por consiguiente, el consumidor puede solicitar un nivel superior de aislamiento en un conjunto de filas modificable pero no puede solicitar con éxito un nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="5fff1-110">Therefore, the consumer can request a higher level of isolation in a modifiable rowset but cannot request any lower level successfully.</span></span>  
  
## <a name="immediate-and-delayed-update-modes"></a><span data-ttu-id="5fff1-111">Modos de actualización inmediata y retrasada</span><span class="sxs-lookup"><span data-stu-id="5fff1-111">Immediate and Delayed Update Modes</span></span>  
 <span data-ttu-id="5fff1-112">En el modo de actualización inmediata, cada llamada a **IRowsetChange::SetData** produce un recorrido de ida y vuelta a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5fff1-112">In immediate update mode, each call to **IRowsetChange::SetData** causes a round trip to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="5fff1-113">Si el consumidor realiza varios cambios en una única fila, resulta más eficaz enviar todos los cambios con una única llamada a **SetData**.</span><span class="sxs-lookup"><span data-stu-id="5fff1-113">If the consumer makes multiple changes to a single row, it is more efficient to submit all changes with a single **SetData** call.</span></span>  
  
 <span data-ttu-id="5fff1-114">En el modo de actualización retrasada, se realiza un recorrido de ida y vuelta a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para cada fila indicada en los parámetros *cRows* y *rghRows* de **IRowsetUpdate::Update**.</span><span class="sxs-lookup"><span data-stu-id="5fff1-114">In delayed update mode, a roundtrip is made to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] for each row indicated in the *cRows* and *rghRows* parameters of **IRowsetUpdate::Update**.</span></span>  
  
 <span data-ttu-id="5fff1-115">En ambos modos, un viaje de ida y vuelta representa una transacción distinta cuando no queda abierto ningún objeto de transacción para el conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="5fff1-115">In either mode, a roundtrip represents a distinct transaction when no transaction object is open for the rowset.</span></span>  
  
 <span data-ttu-id="5fff1-116">Cuando se usa **IRowsetUpdate:: Update**, el [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client intenta procesar cada fila indicada.</span><span class="sxs-lookup"><span data-stu-id="5fff1-116">When you are using **IRowsetUpdate::Update**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider tries to process each indicated row.</span></span> <span data-ttu-id="5fff1-117">Se produce un error debido a que los valores de estado, longitud o datos no válidos de una fila no detienen el [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] procesamiento de proveedor de OLE DB de cliente nativo.</span><span class="sxs-lookup"><span data-stu-id="5fff1-117">An error occurring because of invalid data, length, or status values for any row does not stop [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider processing.</span></span> <span data-ttu-id="5fff1-118">Se pueden modificar todas o ninguna de las demás filas que participan en la actualización.</span><span class="sxs-lookup"><span data-stu-id="5fff1-118">All or none of the other rows participating in the update may be modified.</span></span> <span data-ttu-id="5fff1-119">El consumidor debe examinar la matriz *prgRowStatus* devuelta para determinar el error de cualquier fila concreta cuando el [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client devuelve DB_S_ERRORSOCCURRED.</span><span class="sxs-lookup"><span data-stu-id="5fff1-119">The consumer must examine the returned *prgRowStatus* array to determine failure for any specific row when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED.</span></span>  
  
 <span data-ttu-id="5fff1-120">Un consumidor no debe suponer que las filas se procesan en un orden determinado.</span><span class="sxs-lookup"><span data-stu-id="5fff1-120">A consumer should not assume that rows are processed in any specific order.</span></span> <span data-ttu-id="5fff1-121">Si un consumidor necesita el procesamiento ordenado de modificación de datos en más de una fila, debe establecer ese orden en la lógica de la aplicación y abrir una transacción para incluir en ella el proceso.</span><span class="sxs-lookup"><span data-stu-id="5fff1-121">If a consumer requires ordered processing of data modification over more than a single row, the consumer should establish that order in the application logic and open a transaction to enclose the process.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5fff1-122">Consulte también</span><span class="sxs-lookup"><span data-stu-id="5fff1-122">See Also</span></span>  
 [<span data-ttu-id="5fff1-123">Actualizar datos en conjuntos de filas</span><span class="sxs-lookup"><span data-stu-id="5fff1-123">Updating Data in Rowsets</span></span>](updating-data-in-rowsets.md)  
  
  
