---
title: Captura de filas | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- fetching rows
- OLE DB rowsets, fetching
- rowsets [OLE DB], fetching
- IRowset interface
- SQL Server Native Client OLE DB provider, fetching
ms.assetid: 5e6dbe36-b682-464d-adfa-8e886f9bd452
author: rothja
ms.author: jroth
ms.openlocfilehash: 435e1d705091814b2544c75772f20882caddf942
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669662"
---
# <a name="fetching-rows"></a><span data-ttu-id="778d2-102">Capturar filas</span><span class="sxs-lookup"><span data-stu-id="778d2-102">Fetching Rows</span></span>
  <span data-ttu-id="778d2-103">La interfaz **IRowset** es la interfaz de conjunto de filas base.</span><span class="sxs-lookup"><span data-stu-id="778d2-103">The **IRowset** interface is the base rowset interface.</span></span> <span data-ttu-id="778d2-104">La interfaz **IRowset** proporciona métodos para capturar filas secuencialmente, obtiene los datos de esas filas y administra las filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-104">The **IRowset** interface provides methods for fetching rows sequentially, getting the data from those rows, and managing rows.</span></span> <span data-ttu-id="778d2-105">Los consumidores usan los métodos de **IRowset** para todas las operaciones básicas de conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-105">Consumers use the methods in **IRowset** for all basic rowset operations.</span></span> <span data-ttu-id="778d2-106">Esto incluye la captura y liberación de filas y la obtención de los valores de columna.</span><span class="sxs-lookup"><span data-stu-id="778d2-106">This includes fetching and releasing rows and getting column values.</span></span>  
  
 <span data-ttu-id="778d2-107">Cuando un consumidor obtiene un puntero de interfaz en un conjunto de filas, el primer paso normalmente es determinar las funciones del conjunto de filas con el método **IRowsetInfo::GetProperties**.</span><span class="sxs-lookup"><span data-stu-id="778d2-107">When a consumer obtains an interface pointer on a rowset, the first step is ordinarily to determine the capabilities of the rowset by using the **IRowsetInfo::GetProperties** method.</span></span> <span data-ttu-id="778d2-108">Esto devuelve información acerca de las interfaces expuestas por el conjunto de filas y también de las capacidades del conjunto de filas que no se presentan como interfaces distintas, como el número máximo de filas activas y el número de filas que pueden tener actualizaciones pendientes al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="778d2-108">This returns information about the interfaces exposed by the rowset and also capabilities of the rowset that do not show up as distinct interfaces, such as the maximum number of active rows and the number of rows that can have pending updates at the same time.</span></span>  
  
 <span data-ttu-id="778d2-109">El paso siguiente para los consumidores es determinar las características, o los metadatos, de las columnas del conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-109">The next step for consumers is to determine the characteristics, or metadata, of the columns in the rowset.</span></span> <span data-ttu-id="778d2-110">Para esto, usan el método **IColumnsInfo** para la información de columna simple o el método **IColumnsRowset** para la información de columna extendida.</span><span class="sxs-lookup"><span data-stu-id="778d2-110">For this they use the **IColumnsInfo** method for simple column information or the **IColumnsRowset** method for extended column information.</span></span> <span data-ttu-id="778d2-111">El método **GetColumnInfo** devuelve la información siguiente:</span><span class="sxs-lookup"><span data-stu-id="778d2-111">The **GetColumnInfo** method returns the following information:</span></span>  
  
-   <span data-ttu-id="778d2-112">El número de columnas del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="778d2-112">The number of columns in the result set.</span></span>  
  
-   <span data-ttu-id="778d2-113">Una matriz de estructuras DBCOLUMNINFO, una por columna.</span><span class="sxs-lookup"><span data-stu-id="778d2-113">An array of DBCOLUMNINFO structures, one per column.</span></span>  
  
     <span data-ttu-id="778d2-114">El orden de las estructuras es el orden en que las columnas aparecen en el conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-114">The order of the structures is the order in which the columns appear in the rowset.</span></span> <span data-ttu-id="778d2-115">Cada estructura DBCOLUMNINFO incluye los metadatos de columna, como el nombre de la columna, el ordinal de la columna, la longitud máxima posible de un valor de la columna, el tipo de datos de la columna, la precisión y la longitud.</span><span class="sxs-lookup"><span data-stu-id="778d2-115">Each DBCOLUMNINFO structure includes column metadata, such as column name, ordinal of the column, maximum possible length of a value in the column, data type of the column, precision, and length.</span></span>  
  
-   <span data-ttu-id="778d2-116">El puntero a un almacenamiento para todos los valores de cadena dentro de un bloque de asignación único.</span><span class="sxs-lookup"><span data-stu-id="778d2-116">The pointer to a storage for all string values within a single allocation block.</span></span>  
  
 <span data-ttu-id="778d2-117">El consumidor determina qué columnas necesita basándose en los metadatos o en el comando de texto que generó el conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-117">The consumer determines which columns it needs either from the metadata or based on the text command that generated the rowset.</span></span> <span data-ttu-id="778d2-118">Determina los ordinales de las columnas necesarias de la clasificación de la información de columna devuelta por **IColumnsInfo** o de los ordinales del conjunto de filas de metadatos de columna devueltos por **IColumnsRowset**.</span><span class="sxs-lookup"><span data-stu-id="778d2-118">It determines the ordinals of the needed columns from the ordering of the column information returned by **IColumnsInfo** or from the ordinals in the column metadata rowset returned by **IColumnsRowset**.</span></span>  
  
 <span data-ttu-id="778d2-119">Las interfaces **IColumnsInfo** e **IColumnsRowset** se usan para extraer información sobre las columnas del conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-119">The **IColumnsInfo** and **IColumnsRowset** interfaces are used to extract information about the columns in the rowset.</span></span> <span data-ttu-id="778d2-120">La interfaz **IColumnsInfo** devuelve un conjunto limitado de información, mientras que **IColumnsRowset** proporciona todos los metadatos.</span><span class="sxs-lookup"><span data-stu-id="778d2-120">The **IColumnsInfo** interface returns a limited set of information, whereas **IColumnsRowset** provides all the metadata.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="778d2-121">En [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] versión 7.0 y anteriores, la columna de metadatos opcional DBCOLUMN_COMPUTEMODE devuelta por **IColumnsInfo::GetColumnsInfo** devuelve DBSTATUS_S_ISNULL (en lugar de los valores que describen si se calcula la columna) porque no se puede determinar si se calcula la columna subyacente.</span><span class="sxs-lookup"><span data-stu-id="778d2-121">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 and earlier, the optional metadata column DBCOLUMN_COMPUTEMODE returned by **IColumnsInfo::GetColumnsInfo** returns DBSTATUS_S_ISNULL (instead of the values describing whether the column is computed) because it cannot be determined whether the underlying column is computed.</span></span>  
  
 <span data-ttu-id="778d2-122">Los ordinales se utilizan para especificar un enlace a una columna.</span><span class="sxs-lookup"><span data-stu-id="778d2-122">The ordinals are used to specify a binding to a column.</span></span> <span data-ttu-id="778d2-123">Un enlace es una estructura que asocia un elemento de la estructura del consumidor a una columna.</span><span class="sxs-lookup"><span data-stu-id="778d2-123">A binding is a structure that associates an element of the consumer's structure with a column.</span></span> <span data-ttu-id="778d2-124">El enlace puede enlazar el valor de datos, la longitud y el valor de estado de la columna.</span><span class="sxs-lookup"><span data-stu-id="778d2-124">The binding can bind the data value, length, and status value of the column.</span></span>  
  
 <span data-ttu-id="778d2-125">Un conjunto de enlaces se reúne en un descriptor de acceso.</span><span class="sxs-lookup"><span data-stu-id="778d2-125">A set of bindings is gathered together in an accessor.</span></span> <span data-ttu-id="778d2-126">Esto se crea con el método **IAccessor::CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="778d2-126">This is created by using the **IAccessor::CreateAccessor** method.</span></span> <span data-ttu-id="778d2-127">Un descriptor de acceso puede contener varios enlaces para que se puedan recuperar los datos de varias columnas o establecerse en una llamada única.</span><span class="sxs-lookup"><span data-stu-id="778d2-127">An accessor can contain multiple bindings so that the data for multiple columns can be retrieved or set in a single call.</span></span> <span data-ttu-id="778d2-128">El consumidor puede crear varios descriptores de acceso para coincidir con modelos de uso distintos en distintas partes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="778d2-128">The consumer can create several accessors to match different usage patterns in different parts of the application.</span></span> <span data-ttu-id="778d2-129">Puede crear y liberar los descriptores de acceso mientras que el conjunto de filas sigue existiendo.</span><span class="sxs-lookup"><span data-stu-id="778d2-129">It can create and release accessors while the rowset remains in existence.</span></span>  
  
 <span data-ttu-id="778d2-130">Para capturar filas de la base de datos, el consumidor llama a un método, como **IRowset::GetNextRows** o **IRowsetLocate::GetRowsAt**.</span><span class="sxs-lookup"><span data-stu-id="778d2-130">To fetch rows from the database, the consumer calls a method, such as **IRowset::GetNextRows** or **IRowsetLocate::GetRowsAt**.</span></span> <span data-ttu-id="778d2-131">Estas operaciones de captura colocan los datos de filas del servidor en el búfer de filas del proveedor.</span><span class="sxs-lookup"><span data-stu-id="778d2-131">These fetch operations put row data from the server into the row buffer of the provider.</span></span> <span data-ttu-id="778d2-132">El consumidor no tiene acceso directo al búfer de filas del proveedor.</span><span class="sxs-lookup"><span data-stu-id="778d2-132">The consumer does not have direct access to the row buffer of the provider.</span></span> <span data-ttu-id="778d2-133">El consumidor usa **IRowset::GetData** para copiar los datos del búfer del proveedor en el búfer del consumidor e **IRowsetChange::SetData** para copiar los cambios de datos del búfer del consumidor en el búfer del proveedor.</span><span class="sxs-lookup"><span data-stu-id="778d2-133">The consumer uses **IRowset::GetData** to copy data from the buffer of the provider to the consumer buffer and **IRowsetChange::SetData** to copy data changes from the consumer buffer to the provider buffer.</span></span>  
  
 <span data-ttu-id="778d2-134">El consumidor llama al método **GetData** y pasa el identificador a una fila, el identificador a un descriptor de acceso, y un puntero a un búfer asignado por el consumidor.</span><span class="sxs-lookup"><span data-stu-id="778d2-134">The consumer calls the **GetData** method and passes the handle to a row, the handle to an accessor, and a pointer to a consumer-allocated buffer.</span></span> <span data-ttu-id="778d2-135">**GetData** convierte los datos y devuelve las columnas como se especifica en los enlaces usados para crear el descriptor de acceso.</span><span class="sxs-lookup"><span data-stu-id="778d2-135">**GetData** converts the data and returns the columns as specified in the bindings used to create the accessor.</span></span> <span data-ttu-id="778d2-136">El consumidor puede llamar a **GetData** más de una vez para una fila, con descriptores de acceso y búferes distintos y, por tanto, el consumidor puede obtener varias copias de los mismos datos.</span><span class="sxs-lookup"><span data-stu-id="778d2-136">The consumer can call **GetData** more than one time for a row, using different accessors and buffers and therefore the consumer can obtain multiple copies of the same data.</span></span>  
  
 <span data-ttu-id="778d2-137">Los datos de las columnas de longitud variable se pueden tratar de varias maneras.</span><span class="sxs-lookup"><span data-stu-id="778d2-137">Data from variable-length columns can be treated several ways.</span></span> <span data-ttu-id="778d2-138">Primero, tales columnas se pueden enlazar a una sección finita de la estructura del consumidor.</span><span class="sxs-lookup"><span data-stu-id="778d2-138">First, such columns can be bound to a finite section of the consumer's structure.</span></span> <span data-ttu-id="778d2-139">Esto produce un truncamiento cuando la longitud de los datos supera la longitud del búfer.</span><span class="sxs-lookup"><span data-stu-id="778d2-139">This causes truncation when the length of the data exceeds the length of the buffer.</span></span> <span data-ttu-id="778d2-140">El consumidor puede determinar que se ha producido ese truncamiento comprobando el estado DBSTATUS_S_TRUNCATED.</span><span class="sxs-lookup"><span data-stu-id="778d2-140">The consumer can determine that truncation has occurred by checking for the status DBSTATUS_S_TRUNCATED.</span></span> <span data-ttu-id="778d2-141">La longitud devuelta siempre es la longitud verdadera en bytes, para que el consumidor pueda determinar también cuántos datos se han truncado.</span><span class="sxs-lookup"><span data-stu-id="778d2-141">The returned length is always the true length in bytes, so that the consumer also can determine how much data was truncated.</span></span>  
  
 <span data-ttu-id="778d2-142">Cuando el consumidor ha finalizado la captura o actualización de las filas, las libera con el método **ReleaseRows**.</span><span class="sxs-lookup"><span data-stu-id="778d2-142">When the consumer has finished fetching or updating rows, it releases them with the **ReleaseRows** method.</span></span> <span data-ttu-id="778d2-143">Esto libera los recursos de la copia de las filas del conjunto de filas y crea espacio para las nuevas filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-143">This releases resources from the copy of the rows in the rowset and makes room for new rows.</span></span> <span data-ttu-id="778d2-144">A continuación, el consumidor puede repetir su ciclo de captura o creación de filas y obtener acceso a los datos de ellas.</span><span class="sxs-lookup"><span data-stu-id="778d2-144">The consumer can then repeat its cycle of fetching or creating rows and accessing the data in them.</span></span>  
  
 <span data-ttu-id="778d2-145">Cuando el consumidor ha finalizado con el conjunto de filas, llama al método **IAccessor::ReleaseAccessor** para liberar los descriptores de acceso.</span><span class="sxs-lookup"><span data-stu-id="778d2-145">When the consumer is finished with the rowset, it calls the **IAccessor::ReleaseAccessor** method to release any accessor.</span></span> <span data-ttu-id="778d2-146">Llama al método **IUnknown::Release** en todas las interfaces expuestas por el conjunto de filas para liberar el conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="778d2-146">It calls the **IUnknown::Release** method on all interfaces exposed by the rowset to release the rowset.</span></span> <span data-ttu-id="778d2-147">Cuando se libera el conjunto de filas, fuerza la liberación de las filas o descriptores de acceso restantes que el consumidor pueda contener.</span><span class="sxs-lookup"><span data-stu-id="778d2-147">When the rowset is released, it forces the release of any remaining rows or accessors the consumer may hold.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="778d2-148">En esta sección</span><span class="sxs-lookup"><span data-stu-id="778d2-148">In This Section</span></span>  
  
-   [<span data-ttu-id="778d2-149">Posición de captura siguiente</span><span class="sxs-lookup"><span data-stu-id="778d2-149">Next Fetch Position</span></span>](fetching-rows-next-fetch-position.md)  
  
## <a name="see-also"></a><span data-ttu-id="778d2-150">Consulte también</span><span class="sxs-lookup"><span data-stu-id="778d2-150">See Also</span></span>  
 [<span data-ttu-id="778d2-151">Conjuntos de filas</span><span class="sxs-lookup"><span data-stu-id="778d2-151">Rowsets</span></span>](rowsets.md)  
  
  
