---
title: Implementación de la compresión de página | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- page compression [Database Engine]
- compression [SQL Server], page
ms.assetid: 78c83277-1dbb-4e07-95bd-47b14d2b5cd4
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e6edba79d1548d68e60f406d370abd5354a62fcb
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87675991"
---
# <a name="page-compression-implementation"></a><span data-ttu-id="62674-102">Implementación de la compresión de página</span><span class="sxs-lookup"><span data-stu-id="62674-102">Page Compression Implementation</span></span>
  <span data-ttu-id="62674-103">En este tema se resume cómo el [!INCLUDE[ssDE](../../includes/ssde-md.md)] implementa la compresión de página.</span><span class="sxs-lookup"><span data-stu-id="62674-103">This topic summarizes how the [!INCLUDE[ssDE](../../includes/ssde-md.md)] implements page compression.</span></span> <span data-ttu-id="62674-104">Este resumen proporciona la información básica para ayudarle a planear el espacio de almacenamiento que necesita para sus datos.</span><span class="sxs-lookup"><span data-stu-id="62674-104">This summary provides basic information to help you plan the storage space that you need for your data.</span></span>  
  
 <span data-ttu-id="62674-105">La compresión de página es similar para las tablas, las particiones de tabla, los índices y las particiones de índice.</span><span class="sxs-lookup"><span data-stu-id="62674-105">Page compression is similar for tables, table partitions, indexes, and index partitions.</span></span> <span data-ttu-id="62674-106">La descripción siguiente de la compresión de página para una tabla se aplica a la compresión de página para todos los tipos de objeto.</span><span class="sxs-lookup"><span data-stu-id="62674-106">The following description of page compression for a table applies equally to page compression for all object types.</span></span> <span data-ttu-id="62674-107">En los ejemplos siguientes se comprimen las cadenas de caracteres, pero la compresión de prefijo y de diccionario aplican los mismos principios a otros tipos de datos.</span><span class="sxs-lookup"><span data-stu-id="62674-107">The following examples compress character strings, but both prefix and dictionary compression apply the same principles to other data types.</span></span>  
  
 <span data-ttu-id="62674-108">El proceso de compresión del nivel hoja de tablas y índices mediante compresión de página consta de tres operaciones, según el siguiente orden:</span><span class="sxs-lookup"><span data-stu-id="62674-108">Compressing the leaf level of tables and indexes with page compression consists of three operations in the following order:</span></span>  
  
1.  <span data-ttu-id="62674-109">Compresión de fila</span><span class="sxs-lookup"><span data-stu-id="62674-109">Row compression</span></span>  
  
2.  <span data-ttu-id="62674-110">Compresión de prefijo</span><span class="sxs-lookup"><span data-stu-id="62674-110">Prefix compression</span></span>  
  
3.  <span data-ttu-id="62674-111">Compresión de diccionario</span><span class="sxs-lookup"><span data-stu-id="62674-111">Dictionary compression</span></span>  
  
 <span data-ttu-id="62674-112">Al usar la compresión de página, las páginas que no están en el nivel hoja de los índices se comprimen usando únicamente la compresión de fila.</span><span class="sxs-lookup"><span data-stu-id="62674-112">When you use page compression, non-leaf-level pages of indexes are compressed by using only row compression.</span></span> <span data-ttu-id="62674-113">Para obtener más información acerca de la compresión de fila, vea [Row Compression Implementation](../data-compression/row-compression-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="62674-113">For more information about row compression, see [Row Compression Implementation](../data-compression/row-compression-implementation.md).</span></span>  
  
## <a name="prefix-compression"></a><span data-ttu-id="62674-114">Compresión de prefijo</span><span class="sxs-lookup"><span data-stu-id="62674-114">Prefix Compression</span></span>  
 <span data-ttu-id="62674-115">Para cada página que se comprime, la compresión de prefijo utiliza los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="62674-115">For each page that is being compressed, prefix compression uses the following steps:</span></span>  
  
1.  <span data-ttu-id="62674-116">Para cada columna, se identifica un valor que se puede utilizar para reducir el espacio de almacenamiento de los valores de cada columna.</span><span class="sxs-lookup"><span data-stu-id="62674-116">For each column, a value is identified that can be used to reduce the storage space for the values in each column.</span></span>  
  
2.  <span data-ttu-id="62674-117">Una fila que representa los valores de prefijo para cada columna se crea y se almacena en la estructura de información de compresión (CI), situada inmediatamente después del encabezado de página.</span><span class="sxs-lookup"><span data-stu-id="62674-117">A row that represents the prefix values for each column is created and stored in the compression information (CI) structure that immediately follows the page header.</span></span>  
  
3.  <span data-ttu-id="62674-118">Los valores de prefijo repetidos en la columna se sustituyen por una referencia al prefijo correspondiente.</span><span class="sxs-lookup"><span data-stu-id="62674-118">The repeated prefix values in the column are replaced by a reference to the corresponding prefix.</span></span> <span data-ttu-id="62674-119">Si el valor de una fila no coincide exactamente con el valor de prefijo seleccionado, se puede indicar una coincidencia parcial.</span><span class="sxs-lookup"><span data-stu-id="62674-119">If the value in a row does not exactly match the selected prefix value, a partial match can still be indicated.</span></span>  
  
 <span data-ttu-id="62674-120">En la siguiente ilustración se muestra un ejemplo de página de una tabla antes de la compresión de prefijo.</span><span class="sxs-lookup"><span data-stu-id="62674-120">The following illustration shows a sample page of a table before prefix compression.</span></span>  
  
 <span data-ttu-id="62674-121">![Página antes de la compresión del prefijo](../media/skt-tblcompression1c.gif "Página antes de la compresión del prefijo")</span><span class="sxs-lookup"><span data-stu-id="62674-121">![Page before prefix compression](../media/skt-tblcompression1c.gif "Page before prefix compression")</span></span>  
  
 <span data-ttu-id="62674-122">En la ilustración siguiente se muestra la misma página después de la compresión de prefijo.</span><span class="sxs-lookup"><span data-stu-id="62674-122">The following illustration shows the same page after prefix compression.</span></span> <span data-ttu-id="62674-123">El prefijo se mueva al encabezado y los valores de columna se cambian a referencias al prefijo.</span><span class="sxs-lookup"><span data-stu-id="62674-123">The prefix is moved to the header, and the column values are changed to references to the prefix.</span></span>  
  
 <span data-ttu-id="62674-124">![Página después de la compresión del prefijo](../media/tblcompression2.gif "Página después de la compresión del prefijo")</span><span class="sxs-lookup"><span data-stu-id="62674-124">![Page after prefix compression](../media/tblcompression2.gif "Page after prefix compression")</span></span>  
  
 <span data-ttu-id="62674-125">En la primera columna de la primera fila, el valor 4b indica que los primeros cuatro caracteres del prefijo (aaab) están presentes para esa fila, así como el carácter b.</span><span class="sxs-lookup"><span data-stu-id="62674-125">In the first column of the first row, the value 4b indicates that the first four characters of the prefix (aaab) are present for that row, and also the character b.</span></span> <span data-ttu-id="62674-126">De esta forma, el valor resultante será aaabb, que es el valor original.</span><span class="sxs-lookup"><span data-stu-id="62674-126">This makes the resultant value aaabb, which is the original value.</span></span>  
  
## <a name="dictionary-compression"></a><span data-ttu-id="62674-127">Compresión de diccionario</span><span class="sxs-lookup"><span data-stu-id="62674-127">Dictionary Compression</span></span>  
 <span data-ttu-id="62674-128">Una vez completada la compresión de prefijo, se aplica la compresión de diccionario.</span><span class="sxs-lookup"><span data-stu-id="62674-128">After prefix compression has been completed, dictionary compression is applied.</span></span> <span data-ttu-id="62674-129">La compresión de diccionario busca valores repetidos en cualquier lugar de la página y los almacena en el área de CI.</span><span class="sxs-lookup"><span data-stu-id="62674-129">Dictionary compression searches for repeated values anywhere on the page, and stores them in the CI area.</span></span> <span data-ttu-id="62674-130">A diferencia de la compresión de prefijo, la compresión de diccionario no está restringida a una columna.</span><span class="sxs-lookup"><span data-stu-id="62674-130">Unlike prefix compression, dictionary compression is not restricted to one column.</span></span> <span data-ttu-id="62674-131">La compresión de diccionario puede sustituir a los valores repetidos que se producen en cualquier lugar de una página.</span><span class="sxs-lookup"><span data-stu-id="62674-131">Dictionary compression can replace repeated values that occur anywhere on a page.</span></span> <span data-ttu-id="62674-132">En la ilustración siguiente se muestra la misma página después de la compresión de diccionario.</span><span class="sxs-lookup"><span data-stu-id="62674-132">The following illustration shows the same page after dictionary compression.</span></span>  
  
 <span data-ttu-id="62674-133">![Página después de la compresión del diccionario](../media/tblcompression3.gif "Página después de la compresión del diccionario")</span><span class="sxs-lookup"><span data-stu-id="62674-133">![Page after dictionary compression](../media/tblcompression3.gif "Page after dictionary compression")</span></span>  
  
 <span data-ttu-id="62674-134">Tenga en cuenta que se ha hecho referencia al valor 4b desde distintas columnas de la página.</span><span class="sxs-lookup"><span data-stu-id="62674-134">Note that the value 4b has been referenced from different columns of the page.</span></span>  
  
## <a name="when-page-compression-occurs"></a><span data-ttu-id="62674-135">Momento en el que se produce la compresión de página</span><span class="sxs-lookup"><span data-stu-id="62674-135">When Page Compression Occurs</span></span>  
 <span data-ttu-id="62674-136">Cuando se crea una nueva tabla que tiene compresión de página, no se producirá la compresión.</span><span class="sxs-lookup"><span data-stu-id="62674-136">When a new table is created that has page compression, no compression occurs.</span></span> <span data-ttu-id="62674-137">Sin embargo, los metadatos de la tabla indican que es necesario utilizar la compresión de página.</span><span class="sxs-lookup"><span data-stu-id="62674-137">However, the metadata for the table indicates that page compression should be used.</span></span> <span data-ttu-id="62674-138">A medida que se agregan datos a la primera página de datos, se produce la compresión de fila de los datos.</span><span class="sxs-lookup"><span data-stu-id="62674-138">As data is added to the first data page, data is row-compressed.</span></span> <span data-ttu-id="62674-139">Como la página no está llena, no se obtiene ninguna ventaja de la compresión de página.</span><span class="sxs-lookup"><span data-stu-id="62674-139">Because the page is not full, no benefit is gained from page compression.</span></span> <span data-ttu-id="62674-140">Cuando la página está llena, la siguiente fila que va a agregarse inicia la operación de compresión de página.</span><span class="sxs-lookup"><span data-stu-id="62674-140">When the page is full, the next row to be added initiates the page compression operation.</span></span> <span data-ttu-id="62674-141">La página entera se revisa y cada columna se evalúa para la compresión de prefijo. A continuación, todas las columnas se evalúan para la compresión de diccionario.</span><span class="sxs-lookup"><span data-stu-id="62674-141">The whole page is reviewed; each column is evaluated for prefix compression, and then all columns are evaluated for dictionary compression.</span></span> <span data-ttu-id="62674-142">Si la compresión de página ha creado espacio suficiente en la página para una fila adicional, la fila se agregará y se producirá la compresión de fila y de página de los datos.</span><span class="sxs-lookup"><span data-stu-id="62674-142">If page compression has created enough room on the page for an additional row, the row is added, and the data is both row- and page-compressed.</span></span> <span data-ttu-id="62674-143">Si el resultado del espacio obtenido mediante la compresión de página menos el espacio que se requiere para la estructura CI no es significativo, la compresión de página no se utiliza para esa página.</span><span class="sxs-lookup"><span data-stu-id="62674-143">If the space gained by page compression minus the space that is required for the CI structure is not significant, page compression is not used for that page.</span></span> <span data-ttu-id="62674-144">Las filas subsiguientes se ajustan a la nueva página o, si no caben, se agrega una nueva página a la tabla.</span><span class="sxs-lookup"><span data-stu-id="62674-144">Future rows either fit onto the new page or, if they do not fit, a new page is added to the table.</span></span> <span data-ttu-id="62674-145">Al igual que la primera página, no se realiza la compresión de página de la nueva página al principio.</span><span class="sxs-lookup"><span data-stu-id="62674-145">Similar to the first page, the new page is not at first page-compressed.</span></span>  
  
 <span data-ttu-id="62674-146">Cuando se convierte para la compresión de página una tabla existente con datos, todas las páginas se volverán a crear y evaluar.</span><span class="sxs-lookup"><span data-stu-id="62674-146">When an existing table that contains data is converted to page compression, each page is rebuilt and evaluated.</span></span> <span data-ttu-id="62674-147">La regeneración de todas las páginas hace que se vuelva a generar la tabla, el índice o la partición.</span><span class="sxs-lookup"><span data-stu-id="62674-147">Rebuilding all the pages causes the rebuilding of the table, index, or partition.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="62674-148">Consulte también</span><span class="sxs-lookup"><span data-stu-id="62674-148">See Also</span></span>  
 <span data-ttu-id="62674-149">[Comprimir datos](data-compression.md) </span><span class="sxs-lookup"><span data-stu-id="62674-149">[Data Compression](data-compression.md) </span></span>  
 [<span data-ttu-id="62674-150">Implementación de la compresión de fila</span><span class="sxs-lookup"><span data-stu-id="62674-150">Row Compression Implementation</span></span>](row-compression-implementation.md)  
  
  
