---
title: Actualizar una aplicación desde SQL Server 2005 Native Client | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: rothja
ms.author: jroth
ms.openlocfilehash: 6db02837b854d237607eba7583d204a4860906b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87748742"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a><span data-ttu-id="99e0d-102">Actualizar una aplicación desde SQL Server 2005 Native Client</span><span class="sxs-lookup"><span data-stu-id="99e0d-102">Updating an Application from SQL Server 2005 Native Client</span></span>
  <span data-ttu-id="99e0d-103">En este tema se describen los cambios importantes en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client con respecto a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client en [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99e0d-103">This topic discusses the breaking changes in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client since [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="99e0d-104">Al realizar una actualización de Microsoft Data Access Components (MDAC) a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, también es posible que observe algunas diferencias de comportamiento.</span><span class="sxs-lookup"><span data-stu-id="99e0d-104">When you upgrade from Microsoft Data Access Components (MDAC) to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, you might also see some behavior differences.</span></span> <span data-ttu-id="99e0d-105">Para obtener más información, vea [actualizar una aplicación a SQL Server Native Client desde MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span><span class="sxs-lookup"><span data-stu-id="99e0d-105">For more information, see [Updating an Application to SQL Server Native Client from MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-106">Native Client 9.0 se incluyó en [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99e0d-106">Native Client 9.0 shipped with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-107">Native Client 10.0 se incluyó en [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99e0d-107">Native Client 10.0 shipped with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-108">Native Client 10.5 se incluyó en [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99e0d-108">Native Client 10.5 shipped with [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-109">Native Client 11.0 se incluyó en [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] y [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99e0d-109">Native Client 11.0 shipped with [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] and [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span>  
  
|<span data-ttu-id="99e0d-110">Cambios de comportamiento en SQL Server Native Client desde [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span><span class="sxs-lookup"><span data-stu-id="99e0d-110">Changed behavior in SQL Server Native Client Since [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span></span>|<span data-ttu-id="99e0d-111">Descripción</span><span class="sxs-lookup"><span data-stu-id="99e0d-111">Description</span></span>|  
|------------------------------------------------------------------------------------|-----------------|  
|<span data-ttu-id="99e0d-112">OLE DB solamente rellena los datos hasta la escala definida.</span><span class="sxs-lookup"><span data-stu-id="99e0d-112">OLE DB pads only to the defined scale.</span></span>|<span data-ttu-id="99e0d-113">Para las conversiones en las que los datos convertidos se envían al servidor, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (a partir de [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) solamente rellena los datos con ceros a la derecha hasta la longitud máxima de los valores `datetime`.</span><span class="sxs-lookup"><span data-stu-id="99e0d-113">For conversions where converted data is sent to the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) pads trailing zeros in data only up to the maximum length of `datetime` values.</span></span> <span data-ttu-id="99e0d-114">En SQL Server Native Client 9.0 los datos se rellenaban hasta 9 dígitos.</span><span class="sxs-lookup"><span data-stu-id="99e0d-114">SQL Server Native Client 9.0 padded to 9 digits.</span></span>|  
|<span data-ttu-id="99e0d-115">Valide DBTYPE_DBTIMESTAMP para ICommandWithParameter::SetParameterInfo.</span><span class="sxs-lookup"><span data-stu-id="99e0d-115">Validate DBTYPE_DBTIMESTAMP for ICommandWithParameter::SetParameterInfo.</span></span>|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="99e0d-116">Native Client (a partir de [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ) implementa el requisito OLE DB de *BScale* en ICommandWithParameter:: SetParameterInfo para establecerse en la precisión de fracciones de segundo para DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="99e0d-116">Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) implements the OLE DB requirement for *bScale* in ICommandWithParameter::SetParameterInfo to be set to the fractional seconds' precision for DBTYPE_DBTIMESTAMP.</span></span>|  
|<span data-ttu-id="99e0d-117">El `sp_columns` procedimiento almacenado devuelve ahora **"no"** en lugar de **"no"** para la columna IS_NULLABLE.</span><span class="sxs-lookup"><span data-stu-id="99e0d-117">The `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for the IS_NULLABLE column.</span></span>|<span data-ttu-id="99e0d-118">A partir de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0 ( [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ), el `sp_columns` procedimiento almacenado devuelve ahora **"no"** en lugar de **"no"** para una IS_NULLABLE columna.</span><span class="sxs-lookup"><span data-stu-id="99e0d-118">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]), `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for an IS_NULLABLE column.</span></span>|  
|<span data-ttu-id="99e0d-119">SQLSetDescRec, SQLBindParameter y SQLBindCol ahora realizan la comprobación de coherencia.</span><span class="sxs-lookup"><span data-stu-id="99e0d-119">SQLSetDescRec, SQLBindParameter, and SQLBindCol now perform consistency checking.</span></span>|<span data-ttu-id="99e0d-120">Antes de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, el establecimiento de SQL_DESC_DATA_PTR no provocaba una comprobación de coherencia para ningún tipo de descriptor en SQLSetDescRec, SQLBindParameter o SQLBindCol.</span><span class="sxs-lookup"><span data-stu-id="99e0d-120">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, setting SQL_DESC_DATA_PTR did not cause a consistency check for any descriptor type in SQLSetDescRec, SQLBindParameter, or SQLBindCol.</span></span>|  
|<span data-ttu-id="99e0d-121">SQLCopyDesc Now realiza la comprobación de coherencia del descriptor.</span><span class="sxs-lookup"><span data-stu-id="99e0d-121">SQLCopyDesc now does descriptor consistency checking.</span></span>|<span data-ttu-id="99e0d-122">Antes de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, SQLCopyDesc no realizaba una comprobación de coherencia cuando el campo SQL_DESC_DATA_PTR estaba establecido en un registro determinado.</span><span class="sxs-lookup"><span data-stu-id="99e0d-122">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLCopyDesc did not do a consistency check when the SQL_DESC_DATA_PTR field was set on a particular record.</span></span>|  
|<span data-ttu-id="99e0d-123">SQLGetDescRec ya no realiza una comprobación de coherencia del descriptor.</span><span class="sxs-lookup"><span data-stu-id="99e0d-123">SQLGetDescRec no longer does a descriptor consistency check.</span></span>|<span data-ttu-id="99e0d-124">Antes de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, SQLGetDescRec realizó una comprobación de coherencia del descriptor cuando se estableció el campo SQL_DESC_DATA_PTR.</span><span class="sxs-lookup"><span data-stu-id="99e0d-124">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLGetDescRec performed a descriptor consistency check when the SQL_DESC_DATA_PTR field was set.</span></span> <span data-ttu-id="99e0d-125">Esto último no era un requisito de la especificación de ODBC y, en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) y versiones posteriores, ya no se realiza esta comprobación de coherencia.</span><span class="sxs-lookup"><span data-stu-id="99e0d-125">This was not required by the ODBC specification and in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) and later versions, this consistency check is no longer performed.</span></span>|  
|<span data-ttu-id="99e0d-126">Se devuelve un error distinto cuando la fecha se encuentra fuera del intervalo.</span><span class="sxs-lookup"><span data-stu-id="99e0d-126">Different error returned when date is out of range.</span></span>|<span data-ttu-id="99e0d-127">Para el tipo `datetime`, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (a partir de [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) devuelve un número de error distinto al que se devolvía en versiones anteriores para una fecha que se encuentre fuera del intervalo de fechas admitido.</span><span class="sxs-lookup"><span data-stu-id="99e0d-127">For the `datetime` type, a different error number will be returned by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) for an out-of-range date than was returned in earlier versions.</span></span><br /><br /> <span data-ttu-id="99e0d-128">Concretamente, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 devolvía 22007 para todos los valores de año fuera del intervalo en conversiones de cadenas a `datetime`, y [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client a partir de la versión 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) devuelve 22008 cuando la fecha se encuentra dentro del intervalo admitido por `datetime2` pero fuera del intervalo admitido por `datetime` o `smalldatetime`.</span><span class="sxs-lookup"><span data-stu-id="99e0d-128">Specifically, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 returned 22007 for all out of range year values in string conversions to `datetime`, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client beginning with version 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) returns 22008 when the date is within the range supported by `datetime2` but outside the range supported by `datetime` or `smalldatetime`.</span></span>|  
|<span data-ttu-id="99e0d-129">El valor `datetime` trunca las fracciones de segundo y no se redondea si el redondeo cambia el día.</span><span class="sxs-lookup"><span data-stu-id="99e0d-129">`datetime` value truncates fractional seconds and not round if rounding will change the day.</span></span>|<span data-ttu-id="99e0d-130">En versiones anteriores a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, el comportamiento del cliente para los valores `datetime` que se enviaban al servidor era redondearlos a la fracción 1/300 de segundo más próxima.</span><span class="sxs-lookup"><span data-stu-id="99e0d-130">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the client behavior for `datetime` values sent to the server is to round them to nearest 1/300th of a second.</span></span> <span data-ttu-id="99e0d-131">A partir de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, este mismo escenario provoca un truncamiento de fracciones de segundo si al redondear cambia el día.</span><span class="sxs-lookup"><span data-stu-id="99e0d-131">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, this scenario causes a truncation of fractional seconds if rounding changes the day.</span></span>|  
|<span data-ttu-id="99e0d-132">Posible truncamiento de segundos para el valor `datetime`.</span><span class="sxs-lookup"><span data-stu-id="99e0d-132">Possible trunction of seconds for `datetime` value.</span></span>|<span data-ttu-id="99e0d-133">Una aplicación compilada con [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (o posterior) que se conecta a un servidor [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 truncará segundos y fracciones de segundo para la parte de hora de los datos enviados al servidor si se enlaza con una columna de fecha y hora con un identificador de tipo DBTYPE_DBTIMESTAMP (OLE DB) o SQL_TIMESTAMP (ODBC) y una escala de 0.</span><span class="sxs-lookup"><span data-stu-id="99e0d-133">An application built with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (or later) that connects to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 server will truncate seconds and fractional seconds for time portion of data sent to the server if you bind to a datetime column with a type identifier of DBTYPE_DBTIMESTAMP (OLE DB) or SQL_TIMESTAMP (ODBC) and a scale of 0.</span></span><br /><br /> <span data-ttu-id="99e0d-134">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="99e0d-134">For example:</span></span><br /><br /> <span data-ttu-id="99e0d-135">Datos de entrada: 1994-08-21 21:21:36.000</span><span class="sxs-lookup"><span data-stu-id="99e0d-135">Input data: 1994-08-21 21:21:36.000</span></span><br /><br /> <span data-ttu-id="99e0d-136">Datos insertados: 1994-08-21 21:21:00.000</span><span class="sxs-lookup"><span data-stu-id="99e0d-136">Inserted data: 1994-08-21 21:21:00.000</span></span>|  
|<span data-ttu-id="99e0d-137">La conversión de datos OLE DB de DBTYPE_DBTIME a DBTYPE_DATE ya no puede hacer que cambie el día.</span><span class="sxs-lookup"><span data-stu-id="99e0d-137">OLE DB data conversion from DBTYPE_DBTIME to DBTYPE_DATE no longer can cause the day to change.</span></span>|<span data-ttu-id="99e0d-138">En versiones anteriores a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, si la parte correspondiente a la hora de DBTYPE_DATE se encontraba a medio segundo de la medianoche, el código de conversión de OLE DB hacía que el día cambiara.</span><span class="sxs-lookup"><span data-stu-id="99e0d-138">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, if the time part of a DBTYPE_DATE was within a half second of midnight, OLE DB conversion code caused the day to change.</span></span> <span data-ttu-id="99e0d-139">A partir de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, el día no cambiará (las fracciones de segundo se truncan y no se redondean).</span><span class="sxs-lookup"><span data-stu-id="99e0d-139">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the day will not change (fractional seconds are truncated and not rounded).</span></span>|  
|<span data-ttu-id="99e0d-140">Cambios en la conversión IBCPSession::BCColFmt.</span><span class="sxs-lookup"><span data-stu-id="99e0d-140">IBCPSession::BCColFmt conversion changes.</span></span>|<span data-ttu-id="99e0d-141">A partir de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, cuando se usa IBCPSession:: BCOColFmt para convertir SqlDateTime o SqlDateTime en un tipo de cadena, se exporta un valor fraccionario.</span><span class="sxs-lookup"><span data-stu-id="99e0d-141">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, when you use IBCPSession::BCOColFmt to convert SQLDATETIME or SQLDATETIME to a string type, a fractional value is exported.</span></span> <span data-ttu-id="99e0d-142">Por ejemplo, al convertir un tipo SQLDATETIME en un tipo SQLNVARCHARMAX, las versiones anteriores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client devolvían</span><span class="sxs-lookup"><span data-stu-id="99e0d-142">For example, when converting type SQLDATETIME to type SQLNVARCHARMAX, earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client returned</span></span><br /><br /> <span data-ttu-id="99e0d-143">1989-02-01 00:00:00.</span><span class="sxs-lookup"><span data-stu-id="99e0d-143">1989-02-01 00:00:00.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-144">Native Client 10.0 y versiones posteriores devuelven 1989-02-01 00:00:00.0000000.</span><span class="sxs-lookup"><span data-stu-id="99e0d-144">Native Client 10.0 and later versions return 1989-02-01 00:00:00.0000000.</span></span>|  
|<span data-ttu-id="99e0d-145">El tamaño de los datos enviados debe coincidir con la longitud especificada en SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="99e0d-145">Size of data sent must match length specified in SQL_LEN_DATA_AT_EXEC.</span></span>|<span data-ttu-id="99e0d-146">Cuando se utiliza SQL_LEN_DATA_AT_EXEC, el tamaño de los datos debe coincidir con la longitud especificada en SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="99e0d-146">When using SQL_LEN_DATA_AT_EXEC, the size of the data must match the length that you specified with SQL_LEN_DATA_AT_EXEC.</span></span> <span data-ttu-id="99e0d-147">Puede usar SQL_DATA_AT_EXEC, pero resulta mucho más ventajoso desde el punto de vista del rendimiento utilizar SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="99e0d-147">You can use SQL_DATA_AT_EXEC but there are potential performance benefits to using SQL_LEN_DATA_AT_EXEC.</span></span>|  
|<span data-ttu-id="99e0d-148">Ahora, las aplicaciones personalizadas que utilizan la API de BCP pueden recibir una advertencia.</span><span class="sxs-lookup"><span data-stu-id="99e0d-148">Custom applications that use the BCP API can now see a warning.</span></span>|<span data-ttu-id="99e0d-149">La API de BCP generará un mensaje de advertencia si la longitud de los datos es mayor que la longitud especificada en un campo para todos los tipos.</span><span class="sxs-lookup"><span data-stu-id="99e0d-149">The BCP API will generate a warning message if data length is greater than the specified length for a field for all types.</span></span> <span data-ttu-id="99e0d-150">Anteriormente, esta advertencia solo se recibía para los tipos de caracteres, pero no se emitía para todos los tipos.</span><span class="sxs-lookup"><span data-stu-id="99e0d-150">Previously, this warning was only given for character types, but will not be issued for all types.</span></span>|  
|<span data-ttu-id="99e0d-151">Si se inserta una cadena vacía en un `sql_variant` enlazado como un tipo de fecha y hora, se genera un error.</span><span class="sxs-lookup"><span data-stu-id="99e0d-151">Inserting an empty string into a `sql_variant` bound as a date/time type generates an error.</span></span>|<span data-ttu-id="99e0d-152">En [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, al insertar una cadena vacía en un elemento `sql_variant` enlazado como un tipo de fecha y hora no se generaba ningún error.</span><span class="sxs-lookup"><span data-stu-id="99e0d-152">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, inserting an empty string into a `sql_variant` bound as a date/time type did not generate an error.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-153">Native Client 10.0 (y posterior) genera un error en esta situación.</span><span class="sxs-lookup"><span data-stu-id="99e0d-153">Native Client 10.0 (and later) correctly generates an error in this situation.</span></span>|  
|<span data-ttu-id="99e0d-154">Validación de parámetros SQL_C_TYPE_TIMESTAMP y DBTYPE_DBTIMESTAMP más estricta.</span><span class="sxs-lookup"><span data-stu-id="99e0d-154">Stricter SQL_C_TYPE _TIMESTAMP and DBTYPE_DBTIMESTAMP parameter validation.</span></span>|<span data-ttu-id="99e0d-155">Antes de [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client, `datetime` los valores se redondean para ajustarse a la escala de `datetime` `smalldatetime` columnas y por [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="99e0d-155">Prior to [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client, `datetime` values were rounded to fit the scale of `datetime` and `smalldatetime` columns by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] <span data-ttu-id="99e0d-156">Native Client (y posteriores) aplica reglas de validación más estrictas, que se definen en la especificación básica de ODBC para las fracciones de segundo.</span><span class="sxs-lookup"><span data-stu-id="99e0d-156">Native Client (and later) applies the stricter validation rules that are defined in the ODBC core specification for fractional seconds.</span></span> <span data-ttu-id="99e0d-157">Si un valor de parámetro no puede convertirse en el tipo SQL utilizando la escala especificada o no puede implicarse mediante el enlace del cliente sin que se produzca un truncamiento de los dígitos finales, se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="99e0d-157">If a parameter value cannot be converted to the SQL type by using the scale specified or implied by the client binding without truncation of trailing digits, an error is returned.</span></span>|  
|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="99e0d-158">puede devolver resultados diferentes cuando se ejecuta un desencadenador.</span><span class="sxs-lookup"><span data-stu-id="99e0d-158">might return different results when a trigger runs.</span></span>|<span data-ttu-id="99e0d-159">Los cambios introducidos en [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] pueden hacer que una aplicación devuelva resultados diferentes de una instrucción que produjo la ejecución de un desencadenador cuando `NOCOUNT OFF` estaba activo.</span><span class="sxs-lookup"><span data-stu-id="99e0d-159">Changes introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] might cause an application to have different results returned from a statement that caused a trigger to run when `NOCOUNT OFF` was in effect.</span></span> <span data-ttu-id="99e0d-160">En esta situación, es posible que la aplicación genere un error.</span><span class="sxs-lookup"><span data-stu-id="99e0d-160">In this situation, your application might generate an error.</span></span> <span data-ttu-id="99e0d-161">Para resolver este error, establezca `NOCOUNT ON` en el desencadenador o llame a SQLMoreResults para avanzar al resultado siguiente.</span><span class="sxs-lookup"><span data-stu-id="99e0d-161">To resolve this error, set `NOCOUNT ON` in the trigger or call SQLMoreResults to advance to the next result.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="99e0d-162">Consulte también</span><span class="sxs-lookup"><span data-stu-id="99e0d-162">See Also</span></span>  
 [<span data-ttu-id="99e0d-163">Programación de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="99e0d-163">SQL Server Native Client Programming</span></span>](../sql-server-native-client-programming.md)  
  
  
