---
title: Nombres de entidad de seguridad de servicio (SPN) en conexiones de cliente (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: e212010e-a5b6-4ad1-a3c0-575327d3ffd3
author: rothja
ms.author: jroth
ms.openlocfilehash: cd88b11eb7416be869dce3c9ea166787f88d9ee7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669642"
---
# <a name="service-principal-names-spns-in-client-connections-ole-db"></a><span data-ttu-id="b0c59-102">Nombres de entidad de seguridad del servicio (SPN) en conexiones cliente (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b0c59-102">Service Principal Names (SPNs) in Client Connections (OLE DB)</span></span>
  <span data-ttu-id="b0c59-103">En este tema se describen propiedades y funciones miembro de OLE DB compatibles con los nombres principales de servicio (SPN) en aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="b0c59-103">This topic describes OLE DB properties and member functions that support service principal names (SPNs) in client applications.</span></span> <span data-ttu-id="b0c59-104">Para más información sobre los SPN en las aplicaciones cliente, vea [Compatibilidad con Nombre de la entidad de seguridad del servicio &#40;SPN&#41; en conexiones de cliente](../features/service-principal-name-spn-support-in-client-connections.md).</span><span class="sxs-lookup"><span data-stu-id="b0c59-104">For more information about SPNs in client applications, see [Service Principal Name &#40;SPN&#41; Support in Client Connections](../features/service-principal-name-spn-support-in-client-connections.md).</span></span> <span data-ttu-id="b0c59-105">Para ver un ejemplo, consulte [Autenticación Kerberos integrada &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="b0c59-105">For a sample, see [Integrated Kerberos Authentication &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span></span>  
  
## <a name="provider-initialization-string-keywords"></a><span data-ttu-id="b0c59-106">Palabras clave de cadena de inicialización de proveedor</span><span class="sxs-lookup"><span data-stu-id="b0c59-106">Provider Initialization String Keywords</span></span>  
 <span data-ttu-id="b0c59-107">Las siguientes palabras clave de cadena de inicialización de proveedor admiten SPN en aplicaciones OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0c59-107">The following provider initialization string keywords support SPNs in OLE DB applications.</span></span> <span data-ttu-id="b0c59-108">En la tabla siguiente, los valores de la columna de palabra clave se usan para la cadena del proveedor de IDBInitialize::Initialize.</span><span class="sxs-lookup"><span data-stu-id="b0c59-108">In the following table, the values in the keyword column are used for the provider string of IDBInitialize::Initialize.</span></span> <span data-ttu-id="b0c59-109">Los valores de la columna de descripción se usan en cadenas de inicialización al conectar con ADO o IDataInitialize::GetDataSource.</span><span class="sxs-lookup"><span data-stu-id="b0c59-109">The values in the description column are used in initialization strings when connecting using ADO or IDataInitialize::GetDataSource.</span></span>  
  
|<span data-ttu-id="b0c59-110">Palabra clave</span><span class="sxs-lookup"><span data-stu-id="b0c59-110">Keyword</span></span>|<span data-ttu-id="b0c59-111">Descripción</span><span class="sxs-lookup"><span data-stu-id="b0c59-111">Description</span></span>|<span data-ttu-id="b0c59-112">Value</span><span class="sxs-lookup"><span data-stu-id="b0c59-112">Value</span></span>|  
|-------------|-----------------|-----------|  
|<span data-ttu-id="b0c59-113">ServerSPN</span><span class="sxs-lookup"><span data-stu-id="b0c59-113">ServerSPN</span></span>|<span data-ttu-id="b0c59-114">Dirección SPN del servidor</span><span class="sxs-lookup"><span data-stu-id="b0c59-114">Server SPN</span></span>|<span data-ttu-id="b0c59-115">SPN del servidor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-115">The SPN for the server.</span></span> <span data-ttu-id="b0c59-116">El valor predeterminado es una cadena vacía, que hace que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use el valor predeterminado, SPN generado por proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-116">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="b0c59-117">FailoverPartnerSPN</span><span class="sxs-lookup"><span data-stu-id="b0c59-117">FailoverPartnerSPN</span></span>|<span data-ttu-id="b0c59-118">SPN de asociado de conmutación por error</span><span class="sxs-lookup"><span data-stu-id="b0c59-118">Failover Partner SPN</span></span>|<span data-ttu-id="b0c59-119">SPN del asociado de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b0c59-119">The SPN for the failover partner.</span></span> <span data-ttu-id="b0c59-120">El valor predeterminado es una cadena vacía, que hace que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use el valor predeterminado, SPN generado por proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-120">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-initialization-properties"></a><span data-ttu-id="b0c59-121">Propiedades de inicialización de origen de datos</span><span class="sxs-lookup"><span data-stu-id="b0c59-121">Data Source Initialization Properties</span></span>  
 <span data-ttu-id="b0c59-122">Las propiedades siguientes del conjunto de propiedades `DBPROPSET_SQLSERVERDBINIT` permiten a las aplicaciones especificar SPN.</span><span class="sxs-lookup"><span data-stu-id="b0c59-122">The following properties in the `DBPROPSET_SQLSERVERDBINIT` property set allow applications to specify SPNs.</span></span>  
  
|<span data-ttu-id="b0c59-123">Nombre</span><span class="sxs-lookup"><span data-stu-id="b0c59-123">Name</span></span>|<span data-ttu-id="b0c59-124">Tipo</span><span class="sxs-lookup"><span data-stu-id="b0c59-124">Type</span></span>|<span data-ttu-id="b0c59-125">Uso</span><span class="sxs-lookup"><span data-stu-id="b0c59-125">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="b0c59-126">SSPROP_INIT_SERVERSPN</span><span class="sxs-lookup"><span data-stu-id="b0c59-126">SSPROP_INIT_SERVERSPN</span></span>|<span data-ttu-id="b0c59-127">VT_BSTR, lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="b0c59-127">VT_BSTR, read/write</span></span>|<span data-ttu-id="b0c59-128">Especifica el SPN del servidor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-128">Specifies the SPN for the server.</span></span> <span data-ttu-id="b0c59-129">El valor predeterminado es una cadena vacía, que hace que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use el valor predeterminado, SPN generado por proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-129">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="b0c59-130">SSPROP_INIT_FAILOVERPARTNERSPN</span><span class="sxs-lookup"><span data-stu-id="b0c59-130">SSPROP_INIT_FAILOVERPARTNERSPN</span></span>|<span data-ttu-id="b0c59-131">VT_BSTR, lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="b0c59-131">VT_BSTR, read/write</span></span>|<span data-ttu-id="b0c59-132">Especifica el SPN para el asociado de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b0c59-132">Specifies the SPN for the failover partner.</span></span> <span data-ttu-id="b0c59-133">El valor predeterminado es una cadena vacía, que hace que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client use el valor predeterminado, SPN generado por proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-133">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-properties"></a><span data-ttu-id="b0c59-134">Propiedades de origen de datos</span><span class="sxs-lookup"><span data-stu-id="b0c59-134">Data Source Properties</span></span>  
 <span data-ttu-id="b0c59-135">Las propiedades siguientes del conjunto de propiedades `DBPROPSET_SQLSERVERDATASOURCEINFO` permiten a las aplicaciones detectar el método de autenticación.</span><span class="sxs-lookup"><span data-stu-id="b0c59-135">The following properties in the `DBPROPSET_SQLSERVERDATASOURCEINFO` property set allow applications to discover the authentication method.</span></span>  
  
|<span data-ttu-id="b0c59-136">Nombre</span><span class="sxs-lookup"><span data-stu-id="b0c59-136">Name</span></span>|<span data-ttu-id="b0c59-137">Tipo</span><span class="sxs-lookup"><span data-stu-id="b0c59-137">Type</span></span>|<span data-ttu-id="b0c59-138">Uso</span><span class="sxs-lookup"><span data-stu-id="b0c59-138">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="b0c59-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span><span class="sxs-lookup"><span data-stu-id="b0c59-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span></span>|<span data-ttu-id="b0c59-140">VT_BSTR, solo lectura</span><span class="sxs-lookup"><span data-stu-id="b0c59-140">VT_BSTR, readonly</span></span>|<span data-ttu-id="b0c59-141">Devuelve el método de autenticación que utiliza la conexión.</span><span class="sxs-lookup"><span data-stu-id="b0c59-141">Returns the authentication method used for the connection.</span></span> <span data-ttu-id="b0c59-142">El valor devuelto a la aplicación es el valor que Windows devuelve a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="b0c59-142">The value returned to the application is the value that Windows returns to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="b0c59-143">Estos son los valores posibles:</span><span class="sxs-lookup"><span data-stu-id="b0c59-143">The following are possible values:</span></span><br /><br /> <span data-ttu-id="b0c59-144">-"NTLM", que se devuelve cuando se abre una conexión mediante la autenticación NTLM.</span><span class="sxs-lookup"><span data-stu-id="b0c59-144">-   "NTLM", which is returned when a connection is opened using NTLM authentication.</span></span><br /><span data-ttu-id="b0c59-145">-"Kerberos", que se devuelve cuando se abre una conexión mediante la autenticación Kerberos.</span><span class="sxs-lookup"><span data-stu-id="b0c59-145">-   "Kerberos", which is returned when a connection is opened using Kerberos authentication.</span></span><br /><br /> <span data-ttu-id="b0c59-146">Si se ha abierto una conexión y no se puede determinar el método de autenticación, se devuelve VT_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="b0c59-146">If a connection has been opened and the authentication method cannot be determined, VT_EMPTY is returned.</span></span><br /><br /> <span data-ttu-id="b0c59-147">Esta propiedad solo se puede leer cuando se ha inicializado un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="b0c59-147">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="b0c59-148">Si intenta leer la propiedad antes de que se haya inicializado un origen de datos, IDBProperties::GetProperies devolverá DB_S_ERRORSOCCURRED o DB_E_ERRORSOCCURRED, según corresponda, y DBPROPSTATUS_NOTSUPPORTED se establecerá en DBPROPSET_PROPERTIESINERROR para esta propiedad.</span><span class="sxs-lookup"><span data-stu-id="b0c59-148">If you attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="b0c59-149">Este comportamiento está de acuerdo con la especificación básica de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0c59-149">This behavior is in accordance with the OLE DB core specification.</span></span>|  
|<span data-ttu-id="b0c59-150">SSPROP_MUTUALLYAUTHENICATED</span><span class="sxs-lookup"><span data-stu-id="b0c59-150">SSPROP_MUTUALLYAUTHENICATED</span></span>|<span data-ttu-id="b0c59-151">VT_BOOL, solo lectura</span><span class="sxs-lookup"><span data-stu-id="b0c59-151">VT_BOOL, readonly</span></span>|<span data-ttu-id="b0c59-152">Devuelve VARIANT_TRUE si los servidores de la conexión se autenticaron mutuamente; de lo contrario, devuelve VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="b0c59-152">Returns VARIANT_TRUE if the servers on the connection were mutually authenticated; otherwise, returns VARIANT_FALSE.</span></span><br /><br /> <span data-ttu-id="b0c59-153">Esta propiedad solo se puede leer cuando se ha inicializado un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="b0c59-153">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="b0c59-154">Si hay un intento de leer la propiedad antes de que se haya inicializado un origen de datos, IDBProperties::GetProperies devolverá DB_S_ERRORSOCCURRED o DB_E_ERRORSOCCURRED, según corresponda, y DBPROPSTATUS_NOTSUPPORTED se establecerá en DBPROPSET_PROPERTIESINERROR para esta propiedad.</span><span class="sxs-lookup"><span data-stu-id="b0c59-154">If there is an attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="b0c59-155">Este comportamiento está de acuerdo con la especificación básica de OLE DB</span><span class="sxs-lookup"><span data-stu-id="b0c59-155">This behavior is in accordance with the OLE DB core specification</span></span><br /><br /> <span data-ttu-id="b0c59-156">Si este atributo se consulta para una conexión que no usó la autenticación de Windows, se devuelve VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="b0c59-156">If this attribute is queried for a connection that did not use Windows Authentication, VARIANT_FALSE is returned.</span></span>|  
  
## <a name="ole-db-api-support-for-spns"></a><span data-ttu-id="b0c59-157">Compatibilidad de API OLE DB con SPN</span><span class="sxs-lookup"><span data-stu-id="b0c59-157">OLE DB API Support for SPNs</span></span>  
 <span data-ttu-id="b0c59-158">La tabla siguiente describe las funciones del miembro OLE DB que admiten SPN en conexiones de cliente:</span><span class="sxs-lookup"><span data-stu-id="b0c59-158">The following table describes the OLE DB member functions that support SPNs in client connections:</span></span>  
  
|<span data-ttu-id="b0c59-159">Función de miembro</span><span class="sxs-lookup"><span data-stu-id="b0c59-159">Member function</span></span>|<span data-ttu-id="b0c59-160">Descripción</span><span class="sxs-lookup"><span data-stu-id="b0c59-160">Description</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="b0c59-161">IDataInitialize::GetDataSource</span><span class="sxs-lookup"><span data-stu-id="b0c59-161">IDataInitialize::GetDataSource</span></span>|<span data-ttu-id="b0c59-162">*pwszInitializationString* puede contener las nuevas palabras clave `ServerSPN` y `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="b0c59-162">*pwszInitializationString* can contain the new keywords `ServerSPN` and `FailoverPartnerSPN`.</span></span>|  
|<span data-ttu-id="b0c59-163">IDataInitialize::GetInitializationString</span><span class="sxs-lookup"><span data-stu-id="b0c59-163">IDataInitialize::GetInitializationString</span></span>|<span data-ttu-id="b0c59-164">Si SSPROP_INIT_SERVERSPN y SSPROP_INIT_FAILOVERPARTNERSPN tienen valores no predeterminados, se incluirán en la cadena de inicialización a través de *ppwszInitString* como valores de palabra clave para `ServerSPN` y `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="b0c59-164">If SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN have non-default values, they will be included in the initialization string through *ppwszInitString* as keyword values for `ServerSPN` and `FailoverPartnerSPN`.</span></span> <span data-ttu-id="b0c59-165">De lo contrario, estas palabras clave no estarán incluidas en la cadena de inicialización.</span><span class="sxs-lookup"><span data-stu-id="b0c59-165">Otherwise, these keywords will not be included in the initialization string.</span></span>|  
|<span data-ttu-id="b0c59-166">IDBInitialize::Initialize</span><span class="sxs-lookup"><span data-stu-id="b0c59-166">IDBInitialize::Initialize</span></span>|<span data-ttu-id="b0c59-167">Si están habilitados los mensajes configurando DBPROP_INIT_PROMPT en las propiedades de inicialización de origen de datos, se mostrará el cuadro de diálogo Inicio de sesión de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b0c59-167">If prompting is enabled by setting DBPROP_INIT_PROMPT in the data source initialization properties, the OLE DB Login dialog box will be displayed.</span></span> <span data-ttu-id="b0c59-168">Esto permite escribir SPN tanto para el servidor principal como para su asociado de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b0c59-168">This allows SPNs to be entered for both the principal server and its failover partner.</span></span><br /><br /> <span data-ttu-id="b0c59-169">La cadena de proveedor en DPPROP_INIT_PROVIDERSTRING, si se establece, reconocerá las nuevas palabras clave `ServerSPN` y `FailoverPartnerSPN` y usará sus valores, si están presentes, para inicializar SSPROP_INIT_SERVER_SPN y SSPROP_INIT_FAILOVER_PARTNER_SPN.</span><span class="sxs-lookup"><span data-stu-id="b0c59-169">The provider string in DPPROP_INIT_PROVIDERSTRING, if set, will recognize the new keywords `ServerSPN` and `FailoverPartnerSPN` and use their values, if present, to initialize SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN.</span></span><br /><br /> <span data-ttu-id="b0c59-170">Se puede llamar a IDBProperties::SetProperties para establecer las propiedades SSPROP_INIT_SERVER_SPN y SSPROP_INIT_FAILOVER_PARTNER_SPN antes de llamar a IDBInitialize::Initialize.</span><span class="sxs-lookup"><span data-stu-id="b0c59-170">IDBProperties::SetProperties can be called to set the properties SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN before IDBInitialize::Initialize is called.</span></span> <span data-ttu-id="b0c59-171">Ésta es una alternativa a utilizar una cadena de proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-171">This is an alternative to using a provider string.</span></span><br /><br /> <span data-ttu-id="b0c59-172">Si una propiedad se establece en más de un lugar, un valor establecido mediante programación tiene precedencia sobre un conjunto de valores en la cadena de proveedor.</span><span class="sxs-lookup"><span data-stu-id="b0c59-172">If a property is set in more than one place, a value set programmatically takes precedence over a value set in the provider string.</span></span> <span data-ttu-id="b0c59-173">Un conjunto de valores en una cadena de inicialización tiene precedencia sobre un conjunto de valores en un cuadro de diálogo de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="b0c59-173">A value set in an initialization string takes precedence over a value set in a login dialog box.</span></span><br /><br /> <span data-ttu-id="b0c59-174">Si la misma palabra clave aparece más de una vez en la cadena del proveedor, el valor de primera aparición tiene prioridad.</span><span class="sxs-lookup"><span data-stu-id="b0c59-174">If the same keyword appears more than once in the provider string, the value from first occurrence takes precedence.</span></span>|  
|<span data-ttu-id="b0c59-175">IDBProperties::GetProperties</span><span class="sxs-lookup"><span data-stu-id="b0c59-175">IDBProperties::GetProperties</span></span>|<span data-ttu-id="b0c59-176">Se puede llamar a IDBProperties::GetProperties para obtener los valores de las nuevas propiedades de inicialización de origen de datos SSPROP_INIT_SERVERSPN y SSPROP_INIT_FAILOVERPARTNERSPN y de las nuevas propiedades de origen de datos SSPROP_AUTHENTICATIONMETHOD y SSPROP_MUTUALLYAUTHENTICATED.</span><span class="sxs-lookup"><span data-stu-id="b0c59-176">IDBProperties::GetProperties can be called to get the values of the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, and of the new data source properties SSPROP_AUTHENTICATIONMETHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="b0c59-177">IDBProperties::GetPropertyInfo</span><span class="sxs-lookup"><span data-stu-id="b0c59-177">IDBProperties::GetPropertyInfo</span></span>|<span data-ttu-id="b0c59-178">IdbProperties::GetPropertyInfo incluirá las nuevas propiedades de inicialización de origen de datos SSPROP_INIT_SERVERSPN y SSPROP_INIT_FAILOVERPARTNERSPN, o bien las nuevas propiedades de origen de datos SSPROP_AUTHENTICATION_METHOD y SSPROP_MUTUALLYAUTHENTICATED.</span><span class="sxs-lookup"><span data-stu-id="b0c59-178">IdbProperties::GetPropertyInfo will include the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, or the new data source properties SSPROP_AUTHENTICATION_METHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="b0c59-179">IDBProperties::SetProperties</span><span class="sxs-lookup"><span data-stu-id="b0c59-179">IDBProperties::SetProperties</span></span>|<span data-ttu-id="b0c59-180">Se puede llamar a IDBProperties::SetProperties para establecer los valores de las nuevas propiedades de inicialización de origen de datos SSPROP_INITSERVERSPN y SSPROP_INIT_FAILOVERPARTNERSPN.</span><span class="sxs-lookup"><span data-stu-id="b0c59-180">IDBProperties::SetProperties can be called to set the values of the new data source initialization properties SSPROP_INITSERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN.</span></span><br /><br /> <span data-ttu-id="b0c59-181">Estas propiedades se pueden devolver en cualquier momento, pero si el origen de datos ya está abierto, se devolverá el error siguiente: DB_E_ERRORSOCCURRED, "La operación de múltiples pasos de OLE DB generó errores.</span><span class="sxs-lookup"><span data-stu-id="b0c59-181">These properties can be set at any time, but if the data source is already open, the following error will be returned: DB_E_ERRORSOCCURRED, "Multiple-step OLE DB operation generated errors.</span></span> <span data-ttu-id="b0c59-182">Compruebe los valores de estado de OLE DB si es posible.</span><span class="sxs-lookup"><span data-stu-id="b0c59-182">Check each OLE DB status value, if available.</span></span> <span data-ttu-id="b0c59-183">No se realizó ningún trabajo."</span><span class="sxs-lookup"><span data-stu-id="b0c59-183">No work was done."</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b0c59-184">Consulte también</span><span class="sxs-lookup"><span data-stu-id="b0c59-184">See Also</span></span>  
 [<span data-ttu-id="b0c59-185">SQL Server Native Client &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="b0c59-185">SQL Server Native Client &#40;OLE DB&#41;</span></span>](sql-server-native-client-ole-db.md)  
  
  
