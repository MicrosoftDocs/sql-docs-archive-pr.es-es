---
title: Llamada a un procedimiento almacenado (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- calling stored procedures
- RPC escape sequence
- OLE DB, stored procedures
- parameters [SQL Server Native Client], OLE DB
- ODBC CALL escape sequence
- stored procedures [OLE DB], calling
- SQL Server Native Client OLE DB provider, stored procedures
ms.assetid: 8e5738e5-4bbe-4f34-bd69-0c0633290bdd
author: rothja
ms.author: jroth
ms.openlocfilehash: 695848c8633d310f5e8ee21e9e738749d1550e4a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87748728"
---
# <a name="calling-a-stored-procedure-ole-db"></a><span data-ttu-id="7a1ba-102">Llamar a un procedimiento almacenado (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="7a1ba-102">Calling a Stored Procedure (OLE DB)</span></span>
  <span data-ttu-id="7a1ba-103">Un procedimiento almacenado puede tener cero o más parámetros.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-103">A stored procedure can have zero or more parameters.</span></span> <span data-ttu-id="7a1ba-104">También puede devolver un valor.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-104">It can also return a value.</span></span> <span data-ttu-id="7a1ba-105">Cuando se usa el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client, se pueden pasar los parámetros a un procedimiento almacenado:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-105">When using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider, parameters to a stored procedure can be passed by:</span></span>  
  
-   <span data-ttu-id="7a1ba-106">Codificando de forma rígida el valor de datos.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-106">Hard-coding the data value.</span></span>  
  
-   <span data-ttu-id="7a1ba-107">Utilizando un marcador de parámetro (?) para especificar parámetros, enlazar una variable de programa al marcador de parámetro y, a continuación, colocar el valor de datos en la variable de programa.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-107">Using a parameter marker (?) to specify parameters, bind a program variable to the parameter marker, and then place the data value in the program variable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7a1ba-108">Cuando se llama a procedimientos almacenados de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mediante parámetros con nombre con OLE DB, los nombres de parámetro deben empezar con el carácter '\@'.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-108">When calling [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stored procedures using named parameters with OLE DB, the parameter names must start with the '\@' character.</span></span> <span data-ttu-id="7a1ba-109">Se trata de una restricción específica de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7a1ba-109">This is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specific restriction.</span></span> <span data-ttu-id="7a1ba-110">El proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client aplica esta restricción de forma más estricta que MDAC.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider enforces this restriction more strictly than MDAC.</span></span>  
  
 <span data-ttu-id="7a1ba-111">Para admitir parámetros, se expone la interfaz **ICommandWithParameters** en el objeto de comando.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-111">To support parameters, the **ICommandWithParameters** interface is exposed on the command object.</span></span> <span data-ttu-id="7a1ba-112">Para usar parámetros, el cliente primero describe los parámetros al proveedor mediante una llamada al método **ICommandWithParameters::SetParameterInfo** (u opcionalmente prepara una instrucción de llamada que llama al método **GetParameterInfo**).</span><span class="sxs-lookup"><span data-stu-id="7a1ba-112">To use parameters, the consumer first describes the parameters to the provider by calling the **ICommandWithParameters::SetParameterInfo** method (or optionally prepares a calling statement that calls the **GetParameterInfo** method).</span></span> <span data-ttu-id="7a1ba-113">A continuación, el consumidor crea un descriptor de acceso que especifica la estructura de un búfer y coloca los valores de parámetro en este búfer.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-113">The consumer then creates an accessor that specifies the structure of a buffer and places parameter values in this buffer.</span></span> <span data-ttu-id="7a1ba-114">Por último, pasa el identificador del descriptor de acceso y un puntero al búfer a **Execute**.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-114">Finally, it passes the handle of the accessor and a pointer to the buffer to **Execute**.</span></span> <span data-ttu-id="7a1ba-115">En las llamadas posteriores a **Execute**, el cliente coloca nuevos valores de parámetro en el búfer y llama a **Execute** con el identificador del descriptor de acceso y el puntero al búfer.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-115">On later calls to **Execute**, the consumer places new parameter values in the buffer and calls **Execute** with the accessor handle and buffer pointer.</span></span>  
  
 <span data-ttu-id="7a1ba-116">Un comando que llama a un procedimiento almacenado temporal mediante parámetros, primero debe llamar a **ICommandWithParameters::SetParameterInfo** para definir la información de parámetros antes de que se pueda preparar el comando correctamente.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-116">A command that calls a temporary stored procedure using parameters must first call **ICommandWithParameters::SetParameterInfo** to define the parameter information, before the command can be successfully prepared.</span></span> <span data-ttu-id="7a1ba-117">Esto se debe a que el nombre interno para un procedimiento almacenado temporal difiere del nombre externo utilizado por un cliente y SQLOLEDB no puede consultar las tablas del sistema para determinar la información de parámetros para un procedimiento almacenado temporal.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-117">This is because the internal name for a temporary stored procedure differs from the external name used by a client and SQLOLEDB cannot query the system tables to determine the parameter information for a temporary stored procedure.</span></span>  
  
 <span data-ttu-id="7a1ba-118">Estos son los pasos en el proceso de enlace de parámetro:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-118">These are the steps in the parameter binding process:</span></span>  
  
1.  <span data-ttu-id="7a1ba-119">Rellene la información de parámetros en una matriz de estructuras DBPARAMBINDINFO; es decir, el nombre del parámetro, el nombre específico del proveedor para el tipo de datos del parámetro o un nombre del tipo de datos estándar, etc.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-119">Fill in the parameter information in an array of DBPARAMBINDINFO structures; that is, parameter name, provider-specific name for the data type of the parameter or a standard data type name, and so on.</span></span> <span data-ttu-id="7a1ba-120">Cada estructura de la matriz describe un parámetro.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-120">Each structure in the array describes one parameter.</span></span> <span data-ttu-id="7a1ba-121">Luego esta matriz se pasa al método **SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-121">This array is then passed to the **SetParameterInfo** method.</span></span>  
  
2.  <span data-ttu-id="7a1ba-122">Llame al método **ICommandWithParameters::SetParameterInfo** para describir los parámetros al proveedor.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-122">Call the **ICommandWithParameters::SetParameterInfo** method to describe parameters to the provider.</span></span> <span data-ttu-id="7a1ba-123">**SetParameterInfo** especifica el tipo de datos nativo de cada parámetro.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-123">**SetParameterInfo** specifies the native data type of each parameter.</span></span> <span data-ttu-id="7a1ba-124">Los argumentos de **SetParameterInfo** son:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-124">**SetParameterInfo** arguments are:</span></span>  
  
    -   <span data-ttu-id="7a1ba-125">El número de parámetros para los que se ha de establecer información de tipo.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-125">The number of parameters for which to set type information.</span></span>  
  
    -   <span data-ttu-id="7a1ba-126">Una matriz de ordinales de parámetros para los que se ha de establecer información de tipo.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-126">An array of parameter ordinals for which to set type information.</span></span>  
  
    -   <span data-ttu-id="7a1ba-127">Una matriz de estructuras DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-127">An array of DBPARAMBINDINFO structures.</span></span>  
  
3.  <span data-ttu-id="7a1ba-128">Cree un descriptor de acceso a parámetros mediante el comando **IAccessor::CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-128">Create a parameter accessor by using the **IAccessor::CreateAccessor** command.</span></span> <span data-ttu-id="7a1ba-129">El descriptor de acceso especifica la estructura de un búfer y coloca los valores de parámetro en el búfer.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-129">The accessor specifies the structure of a buffer and places parameter values in the buffer.</span></span> <span data-ttu-id="7a1ba-130">El comando **CreateAccessor** crea un descriptor de acceso a partir de un conjunto de enlaces.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-130">The **CreateAccessor** command creates an accessor from a set of bindings.</span></span> <span data-ttu-id="7a1ba-131">El consumidor describe estos enlaces utilizando una matriz de estructuras DBBINDING.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-131">These bindings are described by the consumer by using an array of DBBINDING structures.</span></span> <span data-ttu-id="7a1ba-132">Cada enlace asocia un parámetro único al búfer del consumidor y contiene información como:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-132">Each binding associates a single parameter to the buffer of the consumer and contains information such as:</span></span>  
  
    -   <span data-ttu-id="7a1ba-133">El ordinal del parámetro al que se aplica el enlace.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-133">The ordinal of the parameter to which the binding applies.</span></span>  
  
    -   <span data-ttu-id="7a1ba-134">Lo que se enlaza (el valor de datos, su longitud y su estado).</span><span class="sxs-lookup"><span data-stu-id="7a1ba-134">What is bound (the data value, its length, and its status).</span></span>  
  
    -   <span data-ttu-id="7a1ba-135">El desplazamiento en el búfer a cada una de estas partes.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-135">The offset in the buffer to each of these parts.</span></span>  
  
    -   <span data-ttu-id="7a1ba-136">La longitud y el tipo del valor de datos tal y como está en el búfer del consumidor.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-136">The length and type of the data value as it exists in the buffer of the consumer.</span></span>  
  
     <span data-ttu-id="7a1ba-137">Un descriptor de acceso queda identificado por su identificador, que es de tipo HACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-137">An accessor is identified by its handle, which is of type HACCESSOR.</span></span> <span data-ttu-id="7a1ba-138">El método **CreateAccessor** devuelve este identificador.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-138">This handle is returned by the **CreateAccessor** method.</span></span> <span data-ttu-id="7a1ba-139">Cada vez que el cliente termina de usar un descriptor de acceso, debe llamar al método **ReleaseAccessor** para liberar la memoria que retiene.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-139">Whenever the consumer finishes using an accessor, the consumer must call the **ReleaseAccessor** method to release the memory it holds.</span></span>  
  
     <span data-ttu-id="7a1ba-140">Cuando el cliente llama a un método, como **ICommand::Execute**, pasa automáticamente el identificador a un descriptor de acceso y un puntero a un búfer.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-140">When the consumer calls a method, such as **ICommand::Execute**, it passes the handle to an accessor and a pointer to a buffer itself.</span></span> <span data-ttu-id="7a1ba-141">El proveedor utiliza este descriptor de acceso para determinar cómo transferir los datos incluidos en el búfer.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-141">The provider uses this accessor to determine how to transfer the data contained in the buffer.</span></span>  
  
4.  <span data-ttu-id="7a1ba-142">Rellene la estructura DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-142">Fill in the DBPARAMS structure.</span></span> <span data-ttu-id="7a1ba-143">Las variables del cliente de las que se toman los valores de parámetro de entrada y en las que se escriben los valores de parámetro de salida se pasan en tiempo de ejecución a **ICommand::Execute** en la estructura DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-143">The consumer variables from which input parameter values are taken and to which output parameter values are written are passed at run time to **ICommand::Execute** in the DBPARAMS structure.</span></span> <span data-ttu-id="7a1ba-144">La estructura DBPARAMS incluye tres elementos:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-144">The DBPARAMS structure includes three elements:</span></span>  
  
    -   <span data-ttu-id="7a1ba-145">Un puntero al búfer del que el proveedor recupera los datos de parámetro de entrada y al que devuelve los datos de parámetro de salida, de acuerdo con los enlaces especificados por el identificador de descriptor de acceso.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-145">A pointer to the buffer from which the provider retrieves input parameter data and to which the provider returns output parameter data, according to the bindings specified by the accessor handle.</span></span>  
  
    -   <span data-ttu-id="7a1ba-146">El número de conjuntos de parámetros que hay en el búfer.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-146">The number of sets of parameters in the buffer.</span></span>  
  
    -   <span data-ttu-id="7a1ba-147">El identificador de descriptor de acceso creado en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-147">The accessor handle created in Step 3.</span></span>  
  
5.  <span data-ttu-id="7a1ba-148">Ejecute el comando mediante **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-148">Execute the command by using **ICommand::Execute**.</span></span>  
  
## <a name="methods-of-calling-a-stored-procedure"></a><span data-ttu-id="7a1ba-149">Métodos para llamar a un procedimiento almacenado</span><span class="sxs-lookup"><span data-stu-id="7a1ba-149">Methods of Calling a Stored Procedure</span></span>  
 <span data-ttu-id="7a1ba-150">Al ejecutar un procedimiento almacenado en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-150">When executing a stored procedure in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports the:</span></span>  
  
-   <span data-ttu-id="7a1ba-151">Secuencia de escape ODBC CALL.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-151">ODBC CALL escape sequence.</span></span>  
  
-   <span data-ttu-id="7a1ba-152">Secuencia de escape RPC (llamada a procedimiento remoto).</span><span class="sxs-lookup"><span data-stu-id="7a1ba-152">Remote procedure call (RPC) escape sequence.</span></span>  
  
-   [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="7a1ba-153">Instrucción EXECUTE. </span><span class="sxs-lookup"><span data-stu-id="7a1ba-153">EXECUTE statement.</span></span>  
  
### <a name="odbc-call-escape-sequence"></a><span data-ttu-id="7a1ba-154">Secuencia de escape ODBC CALL</span><span class="sxs-lookup"><span data-stu-id="7a1ba-154">ODBC CALL Escape Sequence</span></span>  
 <span data-ttu-id="7a1ba-155">Si conoce la información de parámetros, llame al método **ICommandWithParameters::SetParameterInfo** para describir los parámetros al proveedor.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-155">If you know parameter information, call **ICommandWithParameters::SetParameterInfo** method to describe the parameters to the provider.</span></span> <span data-ttu-id="7a1ba-156">De lo contrario, cuando se utiliza la sintaxis ODBC CALL para llamar a un procedimiento almacenado, el proveedor llama a una función del asistente para buscar la información de parámetros del procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-156">Otherwise, when the ODBC CALL syntax is used in calling a stored procedure, the provider calls a helper function to find the stored procedure parameter information.</span></span>  
  
 <span data-ttu-id="7a1ba-157">Si no está seguro de la información de parámetros (metadatos de parámetros), es preferible utilizar la sintaxis ODBC CALL.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-157">If you are not sure about the parameter information (parameter metadata), ODBC CALL syntax is recommended.</span></span>  
  
 <span data-ttu-id="7a1ba-158">La sintaxis general para llamar a un procedimiento utilizando la secuencia de escape ODBC CALL es la siguiente:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-158">The general syntax for calling a procedure by using the ODBC CALL escape sequence is:</span></span>  
  
 <span data-ttu-id="7a1ba-159">{[**? =**]**Call**_procedure_name_[**(**[*parámetro*] [**,**[*parámetro*]]... **)**]}</span><span class="sxs-lookup"><span data-stu-id="7a1ba-159">{[**?=**]**call**_procedure_name_[**(**[*parameter*][**,**[*parameter*]]...**)**]}</span></span>  
  
 <span data-ttu-id="7a1ba-160">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-160">For example:</span></span>  
  
```  
{call SalesByCategory('Produce', '1995')}  
```  
  
### <a name="rpc-escape-sequence"></a><span data-ttu-id="7a1ba-161">Secuencia de escape RPC</span><span class="sxs-lookup"><span data-stu-id="7a1ba-161">RPC Escape Sequence</span></span>  
 <span data-ttu-id="7a1ba-162">La secuencia de escape RPC es similar a la sintaxis ODBC CALL para llamar a un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-162">The RPC escape sequence is similar to the ODBC CALL syntax of calling a stored procedure.</span></span> <span data-ttu-id="7a1ba-163">Si va a llamar al procedimiento varias veces, la secuencia de escape RPC es la que proporciona el rendimiento óptimo de entre los tres métodos existentes para llamar a un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-163">If you will call the procedure multiple times, the RPC escape sequence provides most optimal performance among the three methods of calling a stored procedure.</span></span>  
  
 <span data-ttu-id="7a1ba-164">Cuando se utiliza la secuencia de escape RPC para ejecutar un procedimiento almacenado, el proveedor no llama a ninguna función del asistente para determinar la información de parámetros (como hace en el caso de la sintaxis ODBC CALL).</span><span class="sxs-lookup"><span data-stu-id="7a1ba-164">When the RPC escape sequence is used to execute a stored procedure, the provider does not call any helper function to determine the parameter information (as it does in the case of ODBC CALL syntax).</span></span> <span data-ttu-id="7a1ba-165">La sintaxis RPC es más sencilla que la sintaxis ODBC CALL, por lo que el comando se analiza con mayor rapidez y se mejora el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-165">The RPC syntax is simpler than the ODBC CALL syntax, so the command is parsed faster, improving performance.</span></span> <span data-ttu-id="7a1ba-166">En este caso, necesita proporcionar la información de parámetros mediante la ejecución de **ICommandWithParameters::SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-166">In this case, you need to provide the parameter information by executing **ICommandWithParameters::SetParameterInfo**.</span></span>  
  
 <span data-ttu-id="7a1ba-167">La secuencia de escape RPC exige que tenga un valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-167">The RPC escape sequence requires you to have a return value.</span></span> <span data-ttu-id="7a1ba-168">Si el procedimiento almacenado no devuelve un valor, el servidor devuelve de forma predeterminada un 0.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-168">If the stored procedure does not return a value, the server returns a 0 by default.</span></span> <span data-ttu-id="7a1ba-169">Además, no puede abrir un cursor de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] en el procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-169">In addition, you cannot open a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cursor on the stored procedure.</span></span> <span data-ttu-id="7a1ba-170">El procedimiento almacenado se prepara de forma implícita y la llamada a **ICommandPrepare::Prepare** produce un error.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-170">The stored procedure is prepared implicitly and the call to **ICommandPrepare::Prepare** will fail.</span></span> <span data-ttu-id="7a1ba-171">Como no se puede preparar una llamada RPC, no se puede realizar una consulta en los metadatos de columna; IColumnsInfo::GetColumnInfo e IColumnsRowset::GetColumnsRowset devolverán DB_E_NOTPREPARED.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-171">Because of the inability to prepare an RPC call, you can not query column metadata; IColumnsInfo::GetColumnInfo and IColumnsRowset::GetColumnsRowset will return DB_E_NOTPREPARED.</span></span>  
  
 <span data-ttu-id="7a1ba-172">Si conoce todos los metadatos de parámetros, la secuencia de escape RPC es la opción recomendada para ejecutar los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-172">If you know all the parameter metadata, RPC escape sequence is the recommended way to execute stored procedures.</span></span>  
  
 <span data-ttu-id="7a1ba-173">Este es un ejemplo de secuencia de escape RPC para llamar a un procedimiento almacenado:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-173">This is an example of RPC escape sequence for calling a stored procedure:</span></span>  
  
```  
{rpc SalesByCategory}  
```  
  
 <span data-ttu-id="7a1ba-174">Si quiere ver una aplicación de ejemplo que muestre una secuencia de escape RPC, consulte [Ejecución de un procedimiento almacenado &#40;mediante sintaxis RPC&#41; y procesamiento de códigos de devolución y parámetros de salida &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span><span class="sxs-lookup"><span data-stu-id="7a1ba-174">For a sample application that demonstrates an RPC escape sequence, see [Execute a Stored Procedure &#40;Using RPC Syntax&#41; and Process Return Codes and Output Parameters &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span></span>  
  
### <a name="transact-sql-execute-statement"></a><span data-ttu-id="7a1ba-175">Instrucción EXECUTE de Transact-SQL:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-175">Transact-SQL EXECUTE Statement</span></span>  
 <span data-ttu-id="7a1ba-176">Las secuencias de escape ODBC CALL y RPC son los métodos preferidos para llamar a un procedimiento almacenado en lugar de la instrucción [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7a1ba-176">The ODBC CALL escape sequence and the RPC escape sequence are the preferred methods for calling a stored procedure rather than the [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql) statement.</span></span> <span data-ttu-id="7a1ba-177">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client utiliza el mecanismo RPC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para optimizar el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-177">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the RPC mechanism of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to optimize command processing.</span></span> <span data-ttu-id="7a1ba-178">Este protocolo RPC aumenta el rendimiento eliminando gran parte del procesamiento de parámetros y análisis de instrucciones que se realiza en el servidor.</span><span class="sxs-lookup"><span data-stu-id="7a1ba-178">This RPC protocol increases performance by eliminating much of the parameter processing and statement parsing done on the server.</span></span>  
  
 <span data-ttu-id="7a1ba-179">Este es un ejemplo de la instrucción [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE**:</span><span class="sxs-lookup"><span data-stu-id="7a1ba-179">This is an example of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE** statement:</span></span>  
  
```  
EXECUTE SalesByCategory 'Produce', '1995'  
```  
  
## <a name="see-also"></a><span data-ttu-id="7a1ba-180">Consulte también</span><span class="sxs-lookup"><span data-stu-id="7a1ba-180">See Also</span></span>  
 [<span data-ttu-id="7a1ba-181">Procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="7a1ba-181">Stored Procedures</span></span>](stored-procedures.md)  
  
  
