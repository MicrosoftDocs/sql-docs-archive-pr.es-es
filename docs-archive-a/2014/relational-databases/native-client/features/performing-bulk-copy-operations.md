---
title: Realización de operaciones de copia masiva | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669663"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="85e38-102">Realizar operaciones de copia masiva</span><span class="sxs-lookup"><span data-stu-id="85e38-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="85e38-103">La característica de copia masiva de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] admite la transferencia de grandes cantidades de datos a una tabla o vista de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o desde ella.</span><span class="sxs-lookup"><span data-stu-id="85e38-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="85e38-104">Los datos también pueden transferirse especificando una instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="85e38-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="85e38-105">Los datos pueden moverse entre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y un archivo de datos del sistema operativo, como un archivo ASCII.</span><span class="sxs-lookup"><span data-stu-id="85e38-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="85e38-106">El archivo de datos puede tener diferentes formatos; el formato para una copia masiva se define en un archivo de formato.</span><span class="sxs-lookup"><span data-stu-id="85e38-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="85e38-107">Opcionalmente, los datos pueden cargarse en variables de programa y transferirse a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mediante funciones y métodos de copia masiva.</span><span class="sxs-lookup"><span data-stu-id="85e38-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="85e38-108">Para obtener una aplicación de ejemplo que muestra esta característica, consulte [Copia de datos masiva con IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="85e38-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="85e38-109">Normalmente, una aplicación utiliza la copia masiva de una de las siguientes formas:</span><span class="sxs-lookup"><span data-stu-id="85e38-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="85e38-110">Copia masiva de una tabla, una vista o el conjunto de resultados de una instrucción Transact-SQL a un archivo de datos donde los datos se almacenan en el mismo formato que la tabla o vista.</span><span class="sxs-lookup"><span data-stu-id="85e38-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="85e38-111">Recibe el nombre de archivo de datos en modo nativo.</span><span class="sxs-lookup"><span data-stu-id="85e38-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="85e38-112">Copia masiva de una tabla, una vista o el conjunto de resultados de una instrucción Transact-SQL a un archivo de datos donde los datos se almacenan en un formato distinto al de la tabla o vista.</span><span class="sxs-lookup"><span data-stu-id="85e38-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="85e38-113">En este caso, se crea un archivo de formato independiente que define las características (tipo de datos, posición, longitud, terminador, etc.) de cada columna cuando se almacena en el archivo de datos.</span><span class="sxs-lookup"><span data-stu-id="85e38-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="85e38-114">Si todas las columnas se convierten a un formato de caracteres, el archivo resultante se denomina archivo de datos en modo de carácter.</span><span class="sxs-lookup"><span data-stu-id="85e38-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="85e38-115">Copia masiva de un archivo de datos a una tabla o vista.</span><span class="sxs-lookup"><span data-stu-id="85e38-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="85e38-116">Si es necesario, se usa un archivo de formato para determinar el diseño del archivo de datos.</span><span class="sxs-lookup"><span data-stu-id="85e38-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="85e38-117">Carga de datos en variables de programa y, a continuación, importación de los datos en una tabla o vista mediante las funciones de copia masiva a fin de copiar de forma masiva una fila cada vez.</span><span class="sxs-lookup"><span data-stu-id="85e38-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="85e38-118">Los archivos de datos utilizados por las funciones de copia masiva no tienen que ser creados por otro programa de copia masiva.</span><span class="sxs-lookup"><span data-stu-id="85e38-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="85e38-119">Cualquier otro sistema puede generar un archivo de datos y un archivo de formato según las definiciones de copia masiva; estos archivos pueden utilizarse posteriormente con un programa de copia masiva de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para importar datos en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85e38-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="85e38-120">Por ejemplo, puede exportar datos de una hoja de cálculo a un archivo delimitado por tabuladores, generar un archivo de formato que describa el archivo delimitado por tabuladores y, a continuación, usar un programa de copia masiva para importar rápidamente los datos en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85e38-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="85e38-121">Los archivos de datos generados por la copia masiva también pueden importarse en otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="85e38-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="85e38-122">Por ejemplo, puede usar las funciones de copia masiva para exportar datos de una tabla o vista a un archivo delimitado por tabuladores que, a su vez, puede cargarse en una hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="85e38-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="85e38-123">Los programadores que codifican aplicaciones para usar las funciones de copia masiva deben seguir las reglas generales para obtener un rendimiento adecuado de la copia masiva.</span><span class="sxs-lookup"><span data-stu-id="85e38-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="85e38-124">Para más información sobre operaciones de carga masiva en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], consulte [Importar y exportar datos de forma masiva &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="85e38-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="85e38-125">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="85e38-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="85e38-126">Debe enlazarse un tipo definido por el usuario CLR (UDT) en forma de datos binarios.</span><span class="sxs-lookup"><span data-stu-id="85e38-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="85e38-127">Aunque un archivo de formato especifique SQLCHAR como tipo de datos de una columna UDT de destino, la utilidad BCP considerará los datos como binarios.</span><span class="sxs-lookup"><span data-stu-id="85e38-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="85e38-128">No use SET FMTONLY OFF con operaciones de copia masiva.</span><span class="sxs-lookup"><span data-stu-id="85e38-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="85e38-129">SET FMTONLY OFF puede hacer que la operación de copia masiva no se ejecute correctamente o genere resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="85e38-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="85e38-130">Proveedor OLE DB de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="85e38-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="85e38-131">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client implementa dos métodos para realizar operaciones de copia masiva con una [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] base de datos.</span><span class="sxs-lookup"><span data-stu-id="85e38-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="85e38-132">El primer método implica el uso de la interfaz [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) en operaciones de copia masiva basadas en memoria; el segundo, implica el uso de la interfaz [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) en operaciones de copia masiva basadas en archivos.</span><span class="sxs-lookup"><span data-stu-id="85e38-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="85e38-133">Usar operaciones de copia masiva basadas en memoria</span><span class="sxs-lookup"><span data-stu-id="85e38-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="85e38-134">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client implementa la interfaz **IRowsetFastLoad** para exponer la compatibilidad con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] las operaciones de copia masiva basadas en memoria.</span><span class="sxs-lookup"><span data-stu-id="85e38-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="85e38-135">La interfaz **IRowsetFastLoad** implementa los métodos [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) e [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="85e38-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="85e38-136">Habilitar una sesión para IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="85e38-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="85e38-137">El consumidor notifica al proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client su necesidad de una copia masiva mediante el establecimiento de la propiedad SSPROP_ENABLEFASTLOAD de origen de datos específica del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client en VARIANT_TRUE.</span><span class="sxs-lookup"><span data-stu-id="85e38-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="85e38-138">Con la propiedad establecida en el origen de datos, el consumidor crea una sesión de proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="85e38-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="85e38-139">La nueva sesión permite al consumidor acceder a la interfaz **IRowsetFastLoad**.</span><span class="sxs-lookup"><span data-stu-id="85e38-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="85e38-140">Si se usa la interfaz **IDataInitialize** para inicializar el origen de datos, es necesario establecer la propiedad SSPROP_IRowsetFastLoad en el parámetro *rgPropertySets* del método **IOpenRowset::OpenRowset**; de lo contrario, la llamada al método **OpenRowset** devolverá E_NOINTERFACE.</span><span class="sxs-lookup"><span data-stu-id="85e38-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="85e38-141">Al habilitar una sesión para la copia masiva, se restringe la compatibilidad del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client con las interfaces en la sesión.</span><span class="sxs-lookup"><span data-stu-id="85e38-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="85e38-142">Una sesión habilitada para copia masiva solo expone las interfaces siguientes:</span><span class="sxs-lookup"><span data-stu-id="85e38-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="85e38-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="85e38-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="85e38-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="85e38-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="85e38-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="85e38-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="85e38-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="85e38-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="85e38-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="85e38-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="85e38-148">Para deshabilitar la creación de conjuntos de filas habilitados para copia masiva y revertir la sesión del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client al procesamiento estándar, vuelva a establecer SSPROP_ENABLEFASTLOAD en VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="85e38-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="85e38-149">Conjuntos de filas IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="85e38-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="85e38-150">Los conjuntos de filas de copia masiva del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client son de solo escritura, pero exponen interfaces que permiten al consumidor determinar la estructura de una tabla de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85e38-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="85e38-151">En un conjunto de filas del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client habilitado para copia masiva se exponen las siguientes interfaces:</span><span class="sxs-lookup"><span data-stu-id="85e38-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="85e38-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="85e38-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="85e38-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="85e38-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="85e38-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="85e38-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="85e38-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="85e38-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="85e38-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="85e38-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="85e38-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="85e38-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="85e38-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="85e38-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="85e38-159">Las propiedades específicas del proveedor SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS y SSPROP_FASTLOADKEEPIDENTITY controlan el comportamiento de los conjuntos de filas de copia masiva de proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="85e38-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="85e38-160">Las propiedades se especifican en el miembro *rgProperties* de un miembro de parámetro _rgPropertySets_**IOpenRowset**.</span><span class="sxs-lookup"><span data-stu-id="85e38-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="85e38-161">Id. de propiedad</span><span class="sxs-lookup"><span data-stu-id="85e38-161">Property ID</span></span>|<span data-ttu-id="85e38-162">Descripción</span><span class="sxs-lookup"><span data-stu-id="85e38-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="85e38-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="85e38-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="85e38-164">Columna: No</span><span class="sxs-lookup"><span data-stu-id="85e38-164">Column: No</span></span><br /><br /> <span data-ttu-id="85e38-165">R (lectura) y W (escritura): Lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="85e38-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="85e38-166">Escriba:  VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="85e38-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="85e38-167">Valor predeterminado: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="85e38-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="85e38-168">Descripción: Mantiene valores de identidad suministrados por el consumidor.</span><span class="sxs-lookup"><span data-stu-id="85e38-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="85e38-169">VARIANT_FALSE: Los valores para una columna de identidad de la tabla [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] se generan por [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85e38-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="85e38-170">El proveedor de OLE DB de Native Client omite cualquier valor enlazado para la columna [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="85e38-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="85e38-171">VARIANT_TRUE: El consumidor enlaza un descriptor de acceso que proporciona un valor para una columna de identidad de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85e38-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="85e38-172">La propiedad de identidad no está disponible en las columnas que aceptan valores NULL, por lo que el consumidor proporciona un valor único en cada llamada a **IRowsetFastLoad::Insert**.</span><span class="sxs-lookup"><span data-stu-id="85e38-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="85e38-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="85e38-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="85e38-174">Columna: No</span><span class="sxs-lookup"><span data-stu-id="85e38-174">Column: No</span></span><br /><br /> <span data-ttu-id="85e38-175">R (lectura) y W (escritura): Lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="85e38-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="85e38-176">Escriba:  VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="85e38-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="85e38-177">Valor predeterminado: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="85e38-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="85e38-178">Descripción: Mantiene NULL en las columnas con una restricción DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="85e38-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="85e38-179">Solo afecta a las columnas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que aceptan valores NULL y tienen aplicada una restricción DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="85e38-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="85e38-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserta el valor predeterminado de la columna cuando el consumidor del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client inserta una fila que contiene NULL para la columna.</span><span class="sxs-lookup"><span data-stu-id="85e38-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="85e38-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserta el valor NULL como valor de columna cuando el consumidor del proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client inserta una fila que contiene NULL para la columna.</span><span class="sxs-lookup"><span data-stu-id="85e38-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="85e38-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="85e38-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="85e38-183">Columna: No</span><span class="sxs-lookup"><span data-stu-id="85e38-183">Column: No</span></span><br /><br /> <span data-ttu-id="85e38-184">R (lectura) y W (escritura): Lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="85e38-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="85e38-185">Escriba:  VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="85e38-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="85e38-186">Valor predeterminado: ninguno</span><span class="sxs-lookup"><span data-stu-id="85e38-186">Default: none</span></span><br /><br /> <span data-ttu-id="85e38-187">Descripción: Esta propiedad es la misma que la opción **-h** "*hint*[,...*n*]" de la utilidad **bcp**.</span><span class="sxs-lookup"><span data-stu-id="85e38-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="85e38-188">Las cadenas que se indican a continuación pueden utilizarse como opciones para la copia masiva de datos en una tabla.</span><span class="sxs-lookup"><span data-stu-id="85e38-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="85e38-189">**ORDER**(*columna*[**ASC** &#124; **DESC**][,...*n*]): Criterio de ordenación de los datos en el archivo de datos.</span><span class="sxs-lookup"><span data-stu-id="85e38-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="85e38-190">El rendimiento de la copia masiva mejora si el archivo de datos que se carga se ordena según el índice clúster de la tabla.</span><span class="sxs-lookup"><span data-stu-id="85e38-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="85e38-191">**ROWS_PER_BATCH** = *bb*: Número de filas de datos por lote (como *bb*).</span><span class="sxs-lookup"><span data-stu-id="85e38-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="85e38-192">El servidor optimiza la carga masiva según el valor *bb*.</span><span class="sxs-lookup"><span data-stu-id="85e38-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="85e38-193">De forma predeterminada, el valor de **ROWS_PER_BATCH** es desconocido.</span><span class="sxs-lookup"><span data-stu-id="85e38-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="85e38-194">**KILOBYTES_PER_BATCH** = *cc*: Número de kilobytes (KB) de datos por lote (como cc).</span><span class="sxs-lookup"><span data-stu-id="85e38-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="85e38-195">De forma predeterminada, el valor de **KILOBYTES_PER_BATCH** es desconocido.</span><span class="sxs-lookup"><span data-stu-id="85e38-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="85e38-196">**TABLOCK**: Se adquiere un bloqueo de nivel de tabla durante la operación de copia masiva.</span><span class="sxs-lookup"><span data-stu-id="85e38-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="85e38-197">Esta opción mejora notablemente el rendimiento ya que, al mantenerse el bloqueo solamente durante la operación de copia masiva, se reduce la contención en la tabla por bloqueo.</span><span class="sxs-lookup"><span data-stu-id="85e38-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="85e38-198">Varios clientes pueden cargar una tabla de forma simultánea si esta no tiene índices y se especifica **TABLOCK**.</span><span class="sxs-lookup"><span data-stu-id="85e38-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="85e38-199">De forma predeterminada, el comportamiento del bloqueo viene determinado por la opción de tabla **table lock on bulk load**.</span><span class="sxs-lookup"><span data-stu-id="85e38-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="85e38-200">**CHECK_CONSTRAINTS**: Durante la operación de copia masiva se comprueban todas las restricciones de *table_name*.</span><span class="sxs-lookup"><span data-stu-id="85e38-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="85e38-201">De forma predeterminada, se omiten las restricciones.</span><span class="sxs-lookup"><span data-stu-id="85e38-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="85e38-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usa las versiones de fila para los desencadenadores y almacena las versiones de fila en el almacén de versiones, en **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="85e38-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="85e38-203">Por lo tanto, las optimizaciones de registro masivo están disponibles incluso si están habilitados los desencadenadores.</span><span class="sxs-lookup"><span data-stu-id="85e38-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="85e38-204">Antes de realizar una importación masiva de un lote con un número elevado de filas y los desencadenadores habilitados, puede que tenga que ampliar el tamaño de **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="85e38-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="85e38-205">Usar operaciones de copia masiva basadas en archivos</span><span class="sxs-lookup"><span data-stu-id="85e38-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="85e38-206">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client implementa la interfaz **IBCPSession** para exponer la compatibilidad con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] las operaciones de copia masiva basadas en archivos.</span><span class="sxs-lookup"><span data-stu-id="85e38-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="85e38-207">La interfaz **IBCPSession** implementa los métodos [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) e [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="85e38-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="85e38-208">Controlador ODBC de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="85e38-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="85e38-209">El controlador ODBC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client mantiene la misma compatibilidad con las operaciones de copia masiva que formaban parte de las versiones anteriores del controlador ODBC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85e38-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="85e38-210">Para obtener información acerca de las operaciones de copia masiva con el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client, vea [realizar operaciones de copia masiva &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="85e38-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="85e38-211">Consulte también</span><span class="sxs-lookup"><span data-stu-id="85e38-211">See Also</span></span>  
 <span data-ttu-id="85e38-212">[Características de SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="85e38-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="85e38-213">[Propiedades del origen de datos &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="85e38-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="85e38-214">[Importar y exportar datos en bloque &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="85e38-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="85e38-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="85e38-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="85e38-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="85e38-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="85e38-217">[Optimizar el rendimiento de una importación en bloque](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="85e38-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
