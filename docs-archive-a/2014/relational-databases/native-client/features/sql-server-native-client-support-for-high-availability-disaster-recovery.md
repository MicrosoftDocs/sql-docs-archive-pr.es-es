---
title: SQL Server Native Client compatibilidad con la alta disponibilidad y la recuperación ante desastres | Microsoft Docs
ms.custom: ''
ms.date: 08/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 2b06186b-4090-4728-b96b-90d6ebd9f66f
author: rothja
ms.author: jroth
ms.openlocfilehash: 43c835d5c0e1c064387aee7fb0db65f577c3aa26
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87676474"
---
# <a name="sql-server-native-client-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="9fbc8-102">Compatibilidad de SQL Server Native Client para la alta disponibilidad con recuperación de desastres</span><span class="sxs-lookup"><span data-stu-id="9fbc8-102">SQL Server Native Client Support for High Availability, Disaster Recovery</span></span>
  <span data-ttu-id="9fbc8-103">En este tema se explica la compatibilidad de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (incorporada en [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) con [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9fbc8-103">This topic discusses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support (added in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="9fbc8-104">Para más información sobre [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], vea [Agentes de escucha del grupo de disponibilidad, conectividad de cliente y conmutación por error de una aplicación &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creación y configuración de grupos de disponibilidad &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Clústeres de conmutación por error y grupos de disponibilidad AlwaysOn &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md) y [Secundarias activas: réplicas secundarias legibles (grupos de disponibilidad AlwaysOn)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="9fbc8-104">For more information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md), and [Active Secondaries: Readable Secondary Replicas (AlwaysOn Availability Groups)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>  
  
 <span data-ttu-id="9fbc8-105">Puede especificar el agente de escucha del grupo de disponibilidad de un determinado grupo de disponibilidad en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-105">You can specify the availability group listener of a given availability group in the connection string.</span></span> <span data-ttu-id="9fbc8-106">Si una aplicación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client se conecta a una base de datos de un grupo de disponibilidad que conmuta por error, la conexión original se interrumpe y la aplicación debe abrir una nueva conexión para continuar el trabajo después de la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-106">If a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application is connected to a database in an availability group that fails over, the original connection is broken, and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="9fbc8-107">Si no va a conectarse a un agente de escucha del grupo de disponibilidad y si varias direcciones IP están asociados con un nombre de host, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client iterará secuencialmente a través de todas las direcciones IP asociadas a la entrada DNS.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-107">If you are not connecting to an availability group listener, and if multiple IP addresses are associated with a hostname, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="9fbc8-108">Esto puede llevar mucho tiempo si la primera dirección IP que devuelve el servidor DNS no está enlazada a una tarjeta (NIC) de interfaz de red.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-108">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="9fbc8-109">Al conectarse a un agente de escucha de un grupo de disponibilidad, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client intenta establecer conexiones a todas las direcciones IP en paralelo y, si algún intento de conexión tiene éxito, el controlador descartará los intentos de conexión pendientes.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-109">When connecting to an availability group listener, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9fbc8-110">El aumento del tiempo de espera de la conexión y la implementación de la lógica de reintento de conexión aumentarán la probabilidad de que una aplicación se conecte a un grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-110">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="9fbc8-111">Además, dado que una conexión puede producir un error debido a la conmutación por error de un grupo de disponibilidad, es aconsejable implementar la lógica de reintento de conexión y hacer que una conexión que no se ha podido establecer se reintente hasta que vuelva a conectarse.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-111">Also, because a connection can fail because of an availability group failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="9fbc8-112">Conectarse a MultiSubnetFailover</span><span class="sxs-lookup"><span data-stu-id="9fbc8-112">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="9fbc8-113">Especifique siempre `MultiSubnetFailover=Yes` al conectarse a un agente de escucha de grupo de disponibilidad de SQL Server 2012 o a una instancia de clúster de conmutación por error de SQL Server 2012.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-113">Always specify `MultiSubnetFailover=Yes` when connecting to a SQL Server 2012 availability group listener or SQL Server 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="9fbc8-114">`MultiSubnetFailover` habilita una conmutación por error más rápida para todos los grupos de disponibilidad y la instancia del clúster de conmutación por error en SQL Server 2012 y reducirá significativamente el tiempo de la conmutación por error en las topologías únicas y AlwaysOn de varias subredes.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-114">`MultiSubnetFailover` enables faster failover for all Availability Groups and failover cluster instance in SQL Server 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="9fbc8-115">En un clúster de conmutación por error de varias subredes, el cliente intentará conexiones en paralelo.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-115">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="9fbc8-116">Durante una conmutación por error de subred, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client seguirá reintentando la conexión TCP.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-116">During a subnet failover, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="9fbc8-117">La propiedad de conexión `MultiSubnetFailover` indica que la aplicación se implementa en un grupo de disponibilidad o una instancia de clúster de conmutación por error, y que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client intentará conectarse a la base de datos en la instancia principal de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] intentando conectarse a las direcciones IP de todos los grupos de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-117">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or Failover Cluster Instance, and that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="9fbc8-118">Cuando `MultiSubnetFailover=Yes` se especifica para una conexión, el cliente reintenta la conexión TCP con más rapidez que los intervalos de retransmisión TCP predeterminados del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-118">When `MultiSubnetFailover=Yes` is specified for a connection, the client retries TCP connection attempts faster than the operating system's default TCP retransmit intervals.</span></span> <span data-ttu-id="9fbc8-119">Esto permite una reconexión más rápida después de la conmutación por error de un grupo de disponibilidad AlwaysOn o una instancia de clúster de conmutación por error AlwaysOn, y es aplicable a instancias de clúster de conmutación por error y grupos de disponibilidad de una y varias subredes.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-119">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="9fbc8-120">Para más información sobre las palabras clave de cadena de conexión, vea [Usar palabras clave de cadena de conexión con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="9fbc8-120">For more information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="9fbc8-121">Si se especifica `MultiSubnetFailover=Yes` al conectarse a algo que no sea un agente de escucha de un grupo de disponibilidad o una instancia de clúster de conmutación por error, el rendimiento puede verse afectado negativamente y, por ello, no se admite.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-121">Specifying `MultiSubnetFailover=Yes` when connecting to something other than an availability group listener or Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="9fbc8-122">Utilice las siguientes instrucciones para conectarse a un servidor en un grupo de disponibilidad o una instancia de clúster de conmutación por error:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-122">Use the following guidelines to connect to a server in an availability group or Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="9fbc8-123">Utilice la propiedad de conexión `MultiSubnetFailover` al conectarse a una sola subred o a varias subredes. Así mejorará el rendimiento en ambas situaciones.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-123">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="9fbc8-124">Para conectarse a un grupo de disponibilidad, especifique el agente de escucha del grupo de disponibilidad como el servidor en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-124">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="9fbc8-125">La conexión a una instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] configurada con más de 64 direcciones IP producirá un error en la conexión.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-125">Connecting to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="9fbc8-126">El comportamiento de una aplicación que utilice la propiedad de conexión `MultiSubnetFailover` no se ve afectado por el tipo de autenticación: de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], Kerberos o autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-126">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="9fbc8-127">Puede aumentar el valor de `loginTimeout` para tener en cuenta el tiempo de conmutación por error y reducir los reintentos de conexión de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-127">You can increase the value of `loginTimeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="9fbc8-128">No se admiten las transacciones distribuidas.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-128">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="9fbc8-129">Si no está activado el enrutamiento de solo lectura, no se podrá conectar a una ubicación de réplica secundaria en un grupo de disponibilidad en las siguientes situaciones:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-129">If read-only routing is not in effect, connecting to a secondary replica location in an availability group will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="9fbc8-130">Si la ubicación de réplica secundaria no está configurada para aceptar conexiones.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-130">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="9fbc8-131">Si una aplicación utiliza `ApplicationIntent=ReadWrite` (se explica a continuación) y la ubicación de réplica secundaria está configurada para el acceso de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-131">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="9fbc8-132">Una conexión producirá un error si una réplica principal está configurada para rechazar las cargas de trabajo de solo lectura y la cadena de conexión contiene `ApplicationIntent=ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-132">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="9fbc8-133">Actualizar para utilizar clústeres de varias subredes a partir de la creación de reflejo de la base de datos</span><span class="sxs-lookup"><span data-stu-id="9fbc8-133">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="9fbc8-134">Se producirá un error de conexión si las palabras clave de conexión `MultiSubnetFailover` y `Failover_Partner` se encuentran en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-134">A connection error will occur if the `MultiSubnetFailover` and `Failover_Partner` connection keywords are present in the connection string.</span></span> <span data-ttu-id="9fbc8-135">También se producirá un error si se utiliza `MultiSubnetFailover` y [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] devuelve una respuesta del asociado de conmutación por error que indica que forma parte de un par de creación de reflejo de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-135">An error will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="9fbc8-136">Si actualiza una aplicación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client que utilice actualmente la creación de reflejo de la base de datos en un escenario de varias subredes, debe quitar la propiedad de conexión `Failover_Partner` y reemplazarla con `MultiSubnetFailover` establecida en `Yes` y reemplazar el nombre de servidor en la cadena de conexión con un agente de escucha de grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-136">If you upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover_Partner` connection property and replace it with `MultiSubnetFailover` set to `Yes` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="9fbc8-137">Si una cadena de conexión utiliza `Failover_Partner` y `MultiSubnetFailover=Yes`, el controlador generará un error.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-137">If a connection string uses `Failover_Partner` and `MultiSubnetFailover=Yes`, the driver will generate an error.</span></span> <span data-ttu-id="9fbc8-138">Sin embargo, si una cadena de conexión utiliza `Failover_Partner` y `MultiSubnetFailover=No` (o `ApplicationIntent=ReadWrite`), la aplicación utilizará la creación de reflejo de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-138">However, if a connection string uses `Failover_Partner` and `MultiSubnetFailover=No` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="9fbc8-139">El controlador devuelve un error si la creación de reflejo de la base de datos se usa en la base de datos principal del grupo de disponibilidad y si `MultiSubnetFailover=Yes` se utiliza en la cadena de conexión que se conecta a una base de datos principal en lugar de a un agente de escucha del grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-139">The driver will return an error if database mirroring is used on the primary database in the availability group, and if `MultiSubnetFailover=Yes` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="9fbc8-140">Especificar el intento de la aplicación</span><span class="sxs-lookup"><span data-stu-id="9fbc8-140">Specifying Application Intent</span></span>  
 <span data-ttu-id="9fbc8-141">Cuando `ApplicationIntent=ReadOnly`, el cliente solicita una carga de trabajo de lectura al conectarse a una base de datos habilitada para AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-141">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="9fbc8-142">El servidor aplicará el intento en el momento de la conexión y durante una instrucción de base de datos USE pero solo en una base de datos con habilitada para AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-142">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="9fbc8-143">La palabra clave `ApplicationIntent` no funciona con bases de datos de solo lectura heredadas.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-143">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="9fbc8-144">Una base de datos puede permitir o denegar la lectura de las cargas de trabajo en la base de datos de destino AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-144">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="9fbc8-145">(Esto se hace con la cláusula `ALLOW_CONNECTIONS` de las instrucciones `PRIMARY_ROLE` y `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)].)</span><span class="sxs-lookup"><span data-stu-id="9fbc8-145">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="9fbc8-146">La palabra clave `ApplicationIntent` se utiliza para habilitar el enrutamiento de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-146">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="9fbc8-147">Enrutamiento de solo lectura</span><span class="sxs-lookup"><span data-stu-id="9fbc8-147">Read-Only Routing</span></span>  
 <span data-ttu-id="9fbc8-148">El enrutamiento de solo lectura es una característica que puede garantizar la disponibilidad de una réplica de solo lectura de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-148">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="9fbc8-149">Para habilitar el enrutamiento de solo lectura:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-149">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="9fbc8-150">Debe conectarse siempre a un agente de escucha de grupo de disponibilidad Always On.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-150">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="9fbc8-151">La palabra clave de la cadena de conexión `ApplicationIntent` debe establecerse en `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-151">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="9fbc8-152">El administrador de bases de datos debe configurar el grupo de disponibilidad para habilitar el enrutamiento de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-152">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="9fbc8-153">Es posible que varias conexiones con enrutamiento de solo lectura no se conecten todas a la misma réplica de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-153">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="9fbc8-154">Los cambios en la sincronización de la base de datos o los cambios en la configuración de enrutamiento del servidor pueden producir conexiones de cliente para réplicas de solo lectura diferentes.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-154">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="9fbc8-155">Para asegurarse de que todas las solicitudes de solo lectura se conectan a la misma réplica de solo lectura, no pase un agente de escucha de grupo de disponibilidad a la palabra clave de cadena de conexión `Server`.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-155">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Server` connection string keyword.</span></span> <span data-ttu-id="9fbc8-156">En su lugar, especifique el nombre de la instancia de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-156">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="9fbc8-157">El enrutamiento de solo lectura puede tardar más en conectarse al servidor principal porque el enrutamiento de solo lectura se conecta primero al servidor principal y luego busca el mejor secundario legible disponible.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-157">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="9fbc8-158">Por ello, debe aumentar el tiempo de espera de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-158">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="odbc"></a><span data-ttu-id="9fbc8-159">ODBC</span><span class="sxs-lookup"><span data-stu-id="9fbc8-159">ODBC</span></span>  
 <span data-ttu-id="9fbc8-160">Se han agregado dos palabras clave de cadena de conexión ODBC para ser compatible con [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-160">Two ODBC connection string keywords were added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="9fbc8-161">Para más información sobre las palabras clave de cadena de conexión ODBC en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vea [Usar palabras clave de cadena de conexión con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="9fbc8-161">For more information about ODBC connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="9fbc8-162">Las propiedades de conexión equivalentes son:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-162">The equivalent connection properties are:</span></span>  
  
-   `SQL_COPT_SS_APPLICATION_INTENT`  
  
-   `SQL_COPT_SS_MULTISUBNET_FAILOVER`  
  
 <span data-ttu-id="9fbc8-163">Para más información sobre las propiedades de conexión ODBC en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vea [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="9fbc8-163">For more information about ODBC connection properties in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span></span>  
  
 <span data-ttu-id="9fbc8-164">La funcionalidad de las palabras clave `ApplicationIntent` y `MultiSubnetFailover` se expondrá en el Administrador de orígenes de datos ODBC para los DSN que utilizan el controlador de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client a partir de [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9fbc8-164">The functionality of the `ApplicationIntent` and `MultiSubnetFailover` keywords will be exposed in the ODBC Data Source Administrator for DSNs that use the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver, beginning in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
 <span data-ttu-id="9fbc8-165">Una aplicación ODBC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client puede utilizar una de estas tres funciones para realizar la conexión:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-165">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC application can use one of three functions to make the connection:</span></span>  
  
|<span data-ttu-id="9fbc8-166">Función</span><span class="sxs-lookup"><span data-stu-id="9fbc8-166">Function</span></span>|<span data-ttu-id="9fbc8-167">Descripción</span><span class="sxs-lookup"><span data-stu-id="9fbc8-167">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="9fbc8-168">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="9fbc8-168">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)|<span data-ttu-id="9fbc8-169">La lista de servidores devuelta por `SQLBrowseConnect` no incluirá los VNN.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-169">The list of servers returned by `SQLBrowseConnect` will not include VNNs.</span></span> <span data-ttu-id="9fbc8-170">Solo verá una lista de servidores que no indica si el servidor es un servidor independiente, o un servidor principal o secundario de un clúster de clústeres de conmutación por error de Windows Server (WSFC) que contiene dos o más instancias de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] habilitadas para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9fbc8-170">You will only see a list of servers without any indication if the server is a standalone server, or a primary or secondary server in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="9fbc8-171">Si se conecta a un servidor y obtiene un error, puede deberse a que se ha conectado a un servidor, y el valor de `ApplicationIntent` no es compatible con la configuración del servidor.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-171">If you connect to a server and get a failure, it may be because you have connected to a server, and the `ApplicationIntent` setting is not compatible with the server configuration.</span></span><br /><br /> <span data-ttu-id="9fbc8-172">Dado que `SQLBrowseConnect` no reconoce los servidores de un clúster de clústeres de conmutación por error de Windows Server (WSFC) que contiene dos o más instancias de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] habilitadas para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` omite la palabra clave de cadena de conexión `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-172">Because `SQLBrowseConnect` does not recognize servers in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignores the `MultiSubnetFailover` connection string keyword.</span></span>|  
|[<span data-ttu-id="9fbc8-173">SQLConnect</span><span class="sxs-lookup"><span data-stu-id="9fbc8-173">SQLConnect</span></span>](../../native-client-odbc-api/sqlconnect.md)|<span data-ttu-id="9fbc8-174">`SQLConnect` admite `ApplicationIntent` y `MultiSubnetFailover` mediante un nombre del origen de datos (DSN) o mediante propiedades de conexión.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-174">`SQLConnect` supports both `ApplicationIntent` and `MultiSubnetFailover` via a data source name (DSN) or connection properties.</span></span>|  
|[<span data-ttu-id="9fbc8-175">SQLDriverConnect</span><span class="sxs-lookup"><span data-stu-id="9fbc8-175">SQLDriverConnect</span></span>](../../native-client-odbc-api/sqldriverconnect.md)|<span data-ttu-id="9fbc8-176">`SQLDriverConnect` admite `ApplicationIntent` y `MultiSubnetFailover` mediante palabras clave de cadena de conexión, propiedades de conexión o DSN.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-176">`SQLDriverConnect` supports `ApplicationIntent` and `MultiSubnetFailover` via connection string keywords, connection properties, or DSN.</span></span>|  
  
## <a name="ole-db"></a><span data-ttu-id="9fbc8-177">OLE DB</span><span class="sxs-lookup"><span data-stu-id="9fbc8-177">OLE DB</span></span>  
 <span data-ttu-id="9fbc8-178">OLE DB en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client no admite la palabra clave `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-178">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not support the `MultiSubnetFailover` keyword.</span></span>  
  
 <span data-ttu-id="9fbc8-179">OLE DB en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client admitirá la intención de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-179">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will support application intent.</span></span> <span data-ttu-id="9fbc8-180">La intención de aplicaciones se comportará igual para las aplicaciones OLE DB que para las aplicaciones ODBC (vea el párrafo anterior).</span><span class="sxs-lookup"><span data-stu-id="9fbc8-180">Application intent will behave the same for OLE DB applications as ODBC applications (see above).</span></span>  
  
 <span data-ttu-id="9fbc8-181">Se ha agregado una palabra clave de cadena de conexión OLE DB para admitir [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-181">One OLE DB connection string keyword added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `Application Intent`  
  
 <span data-ttu-id="9fbc8-182">Para más información sobre las palabras clave de cadena de conexión en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vea [Usar palabras clave de cadena de conexión con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="9fbc8-182">For more information about connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="9fbc8-183">Las propiedades de conexión equivalentes son:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-183">The equivalent connection properties are:</span></span>  
  
-   `SSPROP_INIT_APPLICATIONINTENT`  
  
-   `DBPROP_INIT_PROVIDERSTRING`  
  
 <span data-ttu-id="9fbc8-184">Una aplicación OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client puede utilizar uno de los métodos siguientes para especificar la intención de aplicaciones:</span><span class="sxs-lookup"><span data-stu-id="9fbc8-184">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB application can use one of the methods to specify application intent:</span></span>  
  
 `IDBInitialize::Initialize`  
 <span data-ttu-id="9fbc8-185">`IDBInitialize::Initialize` utiliza el conjunto de propiedades previamente configurado para inicializar el origen de datos y crear el objeto de origen de datos.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-185">`IDBInitialize::Initialize` uses the previously configured set of properties to initialize the data source and create the data source object.</span></span> <span data-ttu-id="9fbc8-186">Especifique la intención de aplicaciones como una propiedad del proveedor o como parte de la cadena de propiedades extendidas.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-186">Specify application intent as a provider property or as part of the extended properties string.</span></span>  
  
 `IDataInitialize::GetDataSource`  
 <span data-ttu-id="9fbc8-187">`IDataInitialize::GetDataSource` toma una cadena de conexión de entrada que puede contener la palabra clave `Application Intent`.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-187">`IDataInitialize::GetDataSource` takes an input connection string that can contain the `Application Intent` keyword.</span></span>  
  
 `IDBProperties::GetProperties`  
 <span data-ttu-id="9fbc8-188">`IDBProperties::GetProperties` recupera el valor de la propiedad que está establecida actualmente en el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-188">`IDBProperties::GetProperties` retrieves the value of the property that is currently set on the data source.</span></span>  <span data-ttu-id="9fbc8-189">Puede recuperar el valor de `Application Intent` a través de la propiedad DBPROP_INIT_PROVIDERSTRING y la propiedad SSPROP_INIT_APPLICATIONINTENT.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-189">You can retrieve the `Application Intent` value through the DBPROP_INIT_PROVIDERSTRING property and SSPROP_INIT_APPLICATIONINTENT property.</span></span>  
  
 `IDBProperties::SetProperties`  
 <span data-ttu-id="9fbc8-190">Para establecer el valor de la propiedad `ApplicationIntent`, llame a `IDBProperties::SetProperties` y pásele la propiedad `SSPROP_INIT_APPLICATIONINTENT` con el valor "`ReadWrite`" o "`ReadOnly`" o la propiedad `DBPROP_INIT_PROVIDERSTRING` con el valor "`ApplicationIntent=ReadOnly`" o "`ApplicationIntent=ReadWrite`".</span><span class="sxs-lookup"><span data-stu-id="9fbc8-190">To set the `ApplicationIntent` property value, call `IDBProperties::SetProperties` passing in the `SSPROP_INIT_APPLICATIONINTENT` property with value "`ReadWrite`" or "`ReadOnly`" or `DBPROP_INIT_PROVIDERSTRING` property with value containing "`ApplicationIntent=ReadOnly`" or "`ApplicationIntent=ReadWrite`".</span></span>  
  
 <span data-ttu-id="9fbc8-191">Puede especificar la intención de aplicaciones en el campo Propiedades de intención de aplicaciones de la pestaña Todo del cuadro de diálogo **Propiedades de vínculo de datos**.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-191">You can specify application intent in the Application Intent Properties field of the All tab in the **Data Link Properties** dialog box.</span></span>  
  
 <span data-ttu-id="9fbc8-192">Cuando se establezcan conexiones implícitas, estas usarán la configuración de la intención de aplicaciones de la conexión primaria.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-192">When implicit connections are established, the implicit connection will use the application intent setting of the parent connection.</span></span> <span data-ttu-id="9fbc8-193">De forma similar, cuando se creen varias sesiones con el mismo origen de datos estas heredarán la configuración de la intención de aplicaciones del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="9fbc8-193">Similarly, multiple sessions created from the same data source will inherit the data source's application intent setting.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9fbc8-194">Consulte también</span><span class="sxs-lookup"><span data-stu-id="9fbc8-194">See Also</span></span>  
 <span data-ttu-id="9fbc8-195">[Características de SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="9fbc8-195">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="9fbc8-196">Usar palabras clave de cadena de conexión con SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="9fbc8-196">Using Connection String Keywords with SQL Server Native Client</span></span>](../applications/using-connection-string-keywords-with-sql-server-native-client.md)  
  
  
