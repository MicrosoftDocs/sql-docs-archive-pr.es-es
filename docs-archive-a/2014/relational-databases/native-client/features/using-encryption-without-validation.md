---
title: Uso del cifrado sin validación | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], encryption
- cryptography [SQL Server Native Client]
- SQLNCLI, encryption
- encryption [SQL Server Native Client]
- SQL Server Native Client, encryption
ms.assetid: f4c63206-80bb-4d31-84ae-ccfcd563effa
author: rothja
ms.author: jroth
ms.openlocfilehash: 0a6d2e8b3d696a92e3fa3e1b7de7604551d4f9ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669653"
---
# <a name="using-encryption-without-validation"></a><span data-ttu-id="2e29e-102">Utilizar el cifrado sin validación</span><span class="sxs-lookup"><span data-stu-id="2e29e-102">Using Encryption Without Validation</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2e29e-103">cifra siempre los paquetes de red asociados al inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="2e29e-103">always encrypts network packets associated with logging in.</span></span> <span data-ttu-id="2e29e-104">Si no se ha proporcionado ningún certificado en el servidor cuando este se inicia, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] genera un certificado autofirmado que se utiliza para cifrar los paquetes de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="2e29e-104">If no certificate has been provisioned on the server when it starts up, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a self-signed certificate which is used to encrypt login packets.</span></span>  
  
 <span data-ttu-id="2e29e-105">Las aplicaciones pueden solicitar también el cifrado de todo el tráfico de red mediante palabras clave de cadenas de conexión o propiedades de conexión.</span><span class="sxs-lookup"><span data-stu-id="2e29e-105">Applications may also request encryption of all network traffic by using connection string keywords or connection properties.</span></span> <span data-ttu-id="2e29e-106">Las palabras clave son "Encrypt" para ODBC y OLE DB al usar una cadena de proveedor con **IDbInitialize:: Initialize**o "usar cifrado para datos" para ADO y OLE DB cuando se usa una cadena de inicialización con **IDataInitialize**.</span><span class="sxs-lookup"><span data-stu-id="2e29e-106">The keywords are "Encrypt" for ODBC and OLE DB when using a provider string with **IDbInitialize::Initialize**, or "Use Encryption for Data" for ADO and OLE DB when using an initialization string with **IDataInitialize**.</span></span> <span data-ttu-id="2e29e-107">También se puede configurar mediante [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager mediante la opción **forzar cifrado de protocolos** .</span><span class="sxs-lookup"><span data-stu-id="2e29e-107">This may also be configured by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager using the **Force Protocol Encryption** option.</span></span> <span data-ttu-id="2e29e-108">De forma predeterminada, el cifrado de todo el tráfico de red de una conexión requiere que se proporcione un certificado en el servidor.</span><span class="sxs-lookup"><span data-stu-id="2e29e-108">By default, encryption of all network traffic for a connection requires that a certificate be provisioned on the server.</span></span>  
  
 <span data-ttu-id="2e29e-109">Para obtener información sobre las palabras clave de cadena de conexión, vea [usar palabras clave de cadena de conexión con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="2e29e-109">For information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="2e29e-110">Para permitir usar el cifrado cuando no se ha proporcionado un certificado en el servidor, se puede usar el Administrador de configuración de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para establecer las opciones **Forzar cifrado de protocolo** y **Confiar en certificado de servidor**.</span><span class="sxs-lookup"><span data-stu-id="2e29e-110">To enable encryption to be used when a certificate has not been provisioned on the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager can be used to set both the **Force Protocol Encryption** and the **Trust Server Certificate** options.</span></span> <span data-ttu-id="2e29e-111">En ese caso, el cifrado utilizará un certificado de servidor autofirmado sin validación si no se ha proporcionado ningún certificado comprobable en el servidor.</span><span class="sxs-lookup"><span data-stu-id="2e29e-111">In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.</span></span>  
  
 <span data-ttu-id="2e29e-112">Las aplicaciones también pueden utilizar la palabra clave "TrustServerCertificate" o su atributo de conexión asociado para garantizar que se realiza el cifrado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-112">Applications may also use the "TrustServerCertificate" keyword or its associated connection attribute to guarantee that encryption takes place.</span></span> <span data-ttu-id="2e29e-113">La configuración de las aplicaciones nunca reduce el nivel de seguridad establecido por el Administrador de configuración cliente de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], pero sí puede reforzarlo.</span><span class="sxs-lookup"><span data-stu-id="2e29e-113">Application settings never reduce the level of security set by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Client Configuration Manager, but may strengthen it.</span></span> <span data-ttu-id="2e29e-114">Por ejemplo, si **Forzar cifrado de protocolo** no está establecido para el cliente, una aplicación puede solicitar su propio cifrado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-114">For example, if **Force Protocol Encryption** is not set for the client, an application may request encryption itself.</span></span> <span data-ttu-id="2e29e-115">Para garantizar el cifrado incluso cuando no se ha proporcionado un certificado de servidor, una aplicación puede solicitar el cifrado y "TrustServerCertificate".</span><span class="sxs-lookup"><span data-stu-id="2e29e-115">To guarantee encryption even when a server certificate has not been provisioned, an application may request encryption and "TrustServerCertificate".</span></span> <span data-ttu-id="2e29e-116">Sin embargo, si "TrustServerCertificate" no está habilitado en la configuración del cliente, se requiere igualmente un certificado de servidor.</span><span class="sxs-lookup"><span data-stu-id="2e29e-116">However, if "TrustServerCertificate" is not enabled in the client configuration, a provisioned server certificate is still required.</span></span> <span data-ttu-id="2e29e-117">En la tabla siguiente se describen todos los casos:</span><span class="sxs-lookup"><span data-stu-id="2e29e-117">The following table describes all cases:</span></span>  
  
|<span data-ttu-id="2e29e-118">Cliente configurado con Forzar cifrado de protocolo</span><span class="sxs-lookup"><span data-stu-id="2e29e-118">Force Protocol Encryption client setting</span></span>|<span data-ttu-id="2e29e-119">Cliente configurado con Confiar en certificado de servidor</span><span class="sxs-lookup"><span data-stu-id="2e29e-119">Trust Server Certificate client setting</span></span>|<span data-ttu-id="2e29e-120">Cadena/atributo de conexión Encrypt/Use Encryption for Data</span><span class="sxs-lookup"><span data-stu-id="2e29e-120">Connection string/connection attribute Encrypt/Use Encryption for Data</span></span>|<span data-ttu-id="2e29e-121">Cadena/atributo de conexión Trust Server Certificate</span><span class="sxs-lookup"><span data-stu-id="2e29e-121">Connection string/connection attribute Trust Server Certificate</span></span>|<span data-ttu-id="2e29e-122">Resultado</span><span class="sxs-lookup"><span data-stu-id="2e29e-122">Result</span></span>|  
|----------------------------------------------|---------------------------------------------|------------------------------------------------------------------------------|----------------------------------------------------------------------|------------|  
|<span data-ttu-id="2e29e-123">No</span><span class="sxs-lookup"><span data-stu-id="2e29e-123">No</span></span>|<span data-ttu-id="2e29e-124">N/D</span><span class="sxs-lookup"><span data-stu-id="2e29e-124">N/A</span></span>|<span data-ttu-id="2e29e-125">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="2e29e-125">No (default)</span></span>|<span data-ttu-id="2e29e-126">Se ignora.</span><span class="sxs-lookup"><span data-stu-id="2e29e-126">Ignored</span></span>|<span data-ttu-id="2e29e-127">No se produce el cifrado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-127">No encryption occurs.</span></span>|  
|<span data-ttu-id="2e29e-128">No</span><span class="sxs-lookup"><span data-stu-id="2e29e-128">No</span></span>|<span data-ttu-id="2e29e-129">N/D</span><span class="sxs-lookup"><span data-stu-id="2e29e-129">N/A</span></span>|<span data-ttu-id="2e29e-130">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-130">Yes</span></span>|<span data-ttu-id="2e29e-131">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="2e29e-131">No (default)</span></span>|<span data-ttu-id="2e29e-132">El cifrado solamente se produce si hay un certificado de servidor comprobable; de lo contrario, se produce un error en el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="2e29e-132">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="2e29e-133">No</span><span class="sxs-lookup"><span data-stu-id="2e29e-133">No</span></span>|<span data-ttu-id="2e29e-134">N/D</span><span class="sxs-lookup"><span data-stu-id="2e29e-134">N/A</span></span>|<span data-ttu-id="2e29e-135">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-135">Yes</span></span>|<span data-ttu-id="2e29e-136">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-136">Yes</span></span>|<span data-ttu-id="2e29e-137">El cifrado se produce siempre, pero puede que se utilice un certificado de servidor autofirmado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-137">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="2e29e-138">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-138">Yes</span></span>|<span data-ttu-id="2e29e-139">No</span><span class="sxs-lookup"><span data-stu-id="2e29e-139">No</span></span>|<span data-ttu-id="2e29e-140">Se ignora.</span><span class="sxs-lookup"><span data-stu-id="2e29e-140">Ignored</span></span>|<span data-ttu-id="2e29e-141">Se ignora.</span><span class="sxs-lookup"><span data-stu-id="2e29e-141">Ignored</span></span>|<span data-ttu-id="2e29e-142">El cifrado solamente se produce si hay un certificado de servidor comprobable; de lo contrario, se produce un error en el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="2e29e-142">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="2e29e-143">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-143">Yes</span></span>|<span data-ttu-id="2e29e-144">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-144">Yes</span></span>|<span data-ttu-id="2e29e-145">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="2e29e-145">No (default)</span></span>|<span data-ttu-id="2e29e-146">Se ignora.</span><span class="sxs-lookup"><span data-stu-id="2e29e-146">Ignored</span></span>|<span data-ttu-id="2e29e-147">El cifrado se produce siempre, pero puede que se utilice un certificado de servidor autofirmado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-147">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="2e29e-148">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-148">Yes</span></span>|<span data-ttu-id="2e29e-149">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-149">Yes</span></span>|<span data-ttu-id="2e29e-150">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-150">Yes</span></span>|<span data-ttu-id="2e29e-151">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="2e29e-151">No (default)</span></span>|<span data-ttu-id="2e29e-152">El cifrado solamente se produce si hay un certificado de servidor comprobable; de lo contrario, se produce un error en el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="2e29e-152">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="2e29e-153">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-153">Yes</span></span>|<span data-ttu-id="2e29e-154">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-154">Yes</span></span>|<span data-ttu-id="2e29e-155">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-155">Yes</span></span>|<span data-ttu-id="2e29e-156">Sí</span><span class="sxs-lookup"><span data-stu-id="2e29e-156">Yes</span></span>|<span data-ttu-id="2e29e-157">El cifrado se produce siempre, pero es posible que se use un certificado de servidor autofirmado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-157">Encryption always occurs, but might use a self-signed server certificate.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="2e29e-158">Proveedor OLE DB de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2e29e-158">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="2e29e-159">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite el cifrado sin validación mediante la adición de la propiedad de inicialización de origen de datos SSPROP_INIT_TRUST_SERVER_CERTIFICATE, que se implementa en el conjunto de propiedades DBPROPSET_SQLSERVERDBINIT.</span><span class="sxs-lookup"><span data-stu-id="2e29e-159">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports encryption without validation through the addition of the SSPROP_INIT_TRUST_SERVER_CERTIFICATE data source initialization property, which is implemented in the DBPROPSET_SQLSERVERDBINIT property set.</span></span> <span data-ttu-id="2e29e-160">Además, se ha agregado una nueva palabra clave de cadena de conexión, "TrustServerCertificate".</span><span class="sxs-lookup"><span data-stu-id="2e29e-160">In addition, a new connection string keyword, "TrustServerCertificate", as been added.</span></span> <span data-ttu-id="2e29e-161">Acepta valores sí o no; no es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-161">It accepts yes or no values; no is the default.</span></span> <span data-ttu-id="2e29e-162">Cuando se utilizan componentes de servicio, acepta valores true o false; false es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-162">When using service components, it accepts true or false values; false is the default.</span></span>  
  
 <span data-ttu-id="2e29e-163">Para más información sobre las mejoras realizadas en el conjunto de propiedades DBPROPSET_SQLSERVERDBINIT, consulte [Propiedades de inicialización y autorización](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span><span class="sxs-lookup"><span data-stu-id="2e29e-163">For more information about enhancements made to the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="2e29e-164">Controlador ODBC de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2e29e-164">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="2e29e-165">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client admite el cifrado sin validación mediante adiciones a las funciones [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) y [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) .</span><span class="sxs-lookup"><span data-stu-id="2e29e-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports encryption without validation through additions to the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) and [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) functions.</span></span> <span data-ttu-id="2e29e-166">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE se ha agregado para aceptar SQL_TRUST_SERVER_CERTIFICATE_YES o SQL_TRUST_SERVER_CERTIFICATE_NO, siendo SQL_TRUST_SERVER_CERTIFICATE_NO el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-166">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE has been added to accept either SQL_TRUST_SERVER_CERTIFICATE_YES or SQL_TRUST_SERVER_CERTIFICATE_NO, with SQL_TRUST_SERVER_CERTIFICATE_NO being the default.</span></span> <span data-ttu-id="2e29e-167">Además, se ha agregado una nueva palabra clave de cadena de conexión, "TrustServerCertificate".</span><span class="sxs-lookup"><span data-stu-id="2e29e-167">In addition, a new connection string keyword, "TrustServerCertificate", has been added.</span></span> <span data-ttu-id="2e29e-168">Acepta valores sí o no; "no" es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2e29e-168">It accepts yes or no values; "no" is the default.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2e29e-169">Consulte también</span><span class="sxs-lookup"><span data-stu-id="2e29e-169">See Also</span></span>  
 [<span data-ttu-id="2e29e-170">Características de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2e29e-170">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  
