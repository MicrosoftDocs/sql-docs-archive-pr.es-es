---
title: Cambio de las contraseñas mediante programación | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], password expiration
- SQL Server Native Client ODBC driver, passwords
- SQL Server Native Client OLE DB provider, passwords
- passwords [SQL Server], expiration
- SQLNCLI, password expiration
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- expired passwords [SQL Server Native Client]
- SQL Server Native Client, password expiration
- modifying passwords
ms.assetid: 624ad949-5fed-4ce5-b319-878549f9487b
author: rothja
ms.author: jroth
ms.openlocfilehash: 86085f8ba7c54cfcab1a3c7f6e8ade30ecf9d0da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87745263"
---
# <a name="changing-passwords-programmatically"></a><span data-ttu-id="82444-102">Cambiar las contraseñas mediante programación</span><span class="sxs-lookup"><span data-stu-id="82444-102">Changing Passwords Programmatically</span></span>
  <span data-ttu-id="82444-103">En versiones anteriores de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], cuando expiraba una contraseña de usuario, solo el administrador podía restablecerla.</span><span class="sxs-lookup"><span data-stu-id="82444-103">Before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], when a user's password expired, only an administrator could reset it.</span></span> <span data-ttu-id="82444-104">A partir de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] , [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client admite la administración de la expiración de contraseña mediante programación a través del [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client y del [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client, y a través de los cambios en los cuadros de diálogo **SQL Server inicio de sesión** .</span><span class="sxs-lookup"><span data-stu-id="82444-104">Beginning with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports handling password expiration programmatically through both the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and through changes to the **SQL Server Login** dialog boxes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="82444-105">Cuando sea posible, solicite a los usuarios que escriban las credenciales en tiempo de ejecución y eviten almacenarlas en un formato guardado.</span><span class="sxs-lookup"><span data-stu-id="82444-105">When possible, prompt users to enter their credentials at run time and avoid storing their credentials in a persisted format.</span></span> <span data-ttu-id="82444-106">Si tiene que conservar las credenciales, debe cifrarlas con la [API de cifrado de Win32](https://go.microsoft.com/fwlink/?LinkId=64532).</span><span class="sxs-lookup"><span data-stu-id="82444-106">If you must persist their credentials, you should encrypt them using the [Win32 crypto API](https://go.microsoft.com/fwlink/?LinkId=64532).</span></span> <span data-ttu-id="82444-107">Para obtener más información sobre el uso de contraseñas seguras, vea [Contraseñas seguras](../../security/strong-passwords.md).</span><span class="sxs-lookup"><span data-stu-id="82444-107">For more information about the use of passwords, see [Strong Passwords](../../security/strong-passwords.md).</span></span>  
  
## <a name="sql-server-login-error-codes"></a><span data-ttu-id="82444-108">Códigos de error de inicio de sesión de SQL Server</span><span class="sxs-lookup"><span data-stu-id="82444-108">SQL Server Login Error Codes</span></span>  
 <span data-ttu-id="82444-109">Cuando no se puede realizar una conexión debido a problemas de autenticación, uno de los códigos de error de SQL Server siguientes estará disponible para la aplicación para ayudar en el diagnóstico y recuperación.</span><span class="sxs-lookup"><span data-stu-id="82444-109">When a connection cannot be made because of authentication problems, one of the following SQL Server error codes will be available to the application to assist diagnosis and recovery.</span></span>  
  
|<span data-ttu-id="82444-110">Código de error de SQL Server</span><span class="sxs-lookup"><span data-stu-id="82444-110">SQL Server Error Code</span></span>|<span data-ttu-id="82444-111">Mensaje de error</span><span class="sxs-lookup"><span data-stu-id="82444-111">Error Message</span></span>|  
|---------------------------|-------------------|  
|<span data-ttu-id="82444-112">15113</span><span class="sxs-lookup"><span data-stu-id="82444-112">15113</span></span>|<span data-ttu-id="82444-113">Error de inicio de sesión del usuario '%. \* ls'. Motivo: error de validación de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-113">Login failed for user '%.\*ls' Reason: Password validation failed.</span></span> <span data-ttu-id="82444-114">Se ha bloqueado la cuenta.</span><span class="sxs-lookup"><span data-stu-id="82444-114">The account is locked out.</span></span>|  
|<span data-ttu-id="82444-115">18463</span><span class="sxs-lookup"><span data-stu-id="82444-115">18463</span></span>|<span data-ttu-id="82444-116">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-116">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-117">Motivo: error de cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-117">Reason: Password change failed.</span></span> <span data-ttu-id="82444-118">La contraseña no se puede utilizar en este momento.</span><span class="sxs-lookup"><span data-stu-id="82444-118">The password cannot be used at this time.</span></span>|  
|<span data-ttu-id="82444-119">18464</span><span class="sxs-lookup"><span data-stu-id="82444-119">18464</span></span>|<span data-ttu-id="82444-120">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-120">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-121">Motivo: error de cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-121">Reason: Password change failed.</span></span> <span data-ttu-id="82444-122">La contraseña no cumple los requisitos de directiva porque es demasiado larga.</span><span class="sxs-lookup"><span data-stu-id="82444-122">The password does not meet policy requirements because it is too short.</span></span>|  
|<span data-ttu-id="82444-123">18465</span><span class="sxs-lookup"><span data-stu-id="82444-123">18465</span></span>|<span data-ttu-id="82444-124">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-124">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-125">Motivo: error de cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-125">Reason: Password change failed.</span></span> <span data-ttu-id="82444-126">La contraseña no cumple los requisitos de directiva porque es demasiado larga.</span><span class="sxs-lookup"><span data-stu-id="82444-126">The password does not meet policy requirements because it is too long.</span></span>|  
|<span data-ttu-id="82444-127">18466</span><span class="sxs-lookup"><span data-stu-id="82444-127">18466</span></span>|<span data-ttu-id="82444-128">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-128">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-129">Motivo: error de cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-129">Reason: Password change failed.</span></span> <span data-ttu-id="82444-130">La contraseña no cumple los requisitos de directiva porque no es bastante compleja.</span><span class="sxs-lookup"><span data-stu-id="82444-130">The password does not meet policy requirements because it is not complex enough.</span></span>|  
|<span data-ttu-id="82444-131">18467</span><span class="sxs-lookup"><span data-stu-id="82444-131">18467</span></span>|<span data-ttu-id="82444-132">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-132">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-133">Motivo: error de cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-133">Reason: Password change failed.</span></span> <span data-ttu-id="82444-134">La contraseña no cumple los requisitos de la DLL de filtro de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-134">The password does not meet the requirements of the password filter DLL.</span></span>|  
|<span data-ttu-id="82444-135">18468</span><span class="sxs-lookup"><span data-stu-id="82444-135">18468</span></span>|<span data-ttu-id="82444-136">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-136">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-137">Motivo: error de cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-137">Reason: Password change failed.</span></span> <span data-ttu-id="82444-138">Error inesperado durante la validación de la contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-138">An unexpected error occurred during password validation.</span></span>|  
|<span data-ttu-id="82444-139">18487</span><span class="sxs-lookup"><span data-stu-id="82444-139">18487</span></span>|<span data-ttu-id="82444-140">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-140">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-141">Motivo: la contraseña de la cuenta expiró.</span><span class="sxs-lookup"><span data-stu-id="82444-141">Reason: The password of the account has expired.</span></span>|  
|<span data-ttu-id="82444-142">18488</span><span class="sxs-lookup"><span data-stu-id="82444-142">18488</span></span>|<span data-ttu-id="82444-143">Error de inicio de sesión del usuario '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="82444-143">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="82444-144">Motivo: se debe cambiar la contraseña de la cuenta. </span><span class="sxs-lookup"><span data-stu-id="82444-144">Reason: The password of the account must be changed.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="82444-145">Proveedor OLE DB de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="82444-145">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="82444-146">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite la expiración de la contraseña a través de una interfaz de usuario y mediante programación.</span><span class="sxs-lookup"><span data-stu-id="82444-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="ole-db-user-interface-password-expiration"></a><span data-ttu-id="82444-147">Expiración de contraseñas de la interfaz de usuario de OLE DB</span><span class="sxs-lookup"><span data-stu-id="82444-147">OLE DB User Interface Password Expiration</span></span>  
 <span data-ttu-id="82444-148">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite la expiración de la contraseña a través de los cambios realizados en los cuadros de diálogo **SQL Server inicio de sesión** .</span><span class="sxs-lookup"><span data-stu-id="82444-148">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span> <span data-ttu-id="82444-149">Si el valor de DBPROP_INIT_PROMPT está establecido en DBPROMPT_NOPROMPT, se producirá un error en el intento de conexión inicial si la contraseña ha expirado.</span><span class="sxs-lookup"><span data-stu-id="82444-149">If the value of DBPROP_INIT_PROMPT is set to DBPROMPT_NOPROMPT, the initial connection attempt will fail if the password has expired.</span></span>  
  
 <span data-ttu-id="82444-150">Si DBPROP_INIT_PROMPT se ha establecido en cualquier otro valor, el usuario ve el cuadro de diálogo **Inicio de sesión de SQL Server**, independientemente de que la contraseña haya expirado o no.</span><span class="sxs-lookup"><span data-stu-id="82444-150">If DBPROP_INIT_PROMPT has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="82444-151">El usuario puede hacer clic en el botón **Opciones** y seleccionar **Cambiar contraseña** para cambiar la contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-151">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="82444-152">Si el usuario hace clic en Aceptar y la contraseña ha expirado, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pedirá al usuario que escriba y confirme una nueva contraseña mediante el cuadro de diálogo **Cambiar contraseña de SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="82444-152">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts the user to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="ole-db-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="82444-153">Comportamiento de las solicitudes de OLE DB y cuentas bloqueadas</span><span class="sxs-lookup"><span data-stu-id="82444-153">OLE DB Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="82444-154">Los intentos de conexión pueden producir un error debido a que la cuenta está bloqueada.</span><span class="sxs-lookup"><span data-stu-id="82444-154">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="82444-155">Si se produce esto después de la presentación del cuadro de diálogo **Inicio de sesión de SQL Server**, se muestra un mensaje de error del servidor al usuario y se anula el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-155">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="82444-156">Se puede producir también después de la presentación del cuadro de diálogo **Cambiar contraseña de SQL Server** si el usuario especifica un valor incorrecto de la contraseña anterior.</span><span class="sxs-lookup"><span data-stu-id="82444-156">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="82444-157">En este caso se muestra el mismo mensaje de error y se anula el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-157">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="ole-db-connection-pooling-password-expiration-and-locked-accounts"></a><span data-ttu-id="82444-158">Agrupación de conexiones de OLE DB, expiración de contraseña y cuentas bloqueadas</span><span class="sxs-lookup"><span data-stu-id="82444-158">OLE DB Connection Pooling, Password Expiration, and Locked Accounts</span></span>  
 <span data-ttu-id="82444-159">Se puede bloquear una cuenta o puede expirar la contraseña cuando la conexión está activa todavía en un grupo de conexiones.</span><span class="sxs-lookup"><span data-stu-id="82444-159">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="82444-160">El servidor comprueba las contraseñas expiradas y las cuentas bloqueadas en dos ocasiones.</span><span class="sxs-lookup"><span data-stu-id="82444-160">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="82444-161">La primera vez es cuando se crea una conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-161">The first is when a connection is first created.</span></span> <span data-ttu-id="82444-162">La segunda ocasión es al restablecer una conexión, cuando se toma la conexión del grupo.</span><span class="sxs-lookup"><span data-stu-id="82444-162">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="82444-163">Cuando se produce un error en el intento de reinicio, la conexión se quita del grupo y se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="82444-163">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="ole-db-programmatic-password-expiration"></a><span data-ttu-id="82444-164">Expiración de contraseña mediante programación de OLE DB</span><span class="sxs-lookup"><span data-stu-id="82444-164">OLE DB Programmatic Password Expiration</span></span>  
 <span data-ttu-id="82444-165">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite la expiración de la contraseña mediante la adición de la propiedad SSPROP_AUTH_OLD_PASSWORD (tipo VT_BSTR) que se ha agregado al conjunto de propiedades DBPROPSET_SQLSERVERDBINIT.</span><span class="sxs-lookup"><span data-stu-id="82444-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through the addition of the SSPROP_AUTH_OLD_PASSWORD (type VT_BSTR) property that has been added to the DBPROPSET_SQLSERVERDBINIT property set.</span></span>  
  
 <span data-ttu-id="82444-166">La propiedad "Contraseña" existente hace referencia a DBPROP_AUTH_PASSWORD y se utiliza para almacenar la nueva contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-166">The existing "Password" property refers to DBPROP_AUTH_PASSWORD and is used to store the new password.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="82444-167">En la cadena de conexión, la propiedad "Contraseña anterior" establece SSPROP_AUTH_OLD_PASSWORD, que es la contraseña actual (posiblemente expirada) que no está disponible a través de una propiedad de cadena del proveedor.</span><span class="sxs-lookup"><span data-stu-id="82444-167">In the connection string, the "Old Password" property sets SSPROP_AUTH_OLD_PASSWORD, which is the current (possibly expired) password that is not available via a provider string property.</span></span>  
  
 <span data-ttu-id="82444-168">El proveedor no conserva el valor de esta propiedad.</span><span class="sxs-lookup"><span data-stu-id="82444-168">The provider does not persist the value of this property.</span></span> <span data-ttu-id="82444-169">Cuando se establece esta propiedad, el proveedor no utiliza el grupo de conexiones para la primera conexión porque se producirá una nueva conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-169">When this property is set, the provider does not use the connection pool for the first connection because a new connection will occur.</span></span> <span data-ttu-id="82444-170">Si el cambio de contraseña se realiza correctamente, no se puede reutilizar la conexión actual dado que todavía contiene la contraseña anterior, que no será válida después del cambio de contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-170">If the password change is successful, the current connection cannot be reused since it still contains the old password, which will be invalid after the password change.</span></span> <span data-ttu-id="82444-171">Además, si el inicio de sesión tiene éxito, el proveedor borra esta propiedad.</span><span class="sxs-lookup"><span data-stu-id="82444-171">Also, if the login succeeds, the provider clears this property.</span></span> <span data-ttu-id="82444-172">Los intentos subsiguientes de recuperar la contraseña anterior devuelven VT_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="82444-172">Subsequent attempts to retrieve the old password return VT_EMPTY.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="82444-173">No se debe conservar SSPROP_AUTH_OLD_PASSWORD nunca porque solo se utiliza cuando una contraseña ha expirado.</span><span class="sxs-lookup"><span data-stu-id="82444-173">SSPROP_AUTH_OLD_PASSWORD should never be persisted since it is only used when a password has expired.</span></span>  
  
 <span data-ttu-id="82444-174">Recuerde que siempre que se establece la propiedad "Contraseña anterior", el proveedor asume que intenta cambiar la contraseña, a menos que se especifique también la Autenticación de Windows, en cuyo caso tiene siempre prioridad.</span><span class="sxs-lookup"><span data-stu-id="82444-174">Note that whenever the "Old Password" property is set, the provider assumes that an attempt to change the password is being made, unless Windows Authentication is also specified, in which case it always takes precedence.</span></span>  
  
 <span data-ttu-id="82444-175">Si se usa la autenticación de Windows, especificar la contraseña anterior da como resultado DB_E_ERRORSOCCURRED o DB_S_ERRORSOCCURRED en función de que la contraseña anterior se haya especificado como REQUIRED u OPTIONAL respectivamente, y se devuelve el valor de estado de DBPROPSTATUS_CONFLICTINGBADVALUE en *dwStatus*.</span><span class="sxs-lookup"><span data-stu-id="82444-175">If Windows Authentication is used, specifying the old password results in either DB_E_ERRORSOCCURRED or DB_S_ERRORSOCCURRED depending on whether the old password was specified as REQUIRED or OPTIONAL respectively, and the status value of DBPROPSTATUS_CONFLICTINGBADVALUE is returned in *dwStatus*.</span></span> <span data-ttu-id="82444-176">Esto se detecta cuando se llama a **IDBInitialize::Initialize**.</span><span class="sxs-lookup"><span data-stu-id="82444-176">This is detected when **IDBInitialize::Initialize** is called.</span></span>  
  
 <span data-ttu-id="82444-177">Si el intento de cambiar la contraseña produce un error inesperadamente, el servidor devuelve el código de error 18468.</span><span class="sxs-lookup"><span data-stu-id="82444-177">If an attempt to change the password fails unexpectedly, the server returns error code 18468.</span></span> <span data-ttu-id="82444-178">Se devuelve un error OLEDB estándar del intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-178">A standard OLEDB error is returned from the connection attempt.</span></span>  
  
 <span data-ttu-id="82444-179">Para más información sobre el conjunto de propiedades DBPROPSET_SQLSERVERDBINIT, consulte [Propiedades de inicialización y autorización](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span><span class="sxs-lookup"><span data-stu-id="82444-179">For more information about the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="82444-180">Controlador ODBC de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="82444-180">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="82444-181">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] proveedor de OLE DB de Native Client admite la expiración de la contraseña a través de una interfaz de usuario y mediante programación.</span><span class="sxs-lookup"><span data-stu-id="82444-181">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="odbc-user-interface-password-expiration"></a><span data-ttu-id="82444-182">Expiración de contraseñas de la interfaz de usuario de ODBC</span><span class="sxs-lookup"><span data-stu-id="82444-182">ODBC User Interface Password Expiration</span></span>  
 <span data-ttu-id="82444-183">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client admite la expiración de la contraseña a través de los cambios realizados en los cuadros de diálogo de **Inicio de sesión SQL Server** .</span><span class="sxs-lookup"><span data-stu-id="82444-183">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span>  
  
 <span data-ttu-id="82444-184">Si se llama a [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) y el valor de **DriverCompletion** se establece en SQL_DRIVER_NOPROMPT, se produce un error en el intento de conexión inicial si la contraseña ha expirado.</span><span class="sxs-lookup"><span data-stu-id="82444-184">If [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) is called and the value of **DriverCompletion** is set to SQL_DRIVER_NOPROMPT, the initial connection attempt fails if the password has expired.</span></span> <span data-ttu-id="82444-185">Las llamadas posteriores a **SQLError** o **SQLGetDiagRec**devuelven el valor de SQLSTATE 28000 y el valor de código de error nativo 18487.</span><span class="sxs-lookup"><span data-stu-id="82444-185">The SQLSTATE value 28000 and the native error code value 18487 are returned by subsequent calls to **SQLError** or **SQLGetDiagRec**.</span></span>  
  
 <span data-ttu-id="82444-186">Si **DriverCompletion** se ha establecido en cualquier otro valor, el usuario verá el **SQL Server** cuadro de diálogo de inicio de sesión, independientemente de si la contraseña ha expirado o no.</span><span class="sxs-lookup"><span data-stu-id="82444-186">If **DriverCompletion** has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="82444-187">El usuario puede hacer clic en el botón **Opciones** y seleccionar **Cambiar contraseña** para cambiar la contraseña.</span><span class="sxs-lookup"><span data-stu-id="82444-187">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="82444-188">Si el usuario hace clic en aceptar y la contraseña ha expirado, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] le pedirá que escriba y confirme una nueva contraseña mediante el cuadro de diálogo **Cambiar contraseña de SQL Server** .</span><span class="sxs-lookup"><span data-stu-id="82444-188">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="odbc-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="82444-189">Comportamiento de las solicitudes de ODBC y cuentas bloqueadas</span><span class="sxs-lookup"><span data-stu-id="82444-189">ODBC Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="82444-190">Los intentos de conexión pueden producir un error debido a que la cuenta está bloqueada.</span><span class="sxs-lookup"><span data-stu-id="82444-190">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="82444-191">Si se produce esto después de la presentación del cuadro de diálogo **Inicio de sesión de SQL Server**, se muestra un mensaje de error del servidor al usuario y se anula el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-191">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="82444-192">Se puede producir también después de la presentación del cuadro de diálogo **Cambiar contraseña de SQL Server** si el usuario especifica un valor incorrecto de la contraseña anterior.</span><span class="sxs-lookup"><span data-stu-id="82444-192">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="82444-193">En este caso se muestra el mismo mensaje de error y se anula el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-193">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="odbc-connection-pooling-password-expiry-and-locked-accounts"></a><span data-ttu-id="82444-194">Expiración de la agrupación de conexiones de ODBC y cuentas bloqueadas</span><span class="sxs-lookup"><span data-stu-id="82444-194">ODBC Connection Pooling, Password Expiry, and Locked Accounts</span></span>  
 <span data-ttu-id="82444-195">Se puede bloquear una cuenta o puede expirar la contraseña cuando la conexión está activa todavía en un grupo de conexiones.</span><span class="sxs-lookup"><span data-stu-id="82444-195">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="82444-196">El servidor comprueba las contraseñas expiradas y las cuentas bloqueadas en dos ocasiones.</span><span class="sxs-lookup"><span data-stu-id="82444-196">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="82444-197">La primera vez es cuando se crea una conexión.</span><span class="sxs-lookup"><span data-stu-id="82444-197">The first is when a connection is first created.</span></span> <span data-ttu-id="82444-198">La segunda ocasión es al restablecer una conexión, cuando se toma la conexión del grupo.</span><span class="sxs-lookup"><span data-stu-id="82444-198">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="82444-199">Cuando se produce un error en el intento de reinicio, la conexión se quita del grupo y se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="82444-199">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="odbc-programmatic-password-expiration"></a><span data-ttu-id="82444-200">Expiración de contraseña mediante programación de ODBC</span><span class="sxs-lookup"><span data-stu-id="82444-200">ODBC Programmatic Password Expiration</span></span>  
 <span data-ttu-id="82444-201">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client admite la expiración de la contraseña mediante la adición del atributo SQL_COPT_SS_OLDPWD que se establece antes de conectarse al servidor mediante la función [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) .</span><span class="sxs-lookup"><span data-stu-id="82444-201">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through the addition of the SQL_COPT_SS_OLDPWD attribute which is set before connecting to the server using the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) function.</span></span>  
  
 <span data-ttu-id="82444-202">El atributo SQL_COPT_SS_OLDPWD del identificador de conexión hace referencia a la contraseña expirada.</span><span class="sxs-lookup"><span data-stu-id="82444-202">The SQL_COPT_SS_OLDPWD attribute of the connection handle refers to the expired password.</span></span> <span data-ttu-id="82444-203">No hay ningún atributo de cadena de conexión para este atributo, porque esto interferiría con la agrupación de conexiones.</span><span class="sxs-lookup"><span data-stu-id="82444-203">There is no connection string attribute for this attribute, as this would interfere with connection pooling.</span></span> <span data-ttu-id="82444-204">Si el inicio de sesión tiene éxito, el controlador borra este atributo.</span><span class="sxs-lookup"><span data-stu-id="82444-204">If the login succeeds, the driver clears this attribute.</span></span>  
  
 <span data-ttu-id="82444-205">El [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client devuelve SQL_ERROR en cuatro casos para esta característica: la expiración de contraseñas, el conflicto de la Directiva de contraseñas, el bloqueo de cuentas y el momento en que se establece la propiedad contraseña antigua mientras se usa la autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="82444-205">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver returns SQL_ERROR in four cases for this feature: password expiration, password policy conflict, account lockout, and when the old password property is set while using Windows Authentication.</span></span> <span data-ttu-id="82444-206">El controlador devuelve los mensajes de error correspondientes al usuario cuando se invoca [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) .</span><span class="sxs-lookup"><span data-stu-id="82444-206">The driver returns the appropriate error messages to the user when [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) is invoked.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="82444-207">Consulte también</span><span class="sxs-lookup"><span data-stu-id="82444-207">See Also</span></span>  
 [<span data-ttu-id="82444-208">Características de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="82444-208">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  
