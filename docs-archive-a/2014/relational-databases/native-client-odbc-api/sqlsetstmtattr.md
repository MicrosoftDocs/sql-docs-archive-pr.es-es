---
title: SQLSetStmtAttr | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672957"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="3afb4-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="3afb4-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="3afb4-103">El controlador ODBC de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client no admite el modelo de cursor mixto (controlado por conjunto de claves/dinámico).</span><span class="sxs-lookup"><span data-stu-id="3afb4-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="3afb4-104">Cualquier intento de establecer el tamaño del conjunto de claves mediante SQL_ATTR_KEYSET_SIZE generará un error si el conjunto de valores no es igual a 0.</span><span class="sxs-lookup"><span data-stu-id="3afb4-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="3afb4-105">La aplicación establece SQL_ATTR_ROW_ARRAY_SIZE en todas las instrucciones para declarar el número de filas devueltas en una llamada de función **SQLFetch** o [SQLFetchScroll](sqlfetchscroll.md) .</span><span class="sxs-lookup"><span data-stu-id="3afb4-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="3afb4-106">En las instrucciones que indican un cursor de servidor, el controlador utiliza SQL_ATTR_ROW_ARRAY_SIZE para determinar el tamaño del bloque de filas que genera el servidor con el fin de satisfacer una solicitud de captura del cursor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="3afb4-107">Dentro del tamaño de bloque de un cursor dinámico, la pertenencia y el orden de las filas son fijos si el nivel de aislamiento de la transacción es suficiente para asegurar la posibilidad de repetir las lecturas de las transacciones confirmadas.</span><span class="sxs-lookup"><span data-stu-id="3afb4-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="3afb4-108">El cursor es completamente dinámico fuera del bloque indicado por este valor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="3afb4-109">El tamaño del bloque del cursor de servidor es completamente dinámico y se puede cambiar en cualquier punto del procesamiento de captura.</span><span class="sxs-lookup"><span data-stu-id="3afb4-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="3afb4-110">SQLSetStmtAttr y parámetros con valores de tabla</span><span class="sxs-lookup"><span data-stu-id="3afb4-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="3afb4-111">SQLSetStmtAttr se puede usar para establecer SQL_SOPT_SS_PARAM_FOCUS en el descriptor de parámetros de la aplicación (APD) antes de tener acceso a los campos de descriptor para las columnas de parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="3afb4-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="3afb4-112">Si se realiza un intento de establecer SQL_SOPT_SS_PARAM_FOCUS en el ordinal de un parámetro que no es un parámetro con valores de tabla, SQLSetStmtAttr devuelve SQL_ERROR y se crea un registro de diagnóstico con SQLSTATE = HY024 y el mensaje "valor de atributo no válido".</span><span class="sxs-lookup"><span data-stu-id="3afb4-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="3afb4-113">SQL_SOPT_SS_PARAM_FOCUS no cambia cuando se devuelve SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="3afb4-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="3afb4-114">Al establecer SQL_SOPT_SS_PARAM_FOCUS en 0, se restaura acceso a los registros descriptores para parámetros.</span><span class="sxs-lookup"><span data-stu-id="3afb4-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="3afb4-115">SQLSetStmtAttr también se puede usar para establecer SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="3afb4-116">Para obtener más información, vea la sección sobre SQL_SOPT_SS_NAME_SCOPE en este mismo tema.</span><span class="sxs-lookup"><span data-stu-id="3afb4-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="3afb4-117">Para obtener más información, vea [metadatos de parámetros con valores de tabla para instrucciones](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md)preparadas.</span><span class="sxs-lookup"><span data-stu-id="3afb4-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="3afb4-118">Para obtener más información sobre los parámetros con valores de tabla, vea [parámetros con valores de tabla &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="3afb4-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="3afb4-119">Compatibilidad de SQLSetStmtAttr con columnas dispersas</span><span class="sxs-lookup"><span data-stu-id="3afb4-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="3afb4-120">SQLSetStmtAttr se puede usar para establecer SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="3afb4-121">Para obtener más información, vea la sección SQL_SOPT_SS_NAME_SCOPE, más adelante en este tema. Para obtener más información sobre las columnas dispersas, vea [compatibilidad con columnas Dispersas &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="3afb4-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="3afb4-122">Atributos de instrucción</span><span class="sxs-lookup"><span data-stu-id="3afb4-122">Statement Attributes</span></span>  
 <span data-ttu-id="3afb4-123">El controlador ODBC de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client también admite los siguientes atributos de instrucción específicos del controlador.</span><span class="sxs-lookup"><span data-stu-id="3afb4-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="3afb4-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="3afb4-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="3afb4-125">El atributo SQL_SOPT_SS_CURSOR especifica si el controlador utilizará las opciones de rendimiento específicas del controlador en cursores.</span><span class="sxs-lookup"><span data-stu-id="3afb4-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="3afb4-126">No se permite [SQLGetData](sqlgetdata.md) cuando se establecen estas opciones.</span><span class="sxs-lookup"><span data-stu-id="3afb4-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="3afb4-127">El valor predeterminado es SQL_CO_OFF.</span><span class="sxs-lookup"><span data-stu-id="3afb4-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="3afb4-128">El valor de *ValuePtr* es de tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="3afb4-129">Valor *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="3afb4-129">*ValuePtr* value</span></span>|<span data-ttu-id="3afb4-130">Descripción</span><span class="sxs-lookup"><span data-stu-id="3afb4-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3afb4-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="3afb4-131">SQL_CO_OFF</span></span>|<span data-ttu-id="3afb4-132">Predeterminado</span><span class="sxs-lookup"><span data-stu-id="3afb4-132">Default.</span></span> <span data-ttu-id="3afb4-133">Deshabilita los cursores de solo avance rápido y de solo lectura y la captura automática, habilita **SQLGetData** en cursores de solo avance y de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="3afb4-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="3afb4-134">Si SQL_SOPT_SS_CURSOR_OPTIONS está establecido en SQL_CO_OFF, el tipo de cursor no cambiará.</span><span class="sxs-lookup"><span data-stu-id="3afb4-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="3afb4-135">Es decir, el cursor de solo avance rápido seguirá siendo un cursor de solo avance rápido.</span><span class="sxs-lookup"><span data-stu-id="3afb4-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="3afb4-136">Para cambiar el tipo de cursor, la aplicación debe establecer ahora un tipo de cursor diferente mediante `SQLSetStmtAttr` /SQL_ATTR_CURSOR_TYPE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="3afb4-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="3afb4-137">SQL_CO_FFO</span></span>|<span data-ttu-id="3afb4-138">Habilita los cursores de solo avance rápido y solo lectura, deshabilita **SQLGetData** en cursores de solo avance y de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="3afb4-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="3afb4-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="3afb4-139">SQL_CO_AF</span></span>|<span data-ttu-id="3afb4-140">Habilita la opción de captura automática en cualquier tipo de cursor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="3afb4-141">Cuando se establece esta opción para un identificador de instrucción, **SQLExecute** o **SQLExecDirect** generarán una **SQLFetchScroll** implícita (SQL_FIRST).</span><span class="sxs-lookup"><span data-stu-id="3afb4-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="3afb4-142">El cursor se abre y se devuelve el primer lote de filas en un único viaje de ida y vuelta al servidor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="3afb4-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="3afb4-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="3afb4-144">Habilita los cursores de solo avance rápido con la opción de captura automática.</span><span class="sxs-lookup"><span data-stu-id="3afb4-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="3afb4-145">Es lo mismo que si se especifican SQL_CO_AF y SQL_CO_FFO.</span><span class="sxs-lookup"><span data-stu-id="3afb4-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="3afb4-146">Cuando se establecen estas opciones, el servidor cierra el cursor automáticamente en cuanto detecta que se ha capturado la última fila.</span><span class="sxs-lookup"><span data-stu-id="3afb4-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="3afb4-147">La aplicación debe seguir llamando a [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) o [SQLCloseCursor](sqlclosecursor.md), pero el controlador no tiene que enviar la notificación de cierre al servidor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="3afb4-148">Si la lista de selección contiene una columna **Text**, **ntext**o **Image** , el cursor de solo avance rápido se convierte en un cursor dinámico y se permite **SQLGetData** .</span><span class="sxs-lookup"><span data-stu-id="3afb4-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="3afb4-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="3afb4-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="3afb4-150">El atributo SQL_SOPT_SS_DEFER_PREPARE determina si la instrucción se prepara inmediatamente o se aplaza hasta que se ejecuta **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) o [SQLDescribeParam](sqldescribeparam.md) .</span><span class="sxs-lookup"><span data-stu-id="3afb4-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="3afb4-151">En [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 y versiones anteriores, esta propiedad se omite (no hay preparación diferida).</span><span class="sxs-lookup"><span data-stu-id="3afb4-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="3afb4-152">El valor de *ValuePtr* es de tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="3afb4-153">Valor *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="3afb4-153">*ValuePtr* value</span></span>|<span data-ttu-id="3afb4-154">Descripción</span><span class="sxs-lookup"><span data-stu-id="3afb4-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3afb4-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="3afb4-155">SQL_DP_ON</span></span>|<span data-ttu-id="3afb4-156">Predeterminado</span><span class="sxs-lookup"><span data-stu-id="3afb4-156">Default.</span></span> <span data-ttu-id="3afb4-157">Después de llamar a la [función SQLPrepare](https://go.microsoft.com/fwlink/?LinkId=59360), la preparación de la instrucción se aplaza hasta que se llama a **SQLExecute** o se ejecuta la operación de metapropiedad (**SQLDescribeCol** o **SQLDescribeParam**).</span><span class="sxs-lookup"><span data-stu-id="3afb4-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="3afb4-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="3afb4-158">SQL_DP_OFF</span></span>|<span data-ttu-id="3afb4-159">La instrucción se prepara en cuanto se ejecuta **SQLPrepare** .</span><span class="sxs-lookup"><span data-stu-id="3afb4-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="3afb4-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="3afb4-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="3afb4-161">El atributo SQL_SOPT_SS_REGIONALIZE se utiliza para determinar la conversión de datos en el nivel de instrucción.</span><span class="sxs-lookup"><span data-stu-id="3afb4-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="3afb4-162">El atributo hace que el controlador respete la configuración regional del cliente al convertir los valores de fecha, hora y moneda en cadenas de caracteres.</span><span class="sxs-lookup"><span data-stu-id="3afb4-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="3afb4-163">La conversión solo se hace de tipos de datos nativos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a cadenas de caracteres.</span><span class="sxs-lookup"><span data-stu-id="3afb4-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="3afb4-164">El valor de *ValuePtr* es de tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="3afb4-165">Valor *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="3afb4-165">*ValuePtr* value</span></span>|<span data-ttu-id="3afb4-166">Descripción</span><span class="sxs-lookup"><span data-stu-id="3afb4-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3afb4-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="3afb4-167">SQL_RE_OFF</span></span>|<span data-ttu-id="3afb4-168">Predeterminado</span><span class="sxs-lookup"><span data-stu-id="3afb4-168">Default.</span></span> <span data-ttu-id="3afb4-169">El controlador no convierte los datos de fecha, hora y moneda a datos de cadenas de caracteres utilizando la configuración regional del cliente.</span><span class="sxs-lookup"><span data-stu-id="3afb4-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="3afb4-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="3afb4-170">SQL_RE_ON</span></span>|<span data-ttu-id="3afb4-171">El controlador utiliza la configuración regional del cliente al convertir los datos de fecha, hora y moneda en datos de cadenas de caracteres.</span><span class="sxs-lookup"><span data-stu-id="3afb4-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="3afb4-172">La configuración de conversión regional se aplica a los tipos de datos de moneda, numéricos, de fecha y de hora.</span><span class="sxs-lookup"><span data-stu-id="3afb4-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="3afb4-173">La configuración de conversión solamente es aplicable a la conversión de salida cuando los valores de moneda, numéricos, de fecha o de hora se convierten en cadenas de caracteres.</span><span class="sxs-lookup"><span data-stu-id="3afb4-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3afb4-174">Si la opción de instrucción SQL_SOPT_SS_REGIONALIZE está activada, el controlador utiliza la configuración regional del Registro para el usuario actual.</span><span class="sxs-lookup"><span data-stu-id="3afb4-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="3afb4-175">El controlador no respeta la configuración regional del subproceso actual si la aplicación la establece, por ejemplo, llamando a **SetThreadLocale**.</span><span class="sxs-lookup"><span data-stu-id="3afb4-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="3afb4-176">Modificar el comportamiento regional de un origen de datos puede producir errores en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3afb4-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="3afb4-177">Una aplicación que analiza cadenas de fecha y espera que las cadenas de fecha aparezcan tal y como se definen en ODBC, podría verse afectada negativamente por la modificación de este valor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="3afb4-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="3afb4-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="3afb4-179">El atributo SQL_SOPT_SS_TEXTPTR_LOGGING alterna el registro de operaciones en columnas que contienen datos de **texto** o de **imagen** .</span><span class="sxs-lookup"><span data-stu-id="3afb4-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="3afb4-180">El valor de *ValuePtr* es de tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="3afb4-181">Valor *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="3afb4-181">*ValuePtr* value</span></span>|<span data-ttu-id="3afb4-182">Descripción</span><span class="sxs-lookup"><span data-stu-id="3afb4-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3afb4-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="3afb4-183">SQL_TL_OFF</span></span>|<span data-ttu-id="3afb4-184">Deshabilita el registro de operaciones realizadas en datos de **texto** e **imagen** .</span><span class="sxs-lookup"><span data-stu-id="3afb4-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="3afb4-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="3afb4-185">SQL_TL_ON</span></span>|<span data-ttu-id="3afb4-186">Predeterminado</span><span class="sxs-lookup"><span data-stu-id="3afb4-186">Default.</span></span> <span data-ttu-id="3afb4-187">Habilita el registro de operaciones realizadas en datos de **texto** e **imagen** .</span><span class="sxs-lookup"><span data-stu-id="3afb4-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="3afb4-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="3afb4-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="3afb4-189">El atributo SQL_SOPT_SS_HIDDEN_COLUMNS expone, en el conjunto de resultados, las columnas ocultas en una instrucción SELECT FOR BROWSE de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afb4-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="3afb4-190">El controlador no expone estas columnas de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="3afb4-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="3afb4-191">El valor de *ValuePtr* es de tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="3afb4-192">Valor *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="3afb4-192">*ValuePtr* value</span></span>|<span data-ttu-id="3afb4-193">Descripción</span><span class="sxs-lookup"><span data-stu-id="3afb4-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3afb4-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="3afb4-194">SQL_HC_OFF</span></span>|<span data-ttu-id="3afb4-195">Predeterminado</span><span class="sxs-lookup"><span data-stu-id="3afb4-195">Default.</span></span> <span data-ttu-id="3afb4-196">Las columnas FOR BROWSE se ocultan del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="3afb4-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="3afb4-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="3afb4-197">SQL_HC_ON</span></span>|<span data-ttu-id="3afb4-198">Expone las columnas FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="3afb4-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="3afb4-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="3afb4-200">El atributo SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT devuelve el texto del mensaje de la solicitud de notificación de consulta.</span><span class="sxs-lookup"><span data-stu-id="3afb4-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="3afb4-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="3afb4-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="3afb4-202">El atributo SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS especifica las opciones utilizadas para la solicitud de notificación de consulta.</span><span class="sxs-lookup"><span data-stu-id="3afb4-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="3afb4-203">Se especifican en una cadena con sintaxis `name=value` como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="3afb4-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="3afb4-204">La aplicación es la responsable de la creación del servicio y de la lectura de las notificaciones fuera de la cola.</span><span class="sxs-lookup"><span data-stu-id="3afb4-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="3afb4-205">La sintaxis de la cadena de opciones de notificación de consulta es la siguiente:</span><span class="sxs-lookup"><span data-stu-id="3afb4-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="3afb4-206">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="3afb4-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="3afb4-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="3afb4-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="3afb4-208">El atributo SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT especifica el número de segundos que va a seguir estando activa la notificación de consulta.</span><span class="sxs-lookup"><span data-stu-id="3afb4-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="3afb4-209">El valor predeterminado es de 432000 segundos (5 días).</span><span class="sxs-lookup"><span data-stu-id="3afb4-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="3afb4-210">El valor de *ValuePtr* es de tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="3afb4-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="3afb4-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="3afb4-212">El atributo SQL_SOPT_SS_PARAM_FOCUS especifica el foco de las siguientes llamadas a SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec y SQLSetDescRec.</span><span class="sxs-lookup"><span data-stu-id="3afb4-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="3afb4-213">El tipo para SQL_SOPT_SS_PARAM_FOCUS es SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="3afb4-214">El valor predeterminado es 0, lo que significa que estas llamadas direccionan parámetros que corresponden a marcadores de parámetros en la instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="3afb4-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="3afb4-215">Cuando se establecen en el número de parámetro de un parámetro con valores de tabla, estas llamadas direccionan columnas de ese parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="3afb4-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="3afb4-216">Cuando se establece en un valor que no es el número de parámetro de un parámetro con valores de tabla, estas llamadas devuelven el error IM020: "El foco del parámetro no hace referencia a un parámetro de valores de tabla".</span><span class="sxs-lookup"><span data-stu-id="3afb4-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="3afb4-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="3afb4-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="3afb4-218">El atributo SQL_SOPT_SS_NAME_SCOPE especifica el ámbito de nombres para las llamadas posteriores a funciones de catálogo.</span><span class="sxs-lookup"><span data-stu-id="3afb4-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="3afb4-219">El conjunto de resultados devuelto por SQLColumns depende de la configuración de SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="3afb4-220">El tipo para SQL_SOPT_SS_NAME_SCOPE es SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="3afb4-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="3afb4-221">Valor *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="3afb4-221">*ValuePtr* value</span></span>|<span data-ttu-id="3afb4-222">Descripción</span><span class="sxs-lookup"><span data-stu-id="3afb4-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3afb4-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="3afb4-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="3afb4-224">Predeterminado</span><span class="sxs-lookup"><span data-stu-id="3afb4-224">Default.</span></span><br /><br /> <span data-ttu-id="3afb4-225">Cuando se utilizan parámetros con valores de tabla, indica que se deben devolver metadatos para las tablas reales.</span><span class="sxs-lookup"><span data-stu-id="3afb4-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="3afb4-226">Cuando se usa la característica de columnas dispersas, SQLColumns solo devolverá las columnas que no sean miembros del disperso `column_set` .</span><span class="sxs-lookup"><span data-stu-id="3afb4-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="3afb4-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="3afb4-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="3afb4-228">Indica que la aplicación requiere metadatos para un tipo de tabla, en lugar de una tabla real (las funciones de catálogo deben devolver metadatos para los tipos de tabla).</span><span class="sxs-lookup"><span data-stu-id="3afb4-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="3afb4-229">A continuación, la aplicación pasa el TYPE_NAME del parámetro con valores de tabla como parámetro *TableName* .</span><span class="sxs-lookup"><span data-stu-id="3afb4-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="3afb4-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="3afb4-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="3afb4-231">Cuando se usa la característica de columnas dispersas, SQLColumns devuelve todas las columnas, independientemente de la `column_set` pertenencia.</span><span class="sxs-lookup"><span data-stu-id="3afb4-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="3afb4-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="3afb4-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="3afb4-233">Cuando se usa la característica de columnas dispersas, SQLColumns solo devuelve las columnas que son miembros del disperso `column_set` .</span><span class="sxs-lookup"><span data-stu-id="3afb4-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="3afb4-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="3afb4-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="3afb4-235">Igual que SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="3afb4-236">SS_TYPE_CATALOG_NAME y SS_TYPE_SCHEMA_NAME se utilizan con los parámetros *nombrecatálogo* y *SchemaName* , respectivamente, para identificar el catálogo y el esquema para el parámetro con valores de tabla.</span><span class="sxs-lookup"><span data-stu-id="3afb4-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="3afb4-237">Cuando una aplicación ha terminado de recuperar los metadatos para los parámetros con valores de tabla, debe volver a establecer SQL_SOPT_SS_NAME_SCOPE en su valor predeterminado de SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="3afb4-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="3afb4-238">Si SQL_SOPT_SS_NAME_SCOPE está establecido en SQL_SS_NAME_SCOPE_TABLE, las consultas a los servidores vinculados producen un error.</span><span class="sxs-lookup"><span data-stu-id="3afb4-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="3afb4-239">Se producirá un error en las llamadas a SQLColumns o SQLPrimaryKeys con un catálogo que contenga un componente de servidor.</span><span class="sxs-lookup"><span data-stu-id="3afb4-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="3afb4-240">Si intenta establecer SQL_SOPT_SS_NAME_SCOPE en un valor no válido, se devuelve SQL_ERROR y se genera un registro de diagnóstico con SQLSTATE HY024 y el mensaje "Valor de atributo no válido".</span><span class="sxs-lookup"><span data-stu-id="3afb4-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="3afb4-241">Si se llama a una función de catálogo que no sea SQLTables, SQLColumns o SQLPrimaryKeys cuando SQL_SOPT_SS_NAME_SCOPE tiene un valor distinto de SQL_SS_NAME_SCOPE_TABLE, se devuelve SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="3afb4-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="3afb4-242">Se genera un registro de diagnóstico con SQLSTATE HY010 y el mensaje "Error en la secuencia de función (SQL_SOPT_SS_NAME_SCOPE no está establecido en SQL_SS_NAME_SCOPE_TABLE)".</span><span class="sxs-lookup"><span data-stu-id="3afb4-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3afb4-243">Consulte también</span><span class="sxs-lookup"><span data-stu-id="3afb4-243">See Also</span></span>  
 <span data-ttu-id="3afb4-244">[SQLGetStmtAttr función)](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="3afb4-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="3afb4-245">ODBC API Implementation Details</span><span class="sxs-lookup"><span data-stu-id="3afb4-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
