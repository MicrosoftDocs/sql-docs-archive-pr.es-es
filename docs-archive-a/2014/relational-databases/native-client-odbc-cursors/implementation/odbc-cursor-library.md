---
title: Biblioteca de cursores ODBC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87671062"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="d9892-102">Biblioteca de cursores ODBC</span><span class="sxs-lookup"><span data-stu-id="d9892-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="d9892-103">Algunos controladores ODBC solo admiten la configuración predeterminada del cursor; Estos controladores tampoco admiten operaciones de cursor posicionadas, como **SQLSetPos**.</span><span class="sxs-lookup"><span data-stu-id="d9892-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="d9892-104">La biblioteca de cursores ODBC es un componente de Microsoft Data Access Components (MDAC) que se utiliza para implementar cursores de bloque o estáticos en un controlador que normalmente no los admite.</span><span class="sxs-lookup"><span data-stu-id="d9892-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="d9892-105">La biblioteca de cursores también implementa instrucciones UPDATE y DELETE posicionadas y **SQLSetPos** para los cursores que crea.</span><span class="sxs-lookup"><span data-stu-id="d9892-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="d9892-106">La biblioteca de cursores ODBC se implementa como un nivel entre el Administrador de controladores ODBC y un controlador ODBC.</span><span class="sxs-lookup"><span data-stu-id="d9892-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="d9892-107">Si se carga la biblioteca de cursores ODBC, el Administrador de controladores ODBC enruta todos los comandos relacionados con cursor a la biblioteca de cursores en lugar del controlador.</span><span class="sxs-lookup"><span data-stu-id="d9892-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="d9892-108">Para implementar un cursor, la biblioteca de cursores implementa un cursor que captura el conjunto completo de resultados del controlador subyacente y lo almacena en la caché del cliente.</span><span class="sxs-lookup"><span data-stu-id="d9892-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="d9892-109">Al utilizar la biblioteca de cursores ODBC, la aplicación se limita a la funcionalidad del cursor de la biblioteca de cursores; la aplicación no dispone de compatibilidad con funcionalidad adicional del cursor incluida en el controlador subyacente.</span><span class="sxs-lookup"><span data-stu-id="d9892-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="d9892-110">No hay gran necesidad de utilizar la biblioteca de cursores ODBC con el controlador ODBC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ya que el propio controlador admite más funcionalidad de cursor que la biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="d9892-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="d9892-111">La única razón para utilizar la biblioteca de cursores ODBC con el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client se debe a que el controlador implementa su compatibilidad con los cursores a través de cursores de servidor, y los cursores de servidor no admiten todas las instrucciones SQL.</span><span class="sxs-lookup"><span data-stu-id="d9892-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="d9892-112">Considere la posibilidad de utilizar la biblioteca de cursores ODBC siempre que necesite disponer de un cursor estático con procedimientos almacenados, lotes o instrucciones SQL que contengan COMPUTE, COMPUTE BY, FOR BROWSE o INTO.</span><span class="sxs-lookup"><span data-stu-id="d9892-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="d9892-113">Sin embargo, debe prestar atención si utiliza la biblioteca de cursores, ya que almacena en la memoria caché del cliente el conjunto de resultados completo, lo que puede consumir grandes cantidades de memoria y reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d9892-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="d9892-114">Una aplicación invoca la biblioteca de cursores conexión por conexión mediante [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) para establecer el atributo de conexión SQL_ATTR_ODBC_CURSORS antes de conectarse a un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="d9892-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="d9892-115">SQL_ATTR_ODBC_CURSORS se establece en uno de tres valores:</span><span class="sxs-lookup"><span data-stu-id="d9892-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="d9892-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="d9892-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="d9892-117">Cuando esta opción se establece con el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client, la biblioteca de cursores ODBC invalida la [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] compatibilidad con el cursor nativo del controlador ODBC de Native Client.</span><span class="sxs-lookup"><span data-stu-id="d9892-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="d9892-118">En la conexión solo se pueden utilizar los tipos de cursor que admite la biblioteca de cursores; no se pueden utilizar cursores de servidor.</span><span class="sxs-lookup"><span data-stu-id="d9892-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="d9892-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="d9892-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="d9892-120">Cuando se establece esta opción, se puede usar para la conexión toda la compatibilidad de cursor nativa con el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client.</span><span class="sxs-lookup"><span data-stu-id="d9892-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="d9892-121">No se puede inicializar la biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="d9892-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="d9892-122">Todos los cursores se implementan como cursores de servidor.</span><span class="sxs-lookup"><span data-stu-id="d9892-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="d9892-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="d9892-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="d9892-124">Cuando se establece esta opción, el efecto es el mismo que SQL_CUR_USE_DRIVER cuando se usa con el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client.</span><span class="sxs-lookup"><span data-stu-id="d9892-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="d9892-125">En el momento de la conexión, el administrador de controladores ODBC prueba para ver si el controlador ODBC que se está conectando es compatible con la opción SQL_FETCH_PRIOR de [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span><span class="sxs-lookup"><span data-stu-id="d9892-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="d9892-126">Si el controlador no admite la opción, el Administrador de controladores ODBC carga la biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="d9892-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="d9892-127">Si el controlador admite la opción, el Administrador de controladores ODBC no carga la biblioteca de cursores ODBC y la aplicación utiliza la compatibilidad nativa del controlador.</span><span class="sxs-lookup"><span data-stu-id="d9892-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="d9892-128">Dado que el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client admite SQL_FETCH_PRIOR, el administrador de controladores ODBC no carga la biblioteca de cursores ODBC.</span><span class="sxs-lookup"><span data-stu-id="d9892-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="d9892-129">La biblioteca de cursores permite a las aplicaciones utilizar varias instrucciones activas en una conexión, así como cursores desplazables y actualizables.</span><span class="sxs-lookup"><span data-stu-id="d9892-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="d9892-130">La biblioteca de cursores debe estar cargada para admitir esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="d9892-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="d9892-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) para especificar cómo se debe usar la biblioteca de cursores y [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) para especificar el tipo de cursor, la simultaneidad y el tamaño del conjunto de filas.</span><span class="sxs-lookup"><span data-stu-id="d9892-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d9892-132">Consulte también</span><span class="sxs-lookup"><span data-stu-id="d9892-132">See Also</span></span>  
 [<span data-ttu-id="d9892-133">Cómo se implementan los cursores</span><span class="sxs-lookup"><span data-stu-id="d9892-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
