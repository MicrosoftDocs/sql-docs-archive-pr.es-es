---
title: Nueva generación de bases de datos del sistema | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- master database [SQL Server], rebuilding
- REBUILDDATABASE parameter
- rebuilding databases, master
- system databases [SQL Server], rebuilding
ms.assetid: af457ecd-523e-4809-9652-bdf2e81bd876
author: stevestein
ms.author: sstein
ms.openlocfilehash: 5f695589fa0fc1b86d4433d36afa1bc6357aabd6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672091"
---
# <a name="rebuild-system-databases"></a><span data-ttu-id="06acf-102">Volver a generar bases de datos del sistema</span><span class="sxs-lookup"><span data-stu-id="06acf-102">Rebuild System Databases</span></span>
  <span data-ttu-id="06acf-103">Las bases de datos del sistema deben volver a generarse para corregir problemas por daños en las bases de datos [maestra](master-database.md), [modelo](model-database.md), [msdb](msdb-database.md)o de [recursos](resource-database.md) , o para modificar la intercalación de nivel de servidor predeterminada.</span><span class="sxs-lookup"><span data-stu-id="06acf-103">System databases must be rebuilt to fix corruption problems in the [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md), or [resource](resource-database.md) system databases or to modify the default server-level collation.</span></span> <span data-ttu-id="06acf-104">En este tema se ofrecen instrucciones paso a paso para volver a generar las bases de datos del sistema en [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="06acf-104">This topic provides step-by-step instructions to rebuild system databases in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="06acf-105">**En este tema**</span><span class="sxs-lookup"><span data-stu-id="06acf-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="06acf-106">**Antes de empezar:**</span><span class="sxs-lookup"><span data-stu-id="06acf-106">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="06acf-107">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="06acf-107">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="06acf-108">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="06acf-108">Prerequisites</span></span>](#Prerequisites)  
  
-   <span data-ttu-id="06acf-109">**Procedimientos:**</span><span class="sxs-lookup"><span data-stu-id="06acf-109">**Procedures:**</span></span>  
  
     [<span data-ttu-id="06acf-110">Volver a generar bases de datos del sistema</span><span class="sxs-lookup"><span data-stu-id="06acf-110">Rebuild System Databases</span></span>](#RebuildProcedure)  
  
     [<span data-ttu-id="06acf-111">Volver a generar la base de datos de recursos</span><span class="sxs-lookup"><span data-stu-id="06acf-111">Rebuild the resource Database</span></span>](#Resource)  
  
     [<span data-ttu-id="06acf-112">Crear una base de datos msdb</span><span class="sxs-lookup"><span data-stu-id="06acf-112">Create a New msdb Database</span></span>](#CreateMSDB)  
  
-   <span data-ttu-id="06acf-113">**Seguimiento:**</span><span class="sxs-lookup"><span data-stu-id="06acf-113">**Follow Up:**</span></span>  
  
     [<span data-ttu-id="06acf-114">Solucionar errores de recompilación</span><span class="sxs-lookup"><span data-stu-id="06acf-114">Troubleshoot Rebuild Errors</span></span>](#Troubleshoot)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="06acf-115">Antes de comenzar</span><span class="sxs-lookup"><span data-stu-id="06acf-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="06acf-116">Limitaciones y restricciones</span><span class="sxs-lookup"><span data-stu-id="06acf-116">Limitations and Restrictions</span></span>  
 <span data-ttu-id="06acf-117">Cuando se vuelven a generar las bases de datos maestra, modelo, msdb y tempdb del sistema, las bases de datos se quitan y se vuelven a crear en su ubicación original.</span><span class="sxs-lookup"><span data-stu-id="06acf-117">When the master, model, msdb, and tempdb system databases are rebuilt, the databases are dropped and re-created in their original location.</span></span> <span data-ttu-id="06acf-118">Si se especifica una nueva intercalación en la instrucción para volver a generar las bases de datos del sistema, estas se crearán con esa configuración de intercalación.</span><span class="sxs-lookup"><span data-stu-id="06acf-118">If a new collation is specified in the rebuild statement, the system databases are created using that collation setting.</span></span> <span data-ttu-id="06acf-119">Se perderán las modificaciones que los usuarios hayan realizado en esas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="06acf-119">Any user modifications to these databases are lost.</span></span> <span data-ttu-id="06acf-120">Por ejemplo, es posible que haya objetos definidos por los usuarios en la base de datos maestra, trabajos programados en msdb o cambios en la configuración predeterminada de la base de datos modelo.</span><span class="sxs-lookup"><span data-stu-id="06acf-120">For example, you may have user-defined objects in the master database, scheduled jobs in msdb, or changes to the default database settings in the model database.</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="06acf-121">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="06acf-121">Prerequisites</span></span>  
 <span data-ttu-id="06acf-122">Realice las tareas siguientes antes de volver a generar las bases de datos del sistema para asegurarse de que puede restaurar la configuración actual de las mismas.</span><span class="sxs-lookup"><span data-stu-id="06acf-122">Perform the following tasks before you rebuild the system databases to ensure that you can restore the system databases to their current settings.</span></span>  
  
1.  <span data-ttu-id="06acf-123">Registre todos los valores de configuración del servidor.</span><span class="sxs-lookup"><span data-stu-id="06acf-123">Record all server-wide configuration values.</span></span>  
  
    ```  
    SELECT * FROM sys.configurations;  
    ```  
  
2.  <span data-ttu-id="06acf-124">Registre todos los Service Pack y todas las revisiones que se hayan aplicado a la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] y la intercalación actual.</span><span class="sxs-lookup"><span data-stu-id="06acf-124">Record all service packs and hotfixes applied to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current collation.</span></span> <span data-ttu-id="06acf-125">Deberá aplicar estas actualizaciones de nuevo después de volver a generar las bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-125">You must reapply these updates after rebuilding the system databases.</span></span>  
  
    ```  
    SELECT  
    SERVERPROPERTY('ProductVersion ') AS ProductVersion,  
    SERVERPROPERTY('ProductLevel') AS ProductLevel,  
    SERVERPROPERTY('ResourceVersion') AS ResourceVersion,  
    SERVERPROPERTY('ResourceLastUpdateDateTime') AS ResourceLastUpdateDateTime,  
    SERVERPROPERTY('Collation') AS Collation;  
    ```  
  
3.  <span data-ttu-id="06acf-126">Registre la ubicación actual de todos los archivos de registro y datos de las bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-126">Record the current location of all data and log files for the system databases.</span></span> <span data-ttu-id="06acf-127">Al volver a generar las bases de datos del sistema, todas ellas se instalan en su ubicación original.</span><span class="sxs-lookup"><span data-stu-id="06acf-127">Rebuilding the system databases installs all system databases to their original location.</span></span> <span data-ttu-id="06acf-128">Si ha movido los archivos de registro o datos de las bases de datos del sistema a otra ubicación, deberá volver a moverlos.</span><span class="sxs-lookup"><span data-stu-id="06acf-128">If you have moved system database data or log files to a different location, you must move the files again.</span></span>  
  
    ```  
    SELECT name, physical_name AS current_file_location  
    FROM sys.master_files  
    WHERE database_id IN (DB_ID('master'), DB_ID('model'), DB_ID('msdb'), DB_ID('tempdb'));  
    ```  
  
4.  <span data-ttu-id="06acf-129">Busque la copia de seguridad actual de las bases de datos maestra, modelo y msdb.</span><span class="sxs-lookup"><span data-stu-id="06acf-129">Locate the current backup of the master, model, and msdb databases.</span></span>  
  
5.  <span data-ttu-id="06acf-130">Si la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] se configura como Distribuidor de replicación, busque la copia de seguridad actual de la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="06acf-130">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, locate the current backup of the distribution database.</span></span>  
  
6.  <span data-ttu-id="06acf-131">Asegúrese de que tiene los permisos adecuados para volver a generar las bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-131">Ensure you have appropriate permissions to rebuild the system databases.</span></span> <span data-ttu-id="06acf-132">Para realizar esta operación, debe ser miembro del rol fijo de servidor `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="06acf-132">To perform this operation, you must be a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="06acf-133">Para obtener más información, vea [Roles de nivel de servidor](../security/authentication-access/server-level-roles.md).</span><span class="sxs-lookup"><span data-stu-id="06acf-133">For more information, see [Server-Level Roles](../security/authentication-access/server-level-roles.md).</span></span>  
  
7.  <span data-ttu-id="06acf-134">Compruebe que haya copias de los archivos de plantilla de registro y datos de las bases de datos maestra, modelo y msdb en el servidor local.</span><span class="sxs-lookup"><span data-stu-id="06acf-134">Verify that copies of the master, model, msdb data and log template files exist on the local server.</span></span> <span data-ttu-id="06acf-135">La ubicación predeterminada de los archivos de plantilla es C:\Archivos de programa\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="06acf-135">The default location for the template files is C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span></span> <span data-ttu-id="06acf-136">Estos archivos se usan durante el proceso de volver a generar las bases de datos y deben estar presentes para que la instalación se realice correctamente.</span><span class="sxs-lookup"><span data-stu-id="06acf-136">These files are used during the rebuild process and must be present for Setup to succeed.</span></span> <span data-ttu-id="06acf-137">Si no lo están, ejecute la característica de reparación del programa de instalación o copie los archivos manualmente desde el disco de instalación.</span><span class="sxs-lookup"><span data-stu-id="06acf-137">If they are missing, run the Repair feature of Setup, or manually copy the files from your installation media.</span></span> <span data-ttu-id="06acf-138">Para encontrar los archivos en el soporte físico de instalación, navegue hasta el directorio de la plataforma correcta (x86 o x64) y, a continuación, navegue hasta setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="06acf-138">To locate the files on the installation media, navigate to the appropriate platform directory (x86 or x64) and then navigate to setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span></span>  
  
##  <a name="rebuild-system-databases"></a><a name="RebuildProcedure"></a> <span data-ttu-id="06acf-139">Volver a generar bases de datos del sistema</span><span class="sxs-lookup"><span data-stu-id="06acf-139">Rebuild System Databases</span></span>  
 <span data-ttu-id="06acf-140">Con el procedimiento siguiente se vuelven a generar las bases de datos maestra, modelo, msdb y tempdb del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-140">The following procedure rebuilds the master, model, msdb, and tempdb system databases.</span></span> <span data-ttu-id="06acf-141">No se pueden especificar las bases de datos del sistema que se van a volver a generar.</span><span class="sxs-lookup"><span data-stu-id="06acf-141">You cannot specify the system databases to be rebuilt.</span></span> <span data-ttu-id="06acf-142">En el caso de las instancias en clúster, este procedimiento se debe realizar en el nodo activo y desconectar el recurso de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] del grupo de aplicaciones en clúster antes de realizar el procedimiento.</span><span class="sxs-lookup"><span data-stu-id="06acf-142">For clustered instances, this procedure must be performed on the active node and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] resource in the corresponding cluster application group must be taken offline before performing the procedure.</span></span>  
  
 <span data-ttu-id="06acf-143">Este procedimiento no vuelve a generar la base de datos de recursos.</span><span class="sxs-lookup"><span data-stu-id="06acf-143">This procedure does not rebuild the resource database.</span></span> <span data-ttu-id="06acf-144">Vea la sección "Procedimiento para volver a generar la base de datos de recursos" más adelante en este mismo tema.</span><span class="sxs-lookup"><span data-stu-id="06acf-144">See the section, "Rebuild the resource Database Procedure" later in this topic.</span></span>  
  
#### <a name="to-rebuild-system-databases-for-an-instance-of-sql-server"></a><span data-ttu-id="06acf-145">Para volver a generar las bases de datos del sistema para una instancia de SQL Server:</span><span class="sxs-lookup"><span data-stu-id="06acf-145">To rebuild system databases for an instance of SQL Server:</span></span>  
  
1.  <span data-ttu-id="06acf-146">Inserte el disco de instalación de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] en la unidad de disco o, en el símbolo del sistema, cambie el directorio a la ubicación del servidor local donde se encuentra el archivo setup.exe.</span><span class="sxs-lookup"><span data-stu-id="06acf-146">Insert the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] installation media into the disk drive, or, from a command prompt, change directories to the location of the setup.exe file on the local server.</span></span> <span data-ttu-id="06acf-147">La ubicación predeterminada en el servidor es C:\Archivos de programa\Microsoft SQL Server\120\Setup Bootstrap\Release.</span><span class="sxs-lookup"><span data-stu-id="06acf-147">The default location on the server is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Release.</span></span>  
  
2.  <span data-ttu-id="06acf-148">En una ventana del símbolo del sistema, escriba el siguiente comando.</span><span class="sxs-lookup"><span data-stu-id="06acf-148">From a command prompt window, enter the following command.</span></span> <span data-ttu-id="06acf-149">Los parámetros entre corchetes son opcionales.</span><span class="sxs-lookup"><span data-stu-id="06acf-149">Square brackets are used to indicate optional parameters.</span></span> <span data-ttu-id="06acf-150">No escriba los corchetes.</span><span class="sxs-lookup"><span data-stu-id="06acf-150">Do not enter the brackets.</span></span> <span data-ttu-id="06acf-151">Cuando se usa un sistema operativo Windows que tiene el Control de cuentas de usuario (UAC) habilitado, para ejecutar el programa de instalación se requieren privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="06acf-151">When using a Windows operating system that has User Account Control (UAC) enabled, running Setup requires elevated privileges.</span></span> <span data-ttu-id="06acf-152">El símbolo del sistema se debe ejecutar como Administrador.</span><span class="sxs-lookup"><span data-stu-id="06acf-152">The command prompt must be run as Administrator.</span></span>  
  
     `Setup /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=InstanceName /SQLSYSADMINACCOUNTS=accounts [ /SAPWD= StrongPassword ] [ /SQLCOLLATION=CollationName]`  
  
    |<span data-ttu-id="06acf-153">Nombre de parámetro</span><span class="sxs-lookup"><span data-stu-id="06acf-153">Parameter name</span></span>|<span data-ttu-id="06acf-154">Descripción</span><span class="sxs-lookup"><span data-stu-id="06acf-154">Description</span></span>|  
    |--------------------|-----------------|  
    |<span data-ttu-id="06acf-155">/QUIET o /Q</span><span class="sxs-lookup"><span data-stu-id="06acf-155">/QUIET or /Q</span></span>|<span data-ttu-id="06acf-156">Especifica que el programa de instalación se ejecute sin ninguna interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="06acf-156">Specifies that Setup run without any user interface.</span></span>|  
    |<span data-ttu-id="06acf-157">/ACTION=REBUILDDATABASE</span><span class="sxs-lookup"><span data-stu-id="06acf-157">/ACTION=REBUILDDATABASE</span></span>|<span data-ttu-id="06acf-158">Especifica que el programa de instalación vuelva a crear las bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-158">Specifies that Setup re-create the system databases.</span></span>|  
    |<span data-ttu-id="06acf-159">/INSTANCENAME=*InstanceName*</span><span class="sxs-lookup"><span data-stu-id="06acf-159">/INSTANCENAME=*InstanceName*</span></span>|<span data-ttu-id="06acf-160">Es el nombre de la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="06acf-160">Is the name of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="06acf-161">Para la instancia predeterminada, escriba MSSQLSERVER.</span><span class="sxs-lookup"><span data-stu-id="06acf-161">For the default instance, enter MSSQLSERVER.</span></span>|  
    |<span data-ttu-id="06acf-162">/SQLSYSADMINACCOUNTS=*accounts*</span><span class="sxs-lookup"><span data-stu-id="06acf-162">/SQLSYSADMINACCOUNTS=*accounts*</span></span>|<span data-ttu-id="06acf-163">Especifica las cuentas individuales o de grupos de Windows que se agregarán al rol fijo de servidor `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="06acf-163">Specifies the Windows groups or individual accounts to add to the `sysadmin` fixed server role.</span></span> <span data-ttu-id="06acf-164">Si especifica varias cuentas, sepárelas con un espacio en blanco.</span><span class="sxs-lookup"><span data-stu-id="06acf-164">When specifying more than one account, separate the accounts with a blank space.</span></span> <span data-ttu-id="06acf-165">Escriba, por ejemplo, **BUILTIN\Administrators MyDomain\MyUser**.</span><span class="sxs-lookup"><span data-stu-id="06acf-165">For example, enter **BUILTIN\Administrators MyDomain\MyUser**.</span></span> <span data-ttu-id="06acf-166">Cuando está especificando una cuenta que contiene un espacio en blanco dentro del nombre, agregue la cuenta entre comillas tipográficas.</span><span class="sxs-lookup"><span data-stu-id="06acf-166">When you are specifying an account that contains a blank space within the account name, enclose the account in double quotation marks.</span></span> <span data-ttu-id="06acf-167">Por ejemplo, escriba `NT AUTHORITY\SYSTEM`.</span><span class="sxs-lookup"><span data-stu-id="06acf-167">For example, enter `NT AUTHORITY\SYSTEM`.</span></span>|  
    |<span data-ttu-id="06acf-168">[ /SAPWD=*StrongPassword* ]</span><span class="sxs-lookup"><span data-stu-id="06acf-168">[ /SAPWD=*StrongPassword* ]</span></span>|<span data-ttu-id="06acf-169">Especifica la contraseña de la [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` cuenta.</span><span class="sxs-lookup"><span data-stu-id="06acf-169">Specifies the password for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` account.</span></span> <span data-ttu-id="06acf-170">Este parámetro es obligatorio si la instancia usa el modo Autenticación mixta (autenticación de[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] y de Windows).</span><span class="sxs-lookup"><span data-stu-id="06acf-170">This parameter is required if the instance uses Mixed Authentication ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and Windows Authentication) mode.</span></span><br /><br /> <span data-ttu-id="06acf-171">Nota de seguridad la cuenta es \*\* \* una cuenta conocida y \* a menudo se dirige a usuarios malintencionados. \* \* \*\* `sa` [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="06acf-171">**\*\* Security Note \*\*** The `sa` account is a well-known [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] account and it is often targeted by malicious users.</span></span> <span data-ttu-id="06acf-172">Es muy importante que use una contraseña segura en el inicio de sesión de `sa`.</span><span class="sxs-lookup"><span data-stu-id="06acf-172">It is very important that you use a strong password for the `sa` login.</span></span><br /><br /> <span data-ttu-id="06acf-173">No especifique este parámetro para el modo Autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="06acf-173">Do not specify this parameter for Windows Authentication mode.</span></span>|  
    |<span data-ttu-id="06acf-174">[ /SQLCOLLATION=*CollationName* ]</span><span class="sxs-lookup"><span data-stu-id="06acf-174">[ /SQLCOLLATION=*CollationName* ]</span></span>|<span data-ttu-id="06acf-175">Especifica una nueva intercalación de nivel de servidor.</span><span class="sxs-lookup"><span data-stu-id="06acf-175">Specifies a new server-level collation.</span></span> <span data-ttu-id="06acf-176">Este parámetro es opcional.</span><span class="sxs-lookup"><span data-stu-id="06acf-176">This parameter is optional.</span></span> <span data-ttu-id="06acf-177">Cuando no se especifica, se usa la intercalación actual del servidor.</span><span class="sxs-lookup"><span data-stu-id="06acf-177">When not specified, the current collation of the server is used.</span></span><br /><br /> <span data-ttu-id="06acf-178">**\*\* Importante \*\*** Al cambiar la intercalación de nivel de servidor, no se cambia la de las bases de datos de usuario existentes.</span><span class="sxs-lookup"><span data-stu-id="06acf-178">**\*\* Important \*\*** Changing the server-level collation does not change the collation of existing user databases.</span></span> <span data-ttu-id="06acf-179">Todas las bases de datos de usuario nuevas usarán la nueva intercalación de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="06acf-179">All newly created user databases will use the new collation by default.</span></span><br /><br /> <span data-ttu-id="06acf-180">Para obtener más información, vea [Configurar o cambiar la intercalación del servidor](../collations/set-or-change-the-server-collation.md).</span><span class="sxs-lookup"><span data-stu-id="06acf-180">For more information, see [Set or Change the Server Collation](../collations/set-or-change-the-server-collation.md).</span></span>|  
  
3.  <span data-ttu-id="06acf-181">Una vez completada la regeneración de las bases de datos del sistema, el programa de instalación regresa al símbolo del sistema sin mostrar ningún mensaje.</span><span class="sxs-lookup"><span data-stu-id="06acf-181">When Setup has completed rebuilding the system databases, it returns to the command prompt with no messages.</span></span> <span data-ttu-id="06acf-182">Examine el archivo de registro Summary.txt para comprobar que el proceso se completó correctamente.</span><span class="sxs-lookup"><span data-stu-id="06acf-182">Examine the Summary.txt log file to verify that the process completed successfully.</span></span> <span data-ttu-id="06acf-183">Este archivo se encuentra en C:\Archivos de programa\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="06acf-183">This file is located at C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span>  
  
## <a name="post-rebuild-tasks"></a><span data-ttu-id="06acf-184">Tareas posteriores al proceso de volver a generar bases de datos</span><span class="sxs-lookup"><span data-stu-id="06acf-184">Post-Rebuild Tasks</span></span>  
 <span data-ttu-id="06acf-185">Después de volver a generar la base de datos, quizás deba realizar las tareas adicionales siguientes:</span><span class="sxs-lookup"><span data-stu-id="06acf-185">After rebuilding the database you may need to perform the following additional tasks:</span></span>  
  
-   <span data-ttu-id="06acf-186">Restaurar las copias de seguridad completas más recientes de las bases de datos maestra, modelo y msdb.</span><span class="sxs-lookup"><span data-stu-id="06acf-186">Restore your most recent full backups of the master, model, and msdb databases.</span></span> <span data-ttu-id="06acf-187">Para obtener más información, vea [Realizar copias de seguridad y restaurar bases de datos del sistema &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="06acf-187">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="06acf-188">Si ha cambiado la intercalación del servidor, no restaure las bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-188">If you have changed the server collation, do not restore the system databases.</span></span> <span data-ttu-id="06acf-189">Si lo hace, reemplazará la nueva intercalación por la antigua.</span><span class="sxs-lookup"><span data-stu-id="06acf-189">Doing so will replace the new collation with the previous collation setting.</span></span>  
  
     <span data-ttu-id="06acf-190">Si no dispone de una copia de seguridad o si la copia de seguridad restaurada no es actual, vuelva a crear las entradas que no se encuentren.</span><span class="sxs-lookup"><span data-stu-id="06acf-190">If a backup is not available or if the restored backup is not current, re-create any missing entries.</span></span> <span data-ttu-id="06acf-191">Por ejemplo, vuelva a crear todas las entradas que no se encuentren de las bases de datos de usuario, los dispositivos de copia de seguridad, los inicios de sesión de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , los puntos de conexión, etc.</span><span class="sxs-lookup"><span data-stu-id="06acf-191">For example, re-create all missing entries for your user databases, backup devices, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logins, end points, and so on.</span></span> <span data-ttu-id="06acf-192">La mejor forma de volver a crear las entradas es ejecutar los scripts originales que se usaron para crearlas.</span><span class="sxs-lookup"><span data-stu-id="06acf-192">The best way to re-create entries is to run the original scripts that created them.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="06acf-193">Se recomienda proteger los scripts para evitar que los modifiquen personas no autorizadas.</span><span class="sxs-lookup"><span data-stu-id="06acf-193">We recommend that you secure your scripts to prevent their being altered by unauthorized by individuals.</span></span>  
  
-   <span data-ttu-id="06acf-194">Si la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] se configura como Distribuidor de replicación, debe restaurar la base de datos de distribución.</span><span class="sxs-lookup"><span data-stu-id="06acf-194">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, you must restore the distribution database.</span></span> <span data-ttu-id="06acf-195">Para obtener más información, vea [Realizar copias de seguridad y restaurar bases de datos de SQL Server](../replication/administration/back-up-and-restore-replicated-databases.md).</span><span class="sxs-lookup"><span data-stu-id="06acf-195">For more information, see [Back Up and Restore Replicated Databases](../replication/administration/back-up-and-restore-replicated-databases.md).</span></span>  
  
-   <span data-ttu-id="06acf-196">Mover las bases de datos del sistema a las ubicaciones registradas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="06acf-196">Move the system databases to the locations you recorded previously.</span></span> <span data-ttu-id="06acf-197">Para obtener más información, vea [Mover bases de datos del sistema](system-databases.md).</span><span class="sxs-lookup"><span data-stu-id="06acf-197">For more information, see [Move System Databases](system-databases.md).</span></span>  
  
-   <span data-ttu-id="06acf-198">Comprobar que los valores de configuración de todo el servidor coinciden con los valores registrados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="06acf-198">Verify the server-wide configuration values match the values you recorded previously.</span></span>  
  
##  <a name="rebuild-the-resource-database"></a><a name="Resource"></a> <span data-ttu-id="06acf-199">Volver a generar la base de datos de recursos</span><span class="sxs-lookup"><span data-stu-id="06acf-199">Rebuild the resource Database</span></span>  
 <span data-ttu-id="06acf-200">Con el procedimiento siguiente se vuelve a generar la base de datos de recursos.</span><span class="sxs-lookup"><span data-stu-id="06acf-200">The following procedure rebuilds the resource system database.</span></span> <span data-ttu-id="06acf-201">Al volver a generar la base de datos de recursos, se pierden todos los Service Pack y las revisiones y, por lo tanto, se deben volver a aplicar.</span><span class="sxs-lookup"><span data-stu-id="06acf-201">When you rebuild the resource database, all service packs and hot fixes are lost, and therefore must be reapplied.</span></span>  
  
#### <a name="to-rebuild-the-resource-system-database"></a><span data-ttu-id="06acf-202">Para volver a generar la base de datos de recursos:</span><span class="sxs-lookup"><span data-stu-id="06acf-202">To rebuild the resource system database:</span></span>  
  
1.  <span data-ttu-id="06acf-203">Inicie el programa de instalación de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (setup.exe) desde los discos de distribución.</span><span class="sxs-lookup"><span data-stu-id="06acf-203">Launch the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup program (setup.exe) from the distribution media.</span></span>  
  
2.  <span data-ttu-id="06acf-204">En el área de navegación izquierda, haga clic en **Mantenimiento**y, a continuación, en **Reparar**.</span><span class="sxs-lookup"><span data-stu-id="06acf-204">In the left navigation area, click **Maintenance**, and then click **Repair**.</span></span>  
  
3.  <span data-ttu-id="06acf-205">Las rutinas de archivo y de reglas auxiliares del programa de instalación se ejecutan para asegurarse de que el sistema tiene instalados los requisitos previos y que el equipo supera las reglas de validación del programa de instalación.</span><span class="sxs-lookup"><span data-stu-id="06acf-205">Setup support rule and file routines run to ensure that your system has prerequisites installed and that the computer passes Setup validation rules.</span></span> <span data-ttu-id="06acf-206">Haga clic en **Aceptar** o en **Instalar** para continuar.</span><span class="sxs-lookup"><span data-stu-id="06acf-206">Click **OK** or **Install** to continue.</span></span>  
  
4.  <span data-ttu-id="06acf-207">En la página Seleccionar instancia, seleccione la instancia que desea reparar y, a continuación, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="06acf-207">On the Select Instance page, select the instance to repair, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="06acf-208">Las reglas de reparación se ejecutarán para validar la operación.</span><span class="sxs-lookup"><span data-stu-id="06acf-208">The repair rules will run to validate the operation.</span></span> <span data-ttu-id="06acf-209">Para continuar, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="06acf-209">To continue, click **Next**.</span></span>  
  
6.  <span data-ttu-id="06acf-210">En la página **Listo para reparar** , haga clic en **Reparar**.</span><span class="sxs-lookup"><span data-stu-id="06acf-210">From the **Ready to Repair** page, click **Repair**.</span></span> <span data-ttu-id="06acf-211">La página Operación completada indica que la operación ha finalizado.</span><span class="sxs-lookup"><span data-stu-id="06acf-211">The Complete page indicates that the operation is finished.</span></span>  
  
##  <a name="create-a-new-msdb-database"></a><a name="CreateMSDB"></a> <span data-ttu-id="06acf-212">Crear una base de datos msdb</span><span class="sxs-lookup"><span data-stu-id="06acf-212">Create a New msdb Database</span></span>  
 <span data-ttu-id="06acf-213">Si la `msdb` base de datos está dañada y no tiene una copia de seguridad de la `msdb` base de datos, puede crear una nueva mediante `msdb` el script **instmsdb** .</span><span class="sxs-lookup"><span data-stu-id="06acf-213">If the `msdb` database is damaged and you do not have a backup of the `msdb` database, you can create a new `msdb` by using the **instmsdb** script.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="06acf-214">Al volver a generar la `msdb` base de datos mediante el script **instmsdb** , se eliminará toda la información almacenada en, como `msdb` trabajos, alertas, operadores, planes de mantenimiento, historial de copia de seguridad, configuración de la administración basada en directivas, correo electrónico de base de datos, almacenamiento de datos de rendimiento, etc.</span><span class="sxs-lookup"><span data-stu-id="06acf-214">Rebuilding the `msdb` database using the **instmsdb** script will eliminate all the information stored in `msdb` such as jobs, alert, operators, maintenance plans, backup history, Policy-Based Management settings, Database Mail, Performance Data Warehouse, etc.</span></span>  
  
1.  <span data-ttu-id="06acf-215">Detenga todos los servicios que se conectan al [!INCLUDE[ssDE](../../includes/ssde-md.md)], incluido el Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)]y todas las aplicaciones que usan [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] como almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="06acf-215">Stop all services connecting to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], including [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)], and all applications using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] as data store.</span></span>  
  
2.  <span data-ttu-id="06acf-216">Inicie [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] desde la línea de comandos usando el comando: `NET START MSSQLSERVER /T3608`</span><span class="sxs-lookup"><span data-stu-id="06acf-216">Start [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the command line using the command: `NET START MSSQLSERVER /T3608`</span></span>  
  
     <span data-ttu-id="06acf-217">Para más información, consulte [Iniciar, detener, pausar, reanudar y reiniciar el motor de base de datos, Agente SQL Server o el Servicio SQL Server Browser](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span><span class="sxs-lookup"><span data-stu-id="06acf-217">For more information, see [Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span></span>  
  
3.  <span data-ttu-id="06acf-218">En otra ventana de la línea de comandos, Desasocie la `msdb` base de datos ejecutando el comando siguiente, reemplazando *\<servername>* por la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :`SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span><span class="sxs-lookup"><span data-stu-id="06acf-218">In another command line window, detach the `msdb` database by executing the following command, replacing *\<servername>* with the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]: `SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span></span>  
  
4.  <span data-ttu-id="06acf-219">Con el explorador de Windows, cambie el nombre de los `msdb` archivos de base de datos.</span><span class="sxs-lookup"><span data-stu-id="06acf-219">Using the Windows Explorer, rename the `msdb` database files.</span></span> <span data-ttu-id="06acf-220">De forma predeterminada, están en la subcarpeta DATA de la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="06acf-220">By default these are in the DATA sub-folder for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
5.  <span data-ttu-id="06acf-221">Con el Administrador de configuración de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , detenga y reinicie el servicio [!INCLUDE[ssDE](../../includes/ssde-md.md)] de la forma normal.</span><span class="sxs-lookup"><span data-stu-id="06acf-221">Using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, stop and restart the [!INCLUDE[ssDE](../../includes/ssde-md.md)] service normally.</span></span>  
  
6.  <span data-ttu-id="06acf-222">En una ventana de línea de comandos, conéctese a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] y ejecute el comando: `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span><span class="sxs-lookup"><span data-stu-id="06acf-222">In a command line window, connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and execute the command: `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span></span>  
  
     <span data-ttu-id="06acf-223">Reemplace *\<servername>* con la instancia de [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="06acf-223">Replace *\<servername>* with the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span> <span data-ttu-id="06acf-224">Use la ruta de acceso al sistema de archivos de la instancia de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="06acf-224">Use the file system path of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
7.  <span data-ttu-id="06acf-225">Con el Bloc de notas de Windows, abra el archivo **instmsdb.out** y compruebe si hay errores en la salida.</span><span class="sxs-lookup"><span data-stu-id="06acf-225">Using the Windows Notepad, open the **instmsdb.out** file and check the output for any errors.</span></span>  
  
8.  <span data-ttu-id="06acf-226">Vuelva a aplicar todos los Service Pack y todas las revisiones instaladas en la instancia.</span><span class="sxs-lookup"><span data-stu-id="06acf-226">Re-apply any service packs or hotfix installed on the instance.</span></span>  
  
9. <span data-ttu-id="06acf-227">Vuelva a crear el contenido de usuario almacenado en la `msdb` base de datos, como trabajos, alertas, etc.</span><span class="sxs-lookup"><span data-stu-id="06acf-227">Recreate the user content stored in the `msdb` database, such as jobs, alert, etc.</span></span>  
  
10. <span data-ttu-id="06acf-228">Haga una copia de seguridad de la base de datos `msdb` .</span><span class="sxs-lookup"><span data-stu-id="06acf-228">Backup the `msdb` database.</span></span>  
  
##  <a name="troubleshoot-rebuild-errors"></a><a name="Troubleshoot"></a> <span data-ttu-id="06acf-229">Solucionar errores de recompilación</span><span class="sxs-lookup"><span data-stu-id="06acf-229">Troubleshoot Rebuild Errors</span></span>  
 <span data-ttu-id="06acf-230">Los errores de sintaxis y otros errores en tiempo de ejecución se muestran en la ventana del símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-230">Syntax and other run-time errors are displayed in the command prompt window.</span></span> <span data-ttu-id="06acf-231">Examine la instrucción de instalación en busca de los siguientes errores de sintaxis:</span><span class="sxs-lookup"><span data-stu-id="06acf-231">Examine the Setup statement for the following syntax errors:</span></span>  
  
-   <span data-ttu-id="06acf-232">La barra diagonal (/) no aparece delante de los nombres de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="06acf-232">Missing slash mark (/) in front of each parameter name.</span></span>  
  
-   <span data-ttu-id="06acf-233">Se ha omitido el signo de igualdad (=) entre el nombre del parámetro y su valor.</span><span class="sxs-lookup"><span data-stu-id="06acf-233">Missing equal sign (=) between the parameter name and the parameter value.</span></span>  
  
-   <span data-ttu-id="06acf-234">Hay espacios en blanco entre el nombre del parámetro y el signo igual.</span><span class="sxs-lookup"><span data-stu-id="06acf-234">Presence of blank spaces between the parameter name and the equal sign.</span></span>  
  
-   <span data-ttu-id="06acf-235">Presencia de comas (,) u otros caracteres que no se especifican en la sintaxis.</span><span class="sxs-lookup"><span data-stu-id="06acf-235">Presence of commas (,) or other characters that are not specified in the syntax.</span></span>  
  
 <span data-ttu-id="06acf-236">Cuando se haya completado el proceso de volver a generar la base de datos, examine los registros de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en busca de errores.</span><span class="sxs-lookup"><span data-stu-id="06acf-236">After the rebuild operation is complete, examine the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logs for any errors.</span></span> <span data-ttu-id="06acf-237">De manera predeterminada, están en C:\Archivos de programa\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="06acf-237">The default log location is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span> <span data-ttu-id="06acf-238">Para encontrar el archivo de registro que contiene los resultados del proceso de volver a generar bases de datos, cambie el directorio a la carpeta Logs en un símbolo del sistema y, a continuación, ejecute `findstr /s RebuildDatabase summary*.*`.</span><span class="sxs-lookup"><span data-stu-id="06acf-238">To locate the log file that contains the results of the rebuild process, change directories to the Logs folder from a command prompt, and then run `findstr /s RebuildDatabase summary*.*`.</span></span> <span data-ttu-id="06acf-239">Esta búsqueda indicará los archivos de registro que contengan los resultados del proceso de volver a generar las bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="06acf-239">This search will point you to any log files that contain the results of rebuilding system databases.</span></span> <span data-ttu-id="06acf-240">Abra los archivos de registro y examine si contienen mensajes de error relevantes.</span><span class="sxs-lookup"><span data-stu-id="06acf-240">Open the log files and examine them for relevant error messages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="06acf-241">Consulte también</span><span class="sxs-lookup"><span data-stu-id="06acf-241">See Also</span></span>  
 [<span data-ttu-id="06acf-242">Bases de datos del sistema</span><span class="sxs-lookup"><span data-stu-id="06acf-242">System Databases</span></span>](system-databases.md)  
  
  
