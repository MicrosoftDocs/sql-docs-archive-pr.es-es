---
title: Errores posibles de medios durante copia de seguridad y restauración (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- media errors [SQL Server]
- CONTINUE_AFTER_ERROR option
- errors [SQL Server], backups
- backups [SQL Server], errors
- RESTORE VERIFYONLY statement
- backup media [SQL Server], error management
- page checksums [SQL Server]
- backup checksums [SQL Server]
- backing up [SQL Server], media errors
- RESTORE statement, media errors
- NO_CHECKSUM option
- checksums [SQL Server]
ms.assetid: 83a27b29-1191-4f8d-9648-6e6be73a9b7c
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 15691c513aad6027be1063ef566ebdf245ebcc8c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87748144"
---
# <a name="possible-media-errors-during-backup-and-restore-sql-server"></a><span data-ttu-id="dda67-102">Errores posibles de medios durante copia de seguridad y restauración (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="dda67-102">Possible Media Errors During Backup and Restore (SQL Server)</span></span>
  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="dda67-103">ofrece la opción de recuperación de una base de datos a pesar de los errores detectados.</span><span class="sxs-lookup"><span data-stu-id="dda67-103">gives you the option of recovering a database despite detected errors.</span></span> <span data-ttu-id="dda67-104">Un importante mecanismo de detección de errores nuevo es la creación opcional de una suma de comprobación de copia de seguridad que se puede crear mediante una operación de copia de seguridad y validar mediante una operación de restauración.</span><span class="sxs-lookup"><span data-stu-id="dda67-104">An important new error-detection mechanism is the optional creation of a backup checksum that can be created by a backup operation and validated by a restore operation.</span></span> <span data-ttu-id="dda67-105">Puede controlar si una operación comprueba si hay errores y si la operación se detiene o continúa al encontrar un error.</span><span class="sxs-lookup"><span data-stu-id="dda67-105">You can control whether an operation checks for errors and whether the operation stops or continues on encountering an error.</span></span> <span data-ttu-id="dda67-106">Si una copia de seguridad contiene una suma de comprobación de copia de seguridad, las instrucciones RESTORE y RESTORE VERIFYONLY pueden comprobar si hay errores.</span><span class="sxs-lookup"><span data-stu-id="dda67-106">If a backup contains a backup checksum, RESTORE and RESTORE VERIFYONLY statements can check for errors.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="dda67-107">Las copias de seguridad reflejadas proporcionan hasta cuatro copias (reflejos) de un conjunto de medios, ofreciendo copias alternativas para recuperar el sistema de los errores provocados por los medios dañados.</span><span class="sxs-lookup"><span data-stu-id="dda67-107">Mirrored backups provide up to four copies (mirrors) of a media set, providing alternative copies for recovering from errors caused by damaged media.</span></span> <span data-ttu-id="dda67-108">Para obtener más información, vea [Conjuntos de medios de copia de seguridad reflejados &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="dda67-108">For more information, see [Mirrored Backup Media Sets &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md).</span></span>  
  
  
  
##  <a name="backup-checksums"></a><a name="BckChecksums"></a> <span data-ttu-id="dda67-109">Comprobaciones de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="dda67-109">Backup Checksums</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="dda67-110">admite tres tipos de sumas de comprobación: una suma de comprobación de páginas, una de bloques de registro y una de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="dda67-110">supports three types of checksums: a checksum on pages, a checksum in log blocks, and a backup checksum.</span></span> <span data-ttu-id="dda67-111">Al generar una suma de comprobación de copia de seguridad, BACKUP comprueba que los datos que se leen de la base de datos son coherentes con cualquier suma de comprobación o indicación de página rasgada de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="dda67-111">When generating a backup checksum, BACKUP verifies that the data read from the database is consistent with any checksum or torn-page indication that is present in the database.</span></span>  
  
 <span data-ttu-id="dda67-112">La instrucción BACKUP calcula opcionalmente una suma de comprobación de copia de seguridad en el flujo de copia de seguridad; si hay una suma de comprobación de página o información de página rasgada en determinada página, al hacer la copia de seguridad de la página, BACKUP comprueba también el estado de página rasgada, la suma de comprobación y el Id. de la página.</span><span class="sxs-lookup"><span data-stu-id="dda67-112">The BACKUP statement optionally computes a backup checksum on the backup stream; if page-checksum or torn-page information is present on a given page, when backing up the page, BACKUP also verifies the checksum and torn-page status and the page ID, of the page.</span></span> <span data-ttu-id="dda67-113">Al crear una suma de comprobación de copia de seguridad, una operación de copia de seguridad no agrega sumas de comprobación a las páginas.</span><span class="sxs-lookup"><span data-stu-id="dda67-113">When creating a backup checksum, a backup operation does not add any checksums to pages.</span></span> <span data-ttu-id="dda67-114">Las páginas se copian tal y como están en la base de datos y la copia de seguridad no las modifica.</span><span class="sxs-lookup"><span data-stu-id="dda67-114">Pages are backed up as they exist in the database, and the pages are unmodified by backup.</span></span>  
  
 <span data-ttu-id="dda67-115">Debido a la carga que supone comprobar y generar sumas de comprobación de seguridad, su utilización puede tener consecuencias negativas sobre el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="dda67-115">Due to the overhead verifying and generating backup checksums, using backup checksums poses a potential performance impact.</span></span> <span data-ttu-id="dda67-116">Pueden quedar afectados tanto la carga de trabajo como el rendimiento de la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="dda67-116">Both the workload and the backup throughput may be affected.</span></span> <span data-ttu-id="dda67-117">Por consiguiente, el uso de la suma de comprobación de copia de seguridad es opcional.</span><span class="sxs-lookup"><span data-stu-id="dda67-117">Therefore, using backup checksums is optional.</span></span> <span data-ttu-id="dda67-118">Cuando decida si va a generar sumas de comprobación durante una copia de seguridad, supervise cuidadosamente la sobrecarga de CPU en la que se incurrirá, así como el impacto sobre las posibles cargas de trabajo simultáneas del sistema.</span><span class="sxs-lookup"><span data-stu-id="dda67-118">When deciding to generate checksums during a backup, carefully monitor the CPU overhead incurred as well as the impact on any concurrent workload on the system.</span></span>  
  
 <span data-ttu-id="dda67-119">BACKUP no modifica nunca la página de origen del disco ni el contenido de una página.</span><span class="sxs-lookup"><span data-stu-id="dda67-119">BACKUP never modifies the source page on disk nor the contents of a page.</span></span>  
  
 <span data-ttu-id="dda67-120">Cuando se habilitan las sumas de comprobación de copia de seguridad, una operación de copia de seguridad realiza los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="dda67-120">When backup checksums are enabled, a backup operation performs the following steps:</span></span>  
  
1.  <span data-ttu-id="dda67-121">Antes de escribir una página en los medios de copia de seguridad, la operación de copia de seguridad comprueba la información en el nivel de página (suma de comprobación de página o detección de página rasgada), si existe.</span><span class="sxs-lookup"><span data-stu-id="dda67-121">Before writing a page to the backup media, the backup operation verifies the page-level information (page checksum or torn page detection), if either exists.</span></span> <span data-ttu-id="dda67-122">Si no existe, la copia de seguridad no puede comprobar la página.</span><span class="sxs-lookup"><span data-stu-id="dda67-122">If neither exists, backup cannot verify the page.</span></span> <span data-ttu-id="dda67-123">Las páginas no comprobadas se incluyen tal cual y su contenido se agrega a la suma de comprobación de copia de seguridad total.</span><span class="sxs-lookup"><span data-stu-id="dda67-123">Unverified the pages are included as is, and their contents are added to the overall backup checksum.</span></span>  
  
     <span data-ttu-id="dda67-124">Si la operación de copia de seguridad encuentra un error de página durante la comprobación, la copia de seguridad genera un error.</span><span class="sxs-lookup"><span data-stu-id="dda67-124">If the backup operation encounters a page error during verification, the backup fails.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="dda67-125">Para obtener más información acerca de las sumas de comprobación de página y la detección de página rasgada, vea la opción PAGE_VERIFY de la instrucción ALTER DATABASE.</span><span class="sxs-lookup"><span data-stu-id="dda67-125">For more information about page checksums and torn page detection, see the PAGE_VERIFY option of the ALTER DATABASE statement.</span></span> <span data-ttu-id="dda67-126">Para obtener más información, vea [ALTER DATABASE SET Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-set-options).</span><span class="sxs-lookup"><span data-stu-id="dda67-126">For more information, see [ALTER DATABASE SET Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-set-options).</span></span>  
  
2.  <span data-ttu-id="dda67-127">Aunque se incluyan sumas de comprobación de página, BACKUP genera una suma de comprobación de copia de seguridad independiente para las secuencias de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="dda67-127">Regardless of whether page checksums are present, BACKUP generates a separate backup checksum for the backup streams.</span></span> <span data-ttu-id="dda67-128">Opcionalmente, las operaciones de restauración pueden utilizar la suma de comprobación de copia de seguridad para confirmar que la copia de seguridad no está dañada.</span><span class="sxs-lookup"><span data-stu-id="dda67-128">Restore operations can optionally use the backup checksum to validate that the backup is not corrupted.</span></span> <span data-ttu-id="dda67-129">La suma de comprobación de copia de seguridad se almacena en el medio de copia de seguridad y no en las páginas de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="dda67-129">The backup checksum is stored on the backup media, not on the database pages.</span></span> <span data-ttu-id="dda67-130">La suma de comprobación de copia de seguridad se puede utilizar opcionalmente en el momento de la restauración.</span><span class="sxs-lookup"><span data-stu-id="dda67-130">The backup checksum can optionally be used at restore time.</span></span>  
  
3.  <span data-ttu-id="dda67-131">El conjunto de copia de seguridad se marca para indicar que contiene sumas de comprobación de copia de seguridad (en la columna **has_backup_checksums** de **msdb..backupset)** .</span><span class="sxs-lookup"><span data-stu-id="dda67-131">The backup set is flagged as containing backup checksums (in the **has_backup_checksums** column of **msdb..backupset)**.</span></span> <span data-ttu-id="dda67-132">Para obtener más información, vea [backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dda67-132">For more information, see [backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql).</span></span>  
  
 <span data-ttu-id="dda67-133">Durante una operación de restauración, si hay sumas de comprobación de copia de seguridad en los medios de copia de seguridad, de forma predeterminada, las operaciones RESTORE y RESTORE VERIFYONLY comprueban las sumas de comprobación de copia de seguridad y las sumas de comprobación de página.</span><span class="sxs-lookup"><span data-stu-id="dda67-133">During a restore operation, if backup checksums are present on the backup media, by default, both the RESTORE and RESTORE VERIFYONLY statements verify the backup checksums and page checksums.</span></span> <span data-ttu-id="dda67-134">Si no hay ninguna suma de comprobación de copia de seguridad, cualquiera de las dos operaciones de restauración continúa sin realizar ninguna comprobación; esto se debe a que, sin una suma de comprobación de copia de seguridad, la restauración no puede comprobar de forma confiable las sumas de comprobación de página.</span><span class="sxs-lookup"><span data-stu-id="dda67-134">If there is no backup checksum, either restore operation proceeds without any verification; this is because without a backup checksum, restore cannot reliably verify page checksums.</span></span>  
  
## <a name="response-to-page-checksum-errors-during-a-backup-or-restore-operation"></a><span data-ttu-id="dda67-135">Respuesta a errores de suma de comprobación de página durante una operación de copia de seguridad o restauración</span><span class="sxs-lookup"><span data-stu-id="dda67-135">Response to Page Checksum Errors During a Backup or Restore Operation</span></span>  
 <span data-ttu-id="dda67-136">De forma predeterminada, después de encontrar un error de suma de comprobación de página, una operación BACKUP o RESTORE produce un error y una operación VERIFYONLY continúa.</span><span class="sxs-lookup"><span data-stu-id="dda67-136">By default, after encountering a page checksum error, a BACKUP or RESTORE operation fails and a RESTORE VERIFYONLY operation continues.</span></span> <span data-ttu-id="dda67-137">Sin embargo, se puede controlar si una operación dada se detiene al encontrar un error o continúa de la mejor manera posible.</span><span class="sxs-lookup"><span data-stu-id="dda67-137">However, you can control whether a given operation fails on encountering an error or continues as best it can.</span></span>  
  
 <span data-ttu-id="dda67-138">Si una operación BACKUP continúa después de encontrar errores, la operación realiza los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="dda67-138">If a BACKUP operation continues after encountering errors, the operation performs the following steps:</span></span>  
  
1.  <span data-ttu-id="dda67-139">Indica en el conjunto de copia de seguridad de los medios de copia de seguridad que hay errores y realiza el seguimiento de la página en la tabla **suspect_pages** de la base de datos **msdb** .</span><span class="sxs-lookup"><span data-stu-id="dda67-139">Flags the backup set on the backup media as containing errors and tracks the page in the **suspect_pages** table in the **msdb** database.</span></span> <span data-ttu-id="dda67-140">Para obtener más información, vea [suspect_pages &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/suspect-pages-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dda67-140">For more information, see [suspect_pages &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/suspect-pages-transact-sql).</span></span>  
  
2.  <span data-ttu-id="dda67-141">Registra el error en el registro de errores de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="dda67-141">Logs the error in the SQL Server error log.</span></span>  
  
3.  <span data-ttu-id="dda67-142">Marca el conjunto de copia de seguridad como conjunto que contiene este tipo de error (en la columna **is_damaged** de **msdb.backupset)** .</span><span class="sxs-lookup"><span data-stu-id="dda67-142">Marks the backup set as containing this type of error (in the **is_damaged** column of **msdb.backupset)**.</span></span> <span data-ttu-id="dda67-143">Para obtener más información, vea [backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="dda67-143">For more information, see [backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql).</span></span>  
  
4.  <span data-ttu-id="dda67-144">Emite un mensaje que indica que la copia de seguridad se generó correctamente, pero contiene errores de página.</span><span class="sxs-lookup"><span data-stu-id="dda67-144">Issues a message that the backup was successfully generated, but contains page errors.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="dda67-145">Tareas relacionadas</span><span class="sxs-lookup"><span data-stu-id="dda67-145">Related Tasks</span></span>  
 <span data-ttu-id="dda67-146">**Para habilitar o deshabilitar sumas de comprobación de copia de seguridad**</span><span class="sxs-lookup"><span data-stu-id="dda67-146">**To enable or disable backup checksums**</span></span>  
  
-   [<span data-ttu-id="dda67-147">Habilitar o deshabilitar sumas de comprobación de copia de seguridad durante copia de seguridad o restauración &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="dda67-147">Enable or Disable Backup Checksums During Backup or Restore &#40;SQL Server&#41;</span></span>](enable-or-disable-backup-checksums-during-backup-or-restore-sql-server.md)  
  
 <span data-ttu-id="dda67-148">**Para controlar la respuesta a un error durante una operación de copia de seguridad**</span><span class="sxs-lookup"><span data-stu-id="dda67-148">**To control the response to a error during a backup operation**</span></span>  
  
-   [<span data-ttu-id="dda67-149">Especificar si una operación de copia de seguridad o restauración continúa o se detiene después de encontrar un error &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="dda67-149">Specify Whether a Backup or Restore Operation Continues or Stops After Encountering an Error &#40;SQL Server&#41;</span></span>](specify-if-backup-or-restore-continues-or-stops-after-error.md)  
  
## <a name="see-also"></a><span data-ttu-id="dda67-150">Consulte también</span><span class="sxs-lookup"><span data-stu-id="dda67-150">See Also</span></span>  
 <span data-ttu-id="dda67-151">[ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="dda67-151">[ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql) </span></span>  
 <span data-ttu-id="dda67-152">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="dda67-152">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="dda67-153">[backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="dda67-153">[backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql) </span></span>  
 <span data-ttu-id="dda67-154">[Conjuntos de medios de copia de seguridad reflejados &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="dda67-154">[Mirrored Backup Media Sets &#40;SQL Server&#41;](mirrored-backup-media-sets-sql-server.md) </span></span>  
 <span data-ttu-id="dda67-155">[RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="dda67-155">[RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) </span></span>  
 [<span data-ttu-id="dda67-156">RESTORE VERIFYONLY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="dda67-156">RESTORE VERIFYONLY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/restore-statements-verifyonly-transact-sql)  
  
  
