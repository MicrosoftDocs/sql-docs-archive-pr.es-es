---
title: Copias de seguridad diferenciales (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- differential backups
- differential backups, about
ms.assetid: 123bb7af-1367-4bde-bfcb-76d36799b905
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5c057e0d41cb46adef0ec1e01c3406190db900e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87676518"
---
# <a name="differential-backups-sql-server"></a><span data-ttu-id="22324-102">Copias de seguridad diferenciales (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="22324-102">Differential Backups (SQL Server)</span></span>
  <span data-ttu-id="22324-103">Este tema de copias de seguridad y restauración es pertinente para todas las bases de datos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="22324-103">This backup and restore topic is relevant for all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases.</span></span>  
  
 <span data-ttu-id="22324-104">la copia de seguridad diferencial se basa en la copia de seguridad de datos completa anterior más reciente.</span><span class="sxs-lookup"><span data-stu-id="22324-104">A differential backup is based on the most recent, previous full data backup.</span></span> <span data-ttu-id="22324-105">Una copia de seguridad diferencial captura solo los datos que han cambiado después de la última copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="22324-105">A differential backup captures only the data that has changed since that full backup.</span></span> <span data-ttu-id="22324-106">La copia de seguridad completa en la que se basa una diferencial se denomina *base* de la diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-106">The full backup upon which a differential backup is based is known as the *base* of the differential.</span></span> <span data-ttu-id="22324-107">Las copias de seguridad completas, a excepción de las de solo copia, pueden servir como base para una serie de copias de seguridad diferenciales, incluidas las de base de datos, las parciales, y las de archivos.</span><span class="sxs-lookup"><span data-stu-id="22324-107">Full backups, except for copy-only backups, can serve as the base for a series of differential backups, including database backups, partial backups, and file backups.</span></span> <span data-ttu-id="22324-108">La copia de seguridad de base de una copia de seguridad diferencial de archivos puede estar contenida en una copia de seguridad completa, una copia de seguridad de archivos o una copia de seguridad parcial.</span><span class="sxs-lookup"><span data-stu-id="22324-108">The base backup for a file differential backup can be contained within a full backup, a file backup, or a partial backup.</span></span>  
  
  
##  <a name="benefits"></a><a name="Benefits"></a> <span data-ttu-id="22324-109">Ventajas</span><span class="sxs-lookup"><span data-stu-id="22324-109">Benefits</span></span>  
  
-   <span data-ttu-id="22324-110">La creación de copias de seguridad diferencial puede ser muy rápida en comparación con la creación una copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="22324-110">Creating a differential backups can be very fast compared to creating a full backup.</span></span> <span data-ttu-id="22324-111">Una copia de seguridad diferencial registra solo los datos que han cambiado desde la última copia de seguridad completa en la que se basa la diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-111">A differential backup records only the data that has changed since the full backup upon the differential backup is based.</span></span> <span data-ttu-id="22324-112">Esto facilita la realización de copias de seguridad frecuentes, lo que reduce el riesgo de pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="22324-112">This facilitates taking frequent data backups, which decrease the risk of data loss.</span></span> <span data-ttu-id="22324-113">No obstante, antes de restaurar una copia de seguridad diferencial, debe restaurar su base.</span><span class="sxs-lookup"><span data-stu-id="22324-113">However, before you restore a differential backup, you must restore its base.</span></span> <span data-ttu-id="22324-114">Por lo tanto, la restauración de una copia de seguridad diferencial necesitará más pasos y tiempo que la restauración de una copia de seguridad completa porque se requieren dos archivos de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="22324-114">Therefore restoring from a differential backup will necessarily take more steps and time than restoring from a full backup because two backup files are required.</span></span>  
  
-   <span data-ttu-id="22324-115">Las copias de seguridad diferenciales de bases de datos son particularmente útiles si un subconjunto de una base de datos se modifica con más frecuencia que el resto de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="22324-115">Differential database backups are especially useful if a subset of a database is modified more frequently than the rest of the database.</span></span> <span data-ttu-id="22324-116">En tales casos, las copias de seguridad diferenciales de bases de datos le permiten hacer una copia de seguridad con frecuencia sin la sobrecarga que generan las copias de seguridad completas de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="22324-116">In these cases, differential database backups enable you back up frequently without the overhead of full database backups.</span></span>  
  
-   <span data-ttu-id="22324-117">En el modelo de recuperación completa, las copias de seguridad diferenciales pueden reducir el número de copias de seguridad de registros que se deben restaurar.</span><span class="sxs-lookup"><span data-stu-id="22324-117">Under the full recovery model, using differential backups can reduce the number of log backups that you have to restore.</span></span>  
  
##  <a name="overview-of-differential-backups"></a><a name="Overview"></a> <span data-ttu-id="22324-118">Información general de las copias de seguridad diferenciales</span><span class="sxs-lookup"><span data-stu-id="22324-118">Overview of Differential Backups</span></span>  
 <span data-ttu-id="22324-119">Una copia de seguridad diferencial captura el estado de las *extensiones* (colecciones de ocho páginas físicamente contiguas) que hayan cambiado entre el momento de creación de la base diferencial y el momento de creación de la copia de seguridad diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-119">A differential backup captures the state of any *extents* (collections of eight physically contiguous pages) that have changed between when the differential base was created and the when differential backup is created.</span></span> <span data-ttu-id="22324-120">Esto significa que el tamaño de una determinada copia de seguridad diferencial depende de la cantidad de datos que han cambiado desde la base.</span><span class="sxs-lookup"><span data-stu-id="22324-120">This means that the size of a given differential backup depends on the amount of data that has changed since the base.</span></span> <span data-ttu-id="22324-121">Como regla general, cuanto más antigua sea una base, mayor será una nueva copia de seguridad diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-121">Generally, the older a base is, the larger a new differential backup will be.</span></span> <span data-ttu-id="22324-122">En una serie de copias de seguridad diferenciales, es probable que una extensión actualizada con frecuencia contenga datos diferentes en cada una de las copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="22324-122">In a series of differential backups, a frequently updated extent is likely to contain different data in each differential backup.</span></span>  
  
 <span data-ttu-id="22324-123">En la siguiente ilustración se muestra cómo funciona una copia de seguridad diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-123">The following illustration shows how a differential backup works.</span></span> <span data-ttu-id="22324-124">La ilustración muestra 24 extensiones de datos, 6 de las cuales han cambiado.</span><span class="sxs-lookup"><span data-stu-id="22324-124">The figure shows 24 data extents, 6 of which have changed.</span></span> <span data-ttu-id="22324-125">La copia de seguridad diferencial solo contiene estas 6 extensiones de datos.</span><span class="sxs-lookup"><span data-stu-id="22324-125">The differential backup contains only these 6 data extents.</span></span> <span data-ttu-id="22324-126">La operación de copia de seguridad diferencial se basa en una página de mapa de bits que contiene un bit por cada extensión.</span><span class="sxs-lookup"><span data-stu-id="22324-126">The differential backup operation relies on a bitmap page that contains a bit for every extent.</span></span> <span data-ttu-id="22324-127">Por cada extensión actualizada desde que se creó la base, el bit se establece en 1 en el mapa de bits.</span><span class="sxs-lookup"><span data-stu-id="22324-127">For each extent updated since the base, the bit is set to 1 in the bitmap.</span></span>  
  
 <span data-ttu-id="22324-128">![Mapa de bits diferencial que identifica las extensiones modificadas](../../database-engine/media/bnr-how-diff-backups-work.gif "Mapa de bits diferencial que identifica las extensiones modificadas")</span><span class="sxs-lookup"><span data-stu-id="22324-128">![Differential bitmap identifies changed extents](../../database-engine/media/bnr-how-diff-backups-work.gif "Differential bitmap identifies changed extents")</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="22324-129">El mapa de bits de la copia de seguridad diferencial no se actualiza con las copias de seguridad de solo copia.</span><span class="sxs-lookup"><span data-stu-id="22324-129">The differential bitmap is not updated by a copy-only backup.</span></span> <span data-ttu-id="22324-130">Por tanto, una copia de seguridad de solo copia no afecta a las copias de seguridad diferenciales subsiguientes.</span><span class="sxs-lookup"><span data-stu-id="22324-130">Therefore, a copy-only backup does not affect subsequent differential backups.</span></span>  
  
 <span data-ttu-id="22324-131">Una copia de seguridad diferencial que se realiza poco después de su base tiende a ser sustancialmente más pequeña que la base diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-131">A differential backup that is taken fairly soon after its base is usually significantly smaller than the differential base.</span></span> <span data-ttu-id="22324-132">Así, se gana espacio de copia de seguridad y tiempo.</span><span class="sxs-lookup"><span data-stu-id="22324-132">This saves storage space and backup time.</span></span> <span data-ttu-id="22324-133">Sin embargo, a medida que la base de datos cambia, la diferencia entre la base de datos y una base diferencial concreta aumenta.</span><span class="sxs-lookup"><span data-stu-id="22324-133">However, as a database changes over time, the difference between the database and a specific differential base increases.</span></span> <span data-ttu-id="22324-134">Cuanto más tiempo pasa entre una copia de seguridad diferencial y su base, más probabilidades hay de que la copia de seguridad diferencial sea más grande.</span><span class="sxs-lookup"><span data-stu-id="22324-134">The longer the time between a differential backup and its base, the larger the differential backup is likely to be.</span></span> <span data-ttu-id="22324-135">Esto significa que las copias de seguridad diferenciales pueden, a la larga, asemejarse en tamaño a la base diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-135">This means that the differential backups can eventually approach the differential base in size.</span></span> <span data-ttu-id="22324-136">La copia de seguridad diferencial grande pierde las ventajas de una copia de seguridad más rápida y de menor tamaño.</span><span class="sxs-lookup"><span data-stu-id="22324-136">A large differential backup loses the advantages of a faster and smaller backup.</span></span>  
  
 <span data-ttu-id="22324-137">A medida que se incrementa el tamaño de las copias de seguridad diferenciales, la restauración de una copia de seguridad diferencial puede incrementar sensiblemente el tiempo necesario para restaurar una base de datos.</span><span class="sxs-lookup"><span data-stu-id="22324-137">As the differential backups increase in size, restoring a differential backup can significantly increase the time that is required to restore a database.</span></span> <span data-ttu-id="22324-138">Por ello, recomendamos que realice una copia de seguridad completa a intervalos definidos para establecer una nueva base diferencial para los datos.</span><span class="sxs-lookup"><span data-stu-id="22324-138">Therefore, we recommend that you take a new full backup at set intervals to establish a new differential base for the data.</span></span> <span data-ttu-id="22324-139">Por ejemplo, cada semana podría realizar una copia de seguridad completa de toda la base de datos (es decir, una copia de seguridad completa de la base de datos) seguida de una serie de copias de seguridad diferenciales de la base de datos realizadas periódicamente durante la semana.</span><span class="sxs-lookup"><span data-stu-id="22324-139">For example, you might take a weekly full backup of the whole database (that is, a full database backup) followed by a regular series of differential database backups during the week.</span></span>  
  
 <span data-ttu-id="22324-140">En el momento de la restauración, antes de restaurar una copia de seguridad diferencial, debe restaurar su base.</span><span class="sxs-lookup"><span data-stu-id="22324-140">At restore time, before you restore a differential backup, you must restore its base.</span></span> <span data-ttu-id="22324-141">A continuación, solo necesita restaurar la copia diferencial más reciente para poner al día la base de datos hasta el momento en que se creó la copia de seguridad diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-141">Then, restore only the most recent differential backup to bring the database forward to the time when that differential backup was created.</span></span> <span data-ttu-id="22324-142">Por lo general, restaurará la copia de seguridad completa más reciente seguida de la copia de seguridad diferencial más reciente que está basada en la copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="22324-142">Typically, you would restore the most recent full backup followed by the most recent differential backup that is based on that full backup.</span></span>  
  
## <a name="differential-backups-of-databases-with-memory-optimized-tables"></a><span data-ttu-id="22324-143">Copias de seguridad diferenciales de bases de datos con tablas con optimización para memoria</span><span class="sxs-lookup"><span data-stu-id="22324-143">Differential Backups of Databases with Memory-Optimized Tables</span></span>  
 <span data-ttu-id="22324-144">Para obtener información sobre las copias de seguridad diferenciales y las bases de datos optimizadas para memoria, vea [Hacer copia de seguridad de una base de datos con tablas optimizadas para memoria](../in-memory-oltp/memory-optimized-tables.md).</span><span class="sxs-lookup"><span data-stu-id="22324-144">For information about differential backups and databases with memory-optimized tables, see [Backing Up a Database with Memory-Optimized Tables](../in-memory-oltp/memory-optimized-tables.md).</span></span>  
  
##  <a name="differential-backups-of-read-only-databases"></a><a name="ReadOnlyDbs"></a> <span data-ttu-id="22324-145">Copias de seguridad diferencias de bases de datos de solo lectura</span><span class="sxs-lookup"><span data-stu-id="22324-145">Differential Backups of Read-Only Databases</span></span>  
 <span data-ttu-id="22324-146">En el caso de bases de datos de solo lectura, resulta más fácil gestionar las copias de seguridad completas por sí solas que cuando se utilizan junto copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="22324-146">For read-only databases, full backups used alone are easier to manage than when they are used with differential backups.</span></span> <span data-ttu-id="22324-147">Cuando una base de datos es de solo lectura, las operaciones de copia de seguridad y de otro tipo no tienen capacidad para modificar los metadatos del archivo.</span><span class="sxs-lookup"><span data-stu-id="22324-147">When a database is read-only, backup and other operations cannot change the metadata that is contained in the file.</span></span> <span data-ttu-id="22324-148">Por lo tanto, los metadatos que precisan las copias de seguridad diferenciales, como el número de secuencia de registro en el que comienza la copia de seguridad diferencial (el número LSN base diferencial), se almacenan en la base de datos **maestra** .</span><span class="sxs-lookup"><span data-stu-id="22324-148">Therefore, metadata that is required by a differential backup, such as the log sequence number at which the differential backup begins (the differential base LSN) is stored in the **master** database.</span></span> <span data-ttu-id="22324-149">Si la base diferencial se establece cuando la base de datos es de solo lectura, el mapa de bits diferencial indicará más cambios de los que en realidad han ocurrido desde que se realizó la copia de seguridad de base.</span><span class="sxs-lookup"><span data-stu-id="22324-149">If the differential base is taken when the database is read-only, the differential bitmap indicates more changes than have actually occurred since the base backup.</span></span> <span data-ttu-id="22324-150">La copia de seguridad lee los datos adicionales, pero estos no se escriben en la misma, dado que el **differential_base_lsn** almacenado en la tabla del sistema [backupset](/sql/relational-databases/system-tables/backupset-transact-sql) se usa para determinar si los datos realmente han cambiado desde que se creó la base.</span><span class="sxs-lookup"><span data-stu-id="22324-150">The extra data is read by backup, but is not written to the backup, because the **differential_base_lsn** stored in the [backupset](/sql/relational-databases/system-tables/backupset-transact-sql) system table is used to determine whether the data has actually changed since the base.</span></span>  
  
 <span data-ttu-id="22324-151">Cuando se vuelve a generar, restaurar o separar y adjuntar una base de datos de solo lectura, se pierde la información de base diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-151">When a read-only database is rebuilt, restored, or detached and attached, the differential-base information is lost.</span></span> <span data-ttu-id="22324-152">Esto ocurre porque la base de datos **maestra** no está sincronizada con la base de datos de usuario.</span><span class="sxs-lookup"><span data-stu-id="22324-152">This occurs because the **master** database is not synchronized with the user database.</span></span> <span data-ttu-id="22324-153">[!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] no puede detectar ni evitar este problema.</span><span class="sxs-lookup"><span data-stu-id="22324-153">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] cannot detect or prevent this problem.</span></span> <span data-ttu-id="22324-154">Las copias de seguridad diferenciales que se realicen con posterioridad no se basan en la copia de seguridad completa más reciente, por lo que pueden proporcionar resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="22324-154">Any later differential backups are not based on the most recent full backup and could provide unexpected results.</span></span> <span data-ttu-id="22324-155">Para establecer una nueva base diferencial se recomienda crear una copia de seguridad completa de base de datos.</span><span class="sxs-lookup"><span data-stu-id="22324-155">To establish a new differential base, we recommend that you create a full database backup.</span></span>  
  
### <a name="best-practices-for-using-differential-backups-with-a-read-only-database"></a><span data-ttu-id="22324-156">Prácticas recomendadas para utilizar copias de seguridad diferenciales con una base de datos de solo lectura</span><span class="sxs-lookup"><span data-stu-id="22324-156">Best Practices for Using Differential Backups with a Read-Only Database</span></span>  
 <span data-ttu-id="22324-157">Después de crear una copia de seguridad completa de una base de datos de solo lectura, deberá crear una copia de seguridad de la base de datos **maestra** si luego pretende crear una copia de seguridad diferencial.</span><span class="sxs-lookup"><span data-stu-id="22324-157">After you create a full database backup of a read-only database, if you intend to create a subsequent differential backup, back up the **master** database.</span></span>  
  
 <span data-ttu-id="22324-158">Si se pierde la base de datos **maestra** , restáurela antes de restaurar las copias de seguridad diferenciales de una base de datos de usuario.</span><span class="sxs-lookup"><span data-stu-id="22324-158">If the **master** database is lost, restore it before you restore any differential backup of a user database.</span></span>  
  
 <span data-ttu-id="22324-159">Si separa y adjunta una base de datos de solo lectura de la que tiene previsto realizar copias de seguridad diferenciales con posterioridad, realice tan pronto como sea posible una copia de seguridad completa de su base de datos de solo lectura y de la base de datos **maestra** .</span><span class="sxs-lookup"><span data-stu-id="22324-159">If you detach and attach a read-only database for which you plan to later use differential backups, as soon as it is practical, take a full database backup of both the read-only database and of the **master** database.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="22324-160">Tareas relacionadas</span><span class="sxs-lookup"><span data-stu-id="22324-160">Related Tasks</span></span>  
  
-   [<span data-ttu-id="22324-161">Crear una copia de seguridad diferencial de una base de datos &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="22324-161">Create a Differential Database Backup &#40;SQL Server&#41;</span></span>](create-a-differential-database-backup-sql-server.md)  
  
-   [<span data-ttu-id="22324-162">Restaurar una copia de seguridad diferencial de la base de datos &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="22324-162">Restore a Differential Database Backup &#40;SQL Server&#41;</span></span>](restore-a-differential-database-backup-sql-server.md)  
  
  
## <a name="see-also"></a><span data-ttu-id="22324-163">Consulte también</span><span class="sxs-lookup"><span data-stu-id="22324-163">See Also</span></span>  
 <span data-ttu-id="22324-164">[Información general de copia de seguridad &#40;SQL Server&#41;](backup-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="22324-164">[Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md) </span></span>  
 <span data-ttu-id="22324-165">[Copias de seguridad completas de bases de datos &#40;SQL Server&#41;](full-database-backups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="22324-165">[Full Database Backups &#40;SQL Server&#41;](full-database-backups-sql-server.md) </span></span>  
 <span data-ttu-id="22324-166">[Restauraciones de base de datos completas &#40;modelo de recuperación completa&#41;](complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="22324-166">[Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="22324-167">[Restauraciones de base de datos completas &#40;modelo de recuperación simple&#41;](complete-database-restores-simple-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="22324-167">[Complete Database Restores &#40;Simple Recovery Model&#41;](complete-database-restores-simple-recovery-model.md) </span></span>  
 [<span data-ttu-id="22324-168">Copias de seguridad de registros de transacciones &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="22324-168">Transaction Log Backups &#40;SQL Server&#41;</span></span>](transaction-log-backups-sql-server.md)  
  
  
