---
title: Jerarquía de cifrado | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- encryption [SQL Server], hierarchies
- cryptography [SQL Server], hierarchies
- encryption keys [SQL Server]
- security [SQL Server], encryption
- hierarchies [SQL Server], encryption
ms.assetid: 96c276d5-1bba-4e95-b678-10f059f1fbcf
author: jaszymas
ms.author: jaszymas
ms.openlocfilehash: d38bb83c2f6a2487e547c4686be5c65bc012e33e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750590"
---
# <a name="encryption-hierarchy"></a><span data-ttu-id="0dafd-102">Jerarquía de cifrado</span><span class="sxs-lookup"><span data-stu-id="0dafd-102">Encryption Hierarchy</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0dafd-103">cifra los datos con una infraestructura de cifrado jerárquico y administración de claves.</span><span class="sxs-lookup"><span data-stu-id="0dafd-103">encrypts data with a hierarchical encryption and key management infrastructure.</span></span> <span data-ttu-id="0dafd-104">Cada capa cifra la capa inferior utilizando una combinación de certificados, claves asimétricas y claves simétricas.</span><span class="sxs-lookup"><span data-stu-id="0dafd-104">Each layer encrypts the layer below it by using a combination of certificates, asymmetric keys, and symmetric keys.</span></span> <span data-ttu-id="0dafd-105">Las claves asimétricas y las claves simétricas pueden estar almacenadas fuera de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] en un módulo de Administración extensible de claves (EKM).</span><span class="sxs-lookup"><span data-stu-id="0dafd-105">Asymmetric keys and symmetric keys can be stored outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in an Extensible Key Management (EKM) module.</span></span>  
  
 <span data-ttu-id="0dafd-106">La siguiente ilustración muestra que cada nivel de la jerarquía de cifrado cifra el nivel que tiene por debajo y muestra las configuraciones de cifrado más comunes.</span><span class="sxs-lookup"><span data-stu-id="0dafd-106">The following illustration shows that each layer of the encryption hierarchy encrypts the layer beneath it, and displays the most common encryption configurations.</span></span> <span data-ttu-id="0dafd-107">El acceso al principio de la jerarquía se suele proteger mediante una contraseña.</span><span class="sxs-lookup"><span data-stu-id="0dafd-107">The access to the start of the hierarchy is usually protected by a password.</span></span>  
  
 <span data-ttu-id="0dafd-108">![Muestra algunas combinaciones de cifrado en una pila.](../../../database-engine/media/encryption-hierarchy-stack.gif "Muestra algunas combinaciones de cifrado en una pila.")</span><span class="sxs-lookup"><span data-stu-id="0dafd-108">![Displays some encryption combinations in a stack.](../../../database-engine/media/encryption-hierarchy-stack.gif "Displays some encryption combinations in a stack.")</span></span>  
  
 <span data-ttu-id="0dafd-109">Tenga presente los conceptos siguientes:</span><span class="sxs-lookup"><span data-stu-id="0dafd-109">Keep in mind the following concepts:</span></span>  
  
-   <span data-ttu-id="0dafd-110">Para obtener el máximo rendimiento, cifre los datos utilizando claves simétricas en lugar de certificados o claves asimétricas.</span><span class="sxs-lookup"><span data-stu-id="0dafd-110">For best performance, encrypt data using symmetric keys instead of certificates or asymmetric keys.</span></span>  
  
-   <span data-ttu-id="0dafd-111">Las claves maestras de base de datos se protegen mediante la clave maestra de servicio.</span><span class="sxs-lookup"><span data-stu-id="0dafd-111">Database master keys are protected by the Service Master Key.</span></span> <span data-ttu-id="0dafd-112">El programa de instalación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] crea la clave maestra de servicio, que se cifra con la API de protección de datos de Windows (DPAPI).</span><span class="sxs-lookup"><span data-stu-id="0dafd-112">The Service Master Key is created by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup and is encrypted with the Windows Data Protection API (DPAPI).</span></span>  
  
-   <span data-ttu-id="0dafd-113">Hay otras jerarquías de cifrado que apilan niveles adicionales.</span><span class="sxs-lookup"><span data-stu-id="0dafd-113">Other encryption hierarchies stacking additional layers are possible.</span></span>  
  
-   <span data-ttu-id="0dafd-114">El módulo de Administración extensible de claves (EKM) mantiene las claves simétricas o asimétricas fuera de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0dafd-114">An Extensible Key Management (EKM) module holds symmetric or asymmetric keys outside of SQL Server.</span></span>  
  
-   <span data-ttu-id="0dafd-115">El Cifrado de datos transparente (TDE) debe utilizar una clave simétrica denominada clave de cifrado de base de datos que se protege bien mediante un certificado protegido por la clave maestra de base de datos de la base de datos maestra o bien mediante una clave asimétrica almacenada en una EKM.</span><span class="sxs-lookup"><span data-stu-id="0dafd-115">Transparent Data Encryption (TDE) must use a symmetric key called the database encryption key which is protected by either a certificate protected by the database master key of the master database, or by an asymmetric key stored in an EKM.</span></span>  
  
-   <span data-ttu-id="0dafd-116">La clave maestra de servicio y todas las claves maestras de base de datos son claves simétricas.</span><span class="sxs-lookup"><span data-stu-id="0dafd-116">The Service Master Key and all Database Master Keys are symmetric keys.</span></span>  
  
 <span data-ttu-id="0dafd-117">La ilustración siguiente muestra la misma información de una manera alternativa.</span><span class="sxs-lookup"><span data-stu-id="0dafd-117">The following illustration shows the same information in an alternative manner.</span></span>  
  
 <span data-ttu-id="0dafd-118">![Muestra algunas combinaciones de cifrado en una rueda.](../../../database-engine/media/encryption-hierarchy-wheel.gif "Muestra algunas combinaciones de cifrado en una rueda.")</span><span class="sxs-lookup"><span data-stu-id="0dafd-118">![Displays some encryption combinations in a wheel.](../../../database-engine/media/encryption-hierarchy-wheel.gif "Displays some encryption combinations in a wheel.")</span></span>  
  
 <span data-ttu-id="0dafd-119">Este diagrama muestra los conceptos adicionales siguientes:</span><span class="sxs-lookup"><span data-stu-id="0dafd-119">This diagram illustrates the following additional concepts:</span></span>  
  
-   <span data-ttu-id="0dafd-120">En esta ilustración, las flechas indican las jerarquías de cifrado comunes.</span><span class="sxs-lookup"><span data-stu-id="0dafd-120">In this illustration, arrows indicate common encryption hierarchies.</span></span>  
  
-   <span data-ttu-id="0dafd-121">Las claves simétricas y asimétricas de EKM pueden proteger el acceso a las claves simétricas y asimétricas almacenadas en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0dafd-121">Symmetric and asymmetric keys in the EKM can protect access to the symmetric and asymmetric keys stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="0dafd-122">La línea de puntos asociada a la EKM indica que las claves de la EKM podrían reemplazar a las claves simétricas y asimétricas que se almacenan en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0dafd-122">The dotted line associated with EKM indicates that keys in the EKM could replace the symmetric and asymmetric keys stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="encryption-mechanisms"></a><span data-ttu-id="0dafd-123">Mecanismos de cifrado</span><span class="sxs-lookup"><span data-stu-id="0dafd-123">Encryption Mechanisms</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0dafd-124">ofrece los mecanismos siguientes para el cifrado:</span><span class="sxs-lookup"><span data-stu-id="0dafd-124">provides the following mechanisms for encryption:</span></span>  
  
-   [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="0dafd-125">funciones</span><span class="sxs-lookup"><span data-stu-id="0dafd-125">functions</span></span>  
  
-   <span data-ttu-id="0dafd-126">Claves asimétricas</span><span class="sxs-lookup"><span data-stu-id="0dafd-126">Asymmetric keys</span></span>  
  
-   <span data-ttu-id="0dafd-127">Claves simétricas</span><span class="sxs-lookup"><span data-stu-id="0dafd-127">Symmetric keys</span></span>  
  
-   <span data-ttu-id="0dafd-128">Certificados</span><span class="sxs-lookup"><span data-stu-id="0dafd-128">Certificates</span></span>  
  
-   <span data-ttu-id="0dafd-129">Cifrado de datos transparente</span><span class="sxs-lookup"><span data-stu-id="0dafd-129">Transparent Data Encryption</span></span>  
  
### <a name="transact-sql-functions"></a><span data-ttu-id="0dafd-130">Funciones de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="0dafd-130">Transact-SQL Functions</span></span>  
 <span data-ttu-id="0dafd-131">Los elementos individuales se pueden cifrar a medida que se insertan o actualizan utilizando las funciones de [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0dafd-131">Individual items can be encrypted as they are inserted or updated using [!INCLUDE[tsql](../../../includes/tsql-md.md)] functions.</span></span> <span data-ttu-id="0dafd-132">Para obtener más información, vea [ENCRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/encryptbypassphrase-transact-sql) y [DECRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/decryptbypassphrase-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0dafd-132">For more information, see [ENCRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/encryptbypassphrase-transact-sql) and [DECRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/decryptbypassphrase-transact-sql).</span></span>  
  
### <a name="certificates"></a><span data-ttu-id="0dafd-133">Certificados</span><span class="sxs-lookup"><span data-stu-id="0dafd-133">Certificates</span></span>  
 <span data-ttu-id="0dafd-134">Un certificado de clave pública, normalmente denominado solo certificado, es una instrucción firmada digitalmente que enlaza el valor de una clave pública con la identidad de la persona, dispositivo o servicio que tiene la clave privada correspondiente.</span><span class="sxs-lookup"><span data-stu-id="0dafd-134">A public key certificate, usually just called a certificate, is a digitally-signed statement that binds the value of a public key to the identity of the person, device, or service that holds the corresponding private key.</span></span> <span data-ttu-id="0dafd-135">Las entidades certificadoras son las encargadas de emitir y firmar los certificados.</span><span class="sxs-lookup"><span data-stu-id="0dafd-135">Certificates are issued and signed by a certification authority (CA).</span></span> <span data-ttu-id="0dafd-136">La entidad que recibe un certificado de una CA es el sujeto de ese certificado.</span><span class="sxs-lookup"><span data-stu-id="0dafd-136">The entity that receives a certificate from a CA is the subject of that certificate.</span></span> <span data-ttu-id="0dafd-137">Por lo general, los certificados contienen la siguiente información.</span><span class="sxs-lookup"><span data-stu-id="0dafd-137">Typically, certificates contain the following information.</span></span>  
  
-   <span data-ttu-id="0dafd-138">La clave pública del sujeto.</span><span class="sxs-lookup"><span data-stu-id="0dafd-138">The public key of the subject.</span></span>  
  
-   <span data-ttu-id="0dafd-139">La información que identifica al sujeto, como el nombre y la dirección de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="0dafd-139">The identifier information of the subject, such as the name and e-mail address.</span></span>  
  
-   <span data-ttu-id="0dafd-140">El periodo de validez.</span><span class="sxs-lookup"><span data-stu-id="0dafd-140">The validity period.</span></span> <span data-ttu-id="0dafd-141">Es decir, el periodo de tiempo durante el que el certificado se considera válido.</span><span class="sxs-lookup"><span data-stu-id="0dafd-141">This is the length of time that the certificate is considered valid.</span></span>  
  
     <span data-ttu-id="0dafd-142">Un certificado solo es válido durante el periodo de tiempo que se especifica en el mismo; todos los certificados contienen una fecha **Válido desde** y otra **Válido hasta** .</span><span class="sxs-lookup"><span data-stu-id="0dafd-142">A certificate is valid only for the period of time specified within it; every certificate contains **Valid From** and **Valid To** dates.</span></span> <span data-ttu-id="0dafd-143">Estas fechas establecen los límites del periodo de validez.</span><span class="sxs-lookup"><span data-stu-id="0dafd-143">These dates set the boundaries of the validity period.</span></span> <span data-ttu-id="0dafd-144">Cuando el periodo de validez de un certificado ha transcurrido, es necesario que el sujeto del certificado expirado solicite uno nuevo.</span><span class="sxs-lookup"><span data-stu-id="0dafd-144">When the validity period for a certificate has passed, a new certificate must be requested by the subject of the now-expired certificate.</span></span>  
  
-   <span data-ttu-id="0dafd-145">Información de identificador del emisor.</span><span class="sxs-lookup"><span data-stu-id="0dafd-145">Issuer identifier information.</span></span>  
  
-   <span data-ttu-id="0dafd-146">La firma digital del emisor.</span><span class="sxs-lookup"><span data-stu-id="0dafd-146">The digital signature of the issuer.</span></span>  
  
     <span data-ttu-id="0dafd-147">Esta firma da fe de la validez de las obligaciones entre la clave pública y la información de identificador del sujeto.</span><span class="sxs-lookup"><span data-stu-id="0dafd-147">This signature attests to the validity of the binding between the public key and the identifier information of the subject.</span></span> <span data-ttu-id="0dafd-148">(El proceso de firmar digitalmente la información conlleva transformar la información, así como cierta información privada que conserva el remitente, en una etiqueta denominada firma.)</span><span class="sxs-lookup"><span data-stu-id="0dafd-148">(The process of digitally signing information entails transforming the information, as well as some secret information held by the sender, into a tag called a signature.)</span></span>  
  
 <span data-ttu-id="0dafd-149">Una de las principales ventajas de los certificados es que liberan a los hosts de la necesidad de establecer contraseñas para sujetos individuales.</span><span class="sxs-lookup"><span data-stu-id="0dafd-149">A primary benefit of certificates is that they relieve hosts of the need to maintain a set of passwords for individual subjects.</span></span> <span data-ttu-id="0dafd-150">En su lugar, el host simplemente establece la confianza en un emisor de certificados, que a continuación puede firmar un número ilimitado de certificados.</span><span class="sxs-lookup"><span data-stu-id="0dafd-150">Instead, the host merely establishes trust in a certificate issuer, which may then sign an unlimited number of certificates.</span></span>  
  
 <span data-ttu-id="0dafd-151">Cuando un host, por ejemplo, un servidor web seguro, designa a un emisor como entidad emisora raíz de confianza, el host implícitamente confía en las directivas que el emisor ha utilizado para establecer las obligaciones de los certificados que emite.</span><span class="sxs-lookup"><span data-stu-id="0dafd-151">When a host, such as a secure Web server, designates an issuer as a trusted root authority, the host implicitly trusts the policies that the issuer has used to establish the bindings of certificates it issues.</span></span> <span data-ttu-id="0dafd-152">En efecto, el host confía en que el emisor ha comprobado la identidad del sujeto del certificado.</span><span class="sxs-lookup"><span data-stu-id="0dafd-152">In effect, the host trusts that the issuer has verified the identity of the certificate subject.</span></span> <span data-ttu-id="0dafd-153">Un host designa a un emisor como entidad emisora raíz de confianza presentando el certificado autofirmado del emisor, que contiene la clave pública de éste, en el almacén de certificados de la entidad de certificación raíz de confianza del equipo host.</span><span class="sxs-lookup"><span data-stu-id="0dafd-153">A host designates an issuer as a trusted root authority by putting the self-signed certificate of the issuer, which contains the public key of the issuer, into the trusted root certification authority certificate store of the host computer.</span></span> <span data-ttu-id="0dafd-154">Las entidades de certificación intermedias o subordinadas solo son de confianza si tienen una ruta válida de certificación procedente de una entidad de certificación raíz.</span><span class="sxs-lookup"><span data-stu-id="0dafd-154">Intermediate or subordinate certification authorities are trusted only if they have a valid certification path from a trusted root certification authority.</span></span>  
  
 <span data-ttu-id="0dafd-155">El emisor puede revocar un certificado antes de que expire.</span><span class="sxs-lookup"><span data-stu-id="0dafd-155">The issuer can revoke a certificate before it expires.</span></span> <span data-ttu-id="0dafd-156">La revocación cancela las obligaciones que una clave pública tiene con una identidad que se exprese en el certificado.</span><span class="sxs-lookup"><span data-stu-id="0dafd-156">Revocation cancels the binding of a public key to an identity that is asserted in the certificate.</span></span> <span data-ttu-id="0dafd-157">Cada emisor mantiene una lista de revocación de certificados que los programas pueden utilizar cuando estén comprobando la validez de un certificado determinado.</span><span class="sxs-lookup"><span data-stu-id="0dafd-157">Each issuer maintains a certificate revocation list that can be used by programs when they are checking the validity of any given certificate.</span></span>  
  
 <span data-ttu-id="0dafd-158">Los certificados autofirmados que se crean con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cumplen el estándar X.509 y son compatibles con los campos de X.509 v1.</span><span class="sxs-lookup"><span data-stu-id="0dafd-158">The self-signed certificates created by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] follow the X.509 standard and support the X.509 v1 fields.</span></span>  
  
### <a name="asymmetric-keys"></a><span data-ttu-id="0dafd-159">Claves asimétricas</span><span class="sxs-lookup"><span data-stu-id="0dafd-159">Asymmetric Keys</span></span>  
 <span data-ttu-id="0dafd-160">Una clave asimétrica se compone de una clave privada y su correspondiente clave pública.</span><span class="sxs-lookup"><span data-stu-id="0dafd-160">An asymmetric key is made up of a private key and the corresponding public key.</span></span> <span data-ttu-id="0dafd-161">Cada clave puede descifrar los datos que cifra la otra.</span><span class="sxs-lookup"><span data-stu-id="0dafd-161">Each key can decrypt data encrypted by the other.</span></span> <span data-ttu-id="0dafd-162">El cifrado y descifrado asimétricos consumen una cantidad de recursos relativamente elevada, pero proporcionan un nivel de seguridad superior al del cifrado simétrico.</span><span class="sxs-lookup"><span data-stu-id="0dafd-162">Asymmetric encryption and decryption are relatively resource-intensive, but they provide a higher level of security than symmetric encryption.</span></span> <span data-ttu-id="0dafd-163">Una clave asimétrica se puede utilizar para cifrar una clave simétrica para almacenar en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dafd-163">An asymmetric key can be used to encrypt a symmetric key for storage in a database.</span></span>  
  
### <a name="symmetric-keys"></a><span data-ttu-id="0dafd-164">Claves simétricas</span><span class="sxs-lookup"><span data-stu-id="0dafd-164">Symmetric Keys</span></span>  
 <span data-ttu-id="0dafd-165">Una clave simétrica es una clave que se utiliza para el cifrado y el descifrado.</span><span class="sxs-lookup"><span data-stu-id="0dafd-165">A symmetric key is one key that is used for both encryption and decryption.</span></span> <span data-ttu-id="0dafd-166">El cifrado y el descifrado con una clave simétrica son más rápidos y adecuados para usarlos de forma rutinaria con datos confidenciales de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dafd-166">Encryption and decryption by using a symmetric key is fast, and suitable for routine use with sensitive data in the database.</span></span>  
  
### <a name="transparent-data-encryption"></a><span data-ttu-id="0dafd-167">Cifrado de datos transparente</span><span class="sxs-lookup"><span data-stu-id="0dafd-167">Transparent Data Encryption</span></span>  
 <span data-ttu-id="0dafd-168">El Cifrado de datos transparente (TDE) es un caso especial de cifrado que usa una clave simétrica.</span><span class="sxs-lookup"><span data-stu-id="0dafd-168">Transparent Data Encryption (TDE) is a special case of encryption using a symmetric key.</span></span> <span data-ttu-id="0dafd-169">TDE cifra una base de datos completa utilizando la clave simétrica denominada clave de cifrado de base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dafd-169">TDE encrypts an entire database using that symmetric key called the database encryption key.</span></span> <span data-ttu-id="0dafd-170">Otras claves o certificados que se protegen bien mediante la clave maestra de base de datos o bien mediante una clave asimétrica almacenadas en un módulo EKM protegen la clave de cifrado de base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dafd-170">The database encryption key is protected by other keys or certificates which are protected either by the database master key or by an asymmetric key stored in an EKM module.</span></span> <span data-ttu-id="0dafd-171">Para obtener más información, vea [Cifrado de datos transparente &#40;TDE&#41;](transparent-data-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="0dafd-171">For more information, see [Transparent Data Encryption &#40;TDE&#41;](transparent-data-encryption.md).</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="0dafd-172">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="0dafd-172">Related Content</span></span>  
 [<span data-ttu-id="0dafd-173">Proteger SQL Server</span><span class="sxs-lookup"><span data-stu-id="0dafd-173">Securing SQL Server</span></span>](../securing-sql-server.md)  
  
 [<span data-ttu-id="0dafd-174">Funciones de seguridad &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="0dafd-174">Security Functions &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/security-functions-transact-sql)  
  
## <a name="see-also"></a><span data-ttu-id="0dafd-175">Consulte también</span><span class="sxs-lookup"><span data-stu-id="0dafd-175">See Also</span></span>  
 <span data-ttu-id="0dafd-176">[Jerarquía de permisos &#40;motor de base de datos&#41;](../permissions-hierarchy-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="0dafd-176">[Permissions Hierarchy &#40;Database Engine&#41;](../permissions-hierarchy-database-engine.md) </span></span>  
 [<span data-ttu-id="0dafd-177">Elementos protegibles</span><span class="sxs-lookup"><span data-stu-id="0dafd-177">Securables</span></span>](../securables.md)  
  
  
