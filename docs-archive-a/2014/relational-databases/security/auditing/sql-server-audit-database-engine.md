---
title: SQL Server Audit (motor de base de datos) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
f1_keywords:
- audit
helpviewer_keywords:
- SQL Server Audit
- audits [SQL Server], SQL Server Audit
ms.assetid: 0c1fca2e-f22b-4fe8-806f-c87806664f00
author: VanMSFT
ms.author: vanto
ms.openlocfilehash: 2f4f291e5dc4aaa8a240757713cc65bd2a6a8230
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669567"
---
# <a name="sql-server-audit-database-engine"></a><span data-ttu-id="cd983-102">SQL Server Audit (motor de base de datos)</span><span class="sxs-lookup"><span data-stu-id="cd983-102">SQL Server Audit (Database Engine)</span></span>
  <span data-ttu-id="cd983-103">La*auditoría* de una instancia de [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] o de una base de datos individual implica el seguimiento y registro de los eventos que se producen en [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cd983-103">*Auditing* an instance of the [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] or an individual database involves tracking and logging events that occur on the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="cd983-104">La auditoría de[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] permite crear auditorías de servidor, que pueden contener especificaciones de auditoría de servidor para los eventos de servidor, y especificaciones de auditoría de base de datos para los eventos de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-104">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit lets you create server audits, which can contain server audit specifications for server level events, and database audit specifications for database level events.</span></span> <span data-ttu-id="cd983-105">Los eventos auditados se pueden escribir en los registros de eventos o en los archivos de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-105">Audited events can be written to the event logs or to audit files.</span></span>  
  
 <span data-ttu-id="cd983-106">Hay varios niveles de auditoría disponibles para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], dependiendo de los requisitos gubernamentales o normativos de cada instalación.</span><span class="sxs-lookup"><span data-stu-id="cd983-106">There are several levels of auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], depending on government or standards requirements for your installation.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cd983-107">Audit proporciona las herramientas y los procesos necesarios para habilitar, almacenar y ver auditorías en varios objetos de servidor y de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-107">Audit provides the tools and processes you must have to enable, store, and view audits on various server and database objects.</span></span>  
  
 <span data-ttu-id="cd983-108">Puede registrar grupos de acciones de auditoría en el servidor por instancia, así como grupos de acciones o acciones de auditoría en la base de datos por base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-108">You can record server audit action groups per-instance, and either database audit action groups or database audit actions per database.</span></span> <span data-ttu-id="cd983-109">El evento de auditoría se producirá cada vez que se encuentre la acción auditable.</span><span class="sxs-lookup"><span data-stu-id="cd983-109">The audit event will occur every time that the auditable action is encountered.</span></span>  
  
 <span data-ttu-id="cd983-110">Todas las ediciones de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] admiten auditorías en el nivel de servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-110">All editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] support server level audits.</span></span> <span data-ttu-id="cd983-111">Las auditorías de nivel de base de datos se limitan a las ediciones Enterprise, Developer y Evaluation.</span><span class="sxs-lookup"><span data-stu-id="cd983-111">Database level auditing is limited to Enterprise, Developer, and Evaluation editions.</span></span> <span data-ttu-id="cd983-112">Para obtener más información, vea [características compatibles con las ediciones de SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-112">For more information, see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="sql-server-audit-components"></a><span data-ttu-id="cd983-113">Componentes de SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="cd983-113">SQL Server Audit Components</span></span>  
 <span data-ttu-id="cd983-114">Una *auditoría* es la combinación de varios elementos en un único paquete para un grupo específico de acciones de servidor o de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-114">An *audit* is the combination of several elements into a single package for a specific group of server actions or database actions.</span></span> <span data-ttu-id="cd983-115">Los componentes de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit se combinan para producir una salida denominada auditoría, de la misma manera que una definición de informe combinada con gráficos y elementos de datos da como resultado un informe.</span><span class="sxs-lookup"><span data-stu-id="cd983-115">The components of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit combine to produce an output that is called an audit, just as a report definition combined with graphics and data elements produces a report.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cd983-116">Audit usa *eventos extendidos* para facilitar la creación de auditorías.</span><span class="sxs-lookup"><span data-stu-id="cd983-116">audit uses *Extended Events* to help create an audit.</span></span> <span data-ttu-id="cd983-117">Para obtener más información acerca de los eventos extendidos, vea [eventos extendidos](../../extended-events/extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-117">For more information about Extended Events, see [Extended Events](../../extended-events/extended-events.md).</span></span>  
  
### <a name="sql-server-audit"></a><span data-ttu-id="cd983-118">SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="cd983-118">SQL Server Audit</span></span>  
 <span data-ttu-id="cd983-119">El objeto *SQL Server Audit* recopila una única instancia de acciones y grupos de acciones de nivel de servidor o de base de datos para su supervisión.</span><span class="sxs-lookup"><span data-stu-id="cd983-119">The *SQL Server Audit* object collects a single instance of server or database-level actions and groups of actions to monitor.</span></span> <span data-ttu-id="cd983-120">La auditoría se realiza en el nivel de instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-120">The audit is at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance level.</span></span> <span data-ttu-id="cd983-121">Es posible tener varias auditorías por cada instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-121">You can have multiple audits per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="cd983-122">Cuando se define una auditoría, se especifica la ubicación para los resultados generados.</span><span class="sxs-lookup"><span data-stu-id="cd983-122">When you define an audit, you specify the location for the output of the results.</span></span> <span data-ttu-id="cd983-123">Éste es el destino de la auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-123">This is the audit destination.</span></span> <span data-ttu-id="cd983-124">La auditoría se crea en un estado *deshabilitado* y no audita automáticamente ninguna acción.</span><span class="sxs-lookup"><span data-stu-id="cd983-124">The audit is created in a *disabled* state, and does not automatically audit any actions.</span></span> <span data-ttu-id="cd983-125">Una vez habilitada la auditoría, el destino de la auditoría recibe los datos de la misma.</span><span class="sxs-lookup"><span data-stu-id="cd983-125">After the audit is enabled, the audit destination receives data from the audit.</span></span>  
  
### <a name="server-audit-specification"></a><span data-ttu-id="cd983-126">Especificación de auditoría de servidor</span><span class="sxs-lookup"><span data-stu-id="cd983-126">Server Audit Specification</span></span>  
 <span data-ttu-id="cd983-127">El objeto *Especificación de auditoría de servidor* pertenece a una auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-127">The *Server Audit Specification* object belongs to an audit.</span></span> <span data-ttu-id="cd983-128">Puede crear una especificación de auditoría de servidor por cada auditoría, ya que ambos se crean en el ámbito de la instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-128">You can create one server audit specification per audit, because both are created at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance scope.</span></span>  
  
 <span data-ttu-id="cd983-129">La especificación de auditoría de servidor recopila muchos grupos de acciones de nivel de servidor generados por la característica Extended Events.</span><span class="sxs-lookup"><span data-stu-id="cd983-129">The server audit specification collects many server-level action groups raised by the Extended Events feature.</span></span> <span data-ttu-id="cd983-130">Puede incluir *grupos de acciones de auditoría* en una especificación de auditoría de servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-130">You can include *audit action groups* in a server audit specification.</span></span> <span data-ttu-id="cd983-131">Los grupos de acciones de auditoría son grupos predefinidos de acciones, que constituyen eventos atómicos que tienen lugar en el [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cd983-131">Audit action groups are predefined groups of actions, which are atomic events occurring in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="cd983-132">Estas acciones se envían a la auditoría, que las registra en el destino.</span><span class="sxs-lookup"><span data-stu-id="cd983-132">These actions are sent to the audit, which records them in the target.</span></span>  
  
 <span data-ttu-id="cd983-133">Los grupos de acciones de auditoría de nivel de servidor se describen en el tema [Grupos de acciones y acciones de SQL Server Audit](sql-server-audit-action-groups-and-actions.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-133">Server-level audit action groups are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="database-audit-specification"></a><span data-ttu-id="cd983-134">Especificación de auditoría de base de datos</span><span class="sxs-lookup"><span data-stu-id="cd983-134">Database Audit Specification</span></span>  
 <span data-ttu-id="cd983-135">El objeto *Especificación de auditoría de base de datos* también pertenece a una auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-135">The *Database Audit Specification* object also belongs to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit.</span></span> <span data-ttu-id="cd983-136">Puede crear una única especificación de auditoría de base de datos para cada base de datos de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y cada auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-136">You can create one database audit specification per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database per audit.</span></span>  
  
 <span data-ttu-id="cd983-137">La especificación de auditoría de base de datos recopila acciones de auditoría de nivel de base de datos generadas por la característica Extended Events.</span><span class="sxs-lookup"><span data-stu-id="cd983-137">The database audit specification collects database-level audit actions raised by the Extended Events feature.</span></span> <span data-ttu-id="cd983-138">Puede agregar grupos de acciones de auditoría o eventos de auditoría a una especificación de auditoría de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-138">You can add either audit action groups or audit events to a database audit specification.</span></span> <span data-ttu-id="cd983-139">Los*eventos de auditoría* son las acciones atómicas que puede auditar el motor de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-139">*Audit events* are the atomic actions that can be audited by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine.</span></span> <span data-ttu-id="cd983-140">Los*grupos de acciones de auditoría* son grupos predefinidos de acciones.</span><span class="sxs-lookup"><span data-stu-id="cd983-140">*Audit action groups* are predefined groups of actions.</span></span> <span data-ttu-id="cd983-141">Ambos están en el ámbito de la base de datos de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-141">Both are at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database scope.</span></span> <span data-ttu-id="cd983-142">Estas acciones se envían a la auditoría, que las registra en el destino.</span><span class="sxs-lookup"><span data-stu-id="cd983-142">These actions are sent to the audit, which records them in the target.</span></span> <span data-ttu-id="cd983-143">No incluya objetos con ámbito en el servidor, como las vistas del sistema, en una especificación de auditoría de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-143">Do not include server-scoped objects, such as the system views, in a user database audit specification.</span></span>  
  
 <span data-ttu-id="cd983-144">Los grupos de acciones de auditoría de base de datos y las acciones de auditoría se describen en el tema [Grupos de acciones y acciones de SQL Server Audit](sql-server-audit-action-groups-and-actions.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-144">Database-level audit action groups and audit actions are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="target"></a><span data-ttu-id="cd983-145">Destino</span><span class="sxs-lookup"><span data-stu-id="cd983-145">Target</span></span>  
 <span data-ttu-id="cd983-146">Los resultados de una auditoría se envían a un destino, que puede ser un archivo, el registro de eventos de seguridad de Windows o el registro de eventos de aplicación Windows.</span><span class="sxs-lookup"><span data-stu-id="cd983-146">The results of an audit are sent to a target, which can be a file, the Windows Security event log, or the Windows Application event log.</span></span> <span data-ttu-id="cd983-147">Los registros se deben revisar y archivar periódicamente para garantizar que el destino tiene espacio suficiente para escribir registros adicionales.</span><span class="sxs-lookup"><span data-stu-id="cd983-147">Logs must be reviewed and archived periodically to make sure that the target has sufficient space to write additional records.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="cd983-148">Cualquier usuario autenticado puede leer y escribir en el registro de eventos de aplicación Windows.</span><span class="sxs-lookup"><span data-stu-id="cd983-148">Any authenticated user can read and write to the Windows Application event log.</span></span> <span data-ttu-id="cd983-149">El registro de eventos de aplicación requiere permisos más bajos que el registro de eventos de seguridad de Windows, por lo que es menos seguro que éste.</span><span class="sxs-lookup"><span data-stu-id="cd983-149">The Application event log requires lower permissions than the Windows Security event log and is less secure than the Windows Security event log.</span></span>  
  
 <span data-ttu-id="cd983-150">La escritura en el registro de seguridad de Windows requiere que se agregue la cuenta del servicio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] a la directiva **Generar auditorías de seguridad** .</span><span class="sxs-lookup"><span data-stu-id="cd983-150">Writing to the Windows Security log requires the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account to be added to the **Generate security audits** policy.</span></span> <span data-ttu-id="cd983-151">De forma predeterminada, el sistema local, el servicio local y el servicio de red forman parte de esta directiva.</span><span class="sxs-lookup"><span data-stu-id="cd983-151">By default, the Local System, Local Service, and Network Service are part of this policy.</span></span> <span data-ttu-id="cd983-152">Este valor se puede configurar utilizando el complemento de directiva de seguridad (secpol.msc).</span><span class="sxs-lookup"><span data-stu-id="cd983-152">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="cd983-153">Además, la directiva de seguridad **Auditar el acceso a objetos** debe estar habilitada tanto para **Correcto** como para **Error**.</span><span class="sxs-lookup"><span data-stu-id="cd983-153">Additionally, the **Audit object access** security policy must be enabled for both **Success** and **Failure**.</span></span> <span data-ttu-id="cd983-154">Este valor se puede configurar utilizando el complemento de directiva de seguridad (secpol.msc).</span><span class="sxs-lookup"><span data-stu-id="cd983-154">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="cd983-155">En [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] o Windows Server 2008, puede establecer la Directiva de aplicación más granular **generada** desde la línea de comandos mediante el programa de directiva de auditoría ( `AuditPol.exe)` .</span><span class="sxs-lookup"><span data-stu-id="cd983-155">In [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] or Windows Server 2008, you can set the more granular **application generated** policy from the command line by using the audit policy program (`AuditPol.exe)`.</span></span> <span data-ttu-id="cd983-156">Para obtener más información sobre los pasos necesarios para habilitar la escritura en el registro de seguridad de Windows, vea [Escribir eventos de auditoría de SQL Server en el registro de seguridad](write-sql-server-audit-events-to-the-security-log.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-156">For more information about the steps to enable writing to the Windows Security log, see [Write SQL Server Audit Events to the Security Log](write-sql-server-audit-events-to-the-security-log.md).</span></span> <span data-ttu-id="cd983-157">Para obtener más información sobre el programa Auditpol.exe, vea el artículo 921469 de Knowledge Base que describe [cómo usar la directiva de grupo para configurar las opciones detalladas de auditoría de seguridad](https://support.microsoft.com/kb/921469/).</span><span class="sxs-lookup"><span data-stu-id="cd983-157">For more information about the Auditpol.exe program, see Knowledge Base article 921469, [How to use Group Policy to configure detailed security auditing](https://support.microsoft.com/kb/921469/).</span></span> <span data-ttu-id="cd983-158">Los registros de eventos de Windows son globales para el sistema operativo Windows.</span><span class="sxs-lookup"><span data-stu-id="cd983-158">The Windows event logs are global to the Windows operating system.</span></span> <span data-ttu-id="cd983-159">Para obtener más información sobre los registros de eventos de Windows, vea [Información general sobre el Visor de eventos](https://go.microsoft.com/fwlink/?LinkId=101455).</span><span class="sxs-lookup"><span data-stu-id="cd983-159">For more information about the Windows event logs, see [Event Viewer Overview](https://go.microsoft.com/fwlink/?LinkId=101455).</span></span> <span data-ttu-id="cd983-160">Si necesita permisos más concretos en la auditoría, utilice el destino de archivo binario.</span><span class="sxs-lookup"><span data-stu-id="cd983-160">If you need more precise permissions on the audit, use the binary file target.</span></span>  
  
 <span data-ttu-id="cd983-161">Al guardar información de auditoría en un archivo, para tratar de impedir su alteración, puede restringir el acceso a la ubicación del archivo de las maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="cd983-161">When you are saving audit information to a file, to help prevent tampering, you can restrict access to the file location in the following ways:</span></span>  
  
-   <span data-ttu-id="cd983-162">La cuenta de servicio de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] debe tener los permisos de lectura y escritura.</span><span class="sxs-lookup"><span data-stu-id="cd983-162">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service Account must have both Read and Write permission.</span></span>  
  
-   <span data-ttu-id="cd983-163">Normalmente, los administradores de auditoría requieren los permisos de lectura y escritura.</span><span class="sxs-lookup"><span data-stu-id="cd983-163">Audit Administrators typically require Read and Write permission.</span></span> <span data-ttu-id="cd983-164">Entonces, se supone que los administradores de auditoría son cuentas de Windows para la administración de archivos de auditoría, por ejemplo para la copia en diversos recursos compartidos, la copia de seguridad, etc.</span><span class="sxs-lookup"><span data-stu-id="cd983-164">This assumes that the Audit Administrators are Windows accounts for administration of audit files, such as: copying them to different shares, backing them up, and so on.</span></span>  
  
-   <span data-ttu-id="cd983-165">Los lectores de auditoría autorizados para leer archivos de auditoría deben tener permiso de lectura.</span><span class="sxs-lookup"><span data-stu-id="cd983-165">Audit Readers that are authorized to read audit files must have Read permission.</span></span>  
  
 <span data-ttu-id="cd983-166">Incluso cuando el [!INCLUDE[ssDE](../../../includes/ssde-md.md)] está escribiendo en un archivo, otros usuarios de Windows pueden leer el archivo de auditoría si tienen permiso.</span><span class="sxs-lookup"><span data-stu-id="cd983-166">Even when the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] is writing to a file, other Windows users can read the audit file if they have permission.</span></span> <span data-ttu-id="cd983-167">El [!INCLUDE[ssDE](../../../includes/ssde-md.md)] no crea ningún bloqueo exclusivo que evite las operaciones de lectura.</span><span class="sxs-lookup"><span data-stu-id="cd983-167">The [!INCLUDE[ssDE](../../../includes/ssde-md.md)] does not take an exclusive lock that prevents read operations.</span></span>  
  
 <span data-ttu-id="cd983-168">Dado que el [!INCLUDE[ssDE](../../../includes/ssde-md.md)] puede tener acceso al archivo, los inicios de sesión de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que tengan el permiso CONTROL SERVER pueden utilizar el [!INCLUDE[ssDE](../../../includes/ssde-md.md)] para tener acceso a los archivos de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-168">Because the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] can access the file, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logins that have CONTROL SERVER permission can use the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] to access the audit files.</span></span> <span data-ttu-id="cd983-169">Para registrar a todos los usuarios que estén leyendo el archivo de auditoría, defina una auditoría en master.sys.fn_get_audit_file.</span><span class="sxs-lookup"><span data-stu-id="cd983-169">To record any user that is reading the audit file, define an audit on master.sys.fn_get_audit_file.</span></span> <span data-ttu-id="cd983-170">De esta forma se registran los inicios de sesión con permiso CONTROL SERVER que hayan tenido acceso al archivo de auditoría a través de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cd983-170">This records the logins with CONTROL SERVER permission that have accessed the audit file through [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="cd983-171">Si un administrador de auditoría copia el archivo en otra ubicación (para archivarlo, etc.), los permisos de las ACL de la nueva ubicación se deben reducir solo a los siguientes:</span><span class="sxs-lookup"><span data-stu-id="cd983-171">If an Audit Administrator copies the file to a different location (for archive purposes, and so on), the ACLs on the new location should be reduced to the following permissions:</span></span>  
  
-   <span data-ttu-id="cd983-172">Administrador de auditoría: lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="cd983-172">Audit Administrator - Read / Write</span></span>  
  
-   <span data-ttu-id="cd983-173">Lector de auditoría: lectura</span><span class="sxs-lookup"><span data-stu-id="cd983-173">Audit Reader - Read</span></span>  
  
 <span data-ttu-id="cd983-174">Es recomendable generar los informes de la auditoría desde otra instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], por ejemplo una instancia de [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)]a la que solo tengan acceso administradores de auditoría o lectores de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-174">We recommend that you generate audit reports from a separate instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such as an instance of [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)], to which only Audit Administrators or Audit Readers have access.</span></span> <span data-ttu-id="cd983-175">El uso de otra instancia de [!INCLUDE[ssDE](../../../includes/ssde-md.md)] para la creación de informes puede contribuir a evitar que usuarios no autorizados obtengan acceso al registro de la auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-175">By using a separate instance of the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] for reporting, you can help prevent unauthorized users from obtaining access to the audit record.</span></span>  
  
 <span data-ttu-id="cd983-176">Puede proporcionar más protección contra el acceso no autorizado mediante el cifrado de la carpeta en que el archivo de la auditoría está almacenado. Para ello, puede utilizar el Cifrado de unidad Bitlocker de Windows o el Sistema de archivos de cifrado de Windows.</span><span class="sxs-lookup"><span data-stu-id="cd983-176">You can offer additional protection against unauthorized access by encrypting the folder in which the audit file is stored by using Windows BitLocker Drive Encryption or Windows Encrypting File System.</span></span>  
  
 <span data-ttu-id="cd983-177">Para obtener más información sobre los registros de auditoría que se escriben en el destino, vea [SQL Server Audit Records](sql-server-audit-records.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-177">For more information about the audit records that are written to the target, see [SQL Server Audit Records](sql-server-audit-records.md).</span></span>  
  
## <a name="overview-of-using-sql-server-audit"></a><span data-ttu-id="cd983-178">Información general sobre el uso de SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="cd983-178">Overview of Using SQL Server Audit</span></span>  
 <span data-ttu-id="cd983-179">Puede utilizar [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] o [!INCLUDE[tsql](../../../includes/tsql-md.md)] para definir una auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-179">You can use [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)] to define an audit.</span></span> <span data-ttu-id="cd983-180">Una vez creada y habilitada la auditoría, el destino comenzará a recibir entradas.</span><span class="sxs-lookup"><span data-stu-id="cd983-180">After the audit is created and enabled, the target will receive entries.</span></span>  
  
 <span data-ttu-id="cd983-181">Puede leer los registros de eventos de Windows mediante la utilidad **Visor de eventos** en Windows.</span><span class="sxs-lookup"><span data-stu-id="cd983-181">You can read the Windows event logs by using the **Event Viewer** utility in Windows.</span></span> <span data-ttu-id="cd983-182">Para los destinos de archivo, puede usar tanto el **Visor del archivo de registros** en [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] como la función [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) para leer el archivo de destino.</span><span class="sxs-lookup"><span data-stu-id="cd983-182">For file targets, you can use either the **Log File Viewer** in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or the [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) function to read the target file.</span></span>  
  
 <span data-ttu-id="cd983-183">El proceso general de creación y uso de una auditoría es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd983-183">The general process for creating and using an audit is as follows.</span></span>  
  
1.  <span data-ttu-id="cd983-184">Cree una auditoría y defina el destino.</span><span class="sxs-lookup"><span data-stu-id="cd983-184">Create an audit and define the target.</span></span>  
  
2.  <span data-ttu-id="cd983-185">Cree una especificación de auditoría de servidor o una especificación de auditoría de base de datos que se asigne a la auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-185">Create either a server audit specification or database audit specification that maps to the audit.</span></span> <span data-ttu-id="cd983-186">Habilite la especificación de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-186">Enable the audit specification.</span></span>  
  
3.  <span data-ttu-id="cd983-187">Habilite la auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-187">Enable the audit.</span></span>  
  
4.  <span data-ttu-id="cd983-188">Lea los eventos de auditoría mediante el **Visor de eventos**de Windows, el **Visor del archivo de registros**o la función fn_get_audit_file.</span><span class="sxs-lookup"><span data-stu-id="cd983-188">Read the audit events by using the Windows **Event Viewer**, **Log File Viewe**r, or the fn_get_audit_file function.</span></span>  
  
 <span data-ttu-id="cd983-189">Para obtener más información, consulte [Crear una auditoría de servidor y una especificación de auditoría de servidor](create-a-server-audit-and-server-audit-specification.md) y [Crear una especificación de auditoría de servidor y de auditoría de base de datos](create-a-server-audit-and-database-audit-specification.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-189">For more information, see [Create a Server Audit and Server Audit Specification](create-a-server-audit-and-server-audit-specification.md) and [Create a Server Audit and Database Audit Specification](create-a-server-audit-and-database-audit-specification.md).</span></span>  
  
## <a name="considerations"></a><span data-ttu-id="cd983-190">Consideraciones</span><span class="sxs-lookup"><span data-stu-id="cd983-190">Considerations</span></span>  
 <span data-ttu-id="cd983-191">Si se produce un error al comenzar la auditoría, el servidor no se iniciará.</span><span class="sxs-lookup"><span data-stu-id="cd983-191">In the case of a failure during audit initiation, the server will not start.</span></span> <span data-ttu-id="cd983-192">En este caso, se puede iniciar el servidor con la opción **-f** en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="cd983-192">In this case, the server can be started by using the **-f** option at the command line.</span></span>  
  
 <span data-ttu-id="cd983-193">Si un error de auditoría hace que el servidor se cierre o no se inicie porque se ha especificado ON_FAILURE=SHUTDOWN para la auditoría, se escribirá en el registro el evento MSG_AUDIT_FORCED_SHUTDOWN.</span><span class="sxs-lookup"><span data-stu-id="cd983-193">When an audit failure causes the server to shut down or not to start because ON_FAILURE=SHUTDOWN is specified for the audit, the MSG_AUDIT_FORCED_SHUTDOWN event will be written to the log.</span></span> <span data-ttu-id="cd983-194">Dado que el apagado se producirá en la primera aparición de este valor, el evento se escribirá una vez.</span><span class="sxs-lookup"><span data-stu-id="cd983-194">Because the shutdown will occur on the first encounter of this setting, the event will be written one time.</span></span> <span data-ttu-id="cd983-195">Este evento se escribirá después de la aparición del mensaje del error para la auditoría que ha provocado el cierre.</span><span class="sxs-lookup"><span data-stu-id="cd983-195">This event is written after the failure message for the audit causing the shutdown.</span></span> <span data-ttu-id="cd983-196">El administrador puede omitir los cierres provocados por auditorías si inicia [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] en modo de usuario único mediante la marca **-m**.</span><span class="sxs-lookup"><span data-stu-id="cd983-196">An administrator can bypass audit-induced shutdowns by starting [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in Single User mode using the **-m** flag.</span></span> <span data-ttu-id="cd983-197">De esta forma, indicará al sistema que cualquier auditoría en la que se haya especificado ON_FAILURE=SHUTDOWN debe ejecutarse en esa sesión como ON_FAILURE=CONTINUE.</span><span class="sxs-lookup"><span data-stu-id="cd983-197">If you start in Single User mode, you will downgrade any audit where ON_FAILURE=SHUTDOWN is specified to run in that session as ON_FAILURE=CONTINUE.</span></span> <span data-ttu-id="cd983-198">Cuando se inicia [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] con la marca **-m**, se escribe el mensaje MSG_AUDIT_SHUTDOWN_BYPASSED en el registro de errores.</span><span class="sxs-lookup"><span data-stu-id="cd983-198">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is started by using the **-m** flag, the MSG_AUDIT_SHUTDOWN_BYPASSED message will be written to the error log.</span></span>  
  
 <span data-ttu-id="cd983-199">Para obtener más información sobre las opciones de inicio del servicio, vea [Opciones de inicio del servicio de motor de base de datos](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-199">For more information about service startup options, see [Database Engine Service Startup Options](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span></span>  
  
### <a name="attaching-a-database-with-an-audit-defined"></a><span data-ttu-id="cd983-200">Adjuntar una base de datos con una auditoría definida</span><span class="sxs-lookup"><span data-stu-id="cd983-200">Attaching a Database with an Audit Defined</span></span>  
 <span data-ttu-id="cd983-201">Si se adjunta una base de datos que tiene una especificación de auditoría y que especifica un GUID que no existe en el servidor, se producirá una especificación de auditoría *huérfana* .</span><span class="sxs-lookup"><span data-stu-id="cd983-201">Attaching a database that has an audit specification and specifies a GUID that does not exist on the server will cause an *orphaned* audit specification.</span></span> <span data-ttu-id="cd983-202">Dado que en la instancia del servidor no existe ninguna auditoría con ese GUID, no se grabará ningún evento de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-202">Because an audit with a matching GUID does not exist on the server instance, no audit events will be recorded.</span></span> <span data-ttu-id="cd983-203">Para corregir esta situación, utilice el comando ALTER DATABASE AUDIT SPECIFICATION para conectar la especificación de auditoría huérfana a una auditoría de servidor existente.</span><span class="sxs-lookup"><span data-stu-id="cd983-203">To correct this situation, use the ALTER DATABASE AUDIT SPECIFICATION command to connect the orphaned audit specification to an existing server audit.</span></span> <span data-ttu-id="cd983-204">O bien use el comando CREATE SERVER AUDIT para crear una nueva auditoría de servidor con el GUID especificado.</span><span class="sxs-lookup"><span data-stu-id="cd983-204">Or, use the CREATE SERVER AUDIT command to create a new server audit with the specified GUID.</span></span>  
  
 <span data-ttu-id="cd983-205">Si lo desea, puede adjuntar una base de datos en la que se haya definido una especificación de auditoría a otra edición de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que no admita [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit, como [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] , pero no se registrará ningún evento de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-205">You can attach a database that has an audit specification defined on it to another edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that does not support [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit, such as [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] but it will not record audit events.</span></span>  
  
### <a name="database-mirroring-and-sql-server-audit"></a><span data-ttu-id="cd983-206">Creación de reflejo de la base de datos y SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="cd983-206">Database Mirroring and SQL Server Audit</span></span>  
 <span data-ttu-id="cd983-207">Una base de datos en la que se haya definido una especificación de auditoría de base de datos y que use la creación de reflejo de la base de datos incluirá la especificación de auditoría de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-207">A database that has a database audit specification defined and that uses database mirroring will include the database audit specification.</span></span> <span data-ttu-id="cd983-208">Para poder trabajar correctamente en la instancia de SQL reflejada, se deben configurar los elementos siguientes:</span><span class="sxs-lookup"><span data-stu-id="cd983-208">To work correctly on the mirrored SQL instance, the following items must be configured:</span></span>  
  
-   <span data-ttu-id="cd983-209">El servidor reflejado debe tener una auditoría con el mismo GUID para permitir que la especificación de auditoría de base de datos escriba registros de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-209">The mirror server must have an audit with the same GUID to enable the database audit specification to write audit records.</span></span> <span data-ttu-id="cd983-210">Esto se puede configurar mediante el comando CREATE AUDIT WITH GUID `=` \* \<GUID from source Server Audit*> .</span><span class="sxs-lookup"><span data-stu-id="cd983-210">This can be configured by using the command CREATE AUDIT WITH GUID`=`\*\<GUID from source Server Audit*>.</span></span>  
  
-   <span data-ttu-id="cd983-211">En el caso de los destinos de archivo binario, la cuenta de servicio del servidor reflejado debe tener los permisos adecuados para la ubicación en la que se escribe la pista de auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-211">For binary file targets, the mirror server service account must have appropriate permissions to the location where the audit trail is being written.</span></span>  
  
-   <span data-ttu-id="cd983-212">Si el destino es el registro de eventos de Windows, la directiva de seguridad del equipo en el que está ubicado el servidor reflejado debe permitir el acceso de la cuenta de servicio al registro de eventos de seguridad o de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cd983-212">For Windows event log targets, the security policy on the computer where the mirror server is located must allow for service account access to the security or application event log.</span></span>  
  
### <a name="auditing-administrators"></a><span data-ttu-id="cd983-213">Auditar a los administradores</span><span class="sxs-lookup"><span data-stu-id="cd983-213">Auditing Administrators</span></span>  
 <span data-ttu-id="cd983-214">Los miembros del `sysadmin` rol fijo de servidor se identifican como el usuario **DBO** en cada base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-214">Members of the `sysadmin` fixed server role are identified as the **dbo** user in each database.</span></span> <span data-ttu-id="cd983-215">Para auditar las acciones de los administradores, se auditan las acciones del usuario **dbo** .</span><span class="sxs-lookup"><span data-stu-id="cd983-215">To audit actions of the administrators, audit the actions of the **dbo** user.</span></span>  
  
## <a name="creating-and-managing-audits-with-transact-sql"></a><span data-ttu-id="cd983-216">Crear y administrar auditorías con Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="cd983-216">Creating and Managing Audits with Transact-SQL</span></span>  
 <span data-ttu-id="cd983-217">Puede usar instrucciones DDL, vistas y funciones de administración dinámica y vistas de catálogo para implementar todos los aspectos de la Auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-217">You can use DDL statements, dynamic management views and functions, and catalog views to implement all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>  
  
### <a name="data-definition-language-statements"></a><span data-ttu-id="cd983-218">Instrucciones de lenguaje de definición de datos (DDL)</span><span class="sxs-lookup"><span data-stu-id="cd983-218">Data Definition Language Statements</span></span>  
 <span data-ttu-id="cd983-219">Puede usar las siguientes instrucciones DDL para crear, modificar y quitar especificaciones de auditoría:</span><span class="sxs-lookup"><span data-stu-id="cd983-219">You can use the following DDL statements to create, alter, and drop audit specifications:</span></span>  
  
|||  
|-|-|  
|[<span data-ttu-id="cd983-220">ALTER AUTHORIZATION</span><span class="sxs-lookup"><span data-stu-id="cd983-220">ALTER AUTHORIZATION</span></span>](/sql/t-sql/statements/alter-authorization-transact-sql)|[<span data-ttu-id="cd983-221">CREATE SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="cd983-221">CREATE SERVER AUDIT</span></span>](/sql/t-sql/statements/create-server-audit-transact-sql)|  
|[<span data-ttu-id="cd983-222">ALTER DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="cd983-222">ALTER DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-database-audit-specification-transact-sql)|[<span data-ttu-id="cd983-223">CREATE SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="cd983-223">CREATE SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-server-audit-specification-transact-sql)|  
|[<span data-ttu-id="cd983-224">ALTER SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="cd983-224">ALTER SERVER AUDIT</span></span>](/sql/t-sql/statements/alter-server-audit-specification-transact-sql)|[<span data-ttu-id="cd983-225">DROP DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="cd983-225">DROP DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-database-encryption-key-transact-sql)|  
|[<span data-ttu-id="cd983-226">ALTER SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="cd983-226">ALTER SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-server-audit-transact-sql)|[<span data-ttu-id="cd983-227">DROP SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="cd983-227">DROP SERVER AUDIT</span></span>](/sql/t-sql/statements/drop-server-audit-transact-sql)|  
|[<span data-ttu-id="cd983-228">CREATE DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="cd983-228">CREATE DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-database-audit-specification-transact-sql)|[<span data-ttu-id="cd983-229">DROP SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="cd983-229">DROP SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-server-audit-specification-transact-sql)|  
  
### <a name="dynamic-views-and-functions"></a><span data-ttu-id="cd983-230">Funciones y vistas dinámicas</span><span class="sxs-lookup"><span data-stu-id="cd983-230">Dynamic Views and Functions</span></span>  
 <span data-ttu-id="cd983-231">En la tabla siguiente se enumeran las funciones y vistas dinámicas que puede usar con las auditorías de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-231">The following table lists the dynamic views and function that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Auditing.</span></span>  
  
|<span data-ttu-id="cd983-232">Funciones y vistas dinámicas</span><span class="sxs-lookup"><span data-stu-id="cd983-232">Dynamic views and functions</span></span>|<span data-ttu-id="cd983-233">Descripción</span><span class="sxs-lookup"><span data-stu-id="cd983-233">Description</span></span>|  
|---------------------------------|-----------------|  
|[<span data-ttu-id="cd983-234">sys.dm_audit_actions</span><span class="sxs-lookup"><span data-stu-id="cd983-234">sys.dm_audit_actions</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-actions-transact-sql)|<span data-ttu-id="cd983-235">Devuelve una fila por cada acción de auditoría sobre la que se puede guardar información en el registro de auditoría y por cada grupo de acciones de auditoría que se puede configurar como parte de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span><span class="sxs-lookup"><span data-stu-id="cd983-235">Returns a row for every audit action that can be reported in the audit log and every audit action group that can be configured as part of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>|  
|[<span data-ttu-id="cd983-236">sys.dm_server_audit_status</span><span class="sxs-lookup"><span data-stu-id="cd983-236">sys.dm_server_audit_status</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-server-audit-status-transact-sql)|<span data-ttu-id="cd983-237">Proporciona información sobre el estado actual de la auditoría.</span><span class="sxs-lookup"><span data-stu-id="cd983-237">Provides information about the current state of the audit.</span></span>|  
|[<span data-ttu-id="cd983-238">sys.dm_audit_class_type_map</span><span class="sxs-lookup"><span data-stu-id="cd983-238">sys.dm_audit_class_type_map</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-class-type-map-transact-sql)|<span data-ttu-id="cd983-239">Devuelve una tabla que asigna el campo class_type del registro de auditoría al campo class_desc en sys.dm_audit_actions.</span><span class="sxs-lookup"><span data-stu-id="cd983-239">Returns a table that maps the class_type field in the audit log to the class_desc field in sys.dm_audit_actions.</span></span>|  
|[<span data-ttu-id="cd983-240">fn_get_audit_file</span><span class="sxs-lookup"><span data-stu-id="cd983-240">fn_get_audit_file</span></span>](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql)|<span data-ttu-id="cd983-241">Devuelve información de un archivo de auditoría creado por una auditoría de servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-241">Returns information from an audit file created by a server audit.</span></span>|  
  
### <a name="catalog-views"></a><span data-ttu-id="cd983-242">Vistas de catálogo</span><span class="sxs-lookup"><span data-stu-id="cd983-242">Catalog Views</span></span>  
 <span data-ttu-id="cd983-243">En la tabla siguiente se enumeran las vistas de catálogo que puede usar con las auditorías de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-243">The following table lists the catalog views that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] auditing.</span></span>  
  
|<span data-ttu-id="cd983-244">Vistas de catálogo</span><span class="sxs-lookup"><span data-stu-id="cd983-244">Catalog views</span></span>|<span data-ttu-id="cd983-245">Descripción</span><span class="sxs-lookup"><span data-stu-id="cd983-245">Description</span></span>|  
|-------------------|-----------------|  
|[<span data-ttu-id="cd983-246">sys.database_audit_specifications</span><span class="sxs-lookup"><span data-stu-id="cd983-246">sys.database_ audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specifications-transact-sql)|<span data-ttu-id="cd983-247">Contiene información sobre las especificaciones de auditoría de base de datos en una auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de una instancia del servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-247">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="cd983-248">sys.database_audit_specification_details</span><span class="sxs-lookup"><span data-stu-id="cd983-248">sys.database_audit_specification_details</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specification-details-transact-sql)|<span data-ttu-id="cd983-249">Contiene información sobre las especificaciones de auditoría de base de datos en una auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de una instancia de servidor para todas las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-249">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance for all databases.</span></span>|  
|[<span data-ttu-id="cd983-250">sys.server_audits</span><span class="sxs-lookup"><span data-stu-id="cd983-250">sys.server_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audits-transact-sql)|<span data-ttu-id="cd983-251">Contiene una fila para cada auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de una instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-251">Contains one row for each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit in a server instance.</span></span>|  
|[<span data-ttu-id="cd983-252">sys.server_audit_specifications</span><span class="sxs-lookup"><span data-stu-id="cd983-252">sys.server_audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specifications-transact-sql)|<span data-ttu-id="cd983-253">Contiene información sobre las especificaciones de auditoría de servidor en una auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de una instancia del servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-253">Contains information about the server audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="cd983-254">sys.server_audit_specifications_details</span><span class="sxs-lookup"><span data-stu-id="cd983-254">sys.server_audit_specifications_details</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specification-details-transact-sql)|<span data-ttu-id="cd983-255">Contiene información sobre los detalles de especificación de auditoría del servidor (acciones) en una auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de una instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-255">Contains information about the server audit specification details (actions) in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="cd983-256">sys.server_file_audits</span><span class="sxs-lookup"><span data-stu-id="cd983-256">sys.server_file_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-file-audits-transact-sql)|<span data-ttu-id="cd983-257">Contiene información adicional sobre el tipo de auditoría de archivos en una auditoría de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de una instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="cd983-257">Contains stores extended information about the file audit type in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
  
## <a name="permissions"></a><span data-ttu-id="cd983-258">Permisos</span><span class="sxs-lookup"><span data-stu-id="cd983-258">Permissions</span></span>  
 <span data-ttu-id="cd983-259">Cada una de las características y los comandos para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit tiene sus propios requisitos de permisos.</span><span class="sxs-lookup"><span data-stu-id="cd983-259">Each feature and command for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit has individual permission requirements.</span></span>  
  
 <span data-ttu-id="cd983-260">Para crear, modificar o quitar una auditoría de servidor o una especificación de auditoría de servidor, las entidades de seguridad de servidor requieren el permiso ALTER ANY SERVER AUDIT o CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="cd983-260">To create, alter, or drop a Server Audit or Server Audit Specification, server principals require the ALTER ANY SERVER AUDIT or the CONTROL SERVER permission.</span></span> <span data-ttu-id="cd983-261">Para crear, modificar o quitar una especificación de auditoría de base de datos, las entidades de seguridad de base de datos requieren el permiso ALTER ANY DATABASE AUDIT, o el permiso ALTER o CONTROL en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-261">To create, alter, or drop a Database Audit Specification, database principals require the ALTER ANY DATABASE AUDIT permission or the ALTER or CONTROL permission on the database.</span></span> <span data-ttu-id="cd983-262">Además, las entidades de seguridad deben tener el permiso para conectarse a la base de datos o los permisos ALTER ANY SERVER AUDIT o CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="cd983-262">In addition, principals must have permission to connect to the database, or ALTER ANY SERVER AUDIT or CONTROL SERVER permissions.</span></span>  
  
 <span data-ttu-id="cd983-263">A menos que se especifique lo contrario, para que una entidad de seguridad pueda ver las vistas de catálogo debe cumplir una de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="cd983-263">Unless otherwise specified, viewing catalog views requires a principal to have one of the following:</span></span>  
  
-   <span data-ttu-id="cd983-264">Pertenencia al rol fijo de servidor sysadmin.</span><span class="sxs-lookup"><span data-stu-id="cd983-264">Membership in the sysadmin fixed server role.</span></span>  
  
-   <span data-ttu-id="cd983-265">El permiso CONTROL SERVER.</span><span class="sxs-lookup"><span data-stu-id="cd983-265">The CONTROL SERVER permission.</span></span>  
  
-   <span data-ttu-id="cd983-266">El permiso VIEW SERVER STATE.</span><span class="sxs-lookup"><span data-stu-id="cd983-266">The VIEW SERVER STATE permission.</span></span>  
  
-   <span data-ttu-id="cd983-267">El permiso ALTER ANY AUDIT.</span><span class="sxs-lookup"><span data-stu-id="cd983-267">The ALTER ANY AUDIT permission.</span></span>  
  
-   <span data-ttu-id="cd983-268">El permiso VIEW AUDIT STATE (solo da el acceso principal a la vista de catálogo sys.server_audits).</span><span class="sxs-lookup"><span data-stu-id="cd983-268">The VIEW AUDIT STATE permission (gives only the principal access to the sys.server_audits catalog view).</span></span>  
  
 <span data-ttu-id="cd983-269">Una entidad de seguridad debe tener el permiso VIEW SERVER STATE o ALTER ANY AUDIT para utilizar las vistas de administración dinámica.</span><span class="sxs-lookup"><span data-stu-id="cd983-269">A principal must have the VIEW SERVER STATE or ALTER ANY AUDIT permission to use the Dynamic Management Views.</span></span>  
  
 <span data-ttu-id="cd983-270">Para obtener más información sobre cómo conceder derechos y permisos, vea [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="cd983-270">For more information about how to grant rights and permissions, see [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="cd983-271">De la misma forma que las entidades de seguridad del rol sysadmin pueden manipular cualquier componente de auditoría, las del rol db_owner pueden manipular las especificaciones de auditoría en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-271">Principals in the sysadmin role can tamper with any audit component and those in the db_owner role can tamper with audit specifications in a database.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cd983-272">Audit comprobará si un inicio de sesión que crea o modifica una especificación de auditoría tiene al menos el permiso ALTER ANY DATABASE AUDIT.</span><span class="sxs-lookup"><span data-stu-id="cd983-272">Audit will validate that a logon that creates or alters an audit specification has at least the ALTER ANY DATABASE AUDIT permission.</span></span> <span data-ttu-id="cd983-273">Sin embargo, no realiza ninguna validación al adjuntar una base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-273">However, it does no validation when you attach a database.</span></span> <span data-ttu-id="cd983-274">Como norma, debería otorgar la misma confianza a las especificaciones de auditoría de base de datos que a las entidades de seguridad que tienen el rol sysadmin o db_owner.</span><span class="sxs-lookup"><span data-stu-id="cd983-274">You should assume all Database Audit Specifications are only as trustworthy as those principals in the sysadmin or db_owner role.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="cd983-275">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="cd983-275">Related Tasks</span></span>  
 [<span data-ttu-id="cd983-276">Crear una auditoría de servidor y una especificación de auditoría de servidor</span><span class="sxs-lookup"><span data-stu-id="cd983-276">Create a Server Audit and Server Audit Specification</span></span>](create-a-server-audit-and-server-audit-specification.md)  
  
 [<span data-ttu-id="cd983-277">Crear una especificación de auditoría de servidor y de auditoría de base de datos</span><span class="sxs-lookup"><span data-stu-id="cd983-277">Create a Server Audit and Database Audit Specification</span></span>](create-a-server-audit-and-database-audit-specification.md)  
  
 [<span data-ttu-id="cd983-278">Ver un registro de SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="cd983-278">View a SQL Server Audit Log</span></span>](view-a-sql-server-audit-log.md)  
  
 [<span data-ttu-id="cd983-279">Escribir eventos de SQL Server Audit en el registro de seguridad</span><span class="sxs-lookup"><span data-stu-id="cd983-279">Write SQL Server Audit Events to the Security Log</span></span>](write-sql-server-audit-events-to-the-security-log.md)  
  
## <a name="topics-closely-related-to-auditing"></a><span data-ttu-id="cd983-280">Temas estrechamente relacionados con la auditoría</span><span class="sxs-lookup"><span data-stu-id="cd983-280">Topics Closely Related to Auditing</span></span>  
 [<span data-ttu-id="cd983-281">Propiedades del servidor &#40;página Seguridad&#41;</span><span class="sxs-lookup"><span data-stu-id="cd983-281">Server Properties &#40;Security Page&#41;</span></span>](../../../database-engine/configure-windows/server-properties-security-page.md)  
 <span data-ttu-id="cd983-282">Explica cómo activar la auditoría de inicio de sesión para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cd983-282">Explains how to turn on login auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cd983-283">Los registros de auditoría se almacenan en el registro de aplicación de Windows.</span><span class="sxs-lookup"><span data-stu-id="cd983-283">The audit records are stored in the Windows application log.</span></span>  
  
 [<span data-ttu-id="cd983-284">c2 audit mode (opción de configuración del servidor)</span><span class="sxs-lookup"><span data-stu-id="cd983-284">c2 audit mode Server Configuration Option</span></span>](../../../database-engine/configure-windows/c2-audit-mode-server-configuration-option.md)  
 <span data-ttu-id="cd983-285">Explica la compatibilidad de seguridad del modo auditoría C2 en [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cd983-285">Explains the C2 security compliance auditing mode in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 [<span data-ttu-id="cd983-286">Categoría de eventos Auditoría de seguridad &#40;SQL Server Profiler&#41;</span><span class="sxs-lookup"><span data-stu-id="cd983-286">Security Audit Event Category &#40;SQL Server Profiler&#41;</span></span>](../../../relational-databases/event-classes/security-audit-event-category-sql-server-profiler.md)  
 <span data-ttu-id="cd983-287">Explica los eventos de auditoría que puede utilizar en [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cd983-287">Explains the audit events you can use in [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="cd983-288">Para más información, consulte [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="cd983-288">For more information, see [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span></span>  
  
 [<span data-ttu-id="cd983-289">Seguimiento de SQL</span><span class="sxs-lookup"><span data-stu-id="cd983-289">SQL Trace</span></span>](../../sql-trace/sql-trace.md)  
 <span data-ttu-id="cd983-290">Explica cómo puede usar el Seguimiento de SQL desde sus propias aplicaciones para crear seguimientos manualmente, en lugar de usar [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span><span class="sxs-lookup"><span data-stu-id="cd983-290">Explains how SQL Trace can be used from within your own applications to create traces manually, instead of using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span></span>  
  
 [<span data-ttu-id="cd983-291">Desencadenadores DDL</span><span class="sxs-lookup"><span data-stu-id="cd983-291">DDL Triggers</span></span>](../../triggers/ddl-triggers.md)  
 <span data-ttu-id="cd983-292">Explica cómo puede usar los desencadenadores del Lenguaje de definición de datos (DDL) para realizar el seguimiento de los cambios en sus bases de datos.</span><span class="sxs-lookup"><span data-stu-id="cd983-292">Explains how you can use Data Definition Language (DDL) triggers to track changes to your databases.</span></span>  
  
 [<span data-ttu-id="cd983-293">Microsoft TechNet: SQL Server TechCenter: Seguridad y protección de SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="cd983-293">Microsoft TechNet: SQL Server TechCenter: SQL Server 2005 Security and Protection</span></span>](https://go.microsoft.com/fwlink/?LinkId=101152)  
 <span data-ttu-id="cd983-294">Proporciona información actualizada sobre la seguridad de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cd983-294">Provides up-to-date information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cd983-295">Consulte también</span><span class="sxs-lookup"><span data-stu-id="cd983-295">See Also</span></span>  
 <span data-ttu-id="cd983-296">[Grupos de acciones y acciones de SQL Server Audit](sql-server-audit-action-groups-and-actions.md) </span><span class="sxs-lookup"><span data-stu-id="cd983-296">[SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md) </span></span>  
 [<span data-ttu-id="cd983-297">Registros de SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="cd983-297">SQL Server Audit Records</span></span>](sql-server-audit-records.md)  
  
  
