---
title: Tablas e índices con particiones | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- partitioned tables [SQL Server], about partitioned tables
- partitioned indexes [SQL Server], architecture
- partitioned tables [SQL Server], architecture
- partitioned indexes [SQL Server], about partitioned indexes
ms.assetid: cc5bf181-18a0-44d5-8bd7-8060d227c927
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e8d041abcfe491f311e38bc8dab4be4ea253e37c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87749251"
---
# <a name="partitioned-tables-and-indexes"></a><span data-ttu-id="a9436-102">Partitioned Tables and Indexes</span><span class="sxs-lookup"><span data-stu-id="a9436-102">Partitioned Tables and Indexes</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a9436-103">es compatible con la creación de particiones de tabla e índice.</span><span class="sxs-lookup"><span data-stu-id="a9436-103">supports table and index partitioning.</span></span> <span data-ttu-id="a9436-104">Los datos de tablas e índices con particiones se dividen en unidades que pueden propagarse por más de un grupo de archivos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a9436-104">The data of partitioned tables and indexes is divided into units that can be spread across more than one filegroup in a database.</span></span> <span data-ttu-id="a9436-105">Los datos se dividen en sentido horizontal, de forma que los grupos de filas se asignan a particiones individuales.</span><span class="sxs-lookup"><span data-stu-id="a9436-105">The data is partitioned horizontally, so that groups of rows are mapped into individual partitions.</span></span> <span data-ttu-id="a9436-106">Las particiones de un índice o una tabla deben encontrarse en la misma base de datos.</span><span class="sxs-lookup"><span data-stu-id="a9436-106">All partitions of a single index or table must reside in the same database.</span></span> <span data-ttu-id="a9436-107">La tabla o el índice se tratarán como una sola entidad lógica cuando se realicen consultas o actualizaciones en los datos.</span><span class="sxs-lookup"><span data-stu-id="a9436-107">The table or index is treated as a single logical entity when queries or updates are performed on the data.</span></span> <span data-ttu-id="a9436-108">Las tablas e índices con particiones no están disponibles en todas las ediciones de [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a9436-108">Partitioned tables and indexes are not available in every edition of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a9436-109">Para obtener una lista de las características admitidas por las ediciones de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], vea [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="a9436-109">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="a9436-110">admite hasta 15.000 particiones de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a9436-110">supports up to 15,000 partitions by default.</span></span> <span data-ttu-id="a9436-111">En las versiones anteriores a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], el número de particiones está limitado a 1.000 de forma predeterminada. En sistemas basados en x86, se puede crear una tabla o un índice con más de 1000 particiones pero no se admite.</span><span class="sxs-lookup"><span data-stu-id="a9436-111">In versions earlier than [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the number of partitions was limited to 1,000 by default.On x86-based systems, creating a table or index with more than 1000 partitions is possible, but is not supported.</span></span>  
  
## <a name="benefits-of-partitioning"></a><span data-ttu-id="a9436-112">Ventajas de la creación de particiones</span><span class="sxs-lookup"><span data-stu-id="a9436-112">Benefits of Partitioning</span></span>  
 <span data-ttu-id="a9436-113">La creación de particiones de tablas o índices grandes puede tener las siguientes ventajas de administración y rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a9436-113">Partitioning large tables or indexes can have the following manageability and performance benefits.</span></span>  
  
-   <span data-ttu-id="a9436-114">Se puede transferir u obtener acceso a subconjuntos de datos de forma rápida y eficaz, a la vez que mantiene la integridad de una recopilación de datos.</span><span class="sxs-lookup"><span data-stu-id="a9436-114">You can transfer or access subsets of data quickly and efficiently, while maintaining the integrity of a data collection.</span></span> <span data-ttu-id="a9436-115">Por ejemplo, una operación como la carga de datos desde un sistema OLTP a un sistema OLAP tarda solo unos segundos, en lugar de los minutos y las horas que se requieren cuando no se ha realizado una partición de los datos.</span><span class="sxs-lookup"><span data-stu-id="a9436-115">For example, an operation such as loading data from an OLTP to an OLAP system takes only seconds, instead of the minutes and hours the operation takes when the data is not partitioned.</span></span>  
  
-   <span data-ttu-id="a9436-116">Puede realizar operaciones de mantenimiento en una o más particiones más rápidamente.</span><span class="sxs-lookup"><span data-stu-id="a9436-116">You can perform maintenance operations on one or more partitions more quickly.</span></span> <span data-ttu-id="a9436-117">Las operaciones son más eficaces porque solo afectan a estos subconjuntos de datos, y no a toda la tabla.</span><span class="sxs-lookup"><span data-stu-id="a9436-117">The operations are more efficient because they target only these data subsets, instead of the whole table.</span></span> <span data-ttu-id="a9436-118">Por ejemplo, se puede elegir comprimir los datos en una o varias particiones o recompilar una o varias particiones de un índice.</span><span class="sxs-lookup"><span data-stu-id="a9436-118">For example, you can choose to compress data in one or more partitions or rebuild one or more partitions of an index.</span></span>  
  
-   <span data-ttu-id="a9436-119">Se puede mejorar el rendimiento de las consultas, en función de los tipos de consultas que se suelen ejecutar y de la configuración del hardware.</span><span class="sxs-lookup"><span data-stu-id="a9436-119">You may improve query performance, based on the types of queries you frequently run and on your hardware configuration.</span></span> <span data-ttu-id="a9436-120">Por ejemplo, el optimizador de consultas puede procesar consultas de combinación de igualdad entre dos o más tablas con particiones más rápidamente cuando las columnas de partición de las tablas son iguales, porque las particiones se pueden combinar.</span><span class="sxs-lookup"><span data-stu-id="a9436-120">For example, the query optimizer can process equi-join queries between two or more partitioned tables faster when the partitioning columns in the tables are the same, because the partitions themselves can be joined.</span></span>  
  
     <span data-ttu-id="a9436-121">Cuando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] realiza una ordenación de los datos para operaciones de E/S, los ordena primero por partición.</span><span class="sxs-lookup"><span data-stu-id="a9436-121">When [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] performs data sorting for I/O operations, it sorts the data first by partition.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a9436-122">tiene acceso a una unidad cada vez y esto podría reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a9436-122">accesses one drive at a time, and this might reduce performance.</span></span> <span data-ttu-id="a9436-123">Para mejorar el rendimiento de la ordenación de los datos, cree franjas de los archivos de datos de las particiones en más de un disco configurando una RAID.</span><span class="sxs-lookup"><span data-stu-id="a9436-123">To improve data sorting performance, stripe the data files of your partitions across more than one disk by setting up a RAID.</span></span> <span data-ttu-id="a9436-124">De este modo, aunque [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] siga ordenando los datos por partición, puede tener acceso a todas las unidades de cada partición al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="a9436-124">In this way, although [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] still sorts data by partition, it can access all the drives of each partition at the same time.</span></span>  
  
     <span data-ttu-id="a9436-125">Además, la partición permite mejorar el rendimiento habilitando la extensión de bloqueo en el nivel de partición y no en toda la tabla.</span><span class="sxs-lookup"><span data-stu-id="a9436-125">In addition, you can improve performance by enabling lock escalation at the partition level instead of a whole table.</span></span> <span data-ttu-id="a9436-126">Esto puede reducir la contención en la tabla por bloqueo.</span><span class="sxs-lookup"><span data-stu-id="a9436-126">This can reduce lock contention on the table.</span></span>  
  
## <a name="components-and-concepts"></a><span data-ttu-id="a9436-127">Componentes y conceptos</span><span class="sxs-lookup"><span data-stu-id="a9436-127">Components and Concepts</span></span>  
 <span data-ttu-id="a9436-128">Los siguientes términos son aplicables para las particiones de tablas e índices.</span><span class="sxs-lookup"><span data-stu-id="a9436-128">The following terms are applicable to table and index partitioning.</span></span>  
  
 <span data-ttu-id="a9436-129">Función de partición</span><span class="sxs-lookup"><span data-stu-id="a9436-129">Partition function</span></span>  
 <span data-ttu-id="a9436-130">Una función de partición define la forma de asignar las filas de una tabla o un índice a un conjunto de particiones a partir de los valores de una determinada columna, denominada columna de partición.</span><span class="sxs-lookup"><span data-stu-id="a9436-130">A database object that defines how the rows of a table or index are mapped to a set of partitions based on the values of certain column, called a partitioning column.</span></span> <span data-ttu-id="a9436-131">Es decir, la función de partición define el número de particiones que la tabla tendrá y cómo se definen los límites de las particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-131">That is, the partition function defines the number of partitions that the table will have and how the boundaries of the partitions are defined.</span></span> <span data-ttu-id="a9436-132">Por ejemplo, dada una tabla con datos de pedidos de ventas, puede crear doce particiones (mensuales) de la tabla tomando como base una columna `datetime`, por ejemplo una fecha de ventas.</span><span class="sxs-lookup"><span data-stu-id="a9436-132">For example, given a table that contains sales order data, you may want to partition the table into twelve (monthly) partitions based on a `datetime` column such as a sales date.</span></span>  
  
 <span data-ttu-id="a9436-133">Esquema de partición</span><span class="sxs-lookup"><span data-stu-id="a9436-133">Partition scheme</span></span>  
 <span data-ttu-id="a9436-134">Objeto de base de datos que asigna las particiones de una función de partición a un conjunto de grupos de archivos.</span><span class="sxs-lookup"><span data-stu-id="a9436-134">A database object that maps the partitions of a partition function to a set of filegroups.</span></span> <span data-ttu-id="a9436-135">La principal razón para colocar las particiones en distintos grupos de archivos es garantizar que se puedan realizar operaciones de copia de seguridad en particiones de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="a9436-135">The primary reason for placing your partitions on separate filegroups is to make sure that you can independently perform backup operations on partitions.</span></span> <span data-ttu-id="a9436-136">Esto se debe a que se pueden realizar copias de seguridad en grupos de archivos individuales.</span><span class="sxs-lookup"><span data-stu-id="a9436-136">This is because you can perform backups on individual filegroups.</span></span>  
  
 <span data-ttu-id="a9436-137">Columna de partición</span><span class="sxs-lookup"><span data-stu-id="a9436-137">Partitioning column</span></span>  
 <span data-ttu-id="a9436-138">La columna de una tabla o índice que una función de partición usa para crear particiones en la tabla o índice.</span><span class="sxs-lookup"><span data-stu-id="a9436-138">The column of a table or index that a partition function uses to partition the table or index.</span></span> <span data-ttu-id="a9436-139">Las columnas calculadas que participan en una función de partición deben marcarse explícitamente como PERSISTED.</span><span class="sxs-lookup"><span data-stu-id="a9436-139">Computed columns that participate in a partition function must be explicitly marked PERSISTED.</span></span> <span data-ttu-id="a9436-140">Todos los tipos de datos válidos para el uso en columnas de índice pueden utilizarse como una columna de partición con la excepción de `timestamp`.</span><span class="sxs-lookup"><span data-stu-id="a9436-140">All data types that are valid for use as index columns can be used as a partitioning column, except `timestamp`.</span></span> <span data-ttu-id="a9436-141">Los tipos de datos `ntext`, `text`, `image`, `xml`, `varchar(max)`, `nvarchar(max)` o `varbinary(max)` no se pueden especificar.</span><span class="sxs-lookup"><span data-stu-id="a9436-141">The `ntext`, `text`, `image`, `xml`, `varchar(max)`, `nvarchar(max)`, or `varbinary(max)` data types cannot be specified.</span></span> <span data-ttu-id="a9436-142">Tampoco se pueden especificar columnas de tipo de datos de alias y de tipo definido por el usuario de Common Language Runtime (CLR) de Microsoft .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="a9436-142">Also, Microsoft .NET Framework common language runtime (CLR) user-defined type and alias data type columns cannot be specified.</span></span>  
  
 <span data-ttu-id="a9436-143">Índices alineados</span><span class="sxs-lookup"><span data-stu-id="a9436-143">Aligned index</span></span>  
 <span data-ttu-id="a9436-144">Un índice que se compila con el mismo esquema de partición que su tabla correspondiente.</span><span class="sxs-lookup"><span data-stu-id="a9436-144">An index that is built on the same partition scheme as its corresponding table.</span></span> <span data-ttu-id="a9436-145">Cuando una tabla y sus índices están alineados, SQL Server puede dividir las particiones de forma rápida y eficaz al mismo tiempo que mantiene la estructura de la partición tanto en la tabla como en sus índices.</span><span class="sxs-lookup"><span data-stu-id="a9436-145">When a table and its indexes are in alignment, SQL Server can switch partitions quickly and efficiently while maintaining the partition structure of both the table and its indexes.</span></span> <span data-ttu-id="a9436-146">Un índice no tiene por qué participar en la misma función de partición con nombre para alinearse con su tabla base.</span><span class="sxs-lookup"><span data-stu-id="a9436-146">An index does not have to participate in the same named partition function to be aligned with its base table.</span></span> <span data-ttu-id="a9436-147">Sin embargo, la función de partición del índice y la tabla base debe ser básicamente la misma puesto que 1) los argumentos de las funciones de la partición tienen el mismo tipo de datos, 2) definen el mismo número de particiones y 3) definen los mismos valores de límite para las particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-147">However, the partition function of the index and the base table must be essentially the same, in that 1) the arguments of the partition functions have the same data type, 2) they define the same number of partitions, and 3) they define the same boundary values for partitions.</span></span>  
  
 <span data-ttu-id="a9436-148">Índice no alineado</span><span class="sxs-lookup"><span data-stu-id="a9436-148">Nonaligned index</span></span>  
 <span data-ttu-id="a9436-149">Un índice con particiones independientemente de su tabla correspondiente.</span><span class="sxs-lookup"><span data-stu-id="a9436-149">An index partitioned independently from its corresponding table.</span></span> <span data-ttu-id="a9436-150">Es decir, el índice tiene un esquema de partición diferente o está colocado en un grupo de archivos independiente de la tabla base.</span><span class="sxs-lookup"><span data-stu-id="a9436-150">That is, the index has a different partition scheme or is placed on a separate filegroup from the base table.</span></span> <span data-ttu-id="a9436-151">El diseño de un índice con particiones no alineado puede ser útil en los siguientes casos:</span><span class="sxs-lookup"><span data-stu-id="a9436-151">Designing an nonaligned partitioned index can be useful in the following cases:</span></span>  
  
-   <span data-ttu-id="a9436-152">En la tabla base no se han creado particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-152">The base table has not been partitioned.</span></span>  
  
-   <span data-ttu-id="a9436-153">La clave de índice es única y no contiene la columna de partición de la tabla.</span><span class="sxs-lookup"><span data-stu-id="a9436-153">The index key is unique and it does not contain the partitioning column of the table.</span></span>  
  
-   <span data-ttu-id="a9436-154">Desea que la tabla base participe en combinaciones por colocación con más tablas usando columnas de combinación diferentes.</span><span class="sxs-lookup"><span data-stu-id="a9436-154">You want the base table to participate in collocated joins with more tables using different join columns.</span></span>  
  
 <span data-ttu-id="a9436-155">Eliminación de particiones</span><span class="sxs-lookup"><span data-stu-id="a9436-155">Partition elimination</span></span>  
 <span data-ttu-id="a9436-156">El proceso por el que el optimizador de consultas tiene acceso únicamente a las particiones pertinentes para cumplir los criterios de filtro de la consulta.</span><span class="sxs-lookup"><span data-stu-id="a9436-156">The process by which the query optimizer accesses only the relevant partitions to satisfy the filter criteria of the query.</span></span>  
  
## <a name="performance-guidelines"></a><span data-ttu-id="a9436-157">Instrucciones de rendimiento</span><span class="sxs-lookup"><span data-stu-id="a9436-157">Performance Guidelines</span></span>  
 <span data-ttu-id="a9436-158">El nuevo, mayor límite de 15.000 particiones afecta a la memoria, operaciones con particiones de índice, comandos DBCC, y consultas.</span><span class="sxs-lookup"><span data-stu-id="a9436-158">The new, higher limit of 15,000 partitions affects memory, partitioned index operations, DBCC commands, and queries.</span></span> <span data-ttu-id="a9436-159">Esta sección describe las implicaciones para el rendimiento de aumentar el número de particiones en 1.000 y proporciona soluciones según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="a9436-159">This section describes the performance implications of increasing the number of partitions above 1,000 and provides workarounds as needed.</span></span> <span data-ttu-id="a9436-160">Con el límite en el número máximo de particiones ampliado a 15.000, puede almacenar los datos durante más tiempo.</span><span class="sxs-lookup"><span data-stu-id="a9436-160">With the limit on the maximum number of partitions being increased to 15,000, you can store data for a longer time.</span></span> <span data-ttu-id="a9436-161">Sin embargo, debe conservar datos solo mientras sea necesario y mantener un equilibrio entre el rendimiento y el número de particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-161">However, you should retain data only for as long as it is needed and maintain a balance between performance and number of partitions.</span></span>  
  
### <a name="memory-usage-and-guidelines"></a><span data-ttu-id="a9436-162">Instrucciones y uso de la memoria</span><span class="sxs-lookup"><span data-stu-id="a9436-162">Memory Usage and Guidelines</span></span>  
 <span data-ttu-id="a9436-163">Se recomienda usar al menos 16 GB de RAM si un gran número de particiones están en uso.</span><span class="sxs-lookup"><span data-stu-id="a9436-163">We recommend that you use at least 16 GB of RAM if a large number of partitions are in use.</span></span> <span data-ttu-id="a9436-164">Si el sistema no tiene suficiente memoria, (DML) las instrucciones de lenguaje de manipulación de datos, (DDL) instrucciones de lenguaje de definición de datos y otras operaciones pueden generar errores debido a la memoria insuficiente.</span><span class="sxs-lookup"><span data-stu-id="a9436-164">If the system does not have enough memory, Data Manipulation Language (DML) statements, Data Definition Language (DDL) statements and other operations can fail due to insufficient memory.</span></span> <span data-ttu-id="a9436-165">Los sistemas con 16 GB de RAM que funcionan con muchos procesos intensivos de memoria pueden quedarse sin memoria en operaciones que ejecutan en un gran número de particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-165">Systems with 16 GB of RAM that run many memory-intensive processes may run out of memory on operations that run on a large number of partitions.</span></span> <span data-ttu-id="a9436-166">Por consiguiente, cuanta más memoria se tenga por encima de 16 GB menor es la posibilidad de enfrentarse a problemas de rendimiento y de memoria.</span><span class="sxs-lookup"><span data-stu-id="a9436-166">Therefore, the more memory you have over 16 GB, the less likely you are to encounter performance and memory issues.</span></span>  
  
 <span data-ttu-id="a9436-167">Las limitaciones de memoria pueden afectar al rendimiento o capacidad de SQL Server para compilar un índice con particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-167">Memory limitations can affect the performance or ability of SQL Server to build a partitioned index.</span></span> <span data-ttu-id="a9436-168">Esto sucede especialmente cuando el índice no está alineado con su tabla base o no está alineado con su índice clúster si ya se ha aplicado un índice clúster a la tabla.</span><span class="sxs-lookup"><span data-stu-id="a9436-168">This is especially the case when the index is not aligned with its base table or is not aligned with its clustered index, if the table already has a clustered index applied to it.</span></span>  
  
### <a name="partitioned-index-operations"></a><span data-ttu-id="a9436-169">Operaciones de índices con particiones</span><span class="sxs-lookup"><span data-stu-id="a9436-169">Partitioned Index Operations</span></span>  
 <span data-ttu-id="a9436-170">Las limitaciones de memoria pueden afectar al rendimiento o capacidad de SQL Server para compilar un índice con particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-170">Memory limitations can affect the performance or ability of SQL Server to build a partitioned index.</span></span> <span data-ttu-id="a9436-171">Esto es especialmente así con índices no alineados.</span><span class="sxs-lookup"><span data-stu-id="a9436-171">This is especially the case with nonaligned indexes.</span></span> <span data-ttu-id="a9436-172">La creación y regeneración de índices no alineados en una tabla con más de 1.000 particiones es posible, pero no se admite.</span><span class="sxs-lookup"><span data-stu-id="a9436-172">Creating and rebuilding nonaligned indexes on a table with more than 1,000 partitions is possible, but is not supported.</span></span> <span data-ttu-id="a9436-173">Si se hace, se puede degradar el rendimiento o consumir excesiva memoria durante estas operaciones.</span><span class="sxs-lookup"><span data-stu-id="a9436-173">Doing so may cause degraded performance or excessive memory consumption during these operations.</span></span>  
  
 <span data-ttu-id="a9436-174">Crear y recompilar índices alineados podría tardar mucho más tiempo en ejecutarse cuando el número de particiones aumenta.</span><span class="sxs-lookup"><span data-stu-id="a9436-174">Creating and rebuilding aligned indexes could take longer to execute as the number of partitions increases.</span></span> <span data-ttu-id="a9436-175">Se recomienda que no ejecute varios comandos de crear y recompilar índices al mismo tiempo, ya que quizás se enfrente a problemas de rendimiento y memoria.</span><span class="sxs-lookup"><span data-stu-id="a9436-175">We recommend that you do not run multiple create and rebuild index commands at the same time as you may run into performance and memory issues.</span></span>  
  
 <span data-ttu-id="a9436-176">Cuando SQL Server realiza la ordenación para compilar índices con particiones, primero compila una tabla de orden para cada partición.</span><span class="sxs-lookup"><span data-stu-id="a9436-176">When SQL Server performs sorting to build partitioned indexes, it first builds one sort table for each partition.</span></span> <span data-ttu-id="a9436-177">A continuación, compila las tablas de orden en el grupo de archivos respectivo de cada partición o en `tempdb` si se ha especificado la opción de índice SORT_IN_TEMPDB.</span><span class="sxs-lookup"><span data-stu-id="a9436-177">It then builds the sort tables either in the respective filegroup of each partition or in `tempdb`, if the SORT_IN_TEMPDB index option is specified.</span></span> <span data-ttu-id="a9436-178">Cada tabla de orden requiere una cantidad mínima de memoria para su compilación.</span><span class="sxs-lookup"><span data-stu-id="a9436-178">Each sort table requires a minimum amount of memory to build.</span></span> <span data-ttu-id="a9436-179">Cuando crea un índice con particiones que está alineado con su tabla base, las tablas de orden se crean de una en una con menos memoria.</span><span class="sxs-lookup"><span data-stu-id="a9436-179">When you are building a partitioned index that is aligned with its base table, sort tables are built one at a time, using less memory.</span></span> <span data-ttu-id="a9436-180">Sin embargo, cuando crea un índice con particiones no alineado, las tablas de orden se crean al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="a9436-180">However, when you are building a nonaligned partitioned index, the sort tables are built at the same time.</span></span> <span data-ttu-id="a9436-181">En consecuencia, debe haber disponible memoria suficiente para permitir la realización de estas ordenaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="a9436-181">As a result, there must be sufficient memory to handle these concurrent sorts.</span></span> <span data-ttu-id="a9436-182">Cuanto mayor es el número de particiones, mayor es la cantidad de memoria necesaria.</span><span class="sxs-lookup"><span data-stu-id="a9436-182">The larger the number of partitions, the more memory required.</span></span> <span data-ttu-id="a9436-183">El tamaño mínimo para cada tabla de orden y para cada partición es de 40 páginas y 8 kilobytes por página.</span><span class="sxs-lookup"><span data-stu-id="a9436-183">The minimum size for each sort table, for each partition, is 40 pages, with 8 kilobytes per page.</span></span> <span data-ttu-id="a9436-184">Por ejemplo, un índice con particiones no alineado con 100 particiones necesita memoria suficiente para ordenar en serie 4.000 (40 \* 100) páginas al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="a9436-184">For example, a nonaligned partitioned index with 100 partitions requires sufficient memory to serially sort 4,000 (40 \* 100) pages at the same time.</span></span> <span data-ttu-id="a9436-185">Si esta memoria está disponible, la operación de creación será satisfactoria, aunque ello afectará negativamente al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a9436-185">If this memory is available, the build operation will succeed, but performance may suffer.</span></span> <span data-ttu-id="a9436-186">Si esta memoria no está disponible, se producirá un error durante la operación de creación.</span><span class="sxs-lookup"><span data-stu-id="a9436-186">If this memory is not available, the build operation will fail.</span></span> <span data-ttu-id="a9436-187">De forma alternativa, un índice con particiones alineado con 100 particiones solo necesita memoria suficiente para ordenar 40 páginas, ya que las ordenaciones no se realizan al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="a9436-187">Alternatively, an aligned partitioned index with 100 partitions requires only sufficient memory to sort 40 pages, because the sorts are not performed at the same time.</span></span>  
  
 <span data-ttu-id="a9436-188">Tanto para los índices alineados como para los no alineados, el requisito de memoria puede ser mayor si SQL Server está aplicando grados de paralelismo a la operación de compilación en un equipo con varios procesadores.</span><span class="sxs-lookup"><span data-stu-id="a9436-188">For both aligned and nonaligned indexes, the memory requirement can be greater if SQL Server is applying degrees of parallelism to the build operation on a multiprocessor computer.</span></span> <span data-ttu-id="a9436-189">Esto es así porque cuanto mayores son los grados de paralelismo, mayor es también el requisito de memoria.</span><span class="sxs-lookup"><span data-stu-id="a9436-189">This is because the greater the degrees of parallelism, the greater the memory requirement.</span></span> <span data-ttu-id="a9436-190">Por ejemplo, si SQL Server establece los grados de paralelismo en 4, un índice no alineado con 100 particiones necesitará memoria suficiente para que cuatro procesadores puedan ordenar 4.000 páginas al mismo tiempo o 16.000 páginas.</span><span class="sxs-lookup"><span data-stu-id="a9436-190">For example, if SQL Server sets degrees of parallelism to 4, a nonaligned partitioned index with 100 partitions requires sufficient memory for four processors to sort 4,000 pages at the same time, or 16,000 pages.</span></span> <span data-ttu-id="a9436-191">Si el índice con particiones está alineado, el requisito de memoria se reduce a cuatro procesadores que ordenan 40 páginas o 160 (4 \* 40) páginas.</span><span class="sxs-lookup"><span data-stu-id="a9436-191">If the partitioned index is aligned, the memory requirement is reduced to four processors sorting 40 pages, or 160 (4 \* 40) pages.</span></span> <span data-ttu-id="a9436-192">Puede usar la opción de índice MAXDOP para reducir manualmente los grados de paralelismo.</span><span class="sxs-lookup"><span data-stu-id="a9436-192">You can use the MAXDOP index option to manually reduce the degrees of parallelism.</span></span>  
  
### <a name="dbcc-commands"></a><span data-ttu-id="a9436-193">Comandos DBCC</span><span class="sxs-lookup"><span data-stu-id="a9436-193">DBCC Commands</span></span>  
 <span data-ttu-id="a9436-194">Con un número de particiones mayor, los comandos DBCC pueden tardar más tiempo en ejecutarse cuando el número de particiones aumenta.</span><span class="sxs-lookup"><span data-stu-id="a9436-194">With a larger number of partitions, DBCC commands could take longer to execute as the number of partitions increases.</span></span>  
  
### <a name="queries"></a><span data-ttu-id="a9436-195">Consultas</span><span class="sxs-lookup"><span data-stu-id="a9436-195">Queries</span></span>  
 <span data-ttu-id="a9436-196">Las consultas en que se usa la eliminación de particiones podrían tener un rendimiento comparable o mejorado con un número de particiones mayor.</span><span class="sxs-lookup"><span data-stu-id="a9436-196">Queries that use partition elimination could have comparable or improved performance with larger number of partitions.</span></span> <span data-ttu-id="a9436-197">Las consultas que no usan eliminación de particiones podrían tardar más tiempo en ejecutarse cuando el número de particiones aumenta.</span><span class="sxs-lookup"><span data-stu-id="a9436-197">Queries that do not use partition elimination could take longer to execute as the number of partitions increases.</span></span>  
  
 <span data-ttu-id="a9436-198">Por ejemplo, suponga que una tabla tiene 100 millones de filas y columnas `A`, `B`y `C`.</span><span class="sxs-lookup"><span data-stu-id="a9436-198">For example, assume a table has 100 million rows and columns `A`, `B`, and `C`.</span></span> <span data-ttu-id="a9436-199">En el escenario 1, la tabla se divide en 1000 particiones en la columna `A`.</span><span class="sxs-lookup"><span data-stu-id="a9436-199">In scenario 1, the table is divided into 1000 partitions on column `A`.</span></span> <span data-ttu-id="a9436-200">En el escenario 2, la tabla se dividen en 10.000 particiones en la columna `A`.</span><span class="sxs-lookup"><span data-stu-id="a9436-200">In scenario 2, the table is divided into 10,000 partitions on column `A`.</span></span> <span data-ttu-id="a9436-201">Una consulta en la tabla que contiene una filtrado de cláusula WHERE en la columna `A` realizará la eliminación de la partición y examinará una partición.</span><span class="sxs-lookup"><span data-stu-id="a9436-201">A query on the table that has a WHERE clause filtering on column `A` will perform partition elimination and scan one partition.</span></span> <span data-ttu-id="a9436-202">La misma consulta puede ejecutarse con mayor rapidez en el escenario 2 al haber menos filas para examinar en una partición.</span><span class="sxs-lookup"><span data-stu-id="a9436-202">That same query may run faster in scenario 2 as there are fewer rows to scan in a partition.</span></span> <span data-ttu-id="a9436-203">Una consulta que tiene una cláusula de filtrado WHERE en la columna B examina todas las particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-203">A query that has a WHERE clause filtering on column B will scan all partitions.</span></span> <span data-ttu-id="a9436-204">La consulta puede ejecutarse con mayor rapidez en el escenario 1 que en el escenario 2 ya que hay menos particiones para examinar.</span><span class="sxs-lookup"><span data-stu-id="a9436-204">The query may run faster in scenario 1 than in scenario 2 as there are fewer partitions to scan.</span></span>  
  
 <span data-ttu-id="a9436-205">Las consultas que usan operadores como TOP o MAX/MIN en columnas distintas de la columna de partición pueden experimentar un menor rendimiento con las particiones porque se deben evaluar todas las particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-205">Queries that use operators such as TOP or MAX/MIN on columns other than the partitioning column may experience reduced performance with partitioning because all partitions must be evaluated.</span></span>  
  
## <a name="behavior-changes-in-statistics-computation-during-partitioned-index-operations"></a><span data-ttu-id="a9436-206">Cambios de comportamiento en el cálculo de estadísticas durante operaciones con particiones de índice</span><span class="sxs-lookup"><span data-stu-id="a9436-206">Behavior Changes in Statistics Computation During Partitioned Index Operations</span></span>  
 <span data-ttu-id="a9436-207">A partir de [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], las estadísticas no se crean examinando todas las filas de la tabla cuando se crea o se vuelve a generar un índice con particiones.</span><span class="sxs-lookup"><span data-stu-id="a9436-207">Beginning with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], statistics are not created by scanning all the rows in the table when a partitioned index is created or rebuilt.</span></span> <span data-ttu-id="a9436-208">En su lugar, el optimizador de consultas usa el algoritmo de muestreo predeterminado para generar estadísticas.</span><span class="sxs-lookup"><span data-stu-id="a9436-208">Instead, the query optimizer uses the default sampling algorithm to generate statistics.</span></span> <span data-ttu-id="a9436-209">Después de actualizar una base de datos con índices con particiones, puede observar una diferencia en los datos del histograma para estos índices.</span><span class="sxs-lookup"><span data-stu-id="a9436-209">After upgrading a database with partitioned indexes, you may notice a difference in the histogram data for these indexes.</span></span> <span data-ttu-id="a9436-210">Este cambio de comportamiento puede no afectar al rendimiento de las consultas.</span><span class="sxs-lookup"><span data-stu-id="a9436-210">This change in behavior may not affect query performance.</span></span> <span data-ttu-id="a9436-211">Para obtener estadísticas sobre índices con particiones examinando todas las filas de la tabla, use CREATE STATISTICS o UPDATE STATISTICS con la cláusula FULLSCAN.</span><span class="sxs-lookup"><span data-stu-id="a9436-211">To obtain statistics on partitioned indexes by scanning all the rows in the table, use CREATE STATISTICS or UPDATE STATISTICS with the FULLSCAN clause.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="a9436-212">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="a9436-212">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="a9436-213">**Tareas**</span><span class="sxs-lookup"><span data-stu-id="a9436-213">**Tasks**</span></span>|<span data-ttu-id="a9436-214">**Tema.**</span><span class="sxs-lookup"><span data-stu-id="a9436-214">**Topic**</span></span>|  
|<span data-ttu-id="a9436-215">Describe cómo crear funciones de partición y esquemas de partición y cómo aplicarlos a una tabla o índice.</span><span class="sxs-lookup"><span data-stu-id="a9436-215">Describes how to create partition functions and partition schemes and then apply these to a table and index.</span></span>|[<span data-ttu-id="a9436-216">Crear tablas e índices con particiones</span><span class="sxs-lookup"><span data-stu-id="a9436-216">Create Partitioned Tables and Indexes</span></span>](create-partitioned-tables-and-indexes.md)|  
|||  
  
## <a name="related-content"></a><span data-ttu-id="a9436-217">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="a9436-217">Related Content</span></span>  
 <span data-ttu-id="a9436-218">Puede encontrar las siguientes notas del producto en la tabla con particiones y estrategias e implementaciones de índices útiles.</span><span class="sxs-lookup"><span data-stu-id="a9436-218">You may find the following white papers on partitioned table and index strategies and implementations useful.</span></span>  
  
-   <span data-ttu-id="a9436-219">[Estrategias de la tabla con particiones e índices con SQL Server 2008](https://msdn.microsoft.com/library/dd578580\(SQL.100\).aspx)</span><span class="sxs-lookup"><span data-stu-id="a9436-219">[Partitioned Table and Index Strategies Using SQL Server 2008](https://msdn.microsoft.com/library/dd578580\(SQL.100\).aspx)</span></span>  
  
-   <span data-ttu-id="a9436-220">[Cómo implementar una ventana automática deslizante](https://msdn.microsoft.com/library/aa964122\(SQL.90\).aspx)</span><span class="sxs-lookup"><span data-stu-id="a9436-220">[How to Implement an Automatic Sliding Window](https://msdn.microsoft.com/library/aa964122\(SQL.90\).aspx)</span></span>  
  
-   [<span data-ttu-id="a9436-221">Carga masiva en una tabla con particiones</span><span class="sxs-lookup"><span data-stu-id="a9436-221">Bulk Loading into a Partitioned Table</span></span>](https://msdn.microsoft.com/library/cc966380.aspx)  
  
-   [<span data-ttu-id="a9436-222">Mejoras de procesamiento de consultas en las tablas e índices con particiones</span><span class="sxs-lookup"><span data-stu-id="a9436-222">Query Processing Enhancements on Partitioned Tables and Indexes</span></span>](https://msdn.microsoft.com/library/ms345599.aspx)  
  
-   [<span data-ttu-id="a9436-223">Los 10 mejores procedimientos recomendados para compilar un almacén de datos relacionales a gran escala</span><span class="sxs-lookup"><span data-stu-id="a9436-223">Top 10 Best Practices for Building a Large Scale Relational Data Warehouse</span></span>](http://sqlcat.com/top10lists/archive/2008/02/06/top-10-best-practices-for-building-a-large-scale-relational-data-warehouse.aspx)  
  
  
