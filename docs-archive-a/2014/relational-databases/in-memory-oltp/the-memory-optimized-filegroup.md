---
title: El grupo de archivos con optimización para memoria | Microsoft Docs
ms.custom: ''
ms.date: 11/19/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: 14106cc9-816b-493a-bcb9-fe66a1cd4630
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: a4ab6423159d0ba5a27af152cc5578905f57eec6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87677101"
---
# <a name="the-memory-optimized-filegroup"></a><span data-ttu-id="2df46-102">El grupo de archivos con optimización para memoria</span><span class="sxs-lookup"><span data-stu-id="2df46-102">The Memory Optimized Filegroup</span></span>
  <span data-ttu-id="2df46-103">Para crear tablas optimizadas para memoria, primero debe crear un grupo de archivos optimizados para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-103">To create memory-optimized tables, you must first create a memory-optimized filegroup.</span></span> <span data-ttu-id="2df46-104">El grupo de archivos optimizados para memoria contiene uno o varios contenedores.</span><span class="sxs-lookup"><span data-stu-id="2df46-104">The memory-optimized filegroup holds one or more containers.</span></span> <span data-ttu-id="2df46-105">Cada contenedor contiene archivos de datos, archivos delta o ambos tipos de archivos.</span><span class="sxs-lookup"><span data-stu-id="2df46-105">Each container contains data files or delta files or both.</span></span>  
  
 <span data-ttu-id="2df46-106">Aunque las filas de datos de las tablas `SCHEMA_ONLY` no se conservan y los metadatos de las tablas optimizadas para memoria y los procedimientos almacenados compilados de forma nativa se almacenan en los catálogos tradicionales, el motor de [!INCLUDE[hek_2](../../includes/hek-2-md.md)] todavía requiere un grupo de archivos optimizados para memoria para que las tablas `SCHEMA_ONLY` optimizadas para memoria proporcionen una experiencia uniforme para las bases de datos con tablas optimizadas para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-106">Even though data rows from `SCHEMA_ONLY` tables are not persisted and the metadata for memory-optimized tables and natively compiled stored procedures is stored in the traditional catalogs, the [!INCLUDE[hek_2](../../includes/hek-2-md.md)] engine still requires a memory-optimized filegroup for `SCHEMA_ONLY` memory-optimized tables to provide a uniform experience for databases with memory-optimized tables.</span></span>  
  
 <span data-ttu-id="2df46-107">El grupo de archivos optimizados para memoria se basa en el grupo de archivos de FILESTREAM, con las diferencias siguientes:</span><span class="sxs-lookup"><span data-stu-id="2df46-107">The memory-optimized filegroup is based on filestream filegroup, with the following differences:</span></span>  
  
-   <span data-ttu-id="2df46-108">Solo puede crear un grupo de archivos optimizados para memoria por cada base de datos.</span><span class="sxs-lookup"><span data-stu-id="2df46-108">You can only create one memory-optimized filegroup per database.</span></span> <span data-ttu-id="2df46-109">Debe marcarse explícitamente el grupo de archivos como que contiene memory_optimized_data.</span><span class="sxs-lookup"><span data-stu-id="2df46-109">You need to explicitly mark the filegroup as containing memory_optimized_data.</span></span> <span data-ttu-id="2df46-110">Puede crear el grupo de archivos al crear la base de datos o puede agregarlo posteriormente:</span><span class="sxs-lookup"><span data-stu-id="2df46-110">You can create the filegroup when you create the database or you can add it later:</span></span>  
  
    ```sql  
    ALTER DATABASE imoltp ADD FILEGROUP imoltp_mod CONTAINS MEMORY_OPTIMIZED_DATA  
    ```  
  
-   <span data-ttu-id="2df46-111">Es necesario agregar uno o varios contenedores al grupo de archivos MEMORY_OPTIMIZED_DATA.</span><span class="sxs-lookup"><span data-stu-id="2df46-111">You need to add one or more containers to the MEMORY_OPTIMIZED_DATA filegroup.</span></span> <span data-ttu-id="2df46-112">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="2df46-112">For example:</span></span>  
  
    ```sql  
    ALTER DATABASE imoltp ADD FILE (name='imoltp_mod1', filename='c:\data\imoltp_mod1') TO FILEGROUP imoltp_mod  
    ```  
  
-   <span data-ttu-id="2df46-113">No es necesario habilitar la secuencia de archivos ([Habilitar y configurar FILESTREAM](../blob/enable-and-configure-filestream.md)) para crear un grupo de archivos optimizados para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-113">You do not need to enable filestream ([Enable and Configure FILESTREAM](../blob/enable-and-configure-filestream.md)) to create a memory-optimized filegroup.</span></span> <span data-ttu-id="2df46-114">La asignación a la secuencia de archivos la realiza el motor de [!INCLUDE[hek_2](../../includes/hek-2-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2df46-114">The mapping to filestream is done by the [!INCLUDE[hek_2](../../includes/hek-2-md.md)] engine.</span></span>  
  
-   <span data-ttu-id="2df46-115">Puede agregar nuevos contenedores a un grupo de archivos optimizados para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-115">You can add new containers to a memory-optimized filegroup.</span></span> <span data-ttu-id="2df46-116">Es posible que necesite un nuevo contenedor para expandir el almacenamiento necesario para la tabla optimizada para memoria perdurable y también para distribuir la e/s entre varios contenedores.</span><span class="sxs-lookup"><span data-stu-id="2df46-116">You may need a new container to expand the storage needed for durable memory-optimized table and also to distribute I/O across multiple containers.</span></span>  
  
-   <span data-ttu-id="2df46-117">El movimiento de datos con un grupo de archivos optimizados para memoria se optimiza en una configuración de grupo de disponibilidad AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="2df46-117">Data movement with a memory-optimized filegroup is optimized in an AlwaysOn Availability Group configuration.</span></span> <span data-ttu-id="2df46-118">A diferencia de los archivos de FILESTREAM que se envían a las réplicas secundarias, los archivos de punto de comprobación (de datos y delta) del grupo de archivos optimizados para memoria no se envían a las réplicas secundarias.</span><span class="sxs-lookup"><span data-stu-id="2df46-118">Unlike filestream files that are sent to secondary replicas, the checkpoint files (both data and delta) within the memory-optimized filegroup are not sent to secondary replicas.</span></span> <span data-ttu-id="2df46-119">Los archivos de datos y delta se crean mediante el registro de transacciones la réplica secundaria.</span><span class="sxs-lookup"><span data-stu-id="2df46-119">The data and delta files are constructed using the transaction log on the secondary replica.</span></span>  
  
<span data-ttu-id="2df46-120">A continuación se indican las limitaciones del grupo de archivos optimizados para memoria:</span><span class="sxs-lookup"><span data-stu-id="2df46-120">The following limitations of memory-optimized filegroup,</span></span>  
  
-   <span data-ttu-id="2df46-121">Una vez que crea un grupo de archivos optimizados para memoria, solo puede quitarlo si quita la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2df46-121">Once you create a memory-optimized filegroup, you can only remove it by dropping the database.</span></span> <span data-ttu-id="2df46-122">En un entorno de producción, no es probable que necesite quitar el grupo de archivos optimizados para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-122">In a production environment, it is unlikely that you will need to remove the memory-optimized filegroup.</span></span>  
  
-   <span data-ttu-id="2df46-123">No puede quitar un contenedor que no esté vacío ni mover pares de archivos de datos y delta a otro contenedor en el grupo de archivos optimizados para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-123">You cannot drop a non-empty container or move data and delta file pairs to another container in the memory-optimized filegroup.</span></span>  
  
## <a name="configuring-a-memory-optimized-filegroup"></a><span data-ttu-id="2df46-124">Configurar un grupo de archivos con optimización para memoria</span><span class="sxs-lookup"><span data-stu-id="2df46-124">Configuring a Memory-Optimized Filegroup</span></span>  
<span data-ttu-id="2df46-125">Considere la posibilidad de crear varios contenedores en el mismo grupo de archivos optimizados para memoria y distribuirlos en otras unidades para lograr más ancho de banda para transmitir los datos en memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-125">Consider creating multiple containers in the memory-optimized filegroup and distribute them on different drives to achieve more bandwidth to stream the data into memory.</span></span>  
  
<span data-ttu-id="2df46-126">Al configurar el almacenamiento, debe proporcionar una cantidad de espacio en disco disponible que sea cuatro veces el tamaño de tablas durables optimizadas para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-126">When configuring storage, you must provide free disk space that is four times the size of durable memory-optimized tables.</span></span> <span data-ttu-id="2df46-127">Asegúrese de que el subsistema de e/s admite los IOPS necesarios para la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2df46-127">Ensure that your I/O subsystem supports the required IOPS for your workload.</span></span> <span data-ttu-id="2df46-128">Si los pares de archivos de datos y delta se rellenan en las IOPS especificadas, necesita el triple de esas IOPS para dar cabida a las operaciones de almacenamiento y combinación.</span><span class="sxs-lookup"><span data-stu-id="2df46-128">If data and delta file pairs are populated at a given IOPS, you need three times that IOPS to account for storing and merge operations.</span></span> <span data-ttu-id="2df46-129">Puede agregar capacidad de almacenamiento e IOPS si agrega uno o varios contenedores al grupo de archivos optimizados para memoria.</span><span class="sxs-lookup"><span data-stu-id="2df46-129">You can add storage capacity and IOPS by adding one or more containers to the memory-optimized filegroup.</span></span>  
  
<span data-ttu-id="2df46-130">En un escenario de varios contenedores y varias unidades, los archivos de datos y delta se asignan por turnos (round robin) en los contenedores.</span><span class="sxs-lookup"><span data-stu-id="2df46-130">In a multiple container, multiple drive scenario, data and delta files are allocated in a round-robin fashion into containers.</span></span> <span data-ttu-id="2df46-131">El primer archivo de datos se asigna al primer contenedor y el archivo delta se asigna desde el siguiente contenedor, y este modelo de asignación se repite.</span><span class="sxs-lookup"><span data-stu-id="2df46-131">The first data file is allocated from the first container and the delta file is allocated from the next container and this allocation pattern repeats.</span></span> <span data-ttu-id="2df46-132">Este esquema de asignación distribuye uniformemente los archivos de datos y delta entre los contenedores si tiene un número impar de unidades, cada una de ellas asignada a un contenedor.</span><span class="sxs-lookup"><span data-stu-id="2df46-132">This allocation scheme distributes data and delta files evenly across containers if you have an odd number of drives, each mapped to one container.</span></span> <span data-ttu-id="2df46-133">Sin embargo, si tiene un número par de unidades, cada una de ellas asignada a un contenedor, puede provocar un almacenamiento desequilibrado donde los archivos de datos se asignan a las unidades impares y los archivos delta se asignan a las unidades pares.</span><span class="sxs-lookup"><span data-stu-id="2df46-133">However, if you have an even number of drives, each mapped to a container, it can result in imbalanced storage with data files mapped to odd drives and delta files mapped to even drives.</span></span> <span data-ttu-id="2df46-134">Para obtener un flujo equilibrado de e/s en la recuperación, considere la posibilidad de colocar pares de archivos Delta y de datos en los mismos ejes y almacenamiento tal y como se describe en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="2df46-134">To obtain a balanced stream of I/O on recovery, consider placing pairs of data and delta files on the same spindles/storage as described in the example below.</span></span>  

> [!CAUTION]
> <span data-ttu-id="2df46-135">Si se establece un valor `MAXSIZE` para el grupo de archivos optimizados para memoria y los archivos de punto de control superan el tamaño máximo del contenedor, la base de datos se convertirá en SUSPECT.</span><span class="sxs-lookup"><span data-stu-id="2df46-135">If a `MAXSIZE` value is set for the memory-optimized filegroup, and checkpoint files exceed the max size of the container, then the database will become SUSPECT.</span></span>   
> <span data-ttu-id="2df46-136">En este caso no intente establecer la base de datos OFFLINE y ONLINE, lo que haría que permaneciera en un estado RECOVERY_PENDING.</span><span class="sxs-lookup"><span data-stu-id="2df46-136">In this case do not attempt to set the database OFFLINE and ONLINE, causing the database to stay in RECOVERY_PENDING state.</span></span>
  
### <a name="example"></a><span data-ttu-id="2df46-137">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="2df46-137">Example</span></span> 
<span data-ttu-id="2df46-138">Considere un grupo de archivos optimizados para memoria con dos contenedores: el contenedor 1 en la unidad X y el contenedor 2 en las unidades Y.</span><span class="sxs-lookup"><span data-stu-id="2df46-138">Consider a memory-optimized filegroup with two containers: container 1 on drive X and container 2 on drives Y.</span></span>  
<span data-ttu-id="2df46-139">Puesto que la asignación de archivos de datos y delta se hace de modo round robin, el contenedor 1 solamente tendrá archivos de datos y el contenedor 2 solamente tendrá archivos delta, lo que produce un desequilibrio en las operaciones de almacenamiento y entrada/salida por segundo; además, los archivos de datos son mucho mayores que los archivos delta.</span><span class="sxs-lookup"><span data-stu-id="2df46-139">Since the allocation of data and delta files is done in round-robin fashion, container 1 will only have data files and container 2 will only have delta files, which leads to imbalanced persistence for storage as well as input/output operations per second, as data files are significantly larger than the delta files.</span></span>    
<span data-ttu-id="2df46-140">Para distribuir uniformemente los archivos Delta y de datos entre las unidades X e y, cree cuatro contenedores en lugar de dos, y asigne los dos primeros contenedores a la unidad X y los dos contenedores siguientes a la unidad Y.</span><span class="sxs-lookup"><span data-stu-id="2df46-140">To distribute data and delta files uniformly across drives X and Y, create four containers instead of two, and map the first two containers to drive X and the next two containers to drive Y.</span></span>  
<span data-ttu-id="2df46-141">Con la asignación Round Robin, el primer archivo de datos y el primer archivo Delta se asignarán desde el contenedor 1 y el contenedor 2, respectivamente, que se asignan a la unidad X.</span><span class="sxs-lookup"><span data-stu-id="2df46-141">With round-robin allocation, the first data and first delta file will be allocated from container-1 and container-2 respectively, which are mapped to drive X.</span></span>   
<span data-ttu-id="2df46-142">Del mismo modo, el siguiente archivo de datos y delta se asignarán desde el contenedor 3 y el contenedor 4, que están asignados a la unidad Y. Esto permite distribuir uniformemente los archivos Delta y de datos entre dos unidades.</span><span class="sxs-lookup"><span data-stu-id="2df46-142">Similarly, the next data and delta file will be allocated from container-3 and container-4 which are mapped to drive Y. This allows distributing data and delta files across two drives uniformly.</span></span>  
 
  
## <a name="see-also"></a><span data-ttu-id="2df46-143">Consulte también</span><span class="sxs-lookup"><span data-stu-id="2df46-143">See Also</span></span>  
<span data-ttu-id="2df46-144">[Creación y administración del almacenamiento de objetos con optimización para memoria](creating-and-managing-storage-for-memory-optimized-objects.md)   </span><span class="sxs-lookup"><span data-stu-id="2df46-144">[Creating and Managing Storage for Memory-Optimized Objects](creating-and-managing-storage-for-memory-optimized-objects.md)   </span></span>  
[<span data-ttu-id="2df46-145">Archivos y grupos de archivos de base de datos</span><span class="sxs-lookup"><span data-stu-id="2df46-145">Database Files and Filegroups</span></span>](../../relational-databases/databases/database-files-and-filegroups.md)    
  
