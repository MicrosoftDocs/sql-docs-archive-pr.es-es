---
title: Ejecución directa | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, statements
- direct execution [ODBC]
- SQLExecDirect function
- statements [ODBC], direct execution
ms.assetid: fa36e1af-ed98-4abc-97c1-c4cc5d227b29
author: rothja
ms.author: jroth
ms.openlocfilehash: 29153f3e4e9265e87feb0e23ba9ae97118691e95
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87662877"
---
# <a name="direct-execution"></a><span data-ttu-id="1e4e1-102">Ejecución directa</span><span class="sxs-lookup"><span data-stu-id="1e4e1-102">Direct Execution</span></span>
  <span data-ttu-id="1e4e1-103">La ejecución directa es la manera más sencilla de ejecutar una instrucción.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-103">Direct execution is the most basic way to execute a statement.</span></span> <span data-ttu-id="1e4e1-104">Una aplicación genera una cadena de caracteres que contiene una [!INCLUDE[tsql](../../../includes/tsql-md.md)] instrucción y la envía para su ejecución mediante la función **SQLExecDirect** .</span><span class="sxs-lookup"><span data-stu-id="1e4e1-104">An application builds a character string containing a [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement and submits it for execution using the **SQLExecDirect** function.</span></span> <span data-ttu-id="1e4e1-105">Cuando la instrucción llega al servidor, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] la compila en un plan de ejecución y ejecuta inmediatamente el plan de ejecución.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-105">When the statement reaches the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] compiles it into an execution plan and then immediately runs the execution plan.</span></span>  
  
 <span data-ttu-id="1e4e1-106">La ejecución directa se utiliza habitualmente en las aplicaciones que generan y ejecutan instrucciones en tiempo de ejecución y es el método más eficaz para las instrucciones que se van a ejecutar una sola vez.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-106">Direct execution is commonly used by applications that build and execute statements at run time and is the most efficient method for statements that will be executed a single time.</span></span> <span data-ttu-id="1e4e1-107">El inconveniente cuando se utiliza la ejecución directa con muchas bases de datos es que la instrucción SQL se debe analizar y compilar cada vez que se ejecuta, lo que supone una sobrecarga si la instrucción se ejecuta varias veces.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-107">Its drawback with many databases is that the SQL statement must be parsed and compiled each time it is executed, which adds overhead if the statement is executed multiple times.</span></span>  
  
 <span data-ttu-id="1e4e1-108">En [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] se ha mejorado considerablemente el rendimiento de la ejecución directa en instrucciones ejecutadas habitualmente en entornos multiusuario, y el uso de SQLExecDirect con marcadores de parámetros para las instrucciones SQL ejecutadas habitualmente es prácticamente tan eficaz como el de la ejecución preparada.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] significantly improves the performance of direct execution of commonly executed statements in multiuser environments and using SQLExecDirect with parameter markers for commonly executed SQL statements can approach the efficiency of prepared execution.</span></span>  
  
 <span data-ttu-id="1e4e1-109">Cuando se conecta a una instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , el [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] controlador ODBC de Native Client utiliza [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) para transmitir la instrucción SQL o el lote especificado en **SQLExecDirect**.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-109">When connected to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver uses [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) to transmit the SQL statement or batch specified on **SQLExecDirect**.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="1e4e1-110">tiene lógica para determinar rápidamente si una instrucción SQL o un lote ejecutado con **sp_executesql** coincide con la instrucción o lote que generó un plan de ejecución que ya existe en la memoria.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-110">has logic to quickly determine if an SQL statement or batch executed with **sp_executesql** matches the statement or batch that generated an execution plan that already exists in memory.</span></span> <span data-ttu-id="1e4e1-111">Si se encuentra una coincidencia, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] simplemente reutiliza el plan existente en lugar de compilar un nuevo plan.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-111">If a match is made, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] simply reuses the existing plan rather than compile a new plan.</span></span> <span data-ttu-id="1e4e1-112">Esto significa que las instrucciones SQL ejecutadas habitualmente con **SQLExecDirect** en un sistema con muchos usuarios se beneficiarán de muchas de las ventajas de la reutilización de planes que solo estaban disponibles para los procedimientos almacenados de versiones anteriores de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1e4e1-112">This means that commonly executed SQL statements executed with **SQLExecDirect** in a system with many users will benefit from many of the plan-reuse benefits that were only available to stored procedures in earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="1e4e1-113">Esta ventaja de reutilización de los planes de ejecución solo funciona cuando varios usuarios ejecutan la misma instrucción o lote de instrucciones SQL.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-113">This benefit of reusing execution plans only works when several users are executing the same SQL statement or batch.</span></span> <span data-ttu-id="1e4e1-114">Siga estas convenciones de codificación para aumentar la probabilidad de que las instrucciones SQL ejecutadas por clientes diferentes sean lo suficientemente similares para poder reutilizar planes de ejecución:</span><span class="sxs-lookup"><span data-stu-id="1e4e1-114">Follow these coding conventions to increase the probability that the SQL statements executed by different clients are similar enough to be able to reuse execution plans:</span></span>  
  
-   <span data-ttu-id="1e4e1-115">No incluya constantes de datos en las instrucciones SQL; utilice en su lugar marcadores de parámetros enlazados a variables del programa.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-115">Do not include data constants in the SQL statements; instead use parameter markers bound to program variables.</span></span> <span data-ttu-id="1e4e1-116">Para obtener más información, vea [using Statement Parameters](../using-statement-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="1e4e1-116">For more information, see [Using Statement Parameters](../using-statement-parameters.md).</span></span>  
  
-   <span data-ttu-id="1e4e1-117">Utilice nombres de objeto completos.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-117">Use fully qualified object names.</span></span> <span data-ttu-id="1e4e1-118">Los planes de ejecución no se reutilizan si los nombres de objeto no son completos.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-118">Execution plans are not reused if object names are not qualified.</span></span>  
  
-   <span data-ttu-id="1e4e1-119">Haga que las conexiones de la aplicación utilicen siempre que sea posible un conjunto común de opciones de conexión e instrucción.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-119">Have application connections as possible use a common set of connection and statement options.</span></span> <span data-ttu-id="1e4e1-120">Los planes de ejecución generados para una conexión con un conjunto de opciones (como ANSI_NULLS) no se reutilizan para una conexión que tiene otro conjunto de opciones.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-120">Execution plans generated for a connection with one set of options (such as ANSI_NULLS) are not reused for a connection having another set of options.</span></span> <span data-ttu-id="1e4e1-121">El proveedor ODBC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client y el proveedor OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client proporcionan la misma configuración predeterminada para estas opciones.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-121">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider both have the same default settings for these options.</span></span>  
  
 <span data-ttu-id="1e4e1-122">Si todas las instrucciones ejecutadas con **SQLExecDirect** se codifican utilizando estas convenciones, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] puede reutilizar los planes de ejecución cuando surja la oportunidad.</span><span class="sxs-lookup"><span data-stu-id="1e4e1-122">If all statements executed with **SQLExecDirect** are coded using these conventions, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can reuse execution plans when the opportunity arises.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1e4e1-123">Consulte también</span><span class="sxs-lookup"><span data-stu-id="1e4e1-123">See Also</span></span>  
 [<span data-ttu-id="1e4e1-124">Ejecutar instrucciones &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="1e4e1-124">Executing Statements &#40;ODBC&#41;</span></span>](executing-statements-odbc.md)  
  
  
