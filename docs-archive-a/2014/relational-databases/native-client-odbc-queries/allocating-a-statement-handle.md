---
title: Asignar un identificador de instrucción | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQLSetStmtAttr function
- statements [ODBC], statement handles
- ODBC applications, executing queries
- SQLGetStmtAttr function
- SQL Server Native Client ODBC driver, statements
- allocating statement handles
- ODBC applications, statements
- statement handles [ODBC]
- SQLAllocHandle function
ms.assetid: 9ee207f3-2667-45f5-87ca-e6efa1fd7a5c
author: rothja
ms.author: jroth
ms.openlocfilehash: fac0802b474f38f6a6c314dd727fa335d14598d1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750882"
---
# <a name="allocating-a-statement-handle"></a><span data-ttu-id="85550-102">Asignar un identificador de instrucción</span><span class="sxs-lookup"><span data-stu-id="85550-102">Allocating a Statement Handle</span></span>
  <span data-ttu-id="85550-103">Antes de que una aplicación pueda ejecutar una instrucción, debe asignar un identificador de instrucción.</span><span class="sxs-lookup"><span data-stu-id="85550-103">Before an application can execute a statement, it must allocate a statement handle.</span></span> <span data-ttu-id="85550-104">Para ello, se llama a **SQLAllocHandle** con el parámetro *HandleType* establecido en SQL_HANDLE_STMT y *InputHandle* que apunta a un identificador de conexión.</span><span class="sxs-lookup"><span data-stu-id="85550-104">It does this by calling **SQLAllocHandle** with the *HandleType* parameter set to SQL_HANDLE_STMT and *InputHandle* pointing to a connection handle.</span></span>  
  
 <span data-ttu-id="85550-105">Los atributos de instrucción son características del identificador de instrucción.</span><span class="sxs-lookup"><span data-stu-id="85550-105">Statement attributes are characteristics of the statement handle.</span></span> <span data-ttu-id="85550-106">Los atributos de instrucción de ejemplo pueden incluir la utilización de marcadores y el tipo de cursor que se debe utilizar con el conjunto de resultados de la instrucción.</span><span class="sxs-lookup"><span data-stu-id="85550-106">Sample statement attributes can include using bookmarks and the kind of cursor to use with the statement's result set.</span></span> <span data-ttu-id="85550-107">Los atributos de instrucción se establecen con [SQLSetStmtAttr](../native-client-odbc-api/sqlsetstmtattr.md)y su configuración actual se recupera mediante [SQLGetStmtAttr](../native-client-odbc-api/sqlgetstmtattr.md).</span><span class="sxs-lookup"><span data-stu-id="85550-107">Statement attributes are set with [SQLSetStmtAttr](../native-client-odbc-api/sqlsetstmtattr.md), and their current settings are retrieved by using [SQLGetStmtAttr](../native-client-odbc-api/sqlgetstmtattr.md).</span></span> <span data-ttu-id="85550-108">No es necesario que una aplicación establezca atributos de instrucción; todos los atributos de instrucción tienen valores predeterminados y algunos son específicos de controlador.</span><span class="sxs-lookup"><span data-stu-id="85550-108">There is no requirement that an application set any statement attributes; all statement attributes have defaults, and some are driver specific.</span></span>  
  
 <span data-ttu-id="85550-109">Actúe con precaución al usar varias opciones de instrucción y conexión de ODBC.</span><span class="sxs-lookup"><span data-stu-id="85550-109">Use caution in the use of several ODBC statement and connection options.</span></span> <span data-ttu-id="85550-110">La llamada a [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md) con *fOption* establecido en SQL_ATTR_LOGIN_TIMEOUT controla el tiempo que una aplicación espera a que se agote el tiempo de espera de una conexión mientras se espera a establecer una conexión (0 especifica una espera infinita).</span><span class="sxs-lookup"><span data-stu-id="85550-110">Calling [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md) with *fOption* set to SQL_ATTR_LOGIN_TIMEOUT controls the time that an application waits for a connection attempt to time-out while waiting to establish a connection (0 specifies an infinite wait).</span></span> <span data-ttu-id="85550-111">Los sitios con tiempos de respuesta lentos pueden establecer este valor alto para asegurarse de que las conexiones disponen de tiempo suficiente para completarse.</span><span class="sxs-lookup"><span data-stu-id="85550-111">Sites that have slow response times can set this value high to make sure that connections have sufficient time to be completed.</span></span> <span data-ttu-id="85550-112">Sin embargo, el intervalo siempre debe ser lo suficientemente bajo como para proporcionar al usuario una respuesta en un tiempo razonable si el controlador no puede conectar.</span><span class="sxs-lookup"><span data-stu-id="85550-112">However, the interval should always be low enough to give the user a response in a reasonable time if the driver cannot connect.</span></span>  
  
 <span data-ttu-id="85550-113">La llamada a **SQLSetStmtAttr** con *fOption* establecido en SQL_ATTR_QUERY_TIMEOUT establece un intervalo de tiempo de espera de consulta para ayudar a proteger el servidor y el usuario de las consultas de ejecución prolongada.</span><span class="sxs-lookup"><span data-stu-id="85550-113">Calling **SQLSetStmtAttr** with *fOption* set to SQL_ATTR_QUERY_TIMEOUT sets a query time-out interval to help protect the server and the user from long-running queries.</span></span>  
  
 <span data-ttu-id="85550-114">La llamada a **SQLSetStmtAttr** con *fOption* establecido en SQL_ATTR_MAX_LENGTH limita la cantidad de datos de **texto** e **imagen** que puede recuperar una instrucción individual.</span><span class="sxs-lookup"><span data-stu-id="85550-114">Calling **SQLSetStmtAttr** with *fOption* set to SQL_ATTR_MAX_LENGTH limits the amount of **text** and **image** data that an individual statement can retrieve.</span></span> <span data-ttu-id="85550-115">La llamada a **SQLSetStmtAttr** con *fOption* establecido en SQL_ATTR_MAX_ROWS también limita un conjunto de filas a las primeras *n* filas si eso es todo lo que requiere la aplicación.</span><span class="sxs-lookup"><span data-stu-id="85550-115">Calling **SQLSetStmtAttr** with *fOption* set to SQL_ATTR_MAX_ROWS also limits a rowset to the first *n* rows if that is all the application requires.</span></span> <span data-ttu-id="85550-116">Observe que el valor SQL_ATTR_MAX_ROWS hace que el controlador emita una instrucción SET ROWCOUNT al servidor.</span><span class="sxs-lookup"><span data-stu-id="85550-116">Note that setting SQL_ATTR_MAX_ROWS causes the driver to issue a SET ROWCOUNT statement to the server.</span></span> <span data-ttu-id="85550-117">Esto afecta a todas las [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instrucciones, incluidos los desencadenadores y las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="85550-117">This affects all [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] statements, including triggers and updates.</span></span>  
  
 <span data-ttu-id="85550-118">Actúe con precaución cuando establezca estas opciones.</span><span class="sxs-lookup"><span data-stu-id="85550-118">Use caution when you are setting these options.</span></span> <span data-ttu-id="85550-119">Es preferible que todos los identificadores de instrucción de un identificador de conexión tengan la misma configuración en SQL_ATTR_MAX_LENGTH y SQL_ATTR_MAX_ROWS.</span><span class="sxs-lookup"><span data-stu-id="85550-119">It is best if all statement handles on a connection handle have the same settings for SQL_ATTR_MAX_LENGTH and SQL_ATTR_MAX_ROWS.</span></span> <span data-ttu-id="85550-120">Si el controlador cambia de un identificador de instrucción a otro con valores diferentes en estas opciones, debe generar las instrucciones SET TEXTSIZE y SET ROWCOUNT adecuadas para cambiar los valores.</span><span class="sxs-lookup"><span data-stu-id="85550-120">If the driver switches from a statement handle to another with different values for these options, the driver must generate the appropriate SET TEXTSIZE and SET ROWCOUNT statements to change the settings.</span></span> <span data-ttu-id="85550-121">El controlador no puede colocar estas instrucciones en el mismo lote que la instrucción SQL del usuario porque la instrucción SQL del usuario puede contener una instrucción que debe ser la primera de un lote.</span><span class="sxs-lookup"><span data-stu-id="85550-121">The driver cannot put these statements in the same batch as the user SQL statement because the user SQL statement can contain a statement that must be the first statement in a batch.</span></span> <span data-ttu-id="85550-122">El controlador debe enviar las instrucciones SET TEXTSIZE y SET ROWCOUNT en un lote independiente, que genera automáticamente un viaje de ida y vuelta (round trip) adicional al servidor.</span><span class="sxs-lookup"><span data-stu-id="85550-122">The driver must send the SET TEXTSIZE and SET ROWCOUNT statements in a separate batch, which automatically generates an additional roundtrip to the server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="85550-123">Consulte también</span><span class="sxs-lookup"><span data-stu-id="85550-123">See Also</span></span>  
 [<span data-ttu-id="85550-124">Ejecutar consultas &#40;&#41;ODBC</span><span class="sxs-lookup"><span data-stu-id="85550-124">Executing Queries &#40;ODBC&#41;</span></span>](executing-queries-odbc.md)  
  
  
