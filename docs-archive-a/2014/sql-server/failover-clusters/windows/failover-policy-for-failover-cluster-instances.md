---
title: Directiva de conmutación por error para instancias de clústeres de conmutación por error | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- flexible failover policy
ms.assetid: 39ceaac5-42fa-4b5d-bfb6-54403d7f0dc9
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8d441e5627280cb46168d9ff187d7f43da8b26a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672559"
---
# <a name="failover-policy-for-failover-cluster-instances"></a><span data-ttu-id="b471a-102">Directiva de conmutación por error para instancias de clústeres de conmutación por error</span><span class="sxs-lookup"><span data-stu-id="b471a-102">Failover Policy for Failover Cluster Instances</span></span>
  <span data-ttu-id="b471a-103">En una instancia de clúster de conmutación por error (FCI) de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , solo puede haber un nodo propietario del grupo de recursos de clúster de conmutación por error de Windows Server (WSFC) en cada momento.</span><span class="sxs-lookup"><span data-stu-id="b471a-103">In a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI), only one node can own the Windows Server Failover Cluster (WSFC) cluster resource group at a given time.</span></span> <span data-ttu-id="b471a-104">Las solicitudes del cliente se sirven a través de este nodo de la FCI.</span><span class="sxs-lookup"><span data-stu-id="b471a-104">The client requests are served through this node in the FCI.</span></span> <span data-ttu-id="b471a-105">En caso de que se produzca un error o un reinicio incorrecto, la propiedad del grupo se traslada a otro nodo de WSFC de la FCI.</span><span class="sxs-lookup"><span data-stu-id="b471a-105">In the case of a failure and an unsuccessful restart, the group ownership is moved to another WSFC node in the FCI.</span></span> <span data-ttu-id="b471a-106">Este proceso se denomina conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-106">This process is called failover.</span></span> [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="b471a-107">aumenta la confiabilidad de la detección de errores y proporciona una directiva de conmutación por error flexible.</span><span class="sxs-lookup"><span data-stu-id="b471a-107">increases the reliability of failure detection and provides a flexible failover policy.</span></span>  
  
 <span data-ttu-id="b471a-108">Una FCI de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] depende del servicio de WSFC subyacente para la detección de conmutaciones por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-108">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] FCI depends on the underlying WSFC service for failover detection.</span></span> <span data-ttu-id="b471a-109">Por tanto, son dos los mecanismos que determinan el comportamiento de conmutación por error de la FCI: el primero es la funcionalidad nativa de WSFC y el segundo es la funcionalidad agregada por la instalación de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b471a-109">Therefore, two mechanisms determine the failover behavior for FCI: the former is native WSFC functionality, and the latter is functionality added by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup.</span></span>  
  
-   <span data-ttu-id="b471a-110">El clúster de WSFC mantiene la configuración de quórum, lo que garantiza un destino único en caso de una conmutación automática por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-110">The WSFC cluster maintains the quorum configuration, which ensures a unique failover target in an automatic failover.</span></span> <span data-ttu-id="b471a-111">El servicio de WSFC determina si el clúster se encuentra en un estado de quórum óptimo en todo momento y conecta y desconecta el grupo de recursos según convenga.</span><span class="sxs-lookup"><span data-stu-id="b471a-111">The WSFC service determines whether the cluster is in optimal quorum health at all times and brings the resource group online and offline accordingly.</span></span>  
  
-   <span data-ttu-id="b471a-112">La instancia activa de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] notifica periódicamente al grupo de recursos de WSFC un conjunto de diagnósticos de componentes a través de una conexión dedicada.</span><span class="sxs-lookup"><span data-stu-id="b471a-112">The active [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance periodically reports a set of component diagnostics to the WSFC resource group over a dedicated connection.</span></span> <span data-ttu-id="b471a-113">El grupo de recursos de WSFC mantiene la directiva de conmutación por error, que define las condiciones de error que desencadenarán los reinicios y las conmutaciones por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-113">The WSFC resource group maintains the failover policy, which defines the failure conditions that trigger restarts and failovers.</span></span>  
  
 <span data-ttu-id="b471a-114">En este tema se describe el segundo mecanismo mencionado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="b471a-114">This topic discusses the second mechanism above.</span></span> <span data-ttu-id="b471a-115">Para obtener más información sobre el comportamiento de WSFC en la configuración de cuórum y la detección del estado, vea [Configuración de los votos y modos de cuórum WSFC &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b471a-115">For more information on the WSFC behavior for quorum configuration and health detection, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="b471a-116">Las conmutaciones automáticas por error que tienen como origen o destino FCI no están permitidas en el grupo de disponibilidad AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="b471a-116">Automatic failovers to and from an FCI are not allowed in an AlwaysOn availability group.</span></span> <span data-ttu-id="b471a-117">Sin embargo, las conmutaciones por error manuales que tienen como origen y destino la FCI están permitidas en el grupo de disponibilidad AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="b471a-117">However, manual failovers to and from and FCI are allowed in an AlwaysOn availability group.</span></span>  
  
##  <a name="failover-policy-overview"></a><a name="Concepts"></a> <span data-ttu-id="b471a-118">Información general sobre la directiva de migración tras error</span><span class="sxs-lookup"><span data-stu-id="b471a-118">Failover Policy Overview</span></span>  
 <span data-ttu-id="b471a-119">El proceso de conmutación por error se puede descomponer en los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="b471a-119">The failover process can be broken down into the following steps:</span></span>  
  
1.  [<span data-ttu-id="b471a-120">Supervisar el estado de mantenimiento</span><span class="sxs-lookup"><span data-stu-id="b471a-120">Monitor the Health Status</span></span>](failover-policy-for-failover-cluster-instances.md#monitor)  
  
2.  [<span data-ttu-id="b471a-121">Determinar los errores</span><span class="sxs-lookup"><span data-stu-id="b471a-121">Determining Failures</span></span>](failover-policy-for-failover-cluster-instances.md#determine)  
  
3.  [<span data-ttu-id="b471a-122">Responder a errores</span><span class="sxs-lookup"><span data-stu-id="b471a-122">Responding to Failures</span></span>](failover-policy-for-failover-cluster-instances.md#respond)  
  
###  <a name="monitor-the-health-status"></a><a name="monitor"></a><span data-ttu-id="b471a-123">Supervisión del estado de mantenimiento</span><span class="sxs-lookup"><span data-stu-id="b471a-123">Monitor the Health Status</span></span>  
 <span data-ttu-id="b471a-124">Hay tres tipos de estados de mantenimiento que se supervisan en la FCI:</span><span class="sxs-lookup"><span data-stu-id="b471a-124">There are three types of health statuses that are monitored for the FCI:</span></span>  
  
-   [<span data-ttu-id="b471a-125">Estado del servicio de SQL Server</span><span class="sxs-lookup"><span data-stu-id="b471a-125">State of the SQL Server service</span></span>](failover-policy-for-failover-cluster-instances.md#service)  
  
-   [<span data-ttu-id="b471a-126">Capacidad de respuesta de la instancia de SQL Server</span><span class="sxs-lookup"><span data-stu-id="b471a-126">Responsiveness of the SQL Server instance</span></span>](failover-policy-for-failover-cluster-instances.md#instance)  
  
-   [<span data-ttu-id="b471a-127">Diagnóstico de componentes de SQL Server</span><span class="sxs-lookup"><span data-stu-id="b471a-127">SQL Server component diagnostics</span></span>](failover-policy-for-failover-cluster-instances.md#component)  
  
####  <a name="state-of-the-sql-server-service"></a><a name="service"></a><span data-ttu-id="b471a-128">Estado del servicio de SQL Server</span><span class="sxs-lookup"><span data-stu-id="b471a-128">State of the SQL Server service</span></span>  
 <span data-ttu-id="b471a-129">El servicio de WSFC supervisa el estado de inicio del servicio SQL Server del nodo activo de la FCI para detectar cuándo se detiene.</span><span class="sxs-lookup"><span data-stu-id="b471a-129">The WSFC service monitors the start state of the SQL Server service on the active FCI node to detect when the SQL Server service is stopped.</span></span>  
  
####  <a name="responsiveness-of-the-sql-server-instance"></a><a name="instance"></a><span data-ttu-id="b471a-130">Capacidad de respuesta de la instancia de SQL Server</span><span class="sxs-lookup"><span data-stu-id="b471a-130">Responsiveness of the SQL Server instance</span></span>  
 <span data-ttu-id="b471a-131">Durante la instalación de SQL Server, el servicio de WSFC usa la DLL de recursos del motor de base de datos de SQL Server para crear una nueva conexión en un subproceso independiente que se usa exclusivamente para supervisar el estado de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="b471a-131">During SQL Server startup, the WSFC service uses the SQL Server Database Engine resource DLL to create a new connection to on a separate thread that is used exclusively for monitoring the health status.</span></span> <span data-ttu-id="b471a-132">Esto garantiza que en la instancia de SQL tiene los recursos necesarios para notificar su estado de mantenimiento mientras está sujeta a carga.</span><span class="sxs-lookup"><span data-stu-id="b471a-132">This ensures that there the SQL instance has the required resources to report its health status while under load.</span></span> <span data-ttu-id="b471a-133">Con esta conexión dedicada, SQL Server ejecuta el procedimiento almacenado del sistema [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) en modo de repetición para notificar periódicamente el estado de mantenimiento de los componentes de SQL Server a la DLL de recursos.</span><span class="sxs-lookup"><span data-stu-id="b471a-133">Using this dedicated connection, SQL Server runs the [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) system stored procedure in repeat mode to periodically report the health status of the SQL Server components to the resource DLL.</span></span>  
  
 <span data-ttu-id="b471a-134">La DLL de recursos determina la capacidad de respuesta de la instancia de SQL mediante un tiempo de espera de comprobación de estado.</span><span class="sxs-lookup"><span data-stu-id="b471a-134">The resource DLL determines the responsiveness of the SQL instance using a health check timeout.</span></span> <span data-ttu-id="b471a-135">La propiedad HealthCheckTimeout define cuánto tiempo deber esperar la DLL de recursos al procedimiento almacenado de sp_server_diagnostics antes de notificar al servicio de WSFC que la instancia de SQL no responde.</span><span class="sxs-lookup"><span data-stu-id="b471a-135">The HealthCheckTimeout property defines how long the resource DLL should wait for the sp_server_diagnostics stored procedure before it reports the SQL instance as unresponsive to the WSFC service.</span></span> <span data-ttu-id="b471a-136">Esta propiedad se puede configurar utilizando T-SQL, así como el complemento Administrador de clústeres de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-136">This property is configurable using T-SQL as well as in the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="b471a-137">Para obtener más información, vea [Configure HealthCheckTimeout Property Settings](configure-healthchecktimeout-property-settings.md).</span><span class="sxs-lookup"><span data-stu-id="b471a-137">For more information, see [Configure HealthCheckTimeout Property Settings](configure-healthchecktimeout-property-settings.md).</span></span> <span data-ttu-id="b471a-138">Los siguientes elementos describen cómo afecta esta propiedad al tiempo de espera y a la configuración del intervalo de repetición:</span><span class="sxs-lookup"><span data-stu-id="b471a-138">The following items describe how this property affects timeout and repeat interval settings:</span></span>  
  
-   <span data-ttu-id="b471a-139">La DLL de recursos llama al procedimiento almacenado sp_server_diagnostics y establece el intervalo de repetición en un tercio del valor de HealthCheckTimeout.</span><span class="sxs-lookup"><span data-stu-id="b471a-139">The resource DLL calls the sp_server_diagnostics stored procedure and sets the repeat interval to one-third of the HealthCheckTimeout setting.</span></span>  
  
-   <span data-ttu-id="b471a-140">Si el procedimiento almacenado sp_server_diagnostics es lento o no está devolviendo información, la DLL de recursos esperará el intervalo especificado por HealthCheckTimeout antes de notificar al servicio WSFC que la instancia de SQL no responde.</span><span class="sxs-lookup"><span data-stu-id="b471a-140">If the sp_server_diagnostics stored procedure is slow or is not returning information, the resource DLL will wait for the interval specified by HealthCheckTimeout before it reports to the WSFC service that the SQL instance is unresponsive.</span></span>  
  
-   <span data-ttu-id="b471a-141">Si se pierde la conexión dedicada, la DLL de recursos intentará establecer conexión con la instancia de SQL durante el intervalo especificado por HealthCheckTimeout antes de notificar al servicio de WSFC que la instancia de SQL no responde.</span><span class="sxs-lookup"><span data-stu-id="b471a-141">If the dedicated connection is lost, the resource DLL will retry the connection to the SQL instance for the interval specified by HealthCheckTimeout before it reports to the WSFC service that the SQL instance is unresponsive.</span></span>  
  
####  <a name="sql-server-component-diagnostics"></a><a name="component"></a> <span data-ttu-id="b471a-142">Diagnósticos de componentes de SQL Server</span><span class="sxs-lookup"><span data-stu-id="b471a-142">SQL Server component diagnostics</span></span>  
 <span data-ttu-id="b471a-143">El procedimiento almacenado del sistema sp_server_diagnostics recopila periódicamente diagnósticos de componentes de la instancia de SQL.</span><span class="sxs-lookup"><span data-stu-id="b471a-143">The system stored procedure sp_server_diagnostics periodically collects component diagnostics on the SQL instance.</span></span> <span data-ttu-id="b471a-144">La información de diagnóstico que se recopila se exhibe como una fila para cada uno de los componentes siguientes y se pasa al subproceso que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="b471a-144">The diagnostic information that is collected is surfaced as a row for each of the following components and passed to the calling thread.</span></span>  
  
1.  <span data-ttu-id="b471a-145">sistema</span><span class="sxs-lookup"><span data-stu-id="b471a-145">system</span></span>  
  
2.  <span data-ttu-id="b471a-146">resource</span><span class="sxs-lookup"><span data-stu-id="b471a-146">resource</span></span>  
  
3.  <span data-ttu-id="b471a-147">query process</span><span class="sxs-lookup"><span data-stu-id="b471a-147">query process</span></span>  
  
4.  <span data-ttu-id="b471a-148">io_subsystem</span><span class="sxs-lookup"><span data-stu-id="b471a-148">io_subsystem</span></span>  
  
5.  <span data-ttu-id="b471a-149">events</span><span class="sxs-lookup"><span data-stu-id="b471a-149">events</span></span>  
  
 <span data-ttu-id="b471a-150">Los componentes system, resource y query process se utilizan para la detección de errores.</span><span class="sxs-lookup"><span data-stu-id="b471a-150">The system, resource, and query process components are used for failure detection.</span></span> <span data-ttu-id="b471a-151">Los componentes io_subsytem y events solo se utilizan con fines de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="b471a-151">The io_subsytem and events components are used for diagnostic purposes only.</span></span>  
  
 <span data-ttu-id="b471a-152">Cada conjunto de filas de información también se escribe en el registro de diagnósticos de clúster del servidor SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b471a-152">Each rowset of information is also written to the SQL Server cluster diagnostics log.</span></span> <span data-ttu-id="b471a-153">Para obtener más información, vea [Ver y leer el registro de diagnósticos de la instancia de clúster de conmutación por error](view-and-read-failover-cluster-instance-diagnostics-log.md).</span><span class="sxs-lookup"><span data-stu-id="b471a-153">For more information, see [View and Read Failover Cluster Instance Diagnostics Log](view-and-read-failover-cluster-instance-diagnostics-log.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="b471a-154">Aunque el procedimiento almacenado sp_server_diagnostic se usa en la tecnología AlwaysOn de SQL Server, puede usarse en cualquier instancia de SQL Server para ayudar a detectar y solucionar problemas.</span><span class="sxs-lookup"><span data-stu-id="b471a-154">While the sp_server_diagnostic stored procedure is used by SQL Server AlwaysOn technology, it is available for use in any SQL Server instance to help detect and troubleshoot problems.</span></span>  
  
####  <a name="determining-failures"></a><a name="determine"></a><span data-ttu-id="b471a-155">Determinar errores</span><span class="sxs-lookup"><span data-stu-id="b471a-155">Determining Failures</span></span>  
 <span data-ttu-id="b471a-156">La DLL de recursos del motor de base de datos de SQL Server determina si el estado de mantenimiento detectado es una condición de error mediante la propiedad FailureConditionLevel.</span><span class="sxs-lookup"><span data-stu-id="b471a-156">The SQL Server Database Engine resource DLL determines whether the detected health status is a condition for failure using the FailureConditionLevel property.</span></span> <span data-ttu-id="b471a-157">La propiedad FailureConditionLevel define los estados de mantenimiento detectados que causan reinicios o conmutaciones por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-157">The FailureConditionLevel property defines which detected health statuses cause restarts or failovers.</span></span> <span data-ttu-id="b471a-158">Hay varios niveles de opciones disponibles, que van desde el inicio o conmutación por error no automáticos hasta todas las posibles condiciones de error que generan un reinicio o conmutación por error automáticos.</span><span class="sxs-lookup"><span data-stu-id="b471a-158">Multiple levels of options are available, ranging from no automatic restart or failover to all possible failure conditions resulting in an automatic restart or failover.</span></span> <span data-ttu-id="b471a-159">Para obtener más información acerca de cómo configurar esta propiedad, vea [Configure FailureConditionLevel Property Settings](configure-failureconditionlevel-property-settings.md).</span><span class="sxs-lookup"><span data-stu-id="b471a-159">For more information about how to configure this property, see [Configure FailureConditionLevel Property Settings](configure-failureconditionlevel-property-settings.md).</span></span>  
  
 <span data-ttu-id="b471a-160">Las condiciones de error se establecen en una escala creciente.</span><span class="sxs-lookup"><span data-stu-id="b471a-160">The failure conditions are set on an increasing scale.</span></span> <span data-ttu-id="b471a-161">Para los niveles 1 a 5, cada nivel incluye todas las condiciones de los niveles anteriores además de sus propias condiciones.</span><span class="sxs-lookup"><span data-stu-id="b471a-161">For levels 1-5, each level includes all the conditions from the previous levels in addition to its own conditions.</span></span> <span data-ttu-id="b471a-162">Esto significa que con cada nivel, hay mayor probabilidad de que se produzca una conmutación por error o un reinicio.</span><span class="sxs-lookup"><span data-stu-id="b471a-162">This means that with each level, there is an increased probability of a failover or restart.</span></span> <span data-ttu-id="b471a-163">Los niveles de la condición de error se describen en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="b471a-163">The failure condition levels are described in the following table.</span></span>  
  
 <span data-ttu-id="b471a-164">Consulte [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql), ya que este procedimiento almacenado del sistema juega un papel importante en los niveles de condiciones de error.</span><span class="sxs-lookup"><span data-stu-id="b471a-164">Review [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) as this system stored procedure plays in important role in the failure condition levels.</span></span>  
  
|<span data-ttu-id="b471a-165">Nivel</span><span class="sxs-lookup"><span data-stu-id="b471a-165">Level</span></span>|<span data-ttu-id="b471a-166">Condición</span><span class="sxs-lookup"><span data-stu-id="b471a-166">Condition</span></span>|<span data-ttu-id="b471a-167">Descripción</span><span class="sxs-lookup"><span data-stu-id="b471a-167">Description</span></span>|  
|-----------|---------------|-----------------|  
|<span data-ttu-id="b471a-168">0</span><span class="sxs-lookup"><span data-stu-id="b471a-168">0</span></span>|<span data-ttu-id="b471a-169">No hay conmutación automática por error ni reinicio</span><span class="sxs-lookup"><span data-stu-id="b471a-169">No automatic failover or restart</span></span>|<span data-ttu-id="b471a-170">Indica que no se activará la conmutación por error ni el reinicio automáticamente si se dan condiciones de error.</span><span class="sxs-lookup"><span data-stu-id="b471a-170">Indicates that no failover or restart will be triggered automatically on any failure conditions.</span></span> <span data-ttu-id="b471a-171">Este nivel solo tiene como finalidad el mantenimiento del sistema.</span><span class="sxs-lookup"><span data-stu-id="b471a-171">This level is for system maintenance purposes only.</span></span>|  
|<span data-ttu-id="b471a-172">1</span><span class="sxs-lookup"><span data-stu-id="b471a-172">1</span></span>|<span data-ttu-id="b471a-173">Conmutación por error o reinicio si el servidor tiene error</span><span class="sxs-lookup"><span data-stu-id="b471a-173">Failover or restart on server down</span></span>|<span data-ttu-id="b471a-174">Indica que se reiniciará el servidor o se desencadenará una conmutación por error si se produce la siguiente condición:</span><span class="sxs-lookup"><span data-stu-id="b471a-174">Indicates that a server restart or failover will be triggered if the following condition is raised:</span></span><br /><br /> <span data-ttu-id="b471a-175">El servicio SQL Server se apaga.</span><span class="sxs-lookup"><span data-stu-id="b471a-175">SQL Server service is down.</span></span>|  
|<span data-ttu-id="b471a-176">2</span><span class="sxs-lookup"><span data-stu-id="b471a-176">2</span></span>|<span data-ttu-id="b471a-177">Conmutación por error o  reinicio si el servidor no responde</span><span class="sxs-lookup"><span data-stu-id="b471a-177">Failover or restart on server unresponsive</span></span>|<span data-ttu-id="b471a-178">Indica que se reiniciará el servidor o se desencadenará una conmutación por error si se produce alguna de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="b471a-178">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="b471a-179">El servicio SQL Server se apaga.</span><span class="sxs-lookup"><span data-stu-id="b471a-179">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="b471a-180">La instancia de SQL Server no responde (la DLL de recursos no puede recibir datos de sp_server_diagnostics en el intervalo establecido por la configuración de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="b471a-180">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span>|  
|<span data-ttu-id="b471a-181">3\*</span><span class="sxs-lookup"><span data-stu-id="b471a-181">3\*</span></span>|<span data-ttu-id="b471a-182">Conmutación por error o reinicio si hay errores de servidor críticos</span><span class="sxs-lookup"><span data-stu-id="b471a-182">Failover or restart on critical server errors</span></span>|<span data-ttu-id="b471a-183">Indica que se reiniciará el servidor o se desencadenará una conmutación por error si se produce alguna de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="b471a-183">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="b471a-184">El servicio SQL Server se apaga.</span><span class="sxs-lookup"><span data-stu-id="b471a-184">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="b471a-185">La instancia de SQL Server no responde (la DLL de recursos no puede recibir datos de sp_server_diagnostics en el intervalo establecido por la configuración de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="b471a-185">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="b471a-186">El procedimiento almacenado del sistema sp_server_diagnostics devuelve "error del sistema".</span><span class="sxs-lookup"><span data-stu-id="b471a-186">System stored procedure sp_server_diagnostics returns 'system error'.</span></span>|  
|<span data-ttu-id="b471a-187">4</span><span class="sxs-lookup"><span data-stu-id="b471a-187">4</span></span>|<span data-ttu-id="b471a-188">Conmutación por error o reinicio si hay errores de servidor moderados</span><span class="sxs-lookup"><span data-stu-id="b471a-188">Failover or restart on moderate server errors</span></span>|<span data-ttu-id="b471a-189">Indica que se reiniciará el servidor o se desencadenará una conmutación por error si se produce alguna de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="b471a-189">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="b471a-190">El servicio SQL Server se apaga.</span><span class="sxs-lookup"><span data-stu-id="b471a-190">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="b471a-191">La instancia de SQL Server no responde (la DLL de recursos no puede recibir datos de sp_server_diagnostics en el intervalo establecido por la configuración de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="b471a-191">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="b471a-192">El procedimiento almacenado del sistema sp_server_diagnostics devuelve "error del sistema".</span><span class="sxs-lookup"><span data-stu-id="b471a-192">System stored procedure sp_server_diagnostics returns 'system error'.</span></span><br /><br /> <span data-ttu-id="b471a-193">El procedimiento almacenado del sistema sp_server_diagnostics devuelve "error de recurso".</span><span class="sxs-lookup"><span data-stu-id="b471a-193">System  stored procedure sp_server_diagnostics returns 'resource error'.</span></span>|  
|<span data-ttu-id="b471a-194">5</span><span class="sxs-lookup"><span data-stu-id="b471a-194">5</span></span>|<span data-ttu-id="b471a-195">Conmutación por error o reinicio si se produce cualquier condición de error calificada</span><span class="sxs-lookup"><span data-stu-id="b471a-195">Failover or restart on any qualified failure conditions</span></span>|<span data-ttu-id="b471a-196">Indica que se reiniciará el servidor o se desencadenará una conmutación por error si se produce alguna de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="b471a-196">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="b471a-197">El servicio SQL Server se apaga.</span><span class="sxs-lookup"><span data-stu-id="b471a-197">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="b471a-198">La instancia de SQL Server no responde (la DLL de recursos no puede recibir datos de sp_server_diagnostics en el intervalo establecido por la configuración de HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="b471a-198">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="b471a-199">El procedimiento almacenado del sistema sp_server_diagnostics devuelve "error del sistema".</span><span class="sxs-lookup"><span data-stu-id="b471a-199">System stored procedure sp_server_diagnostics returns 'system error'.</span></span><br /><br /> <span data-ttu-id="b471a-200">El procedimiento almacenado del sistema sp_server_diagnostics devuelve "error de recurso".</span><span class="sxs-lookup"><span data-stu-id="b471a-200">System  stored procedure sp_server_diagnostics returns 'resource error'.</span></span><br /><br /> <span data-ttu-id="b471a-201">El procedimiento almacenado del sistema sp_server_diagnostics devuelve "error de query_processing".</span><span class="sxs-lookup"><span data-stu-id="b471a-201">System stored procedure sp_server_diagnostics returns 'query_processing error'.</span></span>|  
  
 <span data-ttu-id="b471a-202">\*Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="b471a-202">\*Default Value</span></span>  
  
####  <a name="responding-to-failures"></a><a name="respond"></a> <span data-ttu-id="b471a-203">Responder a los errores</span><span class="sxs-lookup"><span data-stu-id="b471a-203">Responding to Failures</span></span>  
 <span data-ttu-id="b471a-204">Una vez que se detectan una o varias condiciones de error, el modo en que responda el servicio de WSFC a los errores dependerá del estado de quórum de WSFC y de la configuración de reinicio y conmutación por error del grupo de recursos de la FCI.</span><span class="sxs-lookup"><span data-stu-id="b471a-204">After one or more failure conditions are detected, how the WSFC service responds to the failures depends on the WSFC quorum state and the restart and failover settings of the FCI resource group.</span></span> <span data-ttu-id="b471a-205">Si la FCI ha perdido el quórum de WSFC, toda la FCI se queda sin conexión y deja de tener una disponibilidad elevada.</span><span class="sxs-lookup"><span data-stu-id="b471a-205">If the FCI has lost its WSFC quorum, then the entire FCI is brought offline and the FCI has lost its high availability.</span></span> <span data-ttu-id="b471a-206">Si la FCI todavía mantiene el quórum de WSFC, el servicio de WSFC puede responder primero intentando reiniciar el nodo con errores y, si el intento de reinicio no tiene éxito, intentando la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-206">If the FCI still retains its WSFC quorum, then the WSFC service may respond by first attempting to restart the failed node and then failover if the restart attempts are unsuccessful.</span></span> <span data-ttu-id="b471a-207">La configuración de reinicio y conmutación por error se establece en el complemento Administrador de clústeres de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b471a-207">The restart and failover settings are configured in the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="b471a-208">Para obtener más información sobre esta configuración, vea [ \<Resource> propiedades: pestaña Directivas](https://technet.microsoft.com/library/cc725685.aspx).</span><span class="sxs-lookup"><span data-stu-id="b471a-208">For more information these settings, see [\<Resource> Properties: Policies Tab](https://technet.microsoft.com/library/cc725685.aspx).</span></span>  
  
 <span data-ttu-id="b471a-209">Para obtener más información sobre el mantenimiento del cuórum, vea [Configuración de los votos y modos de cuórum WSFC &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b471a-209">For more information on maintaining quorum health, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b471a-210">Consulte también</span><span class="sxs-lookup"><span data-stu-id="b471a-210">See Also</span></span>  
 [<span data-ttu-id="b471a-211">ALTER SERVER CONFIGURATION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b471a-211">ALTER SERVER CONFIGURATION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-server-configuration-transact-sql)  
  
  
