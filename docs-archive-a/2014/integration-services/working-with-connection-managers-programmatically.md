---
title: Trabajar con administradores de conexiones mediante programación | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- connection managers [Integration Services], programming
ms.assetid: 2686fe84-1ecc-48b8-9160-e7122274bd84
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 01fc61a4a5c85366c7af8c5c68a73777049d3cba
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87674890"
---
# <a name="working-with-connection-managers-programmatically"></a><span data-ttu-id="2a38d-102">Trabajar con administradores de conexiones mediante programación</span><span class="sxs-lookup"><span data-stu-id="2a38d-102">Working with Connection Managers Programmatically</span></span>
  <span data-ttu-id="2a38d-103">En [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], el método AcquireConnection de la clase de administradores de conexiones asociada es el método al que se llama con mayor frecuencia cuando se está trabajando con administradores de conexiones en código administrado.</span><span class="sxs-lookup"><span data-stu-id="2a38d-103">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the AcquireConnection method of the associated connection manager class is the method that you call most often when you are working with connection managers in managed code.</span></span> <span data-ttu-id="2a38d-104">Al escribir código administrado, tiene que llamar al método AcquireConnection para utilizar la funcionalidad de un administrador de conexiones.</span><span class="sxs-lookup"><span data-stu-id="2a38d-104">When you write managed code, you have to call the AcquireConnection method to use the functionality of a connection manager.</span></span> <span data-ttu-id="2a38d-105">Debe llamar a este método independientemente de si escribe el código administrado en una tarea Script, un componente de script, un objeto personalizado o una aplicación personalizada.</span><span class="sxs-lookup"><span data-stu-id="2a38d-105">You have to call this method regardless of whether you are writing managed code in a Script task, Script component, custom object, or custom application.</span></span>  
  
 <span data-ttu-id="2a38d-106">Para llamar correctamente al método AcquireConnection, tiene que conocer las respuestas a las preguntas siguientes:</span><span class="sxs-lookup"><span data-stu-id="2a38d-106">To call the AcquireConnection method successfully, you have to know the answers to the following questions:</span></span>  
  
-   <span data-ttu-id="2a38d-107">**¿Qué administradores de conexiones devuelven un objeto administrado desde el método AcquireConnection?**</span><span class="sxs-lookup"><span data-stu-id="2a38d-107">**Which connection managers return a managed object from the AcquireConnection method?**</span></span>  
  
     <span data-ttu-id="2a38d-108">Muchos administradores de conexiones devuelven objetos COM no administrados (System.__ComObject) y estos objetos no se pueden utilizar con facilidad desde el código administrado.</span><span class="sxs-lookup"><span data-stu-id="2a38d-108">Many connection managers return unmanaged COM objects (System.__ComObject) and these objects cannot easily be used from managed code.</span></span> <span data-ttu-id="2a38d-109">La lista de estos administradores de conexiones incluye el administrador de conexiones OLE DB de uso frecuente.</span><span class="sxs-lookup"><span data-stu-id="2a38d-109">The list of these connection managers includes the frequently used OLE DB connection manager.</span></span>  
  
-   <span data-ttu-id="2a38d-110">**En el caso de los administradores de conexiones que devuelven un objeto administrado, ¿qué objetos devuelven sus métodos AcquireConnection?**</span><span class="sxs-lookup"><span data-stu-id="2a38d-110">**For those connection managers that return a managed object, what objects do their AcquireConnection methods return?**</span></span>  
  
     <span data-ttu-id="2a38d-111">Para convertir el valor devuelto al tipo adecuado, debe saber qué tipo de objeto devuelve el método AcquireConnection.</span><span class="sxs-lookup"><span data-stu-id="2a38d-111">To cast the return value to the appropriate type, you have to know what type of object the AcquireConnection method returns.</span></span> <span data-ttu-id="2a38d-112">Por ejemplo, el método AcquireConnection para el administrador de conexiones [!INCLUDE[vstecado](../includes/vstecado-md.md)] devuelve un objeto SqlConnection abierto al utilizar el proveedor SqlClient.</span><span class="sxs-lookup"><span data-stu-id="2a38d-112">For example, the AcquireConnection method for the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager returns an open SqlConnection object when you use the SqlClient provider.</span></span> <span data-ttu-id="2a38d-113">Sin embargo, el método AcquireConnection para el administrador de conexiones de archivos solamente devuelve una cadena.</span><span class="sxs-lookup"><span data-stu-id="2a38d-113">However, the AcquireConnection method for the File connection manager just returns a string.</span></span>  
  
 <span data-ttu-id="2a38d-114">En este tema se responden estas preguntas sobre los administradores de conexiones incluidos con [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2a38d-114">This topic answers these questions for the connection managers that are included with [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span>  
  
## <a name="connection-managers-that-do-not-return-a-managed-object"></a><span data-ttu-id="2a38d-115">Administradores de conexiones que no devuelven un objeto administrado</span><span class="sxs-lookup"><span data-stu-id="2a38d-115">Connection Managers That Do Not Return a Managed Object</span></span>  
 <span data-ttu-id="2a38d-116">En la tabla siguiente se enumeran los administradores de conexiones que devuelven un objeto COM nativo (System.__ComObject) desde el método AcquireConnection.</span><span class="sxs-lookup"><span data-stu-id="2a38d-116">The following table lists the connection managers that return a native COM object (System.__ComObject) from the AcquireConnection method.</span></span> <span data-ttu-id="2a38d-117">Estos objetos no administrados no resultan fáciles de usar desde código administrado.</span><span class="sxs-lookup"><span data-stu-id="2a38d-117">These unmanaged objects cannot easily be used from managed code.</span></span>  
  
|<span data-ttu-id="2a38d-118">Tipo de administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-118">Connection Manager Type</span></span>|<span data-ttu-id="2a38d-119">Nombre del administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-119">Connection Manager Name</span></span>|  
|-----------------------------|-----------------------------|  
|<span data-ttu-id="2a38d-120">ADO</span><span class="sxs-lookup"><span data-stu-id="2a38d-120">ADO</span></span>|<span data-ttu-id="2a38d-121">Administrador de conexiones ADO</span><span class="sxs-lookup"><span data-stu-id="2a38d-121">ADO Connection Manager</span></span>|  
|<span data-ttu-id="2a38d-122">MSOLAP90</span><span class="sxs-lookup"><span data-stu-id="2a38d-122">MSOLAP90</span></span>|<span data-ttu-id="2a38d-123">Administrador de conexiones de [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="2a38d-123">[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] Connection Manager</span></span>|  
|<span data-ttu-id="2a38d-124">EXCEL</span><span class="sxs-lookup"><span data-stu-id="2a38d-124">EXCEL</span></span>|<span data-ttu-id="2a38d-125">Administrador de conexiones con Excel</span><span class="sxs-lookup"><span data-stu-id="2a38d-125">Excel Connection Manager</span></span>|  
|<span data-ttu-id="2a38d-126">FTP</span><span class="sxs-lookup"><span data-stu-id="2a38d-126">FTP</span></span>|<span data-ttu-id="2a38d-127">FTP, administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-127">FTP Connection Manager</span></span>|  
|<span data-ttu-id="2a38d-128">HTTP</span><span class="sxs-lookup"><span data-stu-id="2a38d-128">HTTP</span></span>|<span data-ttu-id="2a38d-129">HTTP, administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-129">HTTP Connection Manager</span></span>|  
|<span data-ttu-id="2a38d-130">ODBC</span><span class="sxs-lookup"><span data-stu-id="2a38d-130">ODBC</span></span>|<span data-ttu-id="2a38d-131">ODBC, administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-131">ODBC Connection Manager</span></span>|  
|<span data-ttu-id="2a38d-132">OLEDB</span><span class="sxs-lookup"><span data-stu-id="2a38d-132">OLEDB</span></span>|<span data-ttu-id="2a38d-133">OLE DB, administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-133">OLE DB Connection Manager</span></span>|  
  
 <span data-ttu-id="2a38d-134">Normalmente, puede utilizar un administrador de conexiones [!INCLUDE[vstecado](../includes/vstecado-md.md)] desde el código administrado para conectarse a un origen de datos ADO, Excel, ODBC u OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2a38d-134">Typically, you can use an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager from managed code to connect to an ADO, Excel, ODBC, or OLE DB data source.</span></span>  
  
## <a name="return-values-from-the-acquireconnection-method"></a><span data-ttu-id="2a38d-135">Valores devueltos del método AcquireConnection</span><span class="sxs-lookup"><span data-stu-id="2a38d-135">Return Values from the AcquireConnection Method</span></span>  
 <span data-ttu-id="2a38d-136">En la tabla siguiente se enumeran los administradores de conexiones que devuelven un objeto administrado desde el método AcquireConnection.</span><span class="sxs-lookup"><span data-stu-id="2a38d-136">The following table lists the connection managers that return a managed object from the AcquireConnection method.</span></span> <span data-ttu-id="2a38d-137">Estos objetos administrados se pueden usar con facilidad desde código administrado.</span><span class="sxs-lookup"><span data-stu-id="2a38d-137">These managed objects can easily be used from managed code.</span></span>  
  
|<span data-ttu-id="2a38d-138">Tipo de administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-138">Connection Manager Type</span></span>|<span data-ttu-id="2a38d-139">Nombre del administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-139">Connection Manager Name</span></span>|<span data-ttu-id="2a38d-140">Tipo de valor devuelto</span><span class="sxs-lookup"><span data-stu-id="2a38d-140">Type of Return Value</span></span>|<span data-ttu-id="2a38d-141">Información adicional</span><span class="sxs-lookup"><span data-stu-id="2a38d-141">Additional Information</span></span>|  
|-----------------------------|-----------------------------|--------------------------|----------------------------|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="2a38d-142">Administrador de conexiones de [!INCLUDE[vstecado](../includes/vstecado-md.md)]</span><span class="sxs-lookup"><span data-stu-id="2a38d-142">[!INCLUDE[vstecado](../includes/vstecado-md.md)] Connection Manager</span></span>|`System.Data.SqlClient.SqlConnection`||  
|<span data-ttu-id="2a38d-143">FILE</span><span class="sxs-lookup"><span data-stu-id="2a38d-143">FILE</span></span>|<span data-ttu-id="2a38d-144">administrador de conexiones de archivos</span><span class="sxs-lookup"><span data-stu-id="2a38d-144">File Connection Manager</span></span>|`System.String`|<span data-ttu-id="2a38d-145">Ruta de acceso al archivo.</span><span class="sxs-lookup"><span data-stu-id="2a38d-145">Path to the file.</span></span>|  
|<span data-ttu-id="2a38d-146">FLATFILE</span><span class="sxs-lookup"><span data-stu-id="2a38d-146">FLATFILE</span></span>|<span data-ttu-id="2a38d-147">Administrador de conexiones de archivos planos</span><span class="sxs-lookup"><span data-stu-id="2a38d-147">Flat File Connection Manager</span></span>|`System.String`|<span data-ttu-id="2a38d-148">Ruta de acceso al archivo.</span><span class="sxs-lookup"><span data-stu-id="2a38d-148">Path to the file.</span></span>|  
|<span data-ttu-id="2a38d-149">MSMQ</span><span class="sxs-lookup"><span data-stu-id="2a38d-149">MSMQ</span></span>|<span data-ttu-id="2a38d-150">MSMQ, administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-150">MSMQ Connection Manager</span></span>|`System.Messaging.MessageQueue`||  
|<span data-ttu-id="2a38d-151">MULTIFILE</span><span class="sxs-lookup"><span data-stu-id="2a38d-151">MULTIFILE</span></span>|<span data-ttu-id="2a38d-152">administrador de conexiones de varios archivos</span><span class="sxs-lookup"><span data-stu-id="2a38d-152">Multiple Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="2a38d-153">Ruta de acceso a uno de los archivos.</span><span class="sxs-lookup"><span data-stu-id="2a38d-153">Path to one of the files.</span></span>|  
|<span data-ttu-id="2a38d-154">MULTIFLATFILE</span><span class="sxs-lookup"><span data-stu-id="2a38d-154">MULTIFLATFILE</span></span>|<span data-ttu-id="2a38d-155">administrador de conexiones de varios archivos planos</span><span class="sxs-lookup"><span data-stu-id="2a38d-155">Multiple Flat Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="2a38d-156">Ruta de acceso a uno de los archivos.</span><span class="sxs-lookup"><span data-stu-id="2a38d-156">Path to one of the files.</span></span>|  
|<span data-ttu-id="2a38d-157">SMOServer</span><span class="sxs-lookup"><span data-stu-id="2a38d-157">SMOServer</span></span>|<span data-ttu-id="2a38d-158">SMO, administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="2a38d-158">SMO Connection Manager</span></span>|`Microsoft.SqlServer.Management.Smo.Server`||  
|<span data-ttu-id="2a38d-159">SMTP</span><span class="sxs-lookup"><span data-stu-id="2a38d-159">SMTP</span></span>|<span data-ttu-id="2a38d-160">Administrador de conexiones SMTP</span><span class="sxs-lookup"><span data-stu-id="2a38d-160">SMTP Connection Manager</span></span>|`System.String`|<span data-ttu-id="2a38d-161">Por ejemplo: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span><span class="sxs-lookup"><span data-stu-id="2a38d-161">For example: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span></span>|  
|<span data-ttu-id="2a38d-162">WMI</span><span class="sxs-lookup"><span data-stu-id="2a38d-162">WMI</span></span>|<span data-ttu-id="2a38d-163">Administrador de conexiones WMI</span><span class="sxs-lookup"><span data-stu-id="2a38d-163">WMI Connection Manager</span></span>|`System.Management.ManagementScope`||  
|<span data-ttu-id="2a38d-164">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="2a38d-164">SQLMOBILE</span></span>|<span data-ttu-id="2a38d-165">Administrador de conexiones de SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="2a38d-165">SQL Server Compact Connection Manager</span></span>|`System.Data.SqlServerCe.SqlCeConnection`||  
  
<span data-ttu-id="2a38d-166">![Integration Services icono (pequeño)](media/dts-16.gif "Icono de Integration Services (pequeño)")  **Manténgase al día con Integration Services**</span><span class="sxs-lookup"><span data-stu-id="2a38d-166">![Integration Services icon (small)](media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="2a38d-167">Para obtener las descargas, artículos, ejemplos y vídeos más recientes de Microsoft, así como soluciones seleccionadas de la comunidad, visite la página de [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] en MSDN:</span><span class="sxs-lookup"><span data-stu-id="2a38d-167">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="2a38d-168">Visite la página de Integration Services en MSDN</span><span class="sxs-lookup"><span data-stu-id="2a38d-168">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="2a38d-169">Para recibir notificaciones automáticas de estas actualizaciones, suscríbase a las fuentes RSS disponibles en la página.</span><span class="sxs-lookup"><span data-stu-id="2a38d-169">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2a38d-170">Consulte también</span><span class="sxs-lookup"><span data-stu-id="2a38d-170">See Also</span></span>  
 <span data-ttu-id="2a38d-171">[Conexión a orígenes de datos en la tarea script](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span><span class="sxs-lookup"><span data-stu-id="2a38d-171">[Connecting to Data Sources in the Script Task](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span></span>  
 <span data-ttu-id="2a38d-172">[Conectarse a orígenes de datos en el componente de script](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span><span class="sxs-lookup"><span data-stu-id="2a38d-172">[Connecting to Data Sources in the Script Component](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span></span>  
 [<span data-ttu-id="2a38d-173">Conectarse a orígenes de datos de una tarea personalizada</span><span class="sxs-lookup"><span data-stu-id="2a38d-173">Connecting to Data Sources in a Custom Task</span></span>](extending-packages-custom-objects/task/connecting-to-data-sources-in-a-custom-task.md)  
  
  
