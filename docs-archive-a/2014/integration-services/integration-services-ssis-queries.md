---
title: Consultas de Integration Services (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5119ff27606ce4e43f65cc129f3caac764e78e0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87673155"
---
# <a name="integration-services-ssis-queries"></a><span data-ttu-id="f07d7-102">Consultas de Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="f07d7-102">Integration Services (SSIS) Queries</span></span>
  <span data-ttu-id="f07d7-103">La tarea Ejecutar SQL, el origen de OLE DB, el destino de OLE DB y la transformación Búsqueda pueden utilizar consultas de SQL.</span><span class="sxs-lookup"><span data-stu-id="f07d7-103">The Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation can use SQL queries.</span></span> <span data-ttu-id="f07d7-104">En la tarea Ejecutar SQL, las instrucciones SQL pueden crear, actualizar y eliminar datos y objetos de bases de datos, ejecutar procedimientos almacenados y ejecutar instrucciones SELECT.</span><span class="sxs-lookup"><span data-stu-id="f07d7-104">In the Execute SQL task, the SQL statements can create, update, and delete database objects and data; run stored procedures; and perform SELECT statements.</span></span> <span data-ttu-id="f07d7-105">En el origen de OLE DB y la transformación Búsqueda, las instrucciones SQL son normalmente instrucciones SELECT o EXEC.</span><span class="sxs-lookup"><span data-stu-id="f07d7-105">In the OLE DB source and the Lookup transformation, the SQL statements are typically SELECT statements or EXEC statements.</span></span> <span data-ttu-id="f07d7-106">Normalmente, éstas últimas ejecutan procedimientos almacenados que devuelven conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="f07d7-106">The latter most frequently run stored procedures that return result sets.</span></span>  
  
 <span data-ttu-id="f07d7-107">Una consulta se puede analizar para ver si es válida.</span><span class="sxs-lookup"><span data-stu-id="f07d7-107">A query can be parsed to establish whether it is valid.</span></span> <span data-ttu-id="f07d7-108">Al analizar una consulta que usa una conexión a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], la consulta se analiza, se ejecuta y el resultado de la ejecución (correcta o errónea) se asigna al resultado del análisis.</span><span class="sxs-lookup"><span data-stu-id="f07d7-108">When parsing a query that uses a connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the query is parsed, executed, and the execution outcome (success or failure) is assigned to the parsing outcome.</span></span> <span data-ttu-id="f07d7-109">Si la consulta utiliza una conexión a datos que no sean de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], la instrucción solo se analiza.</span><span class="sxs-lookup"><span data-stu-id="f07d7-109">If the query uses a connection to a data other than [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the statement is parsed only.</span></span>  
  
 <span data-ttu-id="f07d7-110">La instrucción SQL se puede definir introduciéndola directamente en el diseñador, o especificando una conexión de archivos o una variable que contenga la instrucción.</span><span class="sxs-lookup"><span data-stu-id="f07d7-110">The SQL statement can be defined either by entering it directly in the designer, or by specifying a file connection or a variable that contains the statement.</span></span>  
  
## <a name="direct-input-sql"></a><span data-ttu-id="f07d7-111">Entrada directa en SQL</span><span class="sxs-lookup"><span data-stu-id="f07d7-111">Direct Input SQL</span></span>  
 <span data-ttu-id="f07d7-112">El Generador de consultas está disponible en la interfaz de usuario de la tarea Ejecutar SQL, el origen de OLE DB, el destino de OLE DB y la transformación Búsqueda.</span><span class="sxs-lookup"><span data-stu-id="f07d7-112">Query Builder is available in the user interface for the Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation.</span></span> <span data-ttu-id="f07d7-113">El Generador de consultas ofrece las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="f07d7-113">Query Builder offers the following advantages:</span></span>  
  
-   <span data-ttu-id="f07d7-114">Trabajar visualmente o con comandos SQL.</span><span class="sxs-lookup"><span data-stu-id="f07d7-114">Work visually or with SQL commands.</span></span>  
  
     <span data-ttu-id="f07d7-115">El Generador de consultas incluye paneles gráficos que muestran la consulta visualmente y un panel de texto que muestra el texto SQL de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f07d7-115">Query Builder includes graphical panes that compose your query visually and a text pane that displays the SQL text of your query.</span></span> <span data-ttu-id="f07d7-116">Puede trabajar en los paneles gráficos o de texto.</span><span class="sxs-lookup"><span data-stu-id="f07d7-116">You can work in either the graphical or text panes.</span></span> <span data-ttu-id="f07d7-117">El Generador de consultas sincroniza las vistas de forma que el texto de la consulta y la representación gráfica de la consulta coincidan siempre.</span><span class="sxs-lookup"><span data-stu-id="f07d7-117">Query Builder synchronizes the views so that the query text and graphical representation always match.</span></span>  
  
-   <span data-ttu-id="f07d7-118">Combinar tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="f07d7-118">Join related tables.</span></span>  
  
     <span data-ttu-id="f07d7-119">Si agrega más de una tabla a la consulta, el Generador de consultas determinará automáticamente cómo están relacionadas las tablas y generará el comando de combinación correspondiente.</span><span class="sxs-lookup"><span data-stu-id="f07d7-119">If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="f07d7-120">Consultar o actualizar bases de datos.</span><span class="sxs-lookup"><span data-stu-id="f07d7-120">Query or update databases.</span></span>  
  
     <span data-ttu-id="f07d7-121">Puede utilizar el Generador de consultas para devolver datos mediante instrucciones SELECT de Transact-SQL, o bien para crear consultas que actualicen, agreguen o eliminen registros de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="f07d7-121">You can use Query Builder to return data using Transact-SQL SELECT statements, or to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="f07d7-122">Ver y modificar los resultados inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="f07d7-122">View and edit results immediately.</span></span>  
  
     <span data-ttu-id="f07d7-123">Puede ejecutar la consulta y trabajar con un conjunto de registros en una cuadrícula que le permita desplazarse por los registros de la base de datos y modificarlos.</span><span class="sxs-lookup"><span data-stu-id="f07d7-123">You can execute your query and work with a recordset in a grid that lets you scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="f07d7-124">A pesar de que el Generador de consultas tiene limitaciones visuales para crear consultas SELECT, puede escribir el SQL para otros tipos de instrucciones, como las instrucciones DELETE y UPDATE, en el panel de texto.</span><span class="sxs-lookup"><span data-stu-id="f07d7-124">Although Query Builder is visually limited to creating SELECT queries, you can type the SQL for other types of statements such as DELETE and UPDATE statements in the text pane.</span></span> <span data-ttu-id="f07d7-125">El panel gráfico se actualiza automáticamente para reflejar la instrucción SQL que escribió.</span><span class="sxs-lookup"><span data-stu-id="f07d7-125">The graphical pane is automatically updated to reflect the SQL statement that you typed.</span></span>  
  
 <span data-ttu-id="f07d7-126">También puede proporcionar entradas directas escribiendo la consulta en el cuadro de diálogo de la tarea o del componente de flujo de datos, o bien en la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="f07d7-126">You can also provide direct input by typing the query in the task or data flow component dialog box or the Properties window.</span></span>  
  
 <span data-ttu-id="f07d7-127">Para más información, consulte [Query Builder](../../2014/integration-services/query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="f07d7-127">For more information, see [Query Builder](../../2014/integration-services/query-builder.md).</span></span>  
  
## <a name="sql-in-files"></a><span data-ttu-id="f07d7-128">SQL en archivos</span><span class="sxs-lookup"><span data-stu-id="f07d7-128">SQL in Files</span></span>  
 <span data-ttu-id="f07d7-129">La instrucción SQL para la tarea Ejecutar SQL también puede residir en un archivo independiente.</span><span class="sxs-lookup"><span data-stu-id="f07d7-129">The SQL statement for the Execute SQL task can also reside in a separate file.</span></span> <span data-ttu-id="f07d7-130">Por ejemplo, puede escribir una consulta utilizando herramientas como el Editor de consultas de [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], guardarla en un archivo y después, leer la consulta del archivo al ejecutar un paquete.</span><span class="sxs-lookup"><span data-stu-id="f07d7-130">For example, you can write queries using tools such as the Query Editor in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], save the query to a file, and then read the query from the file when running a package.</span></span> <span data-ttu-id="f07d7-131">El archivo solo puede contener las instrucciones SQL que se van a ejecutar y comentarios.</span><span class="sxs-lookup"><span data-stu-id="f07d7-131">The file can contain only the SQL statements to run and comments.</span></span> <span data-ttu-id="f07d7-132">Para utilizar una instrucción SQL almacenada en un archivo, debe proporcionar una conexión de archivos que especifique el nombre y la ubicación del archivo.</span><span class="sxs-lookup"><span data-stu-id="f07d7-132">To use a SQL statement stored in a file, you must provide a file connection that specifies the file name and location.</span></span> <span data-ttu-id="f07d7-133">Para obtener más información, consulte [File Connection Manager](connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="f07d7-133">For more information, see [File Connection Manager](connection-manager/file-connection-manager.md).</span></span>  
  
## <a name="sql-in-variables"></a><span data-ttu-id="f07d7-134">SQL en variables</span><span class="sxs-lookup"><span data-stu-id="f07d7-134">SQL in Variables</span></span>  
 <span data-ttu-id="f07d7-135">Si el origen de la instrucción SQL en la tarea Ejecutar SQL es una variable, debe proporcionar el nombre de la variable que contiene la consulta.</span><span class="sxs-lookup"><span data-stu-id="f07d7-135">If the source of the SQL statement in the Execute SQL task is a variable, you provide the name of the variable that contains the query.</span></span> <span data-ttu-id="f07d7-136">La propiedad Value de la variable contiene el texto de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f07d7-136">The Value property of the variable contains the query text.</span></span> <span data-ttu-id="f07d7-137">La propiedad ValueType de la variable se establece en un tipo de datos de cadena y luego se escribe o se copia la instrucción SQL en la propiedad Value.</span><span class="sxs-lookup"><span data-stu-id="f07d7-137">You set the ValueType property of the variable to a string data type and then type or copy the SQL statement into the Value property.</span></span> <span data-ttu-id="f07d7-138">Para más información, vea [Variables de Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) y [Usar variables en paquetes](../../2014/integration-services/use-variables-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="f07d7-138">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [Use Variables in Packages](../../2014/integration-services/use-variables-in-packages.md).</span></span>  
  
  
