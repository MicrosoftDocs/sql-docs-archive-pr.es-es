---
title: Componente de script | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scriptcomponentdetails.f1
helpviewer_keywords:
- Script transformation
- scripts [Integration Services], transformations
- Script component [Integration Services], about Script component
- Script component [Integration Services]
ms.assetid: 131c2d0c-2e33-4785-94af-ada5c049821e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: af8e500e399b0f69a7e34c9e2e01c74d83256107
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752313"
---
# <a name="script-component"></a><span data-ttu-id="96ed7-102">Componente de script</span><span class="sxs-lookup"><span data-stu-id="96ed7-102">Script Component</span></span>
  <span data-ttu-id="96ed7-103">El componente de script hospeda el script y permite a un paquete incluir y ejecutar código personalizado de script.</span><span class="sxs-lookup"><span data-stu-id="96ed7-103">The Script component hosts script and enables a package to include and run custom script code.</span></span> <span data-ttu-id="96ed7-104">Puede usar el componente de script en paquetes para los siguientes fines:</span><span class="sxs-lookup"><span data-stu-id="96ed7-104">You can use the Script component in packages for the following purposes:</span></span>  
  
-   <span data-ttu-id="96ed7-105">Aplicar varias transformaciones a los datos en lugar de usar varias transformaciones en el flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="96ed7-105">Apply multiple transformations to data instead of using multiple transformations in the data flow.</span></span> <span data-ttu-id="96ed7-106">Por ejemplo, un script puede sumar los valores de dos columnas y luego calcular el promedio de la suma.</span><span class="sxs-lookup"><span data-stu-id="96ed7-106">For example, a script can add the values in two columns and then calculate the average of the sum.</span></span>  
  
-   <span data-ttu-id="96ed7-107">Tener acceso a las reglas de negocios en un ensamblado .NET existente.</span><span class="sxs-lookup"><span data-stu-id="96ed7-107">Access business rules in an existing .NET assembly.</span></span> <span data-ttu-id="96ed7-108">Por ejemplo, un script puede aplicar una norma empresarial que especifica el intervalo de valores que son válidos en la columna `Income`.</span><span class="sxs-lookup"><span data-stu-id="96ed7-108">For example, a script can apply a business rule that specifies the range of values that are valid in an `Income` column.</span></span>  
  
-   <span data-ttu-id="96ed7-109">Usar fórmulas personalizadas y funciones, además de las funciones y operadores que proporciona la gramática de la expresión [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="96ed7-109">Use custom formulas and functions in addition to the functions and operators that the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression grammar provides.</span></span> <span data-ttu-id="96ed7-110">Por ejemplo, validar números de tarjeta de crédito mediante la fórmula LUHN.</span><span class="sxs-lookup"><span data-stu-id="96ed7-110">For example, validate credit card numbers that use the LUHN formula.</span></span>  
  
-   <span data-ttu-id="96ed7-111">Validar datos de columna y omitir registros que contienen datos no válidos.</span><span class="sxs-lookup"><span data-stu-id="96ed7-111">Validate column data and skip records that contain invalid data.</span></span> <span data-ttu-id="96ed7-112">Por ejemplo, un script puede evaluar si un valor de franqueo es razonable y omitir registros con valores extremadamente altos o bajos.</span><span class="sxs-lookup"><span data-stu-id="96ed7-112">For example, a script can assess the reasonableness of a postage amount and skip records with extremely high or low amounts.</span></span>  
  
 <span data-ttu-id="96ed7-113">El componente de script proporciona una manera fácil y rápida de incluir funciones personalizadas en un flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="96ed7-113">The Script component provides an easy and quick way to include custom functions in a data flow.</span></span> <span data-ttu-id="96ed7-114">Sin embargo, si planea reutilizar el código de script en varios paquetes, quizás resulte más conveniente programar un componente personalizado en lugar de usar el componente de script.</span><span class="sxs-lookup"><span data-stu-id="96ed7-114">However, if you plan to reuse the script code in multiple packages, you should consider programming a custom component instead of using the Script component.</span></span> <span data-ttu-id="96ed7-115">Para obtener más información, vea [Desarrollar un componente de flujo de datos personalizado](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="96ed7-115">For more information, see [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="96ed7-116">Si el componente de script contiene un script que intenta leer el valor de una columna que es NULL, se produce un error en el componente de script al ejecutar el paquete.</span><span class="sxs-lookup"><span data-stu-id="96ed7-116">If the Script component contains a script that tries to read the value of a column that is NULL, the Script component fails when you run the package.</span></span> <span data-ttu-id="96ed7-117">Es recomendable que el script use el método <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> para determinar si la columna es NULL antes de intentar leer el valor de la columna.</span><span class="sxs-lookup"><span data-stu-id="96ed7-117">We recommend that your script use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> method to determine whether the column is NULL before trying to read the column value.</span></span>  
  
 <span data-ttu-id="96ed7-118">El componente de script se puede usar como origen, transformación o destino.</span><span class="sxs-lookup"><span data-stu-id="96ed7-118">The Script component can be used as a source, a transformation, or a destination.</span></span> <span data-ttu-id="96ed7-119">Este componente admite una entrada y varias salidas.</span><span class="sxs-lookup"><span data-stu-id="96ed7-119">This component supports one input and multiple outputs.</span></span> <span data-ttu-id="96ed7-120">Según la forma en que se usa el componente, admite una entrada o salidas, o ambas cosas.</span><span class="sxs-lookup"><span data-stu-id="96ed7-120">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="96ed7-121">El script es invocado por cada fila en la entrada o la salida.</span><span class="sxs-lookup"><span data-stu-id="96ed7-121">The script is invoked by every row in the input or output.</span></span>  
  
-   <span data-ttu-id="96ed7-122">Si se usa como origen, el componente de script admite varias salidas.</span><span class="sxs-lookup"><span data-stu-id="96ed7-122">If used as a source, the Script component supports multiple outputs.</span></span>  
  
-   <span data-ttu-id="96ed7-123">Si se usa como transformación, el componente de script admite una entrada y varias salidas.</span><span class="sxs-lookup"><span data-stu-id="96ed7-123">If used as a transformation, the Script component supports one input and multiple outputs.</span></span>  
  
-   <span data-ttu-id="96ed7-124">Si se usa como destino, el componente de script admite una entrada.</span><span class="sxs-lookup"><span data-stu-id="96ed7-124">If used as a destination, the Script component supports one input.</span></span>  
  
 <span data-ttu-id="96ed7-125">El componente de script no admite salidas de error.</span><span class="sxs-lookup"><span data-stu-id="96ed7-125">The Script component does not support error outputs.</span></span>  
  
 <span data-ttu-id="96ed7-126">Una vez que haya decidido que el componente de script es la opción adecuada para su paquete, tiene que configurar las entradas y salidas, desarrollar el script que el componente utiliza y configurar el propio componente.</span><span class="sxs-lookup"><span data-stu-id="96ed7-126">After you decide that the Script component is the appropriate choice for your package, you have to configure the inputs and outputs, develop the script that the component uses, and configure the component itself.</span></span>  
  
## <a name="understanding-the-script-component-modes"></a><span data-ttu-id="96ed7-127">Descripción de los modos del componente de script</span><span class="sxs-lookup"><span data-stu-id="96ed7-127">Understanding the Script Component Modes</span></span>  
 <span data-ttu-id="96ed7-128">En el Diseñador [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , el componente de script tiene dos modos: modo de diseño de metadatos y modo de diseño de código.</span><span class="sxs-lookup"><span data-stu-id="96ed7-128">In the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata-design mode and code-design mode.</span></span> <span data-ttu-id="96ed7-129">En el modo de diseño de metadatos, se pueden agregar y modificar las entradas y salidas de componente de script, pero no se puede escribir código.</span><span class="sxs-lookup"><span data-stu-id="96ed7-129">In metadata-design mode, you can add and modify the Script component inputs and outputs, but you cannot write code.</span></span> <span data-ttu-id="96ed7-130">Una vez configuradas todas las entradas y salidas, se cambia al modo de diseño de código para escribir el script.</span><span class="sxs-lookup"><span data-stu-id="96ed7-130">After all the inputs and outputs are configured, you switch to code-design mode to write the script.</span></span> <span data-ttu-id="96ed7-131">El componente de script genera automáticamente código base a partir de los metadatos de entradas y salidas.</span><span class="sxs-lookup"><span data-stu-id="96ed7-131">The Script component automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="96ed7-132">Si cambia los metadatos después de que el componente de script genere el código de base, es posible que su código ya no pueda compilarse porque el código base actualizado puede ser incompatible con su código.</span><span class="sxs-lookup"><span data-stu-id="96ed7-132">If you change the metadata after the Script component generates the base code, your code may no longer compile because the updated base code may be incompatible with your code.</span></span>  
  
## <a name="writing-the-script-that-the-component-uses"></a><span data-ttu-id="96ed7-133">Escribir el script que el componente utiliza</span><span class="sxs-lookup"><span data-stu-id="96ed7-133">Writing the Script that the Component Uses</span></span>  
 <span data-ttu-id="96ed7-134">El componente de script usa [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools para aplicaciones (VSTA) como entorno para escribir los scripts.</span><span class="sxs-lookup"><span data-stu-id="96ed7-134">The Script component uses [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts.</span></span> <span data-ttu-id="96ed7-135">Puede tener acceso a VSTA en el **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="96ed7-135">You access VSTA from the **Script Transformation Editor**.</span></span> <span data-ttu-id="96ed7-136">Para obtener más información, vea [Editor de transformación Script &#40;página Script&#41;](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="96ed7-136">For more information, see [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="96ed7-137">El componente de script proporciona un proyecto de VSTA que incluye una clase autogenerada, llamada ScriptMain, que representa los metadatos del componente.</span><span class="sxs-lookup"><span data-stu-id="96ed7-137">The Script component provides a VSTA project that includes an auto-generated class, named ScriptMain, that represents the component metadata.</span></span> <span data-ttu-id="96ed7-138">Por ejemplo, si el componente de script se usa como una transformación que tiene tres salidas, ScriptMain incluye un método para cada salida.</span><span class="sxs-lookup"><span data-stu-id="96ed7-138">For example, if the Script component is used as a transformation that has three outputs, ScriptMain includes a method for each output.</span></span> <span data-ttu-id="96ed7-139">ScriptMain es el punto de entrada al script.</span><span class="sxs-lookup"><span data-stu-id="96ed7-139">ScriptMain is the entry point to the script.</span></span>  
  
 <span data-ttu-id="96ed7-140">VSTA incluye todas las características estándar del entorno [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] , como el editor de [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] con códigos de color, IntelliSense y el Explorador de objetos.</span><span class="sxs-lookup"><span data-stu-id="96ed7-140">VSTA includes all the standard features of the [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] editor, IntelliSense, and Object Browser.</span></span> <span data-ttu-id="96ed7-141">El script que usa el componente de script se almacena en la definición de paquete.</span><span class="sxs-lookup"><span data-stu-id="96ed7-141">The script that the Script component uses is stored in the package definition.</span></span> <span data-ttu-id="96ed7-142">Al diseñar el paquete, el código de script se escribe temporalmente en un archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="96ed7-142">When you are designing the package, the script code is temporarily written to a project file.</span></span>  
  
 <span data-ttu-id="96ed7-143">VSTA es compatible con los lenguajes de programación de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# y [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="96ed7-143">VSTA supports the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic programming languages.</span></span>  
  
 <span data-ttu-id="96ed7-144">Para obtener información acerca de cómo programar el componente de script, vea [Ampliar el flujo de datos con el componente de script](script-component.md).</span><span class="sxs-lookup"><span data-stu-id="96ed7-144">For information about how to program the Script component, see [Extending the Data Flow with the Script Component](script-component.md).</span></span> <span data-ttu-id="96ed7-145">Para obtener información más específica acerca de cómo configurar el componente de script como origen, transformación o destino, vea [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="96ed7-145">For more specific information about how to configure the Script component as a source, transformation, or destination, see [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span> <span data-ttu-id="96ed7-146">Para consultar ejemplos adicionales, como un destino ODBC, que ilustran el uso del componente de script, vea [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span><span class="sxs-lookup"><span data-stu-id="96ed7-146">For additional examples such as an ODBC destination that demonstrate the use of the Script component, see [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="96ed7-147">A diferencia de las versiones anteriores en las que podía indicar si se precompilaban los scripts, todos los scripts se precompilan en [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="96ed7-147">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="96ed7-148">Al precompilar el script, no se carga el motor del lenguaje en tiempo de ejecución, por lo que el paquete se ejecuta con mayor rapidez.</span><span class="sxs-lookup"><span data-stu-id="96ed7-148">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="96ed7-149">Sin embargo, los archivos binarios precompilados utilizan una cantidad considerable de espacio en disco.</span><span class="sxs-lookup"><span data-stu-id="96ed7-149">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-component"></a><span data-ttu-id="96ed7-150">Configurar el componente de script</span><span class="sxs-lookup"><span data-stu-id="96ed7-150">Configuring the Script Component</span></span>  
 <span data-ttu-id="96ed7-151">Puede configurar el componente de script de las maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="96ed7-151">You can configure the Script component in the following ways:</span></span>  
  
-   <span data-ttu-id="96ed7-152">Seleccionar las columnas de entrada a las que hacer referencia.</span><span class="sxs-lookup"><span data-stu-id="96ed7-152">Select the input columns to reference.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="96ed7-153">Puede configurar solo una entrada al usar el Diseñador de [!INCLUDE[ssIS](../../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="96ed7-153">You can configure only one input when you use the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer.</span></span>  
  
-   <span data-ttu-id="96ed7-154">Proporcionar el script que ejecuta el componente.</span><span class="sxs-lookup"><span data-stu-id="96ed7-154">Provide the script that the component runs.</span></span>  
  
-   <span data-ttu-id="96ed7-155">Especificar el lenguaje de script.</span><span class="sxs-lookup"><span data-stu-id="96ed7-155">Specify the script language.</span></span>  
  
-   <span data-ttu-id="96ed7-156">Proporcionar listas separadas por comas de variables de solo lectura y de lectura/escritura.</span><span class="sxs-lookup"><span data-stu-id="96ed7-156">Provide comma-separated lists of read-only and read/write variables.</span></span>  
  
-   <span data-ttu-id="96ed7-157">Agregue más salidas, así como columnas de salida en las que el script realiza asignaciones.</span><span class="sxs-lookup"><span data-stu-id="96ed7-157">Add more outputs, and add output columns to which the script assigns.</span></span>  
  
 <span data-ttu-id="96ed7-158">Puede establecer propiedades a través del Diseñador de [!INCLUDE[ssIS](../../../includes/ssis-md.md)] o mediante programación.</span><span class="sxs-lookup"><span data-stu-id="96ed7-158">You can set properties through [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-component-in-the-designer"></a><span data-ttu-id="96ed7-159">Configurar el componente de script en el Diseñador</span><span class="sxs-lookup"><span data-stu-id="96ed7-159">Configuring the Script Component in the Designer</span></span>  
 <span data-ttu-id="96ed7-160">Para obtener más información sobre las propiedades que se pueden establecer en el cuadro de diálogo **Editor de transformación Script** , haga clic en uno de los siguientes temas:</span><span class="sxs-lookup"><span data-stu-id="96ed7-160">For more information about the properties that you can set in the **Script Transformation Editor** dialog box, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="96ed7-161">Editor de transformación Script &#40;página Columnas de entrada&#41;</span><span class="sxs-lookup"><span data-stu-id="96ed7-161">Script Transformation Editor &#40;Input Columns Page&#41;</span></span>](../../script-transformation-editor-input-columns-page.md)  
  
-   [<span data-ttu-id="96ed7-162">Editor de transformación Script &#40;página Entradas y salidas&#41;</span><span class="sxs-lookup"><span data-stu-id="96ed7-162">Script Transformation Editor &#40;Inputs and Outputs Page&#41;</span></span>](../../script-transformation-editor-inputs-and-outputs-page.md)  
  
-   [<span data-ttu-id="96ed7-163">Editor de transformación Script &#40;página Script&#41;</span><span class="sxs-lookup"><span data-stu-id="96ed7-163">Script Transformation Editor &#40;Script Page&#41;</span></span>](../../script-transformation-editor-script-page.md)  
  
-   [<span data-ttu-id="96ed7-164">Editor de transformación Script &#40;página Administradores de conexión&#41;</span><span class="sxs-lookup"><span data-stu-id="96ed7-164">Script Transformation Editor &#40;Connection Managers Page&#41;</span></span>](../../script-transformation-editor-connection-managers-page.md)  
  
 <span data-ttu-id="96ed7-165">Para obtener más información sobre cómo establecer estas propiedades en el Diseñador [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , haga clic en el siguiente tema:</span><span class="sxs-lookup"><span data-stu-id="96ed7-165">For more information about how to set these properties in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="96ed7-166">Establecer las propiedades de un componente de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="96ed7-166">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
### <a name="configuring-the-script-component-programmatically"></a><span data-ttu-id="96ed7-167">Configurar el componente de script mediante programación</span><span class="sxs-lookup"><span data-stu-id="96ed7-167">Configuring the Script Component Programmatically</span></span>  
 <span data-ttu-id="96ed7-168">Para obtener más información sobre las propiedades que se pueden establecer en la ventana **Propiedades** o mediante programación, haga clic en uno de los siguientes temas:</span><span class="sxs-lookup"><span data-stu-id="96ed7-168">For more information about the properties that you can set in the **Properties** window or programmatically, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="96ed7-169">Common Properties</span><span class="sxs-lookup"><span data-stu-id="96ed7-169">Common Properties</span></span>](../../common-properties.md)  
  
-   [<span data-ttu-id="96ed7-170">Propiedades personalizadas de transformación</span><span class="sxs-lookup"><span data-stu-id="96ed7-170">Transformation Custom Properties</span></span>](transformation-custom-properties.md)  
  
 <span data-ttu-id="96ed7-171">Para obtener más información sobre cómo establecer valores de propiedades, haga clic en uno de los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="96ed7-171">For more information about how to set properties, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="96ed7-172">Establecer las propiedades de un componente de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="96ed7-172">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="96ed7-173">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="96ed7-173">Related Content</span></span>  
 [<span data-ttu-id="96ed7-174">Transformaciones de Integration Services</span><span class="sxs-lookup"><span data-stu-id="96ed7-174">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
 [<span data-ttu-id="96ed7-175">Ampliar el flujo de datos con el componente de script</span><span class="sxs-lookup"><span data-stu-id="96ed7-175">Extending the Data Flow with the Script Component</span></span>](script-component.md)  
  
  
