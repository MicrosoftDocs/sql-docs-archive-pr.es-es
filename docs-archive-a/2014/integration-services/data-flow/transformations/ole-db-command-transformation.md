---
title: Transformación Comando de OLE DB | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87752326"
---
# <a name="ole-db-command-transformation"></a><span data-ttu-id="8d4c3-102">transformación Comando de OLE DB</span><span class="sxs-lookup"><span data-stu-id="8d4c3-102">OLE DB Command Transformation</span></span>
  <span data-ttu-id="8d4c3-103">La transformación Comando de OLE DB ejecuta una instrucción SQL para cada fila en un flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-103">The OLE DB Command transformation runs an SQL statement for each row in a data flow.</span></span> <span data-ttu-id="8d4c3-104">Por ejemplo, puede ejecutar una instrucción SQL que inserte, actualice o elimine filas en una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-104">For example, you can run an SQL statement that inserts, updates, or deletes rows in a database table.</span></span>  
  
 <span data-ttu-id="8d4c3-105">Puede configurar el administrador de conexiones OLE DB de las maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="8d4c3-105">You can configure the OLE DB Command Transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="8d4c3-106">Proporcionar la instrucción SQL que la transformación ejecuta para cada fila.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-106">Provide the SQL statement that the transformation runs for each row.</span></span>  
  
-   <span data-ttu-id="8d4c3-107">Especifica la cantidad de segundos que tienen que transcurrir antes de que la instrucción SQL agote el tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-107">Specify the number of seconds before the SQL statement times out.</span></span>  
  
-   <span data-ttu-id="8d4c3-108">Especificar la página de códigos predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-108">Specify the default code page.</span></span>  
  
 <span data-ttu-id="8d4c3-109">Normalmente, la instrucción SQL incluye parámetros.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-109">Typically, the SQL statement includes parameters.</span></span> <span data-ttu-id="8d4c3-110">Los valores de parámetro se almacenan en columnas externas en la entrada de transformación y al asignar una columna de entrada a una columna externa se asigna una columna de entrada a un parámetro.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-110">The parameter values are stored in external columns in the transformation input, and mapping an input column to an external column maps an input column to a parameter.</span></span> <span data-ttu-id="8d4c3-111">Por ejemplo, para buscar filas en la tabla **DimProduct** por el valor de su columna **ProductKey** y luego eliminarlas, puede asignar la columna externa denominada **Param_0** a la columna de entrada denominada **ProductKey** y luego ejecutar la instrucción SQL `DELETE FROM DimProduct WHERE ProductKey = ?`.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-111">For example, to locate rows in the **DimProduct** table by the value in their **ProductKey** column and then delete them, you can map the external column named **Param_0** to the input column named **ProductKey,** and then run the SQL statement `DELETE FROM DimProduct WHERE ProductKey = ?`..</span></span> <span data-ttu-id="8d4c3-112">La transformación Comando de OLE DB proporciona los nombres de parámetro y no puede modificarlos.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-112">The OLE DB Command transformation provides the parameter names and you cannot modify them.</span></span> <span data-ttu-id="8d4c3-113">Los nombres de parámetro son **Param_0**, **Param_1**y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-113">The parameter names are **Param_0**, **Param_1**, and so on.</span></span>  
  
 <span data-ttu-id="8d4c3-114">Si configura la transformación Comando de OLE DB mediante el cuadro de diálogo **Editor avanzado** , los parámetros de la instrucción SQL se pueden asignar automáticamente a las columnas externas en la entrada de transformación y las características de cada parámetro se definen haciendo clic en el botón **Actualizar** .</span><span class="sxs-lookup"><span data-stu-id="8d4c3-114">If you configure the OLE DB Command transformation by using the **Advanced Editor** dialog box, the parameters in the SQL statement may be mapped automatically to external columns in the transformation input, and the characteristics of each parameter defined, by clicking the **Refresh** button.</span></span> <span data-ttu-id="8d4c3-115">Sin embargo, si el proveedor OLE DB que usa la transformación Comando de OLE DB no admite la derivación de la información de parámetros del parámetro, debe configurar las columnas externas manualmente.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-115">However, if the OLE DB provider that the OLE DB Command transformation uses does not support deriving parameter information from the parameter, you must configure the external columns manually.</span></span> <span data-ttu-id="8d4c3-116">Esto significa que debe agregar una columna por cada parámetro a la entrada externa a la transformación, actualizar los nombres de columna para que usen nombres como **Param_0**, especificar el valor de la propiedad DBParamInfoFlags y asignar las columnas de entrada que contienen valores de parámetro a las columnas externas.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-116">This means that you must add a column for each parameter to the external input to the transformation, update the column names to use names like **Param_0**, specify the value of the DBParamInfoFlags property, and map the input columns that contain parameter values to the external columns.</span></span>  
  
 <span data-ttu-id="8d4c3-117">El valor de DBParamInfoFlags representa las características del parámetro.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-117">The value of DBParamInfoFlags represents the characteristics of the parameter.</span></span> <span data-ttu-id="8d4c3-118">Por ejemplo, el valor **1** especifica que el parámetro es un parámetro de entrada, y el valor **65** especifica que el parámetro es un parámetro de entrada y puede contener un valor NULL.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-118">For example, the value **1** specifies that the parameter is an input parameter, and the value **65** specifies that the parameter is an input parameter and may contain a null value.</span></span> <span data-ttu-id="8d4c3-119">Los valores deben coincidir con los valores de la enumeración OLE DB DBPARAMFLAGSENUM.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-119">The values must match the values in the OLE DB DBPARAMFLAGSENUM enumeration.</span></span> <span data-ttu-id="8d4c3-120">Para obtener más información, vea la documentación de referencia de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-120">For more information, see the OLE DB reference documentation.</span></span>  
  
 <span data-ttu-id="8d4c3-121">La transformación Comando de OLE DB incluye la propiedad personalizada `SQLCommand`.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-121">The OLE DB Command transformation includes the `SQLCommand` custom property.</span></span> <span data-ttu-id="8d4c3-122">Esta propiedad se puede actualizar a través de una expresión de propiedad, al cargar el paquete.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-122">This property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="8d4c3-123">Para más información, vea [Expresiones de Integration Services &#40;SSIS&#41;](../../expressions/integration-services-ssis-expressions.md), [Usar expresiones de propiedad en paquetes](../../expressions/use-property-expressions-in-packages.md) y [Propiedades personalizadas de transformación](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="8d4c3-123">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
 <span data-ttu-id="8d4c3-124">Esta transformación tiene una entrada, una salida normal y una salida de error.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-124">This transformation has one input, one regular output, and one error output.</span></span>  
  
## <a name="logging"></a><span data-ttu-id="8d4c3-125">Registro</span><span class="sxs-lookup"><span data-stu-id="8d4c3-125">Logging</span></span>  
 <span data-ttu-id="8d4c3-126">Puede registrar las llamadas realizadas por la transformación Comando de OLE DB a proveedores de datos externos.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-126">You can log the calls that the OLE DB Command transformation makes to external data providers.</span></span> <span data-ttu-id="8d4c3-127">Puede utilizar esta capacidad de registro para solucionar problemas relacionados con las conexiones y los comandos a orígenes de datos externos realizados por la transformación Comando de OLE DB.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-127">You can use this logging capability to troubleshoot the connections and commands to external data sources that the OLE DB Command transformation performs.</span></span> <span data-ttu-id="8d4c3-128">Para registrar las llamadas que la transformación Comando de OLE DB realiza a los proveedores de datos externos, habilite el registro de paquetes y seleccione el evento **Diagnostic** en el nivel de paquete.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-128">To log the calls that the OLE DB Command transformation makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="8d4c3-129">Para más información, vea [Herramientas para solucionar problemas con la ejecución de paquetes](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="8d4c3-129">For more information, see [Troubleshooting Tools for Package Execution](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="8d4c3-130">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="8d4c3-130">Related Tasks</span></span>  
 <span data-ttu-id="8d4c3-131">Puede configurar la transformación mediante el Diseñador de [!INCLUDE[ssIS](../../../includes/ssis-md.md)] o el modelo de objetos.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-131">You can configure the transformation by either using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or the object model.</span></span> <span data-ttu-id="8d4c3-132">Para obtener detalles sobre cómo configurar la transformación mediante el Diseñador [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , vea  [Configurar la transformación Comando de OLE DB](../../configure-the-ole-db-command-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="8d4c3-132">For details about configuring the transformation using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] designer, see  [Configure the OLE DB Command Transformation](../../configure-the-ole-db-command-transformation.md).</span></span> <span data-ttu-id="8d4c3-133">Vea la Guía del desarrollador para obtener información detallada sobre la configuración mediante programación de esta transformación.</span><span class="sxs-lookup"><span data-stu-id="8d4c3-133">See the Developer Guide for details about programmatically configuring this transformation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8d4c3-134">Consulte también</span><span class="sxs-lookup"><span data-stu-id="8d4c3-134">See Also</span></span>  
 <span data-ttu-id="8d4c3-135">[Flujo de datos](../data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="8d4c3-135">[Data Flow](../data-flow.md) </span></span>  
 [<span data-ttu-id="8d4c3-136">Transformaciones de Integration Services</span><span class="sxs-lookup"><span data-stu-id="8d4c3-136">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
