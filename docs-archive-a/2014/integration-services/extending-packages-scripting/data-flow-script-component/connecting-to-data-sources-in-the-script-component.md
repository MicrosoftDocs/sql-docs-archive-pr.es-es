---
title: Conectarse a orígenes de datos del componente de script | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Script component [Integration Services], connecting to data sources
ms.assetid: 96de63ab-ff48-4e7e-89e0-ffd6a89c63b6
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 9272f946abb68a1c54cd6f4851806ec6a1b15de7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87674208"
---
# <a name="connecting-to-data-sources-in-the-script-component"></a><span data-ttu-id="69cd6-102">Conectarse a orígenes de datos del componente de script</span><span class="sxs-lookup"><span data-stu-id="69cd6-102">Connecting to Data Sources in the Script Component</span></span>
  <span data-ttu-id="69cd6-103">Un administrador de conexiones es una unidad práctica que encapsula y almacena la información necesaria para conectarse a un origen de datos de un tipo determinado.</span><span class="sxs-lookup"><span data-stu-id="69cd6-103">A connection manager is a convenient unit that encapsulates and stores the information that is required to connect to a data source of a particular type.</span></span> <span data-ttu-id="69cd6-104">Para más información, vea [Conexiones de Integration Services &#40;SSIS&#41;](../../connection-manager/integration-services-ssis-connections.md).</span><span class="sxs-lookup"><span data-stu-id="69cd6-104">For more information, see [Integration Services &#40;SSIS&#41; Connections](../../connection-manager/integration-services-ssis-connections.md).</span></span>  
  
 <span data-ttu-id="69cd6-105">Para hacer que los administradores de conexiones existentes estén disponibles para el acceso por parte del script personalizado del componente de origen o de destino, haga clic en los botones **Agregar** y **Quitar** de la página **Administradores de conexiones** del **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="69cd6-105">You can make existing connection managers available for access by the custom script in the source or destination component by clicking the **Add** and **Remove** buttons on the **Connection Managers** page of the **Script Transformation Editor**.</span></span> <span data-ttu-id="69cd6-106">Sin embargo, debe escribir su propio código personalizado para cargar o guardar los datos y posiblemente para abrir y cerrar la conexión al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="69cd6-106">However, you must write your own custom code to load or save your data, and possibly to open and close the connection to the data source.</span></span> <span data-ttu-id="69cd6-107">Para obtener más información acerca de la página **Administradores de conexiones** del **Editor de transformación Script**, vea [Configurar el componente de script en el editor de componentes de script](configuring-the-script-component-in-the-script-component-editor.md) y [Editor de transformación Script &#40;página Administradores de conexiones&#41;](../../script-transformation-editor-connection-managers-page.md).</span><span class="sxs-lookup"><span data-stu-id="69cd6-107">For more information about the **Connection Managers** page of the **Script Transformation Editor**, see [Configuring the Script Component in the Script Component Editor](configuring-the-script-component-in-the-script-component-editor.md) and [Script Transformation Editor &#40;Connection Managers Page&#41;](../../script-transformation-editor-connection-managers-page.md).</span></span>  
  
 <span data-ttu-id="69cd6-108">El componente de script crea una clase de colección `Connections` en el elemento de proyecto `ComponentWrapper` que contiene un descriptor de acceso con establecimiento inflexible de tipos para cada administrador de conexiones que tiene el mismo nombre que el propio administrador de conexiones.</span><span class="sxs-lookup"><span data-stu-id="69cd6-108">The Script component creates a `Connections` collection class in the `ComponentWrapper` project item that contains a strongly-typed accessor for each connection manager that has the same name as the connection manager itself.</span></span> <span data-ttu-id="69cd6-109">Esta colección se expone mediante la propiedad `Connections` de la clase `ScriptMain`.</span><span class="sxs-lookup"><span data-stu-id="69cd6-109">This collection is exposed through the `Connections` property of the `ScriptMain` class.</span></span> <span data-ttu-id="69cd6-110">La propiedad de descriptor de acceso devuelve una referencia al administrador de conexiones como una instancia de <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span><span class="sxs-lookup"><span data-stu-id="69cd6-110">The accessor property returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="69cd6-111">Por ejemplo, si ha agregado un administrador de conexiones denominado `MyADONETConnection` en la página Administradores de conexión del cuadro de diálogo, puede obtener una referencia a dicho administrador en el script agregando el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="69cd6-111">For example, if you have added a connection manager named `MyADONETConnection` on the Connection Managers page of the dialog box, you can obtain a reference to it in your script by adding the following code:</span></span>  
  
 `Dim myADONETConnectionManager As IDTSConnectionManager100 = _`  
  
 `Me.Connections.MyADONETConnection`  
  
> [!NOTE]  
>  <span data-ttu-id="69cd6-112">Debe conocer el tipo de conexión que el administrador de conexiones devuelve antes de llamar a `AcquireConnection`.</span><span class="sxs-lookup"><span data-stu-id="69cd6-112">You must know the type of connection that is returned by the connection manager before you call `AcquireConnection`.</span></span> <span data-ttu-id="69cd6-113">Dado que la tarea Script tiene habilitado `Option Strict`, debe convertir la conexión, que se devuelve como tipo `Object`, al tipo de conexión adecuado antes de poder utilizarlo.</span><span class="sxs-lookup"><span data-stu-id="69cd6-113">Because the Script task has `Option Strict` enabled, you must cast the connection, which is returned as type `Object`, to the appropriate connection type before you can use it.</span></span>  
  
 <span data-ttu-id="69cd6-114">A continuación, puede llamar al método `AcquireConnection` del administrador de conexiones concreto para obtener la conexión subyacente o la información necesaria para conectarse al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="69cd6-114">Next, you call the `AcquireConnection` method of the specific connection manager to obtain either the underlying connection or the information that is required to connect to the data source.</span></span> <span data-ttu-id="69cd6-115">Por ejemplo, puede obtener una referencia al objeto **System.Data.SqlConnection** ajustado por un administrador de conexiones ADO.NET utilizando el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="69cd6-115">For example, you obtain a reference to the **System.Data.SqlConnection** wrapped by an ADO.NET connection manager by using the following code:</span></span>  
  
 `Dim myADOConnection As SqlConnection = _`  
  
 `CType(MyADONETConnectionManager.AcquireConnection(Nothing), SqlConnection)`  
  
 <span data-ttu-id="69cd6-116">En cambio, la misma llamada a un administrador de conexiones de archivos planos devuelve solamente la ruta de acceso y nombre de archivo del origen de datos de archivo.</span><span class="sxs-lookup"><span data-stu-id="69cd6-116">In contrast, the same call to a flat file connection manager returns only the path and file name of the file data source.</span></span>  
  
 `Dim myFlatFile As String = _`  
  
 `CType(MyFlatFileConnectionManager.AcquireConnection(Nothing), String)`  
  
 <span data-ttu-id="69cd6-117">A continuación, debe proporcionar esta ruta de acceso y nombre de archivo a `System.IO.StreamReader` o `Streamwriter` para leer o escribir los datos en el archivo plano.</span><span class="sxs-lookup"><span data-stu-id="69cd6-117">You then must provide this path and file name to a `System.IO.StreamReader` or `Streamwriter` to read or write the data in the flat file.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="69cd6-118">Al escribir el código administrado en un componente de script, no puede llamar al método AcquireConnection de los administradores de conexiones que devuelven objetos no administrados, como el administrador de conexiones de OLE DB y el administrador de conexiones de Excel.</span><span class="sxs-lookup"><span data-stu-id="69cd6-118">When you write managed code in a Script component, you cannot call the AcquireConnection method of connection managers that return unmanaged objects, such as the OLE DB connection manager and the Excel connection manager.</span></span> <span data-ttu-id="69cd6-119">Sin embargo, puede leer la propiedad ConnectionString de estos administradores de conexiones y conectarse directamente al origen de datos en el código utilizando la cadena de conexión de una **conexión** OLEDB del espacio de nombres **System.Data.OleDb**.</span><span class="sxs-lookup"><span data-stu-id="69cd6-119">However, you can read the ConnectionString property of these connection managers, and connect to the data source directly in your code by using the connection string of an OLEDB **connection** from the **System.Data.OleDb** namespace.</span></span>  
>   
>  <span data-ttu-id="69cd6-120">Si tiene que llamar al método AcquireConnection de un administrador de conexiones que devuelve un objeto no administrado, utilice un administrador de conexiones ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="69cd6-120">If you need to call the AcquireConnection method of a connection manager that returns an unmanaged object, use an ADO.NET connection manager.</span></span> <span data-ttu-id="69cd6-121">Al configurar el administrador de conexiones ADO.NET para utilizar un proveedor OLE DB, se conecta mediante el proveedor de datos de .NET Framework para OLE DB.</span><span class="sxs-lookup"><span data-stu-id="69cd6-121">When you configure the ADO.NET connection manager to use an OLE DB provider, it connects by using the .NET Framework Data Provider for OLE DB.</span></span> <span data-ttu-id="69cd6-122">En este caso, el método AcquireConnection devuelve un `System.Data.OleDb.OleDbConnection` objeto en lugar de un objeto no administrado.</span><span class="sxs-lookup"><span data-stu-id="69cd6-122">In this case, the AcquireConnection method returns a `System.Data.OleDb.OleDbConnection` instead of an unmanaged object.</span></span> <span data-ttu-id="69cd6-123">Para configurar un administrador de conexiones ADO.NET para su uso con un origen de datos de Excel, seleccione el proveedor OLE DB de Microsoft para Jet, especifique un libro de Excel y, a continuación, escriba `Excel 8.0` (para Excel 97 y posterior) como el valor de **Propiedades extendidas** en la página **Todas** del cuadro de diálogo **Administrador de conexiones**.</span><span class="sxs-lookup"><span data-stu-id="69cd6-123">To configure an ADO.NET connection manager for use with an Excel data source, select the Microsoft OLE DB Provider for Jet, specify an Excel workbook, and then enter `Excel 8.0` (for Excel 97 and later) as the value of **Extended Properties** on the **All** page of the **Connection Manager** dialog box.</span></span>  
  
 <span data-ttu-id="69cd6-124">Para obtener más información acerca de cómo se utilizan los administradores de conexiones con el componente de script, consulte [Crear un origen con el componente de script](../../extending-packages-scripting-data-flow-script-component-types/creating-a-source-with-the-script-component.md) y [Crear un destino con el componente de script](../../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="69cd6-124">For more information about how to use connection managers with the script component, see [Creating a Source with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-source-with-the-script-component.md) and [Creating a Destination with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span></span>  
  
<span data-ttu-id="69cd6-125">![Integration Services icono (pequeño)](../../media/dts-16.gif "Icono de Integration Services (pequeño)")  **Manténgase al día con Integration Services**</span><span class="sxs-lookup"><span data-stu-id="69cd6-125">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="69cd6-126">Para obtener las descargas, artículos, ejemplos y vídeos más recientes de Microsoft, así como soluciones seleccionadas de la comunidad, visite la página de [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] en MSDN:</span><span class="sxs-lookup"><span data-stu-id="69cd6-126">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="69cd6-127">Visite la página de Integration Services en MSDN</span><span class="sxs-lookup"><span data-stu-id="69cd6-127">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="69cd6-128">Para recibir notificaciones automáticas de estas actualizaciones, suscríbase a las fuentes RSS disponibles en la página.</span><span class="sxs-lookup"><span data-stu-id="69cd6-128">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="69cd6-129">Consulte también</span><span class="sxs-lookup"><span data-stu-id="69cd6-129">See Also</span></span>  
 <span data-ttu-id="69cd6-130">[Integration Services &#40;SSIS&#41; conexiones](../../connection-manager/integration-services-ssis-connections.md) </span><span class="sxs-lookup"><span data-stu-id="69cd6-130">[Integration Services &#40;SSIS&#41; Connections](../../connection-manager/integration-services-ssis-connections.md) </span></span>  
 [<span data-ttu-id="69cd6-131">Crear administradores de conexiones</span><span class="sxs-lookup"><span data-stu-id="69cd6-131">Create Connection Managers</span></span>](../../create-connection-managers.md)  
  
  
