---
title: Tarea Control CDC | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.ssis.designer.cdccontroltask.f1
ms.assetid: 6404dc7f-550c-47cc-b901-c072742f430a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 36f98a02842353fd5196432738f4ebd8b2efb46c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672232"
---
# <a name="cdc-control-task"></a><span data-ttu-id="b8d00-102">Tarea Control CDC</span><span class="sxs-lookup"><span data-stu-id="b8d00-102">CDC Control Task</span></span>
  <span data-ttu-id="b8d00-103">La tarea Control CDC se usa para controlar el ciclo de vida de los paquetes de captura de datos modificados (CDC).</span><span class="sxs-lookup"><span data-stu-id="b8d00-103">The CDC Control task is used to control the life cycle of change data capture (CDC) packages.</span></span> <span data-ttu-id="b8d00-104">Controla la sincronización de paquetes CDC con el paquete de carga inicial, la administración de los intervalos de número de secuencia de registro (LSN) que se procesan en una ejecución de un paquete CDC.</span><span class="sxs-lookup"><span data-stu-id="b8d00-104">It handles CDC package synchronization with the initial load package, the management of Log Sequence Number (LSN) ranges that are processed in a run of a CDC package.</span></span> <span data-ttu-id="b8d00-105">Además, la tarea Control CDC se ocupa de los escenarios de error y de la recuperación.</span><span class="sxs-lookup"><span data-stu-id="b8d00-105">In addition, the CDC Control task deals with error scenarios and recovery.</span></span>  
  
 <span data-ttu-id="b8d00-106">La tarea Control CDC mantiene el estado del paquete CDC en una variable de paquete SSIS y también puede conservarlo en una tabla de base de datos para mantener el estado a través de las activaciones de paquete y entre varios paquetes que realizan conjuntamente un proceso CDC común (por ejemplo, una tarea puede ser responsable de la carga inicial y otro de las actualizaciones de fuente de generación).</span><span class="sxs-lookup"><span data-stu-id="b8d00-106">The CDC Control task maintains the state of the CDC package in an SSIS package variable and it can also persist it in a database table so that the state is maintained across package activations and between multiple packages that together perform a common CDC process (for example, one task may be responsible for the initial loading and the other for the trickle-feed updates).</span></span>  
  
 <span data-ttu-id="b8d00-107">La tarea Control CDC admite dos grupos de operaciones.</span><span class="sxs-lookup"><span data-stu-id="b8d00-107">The CDC Control task supports two groups of operations.</span></span> <span data-ttu-id="b8d00-108">Un grupo controla la sincronización del procesamiento de los cambios y la carga inicial y el otro administra el intervalo de procesamiento de los cambios de los LSN para una ejecución de un paquete CDC y realiza el seguimiento de lo que se procesó correctamente.</span><span class="sxs-lookup"><span data-stu-id="b8d00-108">One group handles the synchronization of initial load and change processing, and the other manages the change-processing range of LSNs for a run of a CDC package and keeps track of what was processed successfully.</span></span>  
  
 <span data-ttu-id="b8d00-109">Las siguientes operaciones controlan la sincronización de la carga inicial y el procesamiento de cambios:</span><span class="sxs-lookup"><span data-stu-id="b8d00-109">The following operations handle the synchronization of initial load and change processing:</span></span>  
  
|<span data-ttu-id="b8d00-110">Operación</span><span class="sxs-lookup"><span data-stu-id="b8d00-110">Operation</span></span>|<span data-ttu-id="b8d00-111">Descripción</span><span class="sxs-lookup"><span data-stu-id="b8d00-111">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="b8d00-112">ResetCdcState</span><span class="sxs-lookup"><span data-stu-id="b8d00-112">ResetCdcState</span></span>|<span data-ttu-id="b8d00-113">Esta operación se usa para restablecer el estado CDC persistente asociado al contexto CDC actual.</span><span class="sxs-lookup"><span data-stu-id="b8d00-113">This operation is used to reset the persistent CDC state associated with the current CDC context.</span></span> <span data-ttu-id="b8d00-114">Después de ejecutar esta operación, el LSN máximo actual de la tabla de `sys.fn_cdc_get_max_lsn` de la marca de tiempo de LSN se convierte en el inicio del intervalo para el siguiente intervalo de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="b8d00-114">After this operation is run, the current maximum LSN from the LSN-timestamp `sys.fn_cdc_get_max_lsn` table becomes the start of the range for the next processing range.</span></span> <span data-ttu-id="b8d00-115">Esta operación requiere una conexión a la base de datos de origen.</span><span class="sxs-lookup"><span data-stu-id="b8d00-115">This operation requires a connection to the source database.</span></span>|  
|<span data-ttu-id="b8d00-116">MarkInitialLoadStart</span><span class="sxs-lookup"><span data-stu-id="b8d00-116">MarkInitialLoadStart</span></span>|<span data-ttu-id="b8d00-117">Esta operación se usa al comienzo de un paquete de carga inicial para registrar el LSN actual en la base de datos de origen antes de que el paquete de carga inicial comience a leer las tablas de origen.</span><span class="sxs-lookup"><span data-stu-id="b8d00-117">This operation is used at the beginning of an initial-load package to record the current LSN in the source database before the initial-load package starts reading the source tables.</span></span> <span data-ttu-id="b8d00-118">Esto requiere una conexión a la base de datos de origen para llamar a `sys.fn_cdc_get_max_lsn`.</span><span class="sxs-lookup"><span data-stu-id="b8d00-118">This requires a connection to the source database to call `sys.fn_cdc_get_max_lsn`.</span></span><br /><br /> <span data-ttu-id="b8d00-119">Si selecciona MarkInitialLoadStart cuando trabaja en CDC de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (es decir, no en Oracle), el usuario especificado en el administrador de conexiones debe ser db_owner o sysadmin.</span><span class="sxs-lookup"><span data-stu-id="b8d00-119">If you select MarkInitialLoadStart when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is, not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
|<span data-ttu-id="b8d00-120">MarkInitialLoadEnd</span><span class="sxs-lookup"><span data-stu-id="b8d00-120">MarkInitialLoadEnd</span></span>|<span data-ttu-id="b8d00-121">Esta operación se usa al final de un paquete de carga inicial para registrar el LSN actual en la base de datos de origen después de que el paquete de carga inicial termine de leer las tablas de origen.</span><span class="sxs-lookup"><span data-stu-id="b8d00-121">This operation is used at the end of an initial-load package to record the current LSN in the source database after the initial-load package finished reading the source tables.</span></span> <span data-ttu-id="b8d00-122">Este LSN se determina mediante el registro de la hora en el momento en que se produjo esta operación y, posteriormente, mediante consulta a la tabla de asignación de `cdc.lsn_time_`de la base de datos CDC en busca de un cambio que hubiera tenido lugar después de dicha hora.</span><span class="sxs-lookup"><span data-stu-id="b8d00-122">This LSN is determined by recording the current time when this operation occurred and then querying the `cdc.lsn_time_`mapping table in the CDC database looking for a change that occurred after that time.</span></span><br /><br /> <span data-ttu-id="b8d00-123">Si selecciona MarkInitialLoadEnd cuando trabaja en CDC de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (es decir, no en Oracle), el usuario especificado en el administrador de conexiones debe ser db_owner o sysadmin.</span><span class="sxs-lookup"><span data-stu-id="b8d00-123">If you select MarkInitialLoadEnd when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is , not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
|<span data-ttu-id="b8d00-124">MarkCdcStart</span><span class="sxs-lookup"><span data-stu-id="b8d00-124">MarkCdcStart</span></span>|<span data-ttu-id="b8d00-125">Esta operación se usa cuando la carga inicial se realiza desde una base de datos de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="b8d00-125">This operation is used when then the initial load is made from a snapshot database.</span></span> <span data-ttu-id="b8d00-126">En este caso, el procesamiento de cambios debe iniciarse inmediatamente después del LSN de la instantánea.</span><span class="sxs-lookup"><span data-stu-id="b8d00-126">In this case, the change processing should start immediately after the snapshot LSN.</span></span> <span data-ttu-id="b8d00-127">Puede especificar el nombre de la base de datos de instantáneas que se usará y la tarea Control CDC consulta a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] el LSN de la instantánea.</span><span class="sxs-lookup"><span data-stu-id="b8d00-127">You can specify the name of the snapshot database to use and the CDC Control task queries [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] for the snapshot LSN.</span></span> <span data-ttu-id="b8d00-128">También tiene la opción de especificar directamente el LSN de la instantánea</span><span class="sxs-lookup"><span data-stu-id="b8d00-128">You also have the option to directly specify the snapshot LSN.</span></span><br /><br /> <span data-ttu-id="b8d00-129">Si selecciona MarkCdcStart cuando trabaja en CDC de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (es decir, no en Oracle), el usuario especificado en el administrador de conexiones debe ser db_owner o sysadmin.</span><span class="sxs-lookup"><span data-stu-id="b8d00-129">If you select MarkCdcStart when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is , not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
  
 <span data-ttu-id="b8d00-130">Las operaciones siguientes se usan para administrar el intervalo de procesamiento:</span><span class="sxs-lookup"><span data-stu-id="b8d00-130">The following operations are used to manage the processing range:</span></span>  
  
|<span data-ttu-id="b8d00-131">Operación</span><span class="sxs-lookup"><span data-stu-id="b8d00-131">Operation</span></span>|<span data-ttu-id="b8d00-132">Descripción</span><span class="sxs-lookup"><span data-stu-id="b8d00-132">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="b8d00-133">GetProcessingRange</span><span class="sxs-lookup"><span data-stu-id="b8d00-133">GetProcessingRange</span></span>|<span data-ttu-id="b8d00-134">Esta operación se usa antes de invocar el flujo de datos que usa el flujo de datos origen de CDC.</span><span class="sxs-lookup"><span data-stu-id="b8d00-134">This operation is used before invoking the data flow that uses the CDC Source data flow.</span></span> <span data-ttu-id="b8d00-135">Establece un intervalo de LSN que lee el flujo de datos de origen de CDC cuando se invoca.</span><span class="sxs-lookup"><span data-stu-id="b8d00-135">It establishes a range of LSNs that the CDC Source data flow reads when invoked.</span></span> <span data-ttu-id="b8d00-136">El intervalo se almacena en una variable de paquete SSIS que usa el origen de CDC durante el procesamiento del flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="b8d00-136">The range is stored in an SSIS package variable that is used by the CDC Source during data-flow processing.</span></span><br /><br /> <span data-ttu-id="b8d00-137">Para obtener más información sobre los estados que se almacenan, vea [Definir una variable de estado](../data-flow/define-a-state-variable.md).</span><span class="sxs-lookup"><span data-stu-id="b8d00-137">For more information about the states that are stored, see [Define a State Variable](../data-flow/define-a-state-variable.md).</span></span>|  
|<span data-ttu-id="b8d00-138">MarkProcessedRange</span><span class="sxs-lookup"><span data-stu-id="b8d00-138">MarkProcessedRange</span></span>|<span data-ttu-id="b8d00-139">: esta operación se ejecuta después de cada ejecución de CDC (después de que el flujo de datos de CDC se completa correctamente) para registrar el último LSN que se ha procesado totalmente en la ejecución de CDC.</span><span class="sxs-lookup"><span data-stu-id="b8d00-139">: This operation is executed after each CDC run (after the CDC data flow is completed successfully) to record the last LSN that was fully processed in the CDC run.</span></span> <span data-ttu-id="b8d00-140">La próxima vez que se ejecute GetProcessingRange, esta posición será el inicio del intervalo de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="b8d00-140">The next time GetProcessingRange is executed, this position is the start of the processing range.</span></span>|  
  
## <a name="handling-cdc-state-persistency"></a><span data-ttu-id="b8d00-141">Controlar la persistencia de estado CDC</span><span class="sxs-lookup"><span data-stu-id="b8d00-141">Handling CDC State Persistency</span></span>  
 <span data-ttu-id="b8d00-142">La tarea Control CDC mantiene un estado persistente entre las activaciones.</span><span class="sxs-lookup"><span data-stu-id="b8d00-142">The CDC Control task maintains a persistent state between activations.</span></span> <span data-ttu-id="b8d00-143">La información almacenada en el estado CDC se usa para determinar y mantener el intervalo de procesamiento del paquete CDC y para detectar condiciones de error.</span><span class="sxs-lookup"><span data-stu-id="b8d00-143">The information stored in the CDC state is used to determine and maintain the processing range for the CDC package and for detecting error conditions.</span></span> <span data-ttu-id="b8d00-144">El estado persistente se almacena como una cadena.</span><span class="sxs-lookup"><span data-stu-id="b8d00-144">The persistent state is stored as a string.</span></span> <span data-ttu-id="b8d00-145">Para obtener más información, consulte [Definir una variable de estado](../data-flow/define-a-state-variable.md).</span><span class="sxs-lookup"><span data-stu-id="b8d00-145">For more information, see [Define a State Variable](../data-flow/define-a-state-variable.md).</span></span>  
  
 <span data-ttu-id="b8d00-146">La tarea Control CDC admite dos tipos de persistencia de estado</span><span class="sxs-lookup"><span data-stu-id="b8d00-146">The CDC Control task supports two types of state persistency</span></span>  
  
-   <span data-ttu-id="b8d00-147">Persistencia de estado manual: en este caso, la tarea Control CDC administra el estado almacenado en una variable de paquete pero el desarrollador del paquete debe leer la variable desde un almacén persistente antes de llamar al Control CDC y después escribirla de nuevo en el almacén persistente cuando el Control CDC se llame por última vez y la ejecución del CDC se complete.</span><span class="sxs-lookup"><span data-stu-id="b8d00-147">Manual State Persistency: In this case, the CDC Control task manages the state stored in a package variable but the package developer must read the variable from a persistent store before calling the CDC Control and then write it back to that persistent store after the CDC Control is last called and the CDC run completes.</span></span>  
  
-   <span data-ttu-id="b8d00-148">Persistencia de estado automática: el estado del CDC se almacena en una tabla de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="b8d00-148">Automatic State Persistency: The CDC state is stored in a table in a database.</span></span> <span data-ttu-id="b8d00-149">El estado se almacena con un nombre proporcionado en la propiedad **StateName** en una tabla denominada en la propiedad **Tabla para Storing State** , que se encuentra en un administrador de conexiones seleccionado para almacenar el estado.</span><span class="sxs-lookup"><span data-stu-id="b8d00-149">The state is stored under a name provided in the **StateName** property in a table named in the **Table to Use for Storing State** property, which is located in a selected connection manager for storing the state.</span></span> <span data-ttu-id="b8d00-150">El valor predeterminado es el administrador de conexiones de origen pero la práctica común es que sea el administrador de conexiones de destino.</span><span class="sxs-lookup"><span data-stu-id="b8d00-150">The default is the source connection manager but the common practice is for it to be the target connection manager.</span></span> <span data-ttu-id="b8d00-151">La tarea Control CDC actualiza el valor de estado en la tabla de estados y esta se confirma como parte de la transacción ambiente.</span><span class="sxs-lookup"><span data-stu-id="b8d00-151">The CDC Control task updates the state value in the state table and this is committed as part of the ambient transaction.</span></span>  
  
## <a name="error-handling"></a><span data-ttu-id="b8d00-152">Tratamiento de errores</span><span class="sxs-lookup"><span data-stu-id="b8d00-152">Error Handling</span></span>  
 <span data-ttu-id="b8d00-153">La tarea Control CDC puede notificar un error cuando:</span><span class="sxs-lookup"><span data-stu-id="b8d00-153">The CDC Control task may report an error when:</span></span>  
  
-   <span data-ttu-id="b8d00-154">No se puede leer el estado CDC persistente o cuando la actualización del estado persistente da error.</span><span class="sxs-lookup"><span data-stu-id="b8d00-154">It fails to read the persistent CDC state or when updating the persistent state fails.</span></span>  
  
-   <span data-ttu-id="b8d00-155">No puede leer la información del LSN actual desde la base de datos de origen.</span><span class="sxs-lookup"><span data-stu-id="b8d00-155">It fails to read the current LSN information from the source database.</span></span>  
  
-   <span data-ttu-id="b8d00-156">Lectura del estado CDC no es coherente.</span><span class="sxs-lookup"><span data-stu-id="b8d00-156">The CDC state read is not consistent.</span></span>  
  
 <span data-ttu-id="b8d00-157">En todos estos casos, la tarea Control CDC notifica un error que se puede controlar igual que SSIS controla los errores de flujo de control.</span><span class="sxs-lookup"><span data-stu-id="b8d00-157">In all of these cases, the CDC Control task reports an error that can be handled in the standard way SSIS handles control-flow errors.</span></span>  
  
 <span data-ttu-id="b8d00-158">La tarea Control CDC también puede notificar una advertencia cuando la operación del intervalo de procesamiento Get se invoca directamente después de otra operación de intervalo de procesamiento Get sin llamar a Marcar intervalo de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="b8d00-158">The CDC Control task may also report a warning when the Get Processing Range operation is invoked directly after another Get Processing Range operation without Mark Processed Range being called.</span></span> <span data-ttu-id="b8d00-159">Esta es una indicación de que la ejecución anterior dio error o de que otro paquete CDC puede estar ejecutándose con el mismo nombre del estado CDC.</span><span class="sxs-lookup"><span data-stu-id="b8d00-159">This is an indication that the previous run failed or that another CDC package may be running using the same CDC state name.</span></span>  
  
## <a name="configuring-the-cdc-control-task"></a><span data-ttu-id="b8d00-160">Configurar la tarea Control CDC</span><span class="sxs-lookup"><span data-stu-id="b8d00-160">Configuring the CDC Control Task</span></span>  
 <span data-ttu-id="b8d00-161">Puede establecer propiedades a través del Diseñador de SSIS o mediante programación.</span><span class="sxs-lookup"><span data-stu-id="b8d00-161">You can set properties through SSIS Designer or programmatically.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="b8d00-162">En esta sección</span><span class="sxs-lookup"><span data-stu-id="b8d00-162">In This Section</span></span>  
  
-   [<span data-ttu-id="b8d00-163">Editor de la tarea Control CDC</span><span class="sxs-lookup"><span data-stu-id="b8d00-163">CDC Control Task Editor</span></span>](../cdc-control-task-editor.md)  
  
-   [<span data-ttu-id="b8d00-164">Propiedades personalizadas de la tarea de control CDC</span><span class="sxs-lookup"><span data-stu-id="b8d00-164">CDC Control Task Custom Properties</span></span>](cdc-control-task-custom-properties.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="b8d00-165">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="b8d00-165">Related Tasks</span></span>  
 [<span data-ttu-id="b8d00-166">Definir una variable de estado</span><span class="sxs-lookup"><span data-stu-id="b8d00-166">Define a State Variable</span></span>](../data-flow/define-a-state-variable.md)  
  
## <a name="related-content"></a><span data-ttu-id="b8d00-167">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="b8d00-167">Related Content</span></span>  
  
-   <span data-ttu-id="b8d00-168">Artículo técnico [Instalar la captura de datos modificados Microsoft SQL Server 2012 para Oracle de Attunity](https://go.microsoft.com/fwlink/?LinkId=252958), en social.technet.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="b8d00-168">Technical article, [Installing Microsoft SQL Server 2012 Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252958), on social.technet.microsoft.com.</span></span>  
  
-   <span data-ttu-id="b8d00-169">Artículo técnico [Solucionar problemas de configuración de la captura de datos modificados de Microsoft para Oracle de Attunity](https://go.microsoft.com/fwlink/?LinkId=252960), en social.technet.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="b8d00-169">Technical article, [Troubleshoot Configuration Issues in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252960), on social.technet.microsoft.com.</span></span>  
  
-   <span data-ttu-id="b8d00-170">Artículo técnico [Solucionar problemas de errores de instancias de CDC de la captura de datos modificados de Microsoft para Oracle de Attunity](https://go.microsoft.com/fwlink/?LinkId=252961), en social.technet.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="b8d00-170">Technical article, [Troubleshoot CDC Instance Errors in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252961), on social.technet.microsoft.com.</span></span>  
  
  
