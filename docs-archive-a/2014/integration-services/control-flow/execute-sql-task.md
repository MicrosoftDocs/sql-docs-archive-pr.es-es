---
title: Tarea Ejecutar SQL | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.executesqltask.f1
helpviewer_keywords:
- Transact-SQL statements, SSIS
- statements [Integration Services]
- batches [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: bebb2e8c-0410-43b2-ac2f-6fc80c8f2e9e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e77b9f442ae8478c57d5b0e68955b541eda38aff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87744812"
---
# <a name="execute-sql-task"></a><span data-ttu-id="9aa87-102">Tarea Ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-102">Execute SQL Task</span></span>
  <span data-ttu-id="9aa87-103">La tarea Ejecutar SQL ejecuta instrucciones SQL o procedimientos almacenados de un paquete.</span><span class="sxs-lookup"><span data-stu-id="9aa87-103">The Execute SQL task runs SQL statements or stored procedures from a package.</span></span> <span data-ttu-id="9aa87-104">La tarea puede contener una sola instrucción SQL o múltiples instrucciones SQL que se ejecutarán de forma secuencial.</span><span class="sxs-lookup"><span data-stu-id="9aa87-104">The task can contain either a single SQL statement or multiple SQL statements that run sequentially.</span></span> <span data-ttu-id="9aa87-105">Puede usar la tarea Ejecutar SQL para los siguientes fines:</span><span class="sxs-lookup"><span data-stu-id="9aa87-105">You can use the Execute SQL task for the following purposes:</span></span>  
  
-   <span data-ttu-id="9aa87-106">Truncar una tabla o vista en preparación para insertar datos.</span><span class="sxs-lookup"><span data-stu-id="9aa87-106">Truncate a table or view in preparation for inserting data.</span></span>  
  
-   <span data-ttu-id="9aa87-107">Crear, modificar y quitar objetos de base de datos, como tablas y vistas.</span><span class="sxs-lookup"><span data-stu-id="9aa87-107">Create, alter, and drop database objects such as tables and views.</span></span>  
  
-   <span data-ttu-id="9aa87-108">Volver a crear tablas de hechos y tablas de dimensiones antes de cargar datos en ellas.</span><span class="sxs-lookup"><span data-stu-id="9aa87-108">Re-create fact and dimension tables before loading data into them.</span></span>  
  
-   <span data-ttu-id="9aa87-109">Ejecutar procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-109">Run stored procedures.</span></span> <span data-ttu-id="9aa87-110">Si la instrucción SQL invoca un procedimiento almacenado que devuelve resultados de una tabla temporal, use la opción WITH RESULT SETS para definir los metadatos del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-110">If the SQL statement invokes a stored procedure that returns results from a temporary table, use the WITH RESULT SETS option to define metadata for the result set.</span></span>  
  
-   <span data-ttu-id="9aa87-111">Guardar en una variable el conjunto de filas devuelto por una consulta.</span><span class="sxs-lookup"><span data-stu-id="9aa87-111">Save the rowset returned from a query into a variable.</span></span>  
  
 <span data-ttu-id="9aa87-112">La tarea Ejecutar SQL puede usarse en combinación con los contenedores de bucles Foreach y For para ejecutar varias instrucciones SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-112">The Execute SQL task can be used in combination with the Foreach Loop and For Loop containers to run multiple SQL statements.</span></span> <span data-ttu-id="9aa87-113">Estos contenedores implementan flujos de control que se repiten en un paquete y pueden ejecutar repetidamente la tarea Ejecutar SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-113">These containers implement repeating control flows in a package and they can run the Execute SQL task repeatedly.</span></span> <span data-ttu-id="9aa87-114">Por ejemplo, un paquete puede usar el contenedor de bucles Foreach para enumerar los archivos de una carpeta y ejecutar una tarea Ejecutar SQL repetidamente con el fin de ejecutar la instrucción SQL almacenada en cada archivo.</span><span class="sxs-lookup"><span data-stu-id="9aa87-114">For example, using the Foreach Loop container, a package can enumerate files in a folder and run an Execute SQL task repeatedly to execute the SQL statement stored in each file.</span></span>  
  
## <a name="connecting-to-a-data-source"></a><span data-ttu-id="9aa87-115">Conectarse a un origen de datos</span><span class="sxs-lookup"><span data-stu-id="9aa87-115">Connecting to a Data Source</span></span>  
 <span data-ttu-id="9aa87-116">La tarea Ejecutar SQL puede usar distintos tipos de administradores de conexión para conectar con el origen de datos en el que se ejecuta la instrucción SQL o el procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="9aa87-116">The Execute SQL task can use different types of connection managers to connect to the data source where it runs the SQL statement or stored procedure.</span></span> <span data-ttu-id="9aa87-117">La tarea puede usar los tipos de conexión mostrados en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="9aa87-117">The task can use the connection types listed in the following table.</span></span>  
  
|<span data-ttu-id="9aa87-118">Tipo de conexión</span><span class="sxs-lookup"><span data-stu-id="9aa87-118">Connection type</span></span>|<span data-ttu-id="9aa87-119">Administrador de conexiones</span><span class="sxs-lookup"><span data-stu-id="9aa87-119">Connection manager</span></span>|  
|---------------------|------------------------|  
|<span data-ttu-id="9aa87-120">EXCEL</span><span class="sxs-lookup"><span data-stu-id="9aa87-120">EXCEL</span></span>|[<span data-ttu-id="9aa87-121">Administrador de conexiones de Excel</span><span class="sxs-lookup"><span data-stu-id="9aa87-121">Excel Connection Manager</span></span>](../connection-manager/excel-connection-manager.md)|  
|<span data-ttu-id="9aa87-122">OLE DB</span><span class="sxs-lookup"><span data-stu-id="9aa87-122">OLE DB</span></span>|[<span data-ttu-id="9aa87-123">Administrador de conexiones OLE DB</span><span class="sxs-lookup"><span data-stu-id="9aa87-123">OLE DB Connection Manager</span></span>](../connection-manager/ole-db-connection-manager.md)|  
|<span data-ttu-id="9aa87-124">ODBC</span><span class="sxs-lookup"><span data-stu-id="9aa87-124">ODBC</span></span>|[<span data-ttu-id="9aa87-125">Administrador de conexiones ODBC</span><span class="sxs-lookup"><span data-stu-id="9aa87-125">ODBC Connection Manager</span></span>](../connection-manager/odbc-connection-manager.md)|  
|<span data-ttu-id="9aa87-126">ADO</span><span class="sxs-lookup"><span data-stu-id="9aa87-126">ADO</span></span>|[<span data-ttu-id="9aa87-127">Administrador de conexiones ADO</span><span class="sxs-lookup"><span data-stu-id="9aa87-127">ADO Connection Manager</span></span>](../connection-manager/ado-connection-manager.md)|  
|<span data-ttu-id="9aa87-128">ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9aa87-128">ADO.NET</span></span>|[<span data-ttu-id="9aa87-129">Administrador de conexiones ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9aa87-129">ADO.NET Connection Manager</span></span>](../connection-manager/ado-net-connection-manager.md)|  
|<span data-ttu-id="9aa87-130">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="9aa87-130">SQLMOBILE</span></span>|[<span data-ttu-id="9aa87-131">Administrador de conexiones con SQL Server Compact Edition</span><span class="sxs-lookup"><span data-stu-id="9aa87-131">SQL Server Compact Edition Connection Manager</span></span>](../connection-manager/sql-server-compact-edition-connection-manager.md)|  
  
## <a name="creating-sql-statements"></a><span data-ttu-id="9aa87-132">Crear instrucciones SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-132">Creating SQL Statements</span></span>  
 <span data-ttu-id="9aa87-133">El origen de las instrucciones SQL usadas por esta tarea puede ser una propiedad de tarea que contiene una instrucción, una conexión con un archivo que contiene una o varias instrucciones, o el nombre de una variable que contiene una instrucción.</span><span class="sxs-lookup"><span data-stu-id="9aa87-133">The source of the SQL statements used by this task can be a task property that contains a statement, a connection to a file that contains one or multiple statements, or the name of a variable that contains a statement.</span></span> <span data-ttu-id="9aa87-134">Debe escribirlas en el dialecto del sistema de administración de bases de datos (DBMS) de origen.</span><span class="sxs-lookup"><span data-stu-id="9aa87-134">The SQL statements must be written in the dialect of the source database management system (DBMS).</span></span> <span data-ttu-id="9aa87-135">Para más información, vea [Consultas de Integration Services &#40;SSIS&#41;](../integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-135">For more information, see [Integration Services &#40;SSIS&#41; Queries](../integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="9aa87-136">Si las instrucciones SQL se almacenan en un archivo, la tarea utiliza un administrador de conexiones de archivos para conectar con el archivo.</span><span class="sxs-lookup"><span data-stu-id="9aa87-136">If the SQL statements are stored in a file, the task uses a File connection manager to connect to the file.</span></span> <span data-ttu-id="9aa87-137">Para obtener más información, consulte [File Connection Manager](../connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-137">For more information, see [File Connection Manager](../connection-manager/file-connection-manager.md).</span></span>  
  
 <span data-ttu-id="9aa87-138">En el Diseñador [!INCLUDE[ssIS](../../includes/ssis-md.md)] , puede utilizar el cuadro de diálogo **Editor de la tarea Ejecutar SQL** para escribir instrucciones SQL, o utilizar el **Generador de consultas**, una interfaz gráfica de usuario para crear consultas SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-138">In [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, you can use the **Execute SQL Task Editor** dialog box to type SQL statements, or use **Query Builder**, a graphical user interface for creating SQL queries.</span></span> <span data-ttu-id="9aa87-139">Para más información, vea [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) y [Generador de consultas](../query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-139">For more information, see [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) and [Query Builder](../query-builder.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9aa87-140">Es posible que la tarea Ejecutar SQL no pueda analizar correctamente instrucciones SQL válidas escritas fuera de dicha tarea.</span><span class="sxs-lookup"><span data-stu-id="9aa87-140">Valid SQL statements written outside the Execute SQL task may not be parsed successfully by the Execute SQL task.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9aa87-141">La tarea Ejecutar SQL usa el valor de enumeración de ParseMode `RecognizeAll`.</span><span class="sxs-lookup"><span data-stu-id="9aa87-141">The Execute SQL Task uses the `RecognizeAll` ParseMode enumeration value.</span></span> <span data-ttu-id="9aa87-142">Para obtener más información, vea [Espacio de nombres ManagedBatchParser](https://go.microsoft.com/fwlink/?LinkId=223617).</span><span class="sxs-lookup"><span data-stu-id="9aa87-142">For more information, see [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span></span>  
  
## <a name="sending-multiple-statements-in-a-batch"></a><span data-ttu-id="9aa87-143">Enviar varias instrucciones en un lote</span><span class="sxs-lookup"><span data-stu-id="9aa87-143">Sending Multiple Statements in a Batch</span></span>  
 <span data-ttu-id="9aa87-144">Si incluye varias instrucciones en una tarea Ejecutar SQL, puede agruparlas y ejecutarlas como un lote.</span><span class="sxs-lookup"><span data-stu-id="9aa87-144">If you include multiple statements in an Execute SQL task, you can group them and run them as a batch.</span></span> <span data-ttu-id="9aa87-145">Para indicar el final de un lote, utilice el comando GO.</span><span class="sxs-lookup"><span data-stu-id="9aa87-145">To signal the end of a batch, use the GO command.</span></span> <span data-ttu-id="9aa87-146">Todas las instrucciones SQL entre dos comandos GO se envían en un lote al proveedor OLE DB para que se ejecuten.</span><span class="sxs-lookup"><span data-stu-id="9aa87-146">All the SQL statements between two GO commands are sent in a batch to the OLE DB provider to be run.</span></span> <span data-ttu-id="9aa87-147">El comando SQL puede incluir varios lotes separados por comandos GO.</span><span class="sxs-lookup"><span data-stu-id="9aa87-147">The SQL command can include multiple batches separated by GO commands.</span></span>  
  
 <span data-ttu-id="9aa87-148">Hay restricciones respecto a los tipos de instrucciones SQL que se pueden agrupar en un lote.</span><span class="sxs-lookup"><span data-stu-id="9aa87-148">There are restrictions on the kinds of SQL statements that you can group in a batch.</span></span> <span data-ttu-id="9aa87-149">Para más información, consulte [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-149">For more information, see [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span></span>  
  
 <span data-ttu-id="9aa87-150">Si la tarea Ejecutar SQL ejecuta un lote de instrucciones SQL, se aplicarán las reglas siguientes al lote:</span><span class="sxs-lookup"><span data-stu-id="9aa87-150">If the Execute SQL task runs a batch of SQL statements, the following rules apply to the batch:</span></span>  
  
-   <span data-ttu-id="9aa87-151">Solo una instrucción puede devolver un conjunto de resultados y debe ser la primera instrucción del lote.</span><span class="sxs-lookup"><span data-stu-id="9aa87-151">Only one statement can return a result set and it must be the first statement in the batch.</span></span>  
  
-   <span data-ttu-id="9aa87-152">Si el conjunto de resultados usa enlaces de resultados, las consultas deben devolver el mismo número de columnas.</span><span class="sxs-lookup"><span data-stu-id="9aa87-152">If the result set uses result bindings, the queries must return the same number of columns.</span></span> <span data-ttu-id="9aa87-153">Si las consultas devuelven un número distinto de columnas, la tarea no se completará correctamente.</span><span class="sxs-lookup"><span data-stu-id="9aa87-153">If the queries return a different number of columns, the task fails.</span></span> <span data-ttu-id="9aa87-154">Sin embargo, aunque la tarea no se complete correctamente, se completarán correctamente las consultas que ejecute, como DELETE o INSERT.</span><span class="sxs-lookup"><span data-stu-id="9aa87-154">However, even if the task fails, the queries that it runs, such as DELETE or INSERT queries, may succeed.</span></span>  
  
-   <span data-ttu-id="9aa87-155">Si los enlaces de resultados usan nombres de columna, la consulta debe devolver columnas que tengan los mismos nombres que los nombres de los conjuntos de resultados que se utilizan en la tarea.</span><span class="sxs-lookup"><span data-stu-id="9aa87-155">If the result bindings use column names, the query must return columns that have the same names as the result set names that are used in the task.</span></span> <span data-ttu-id="9aa87-156">Si faltan columnas, la tarea no se completa correctamente.</span><span class="sxs-lookup"><span data-stu-id="9aa87-156">If the columns are missing, the task fails.</span></span>  
  
-   <span data-ttu-id="9aa87-157">Si la tarea utiliza enlace de parámetros, todas las consultas del lote deberán tener el mismo número de parámetros y estos deberán ser del mismo tipo.</span><span class="sxs-lookup"><span data-stu-id="9aa87-157">If the task uses parameter binding, all the queries in the batch must have the same number and types of parameters.</span></span>  
  
## <a name="running-parameterized-sql-commands"></a><span data-ttu-id="9aa87-158">Ejecutar comandos SQL con parámetros</span><span class="sxs-lookup"><span data-stu-id="9aa87-158">Running Parameterized SQL Commands</span></span>  
 <span data-ttu-id="9aa87-159">Las instrucciones SQL y los procedimientos almacenados suelen usar parámetros de entrada, parámetros de salida y códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="9aa87-159">SQL statements and stored procedures frequently use input parameters, output parameters, and return codes.</span></span> <span data-ttu-id="9aa87-160">La tarea Ejecutar SQL admite los tipos de parámetros `Input`, `Output` y `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="9aa87-160">The Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="9aa87-161">Utilice el tipo `Input` para parámetros de entrada, `Output` para parámetros de salida y `ReturnValue` para códigos de retorno.</span><span class="sxs-lookup"><span data-stu-id="9aa87-161">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9aa87-162">Solo puede usar parámetros en una tarea Ejecutar SQL si el proveedor de datos los admite.</span><span class="sxs-lookup"><span data-stu-id="9aa87-162">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="9aa87-163">Para más información sobre el uso de parámetros y códigos de retorno en la tarea Ejecutar SQL, vea [Parámetros y códigos de retorno en la tarea Ejecutar SQL](execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-163">For information on using parameters and return codes in the Execute SQL task, see [Parameters and Return Codes in the Execute SQL Task](execute-sql-task.md).</span></span>  
  
## <a name="specifying-a-result-set-type"></a><span data-ttu-id="9aa87-164">Especificar un tipo de conjunto de resultados</span><span class="sxs-lookup"><span data-stu-id="9aa87-164">Specifying a Result Set Type</span></span>  
 <span data-ttu-id="9aa87-165">En función del tipo de comando SQL, la tarea Ejecutar SQL puede devolver o no un conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-165">Depending on the type of SQL command, a result set may or may not be returned to the Execute SQL task.</span></span> <span data-ttu-id="9aa87-166">Por ejemplo, una instrucción SELECT suele devolver un conjunto de resultados; en cambio, una instrucción INSERT no lo devuelve.</span><span class="sxs-lookup"><span data-stu-id="9aa87-166">For example, a SELECT statement typically returns a result set, but an INSERT statement does not.</span></span> <span data-ttu-id="9aa87-167">El conjunto de resultados de una instrucción SELECT puede contener cero filas, una fila o muchas filas.</span><span class="sxs-lookup"><span data-stu-id="9aa87-167">The result set from a SELECT statement can contain zero rows, one row, or many rows.</span></span> <span data-ttu-id="9aa87-168">Los procedimientos almacenados también pueden devolver un valor entero, denominado código de retorno, que indica el estado de ejecución del procedimiento.</span><span class="sxs-lookup"><span data-stu-id="9aa87-168">Stored procedures can also return an integer value, called a return code, that indicates the execution status of the procedure.</span></span> <span data-ttu-id="9aa87-169">En tal caso, el conjunto de resultados constará de una fila individual.</span><span class="sxs-lookup"><span data-stu-id="9aa87-169">In that case, the result set consists of a single row.</span></span>  
  
 <span data-ttu-id="9aa87-170">Para más información sobre cómo recuperar conjuntos de resultados de comandos SQL en la tarea Ejecutar SQL, vea [Conjuntos de resultados en la tarea Ejecutar SQL](../result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-170">For information on retrieving result sets from SQL commands in the Execute SQL task, see [Result Sets in the Execute SQL Task](../result-sets-in-the-execute-sql-task.md).</span></span>  
  
## <a name="troubleshooting-the-execute-sql-task"></a><span data-ttu-id="9aa87-171">Solucionar problemas de la tarea Ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-171">Troubleshooting the Execute SQL Task</span></span>  
 <span data-ttu-id="9aa87-172">Puede registrar las llamadas que realiza la tarea Ejecutar SQL a proveedores de datos externos.</span><span class="sxs-lookup"><span data-stu-id="9aa87-172">You can log the calls that the Execute SQL task makes to external data providers.</span></span> <span data-ttu-id="9aa87-173">Puede usar esta capacidad de registro para solucionar problemas relacionados con los comandos SQL que ejecuta la tarea Ejecutar SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-173">You can use this logging capability to troubleshoot the SQL commands that the Execute SQL task runs.</span></span> <span data-ttu-id="9aa87-174">Para registrar las llamadas realizadas por la tarea Ejecutar SQL a proveedores de datos externos, habilite el registro de paquetes y seleccione el evento **Diagnostic** en el nivel de paquete.</span><span class="sxs-lookup"><span data-stu-id="9aa87-174">To log the calls that the Execute SQL task makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="9aa87-175">Para más información, vea [Herramientas para solucionar problemas con la ejecución de paquetes](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-175">For more information, see [Troubleshooting Tools for Package Execution](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
 <span data-ttu-id="9aa87-176">A veces, un procedimiento almacenado o comando SQL devuelve varios conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-176">Sometimes a SQL command or stored procedure returns multiple result sets.</span></span> <span data-ttu-id="9aa87-177">Estos conjuntos de resultados no solo incluyen los conjuntos de filas resultantes de consultas `SELECT`, sino valores únicos generados por errores de las instrucciones `RAISERROR` o `PRINT`.</span><span class="sxs-lookup"><span data-stu-id="9aa87-177">These result sets include not only rowsets that are the result of `SELECT` queries, but single values that are the result of errors of `RAISERROR` or `PRINT` statements.</span></span> <span data-ttu-id="9aa87-178">El hecho de que la tarea omita errores en los conjuntos de resultados que se producen después del primer conjunto de resultados depende del tipo de administrador de conexiones que se use:</span><span class="sxs-lookup"><span data-stu-id="9aa87-178">Whether the task ignores errors in result sets that occur after the first result set depends on the type of connection manager that is used:</span></span>  
  
-   <span data-ttu-id="9aa87-179">Si utiliza los administradores de conexiones ADO y OLE DB, la tarea omite los conjuntos de resultados que se producen después del primer conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-179">When you use OLE DB and ADO connection managers, the task ignores the result sets that occur after the first result set.</span></span> <span data-ttu-id="9aa87-180">Por consiguiente, con estos administradores de conexiones la tarea omite un error devuelto por un procedimiento almacenado o comando SQL cuando el error no forma parte del primer conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-180">Therefore, with these connection managers, the task ignores an error returned by an SQL command or a stored procedure when the error is not part of the first result set.</span></span>  
  
-   <span data-ttu-id="9aa87-181">Si utiliza los administradores de conexiones ODBC y ADO.NET, la tarea no omite los conjuntos de resultados que se producen después del primer conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9aa87-181">When you use ODBC and ADO.NET connection managers, the task does not ignore result sets that occur after the first result set.</span></span> <span data-ttu-id="9aa87-182">Con estos administradores de conexiones, la tarea producirá un error cuando un conjunto de resultados distinto del primer conjunto de resultados contenga un error.</span><span class="sxs-lookup"><span data-stu-id="9aa87-182">With these connection managers, the task will fail with an error when a result set other than the first result set contains an error.</span></span>  
  
### <a name="custom-log-entries"></a><span data-ttu-id="9aa87-183">Entradas del registro personalizadas</span><span class="sxs-lookup"><span data-stu-id="9aa87-183">Custom Log Entries</span></span>  
 <span data-ttu-id="9aa87-184">La siguiente tabla contiene la entrada del registro personalizada para la tarea Ejecutar SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-184">The following table describes the custom log entry for the Execute SQL task.</span></span> <span data-ttu-id="9aa87-185">Para obtener más información, vea [Registro de Integration Services &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) y [Mensajes personalizados para registro](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="9aa87-185">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="9aa87-186">Entrada del registro</span><span class="sxs-lookup"><span data-stu-id="9aa87-186">Log entry</span></span>|<span data-ttu-id="9aa87-187">Descripción</span><span class="sxs-lookup"><span data-stu-id="9aa87-187">Description</span></span>|  
|---------------|-----------------|  
|`ExecuteSQLExecutingQuery`|<span data-ttu-id="9aa87-188">Proporciona información sobre las fases de ejecución de la instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-188">Provides information about the execution phases of the SQL statement.</span></span> <span data-ttu-id="9aa87-189">Las entradas de registro se escriben cuando la tarea adquiere una conexión con la base de datos, cuando la tarea comienza a preparar la instrucción SQL y una vez que se completa la ejecución de la instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-189">Log entries are written when the task acquires connection to the database, when the task starts to prepare the SQL statement, and after the execution of the SQL statement is completed.</span></span> <span data-ttu-id="9aa87-190">La entrada del registro para la fase de preparación incluye la instrucción SQL que utiliza la tarea.</span><span class="sxs-lookup"><span data-stu-id="9aa87-190">The log entry for the prepare phase includes the SQL statement that the task uses.</span></span>|  
  
## <a name="configuring-the-execute-sql-task"></a><span data-ttu-id="9aa87-191">Configurar la tarea Ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-191">Configuring the Execute SQL Task</span></span>  
 <span data-ttu-id="9aa87-192">Puede configurar la tarea Ejecutar SQL de las maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="9aa87-192">You can configure the Execute SQL task in the following ways:</span></span>  
  
-   <span data-ttu-id="9aa87-193">Especificar el tipo de administrador de conexiones que se va a utilizar para conectar con una base de datos.</span><span class="sxs-lookup"><span data-stu-id="9aa87-193">Specify the type of connection manager to use to connect to a database.</span></span>  
  
-   <span data-ttu-id="9aa87-194">Especificar el tipo de conjunto de resultados que devolverá la instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-194">Specify the type of result set that the SQL statement returns.</span></span>  
  
-   <span data-ttu-id="9aa87-195">Especificar un tiempo de espera para las instrucciones SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-195">Specify a time-out for the SQL statements.</span></span>  
  
-   <span data-ttu-id="9aa87-196">Especificar el origen de la instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-196">Specify the source of the SQL statement.</span></span>  
  
-   <span data-ttu-id="9aa87-197">Indicar si la tarea omite la fase de preparación para la instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="9aa87-197">Indicate whether the task skips the prepare phase for the SQL statement.</span></span>  
  
-   <span data-ttu-id="9aa87-198">Si utiliza el tipo de conexión ADO, debe indicar si la instrucción SQL es un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="9aa87-198">If you use the ADO connection type, you must indicate whether the SQL statement is a stored procedure.</span></span> <span data-ttu-id="9aa87-199">Para otros tipos de conexión, esta propiedad es de solo lectura y su valor siempre es `false`.</span><span class="sxs-lookup"><span data-stu-id="9aa87-199">For other connection types, this property is read-only and its value is always `false`.</span></span>  
  
 <span data-ttu-id="9aa87-200">Puede establecer propiedades mediante programación o a través del Diseñador [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9aa87-200">You can set properties programmatically or through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span>  
  
 <span data-ttu-id="9aa87-201">Para obtener más información acerca de las propiedades que puede establecer en el Diseñador [!INCLUDE[ssIS](../../includes/ssis-md.md)] , haga clic en uno de los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="9aa87-201">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="9aa87-202">Editor de la tarea ejecutar SQL &#40;página general&#41;</span><span class="sxs-lookup"><span data-stu-id="9aa87-202">Execute SQL Task Editor &#40;General Page&#41;</span></span>](../execute-sql-task-editor-general-page.md)  
  
-   [<span data-ttu-id="9aa87-203">&#40;página de asignación de parámetros del editor de la tarea ejecutar SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9aa87-203">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../execute-sql-task-editor-parameter-mapping-page.md)  
  
-   [<span data-ttu-id="9aa87-204">Editor de la tarea ejecutar SQL &#40;página conjunto de resultados&#41;</span><span class="sxs-lookup"><span data-stu-id="9aa87-204">Execute SQL Task Editor &#40;Result Set Page&#41;</span></span>](../execute-sql-task-editor-result-set-page.md)  
  
-   [<span data-ttu-id="9aa87-205">Página Expresiones</span><span class="sxs-lookup"><span data-stu-id="9aa87-205">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="9aa87-206">Para obtener más información sobre cómo establecer estas propiedades en el Diseñador [!INCLUDE[ssIS](../../includes/ssis-md.md)] , haga clic en el siguiente tema:</span><span class="sxs-lookup"><span data-stu-id="9aa87-206">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="9aa87-207">Establecer las propiedades de tareas o contenedores</span><span class="sxs-lookup"><span data-stu-id="9aa87-207">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
## <a name="configuring-the-execute-sql-task-programmatically"></a><span data-ttu-id="9aa87-208">Configurar la tarea Ejecutar SQL mediante programación</span><span class="sxs-lookup"><span data-stu-id="9aa87-208">Configuring the Execute SQL Task Programmatically</span></span>  
 <span data-ttu-id="9aa87-209">Para obtener más información sobre cómo establecer estas propiedades mediante programación, haga clic en el tema siguiente:</span><span class="sxs-lookup"><span data-stu-id="9aa87-209">For more information about programmatically setting these properties, click the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask>  
  
## <a name="related-tasks"></a><span data-ttu-id="9aa87-210">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="9aa87-210">Related Tasks</span></span>  
  
-   [<span data-ttu-id="9aa87-211">asignar parámetros de consulta a variables en una tarea Ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-211">Map Query Parameters to Variables in an Execute SQL Task</span></span>](../map-query-parameters-to-variables-in-an-execute-sql-task.md)  
  
-   [<span data-ttu-id="9aa87-212">Asignar conjuntos de resultados a variables en una tarea ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-212">Map Result Sets to Variables in an Execute SQL Task</span></span>](../map-result-sets-to-variables-in-an-execute-sql-task.md)  
  
## <a name="related-content"></a><span data-ttu-id="9aa87-213">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="9aa87-213">Related Content</span></span>  
  
-   [<span data-ttu-id="9aa87-214">Parámetros y códigos de retorno en la tarea Ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-214">Parameters and Return Codes in the Execute SQL Task</span></span>](execute-sql-task.md)  
  
-   [<span data-ttu-id="9aa87-215">Conjuntos de resultados en la tarea Ejecutar SQL</span><span class="sxs-lookup"><span data-stu-id="9aa87-215">Result Sets in the Execute SQL Task</span></span>](../result-sets-in-the-execute-sql-task.md)  
  
-   [<span data-ttu-id="9aa87-216">Referencia de Transact-SQL &#40;motor de base de datos&#41;</span><span class="sxs-lookup"><span data-stu-id="9aa87-216">Transact-SQL Reference &#40;Database Engine&#41;</span></span>](/sql/t-sql/language-reference)  
  
-   <span data-ttu-id="9aa87-217">Entrada de blog, [Nuevas funciones de fecha y hora en SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), en mssqltips.com.</span><span class="sxs-lookup"><span data-stu-id="9aa87-217">Blog entry, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), on mssqltips.com</span></span>  
  
  
