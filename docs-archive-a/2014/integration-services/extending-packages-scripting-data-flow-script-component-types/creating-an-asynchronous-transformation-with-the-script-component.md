---
title: Crear una transformación asincrónica con el componente de script | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- asynchronous outputs [Integration Services]
- transformation components [Integration Services]
- Script component [Integration Services], transformation components
ms.assetid: 0d814404-21e4-4a68-894c-96fa47ab25ae
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 465c4a597b4a18d7bd956116cd5d7640a5393958
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87673768"
---
# <a name="creating-an-asynchronous-transformation-with-the-script-component"></a><span data-ttu-id="8a30c-102">Crear una transformación asincrónica con el componente de script</span><span class="sxs-lookup"><span data-stu-id="8a30c-102">Creating an Asynchronous Transformation with the Script Component</span></span>
  <span data-ttu-id="8a30c-103">Un componente de transformación se utiliza en el flujo de datos de un paquete de [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] para modificar y analizar los datos cuando pasan del origen al destino.</span><span class="sxs-lookup"><span data-stu-id="8a30c-103">You use a transformation component in the data flow of an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package to modify and analyze data as it passes from source to destination.</span></span> <span data-ttu-id="8a30c-104">Una transformación con salidas sincrónicas procesa cada fila de entrada a medida que pasa por el componente.</span><span class="sxs-lookup"><span data-stu-id="8a30c-104">A transformation with synchronous outputs processes each input row as it passes through the component.</span></span> <span data-ttu-id="8a30c-105">Una transformación con salidas asincrónicas puede esperar hasta haber recibido todas las filas de entrada para completar su procesamiento o puede generar algunas filas antes de haber recibido todas las filas de entrada.</span><span class="sxs-lookup"><span data-stu-id="8a30c-105">A transformation with asynchronous outputs may wait to complete its processing until the transformation has received all input rows, or the transformation may output certain rows before it has received all input rows.</span></span> <span data-ttu-id="8a30c-106">En este tema se describe una transformación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="8a30c-106">This topic discusses an asynchronous transformation.</span></span> <span data-ttu-id="8a30c-107">Si el procesamiento requiere una transformación sincrónica, vea [Crear una transformación sincrónica con el componente de script](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="8a30c-107">If your processing requires a synchronous transformation, see [Creating a Synchronous Transformation with the Script Component](../data-flow/transformations/script-component.md).</span></span> <span data-ttu-id="8a30c-108">Para obtener más información acerca de las diferencias que existen entre los componentes sincrónicos y asincrónicos, vea [Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md) (Descripción de las transformaciones sincrónicas y asincrónicas).</span><span class="sxs-lookup"><span data-stu-id="8a30c-108">For more information about the differences between synchronous and asynchronous components, see [Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md).</span></span>

 <span data-ttu-id="8a30c-109">Para obtener una introducción al componente de script, vea [Extending the Data Flow with the Script Component](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md) (Extensión del Flujo de datos con el componente de script).</span><span class="sxs-lookup"><span data-stu-id="8a30c-109">For an overview of the Script component, see [Extending the Data Flow with the Script Component](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span></span>

 <span data-ttu-id="8a30c-110">El componente de script y el código de infraestructura generado por dicho componente simplifican el proceso de desarrollo de un componente de flujo de datos personalizado.</span><span class="sxs-lookup"><span data-stu-id="8a30c-110">The Script component and the infrastructure code that it generates for you simplify the process of developing a custom data flow component.</span></span> <span data-ttu-id="8a30c-111">Sin embargo, para entender cómo funciona el componente de script, puede resultar útil leer los pasos que debe seguir para desarrollar un componente de flujo de datos personalizado en la sección [Developing a Custom Data Flow Component](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) (Desarrollo de un componente Flujo de datos personalizado) y, en especial, [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md) (Desarrollo de un componente de transformación personalizado con salidas sincrónicas).</span><span class="sxs-lookup"><span data-stu-id="8a30c-111">However, to understand how the Script component works, you may find it useful to read through the steps that you must follow in developing a custom data flow component in the [Developing a Custom Data Flow Component](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) section, and especially [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span></span>

## <a name="getting-started-with-an-asynchronous-transformation-component"></a><span data-ttu-id="8a30c-112">Introducción a un componente de transformación asincrónica</span><span class="sxs-lookup"><span data-stu-id="8a30c-112">Getting Started with an Asynchronous Transformation Component</span></span>
 <span data-ttu-id="8a30c-113">Al agregar un componente de script a la pestaña Flujo de datos del Diseñador [!INCLUDE[ssIS](../../includes/ssis-md.md)], se muestra el cuadro de diálogo **Seleccionar el tipo de componente de script**, que solicita al usuario que preconfigure el componente como un origen, una transformación o un destino.</span><span class="sxs-lookup"><span data-stu-id="8a30c-113">When you add a Script component to the Data Flow tab of [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears, prompting you to preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="8a30c-114">En este cuadro de diálogo, seleccione **Transformación**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-114">In this dialog box, select **Transformation**.</span></span>

## <a name="configuring-an-asynchronous-transformation-component-in-metadata-design-mode"></a><span data-ttu-id="8a30c-115">Configurar un componente de transformación asincrónica en el modo de diseño de metadatos</span><span class="sxs-lookup"><span data-stu-id="8a30c-115">Configuring an Asynchronous Transformation Component in Metadata-Design Mode</span></span>
 <span data-ttu-id="8a30c-116">Después de seleccionar la opción para crear un componente de transformación, configure el componente mediante el **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-116">After you select the option to create a transformation component, you configure the component by using the **Script Transformation Editor**.</span></span> <span data-ttu-id="8a30c-117">Para obtener más información, consulte [Configuring the Script Component in the Script Component Editor](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md) (Configurar el componente de script en el editor de componentes de script).</span><span class="sxs-lookup"><span data-stu-id="8a30c-117">For more information, see [Configuring the Script Component in the Script Component Editor](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span></span>

 <span data-ttu-id="8a30c-118">Para seleccionar el lenguaje de script que usará el componente de script, establezca la propiedad **ScriptLanguage** en la página **Script** del cuadro de diálogo **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-118">To select the script language that the Script component will use, you set the **ScriptLanguage** property on the **Script** page of the **Script Transformation Editor** dialog box.</span></span>

> [!NOTE]
>  <span data-ttu-id="8a30c-119">Para establecer el lenguaje de scripting predeterminado para el componente de script, utilice la opción **Lenguaje de scripting** en la página **General** del cuadro de diálogo **Opciones**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-119">To set the default scripting language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="8a30c-120">Para obtener más información, vea [General Page](../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="8a30c-120">For more information, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span>

 <span data-ttu-id="8a30c-121">Un componente de transformación de flujo de datos tiene una entrada y admite una o varias salidas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-121">A data flow transformation component has one input and supports one or more outputs.</span></span> <span data-ttu-id="8a30c-122">La configuración de la entrada y las salidas del componente es uno de los pasos que debe completar en el modo de diseño de metadatos, mediante el **Editor de transformación Script**, antes de escribir un script personalizado.</span><span class="sxs-lookup"><span data-stu-id="8a30c-122">Configuring the input and outputs of your component is one of the steps that you must complete in metadata design mode, by using the **Script Transformation Editor**, before you write your custom script.</span></span>

### <a name="configuring-input-columns"></a><span data-ttu-id="8a30c-123">Configurar las columnas de entrada</span><span class="sxs-lookup"><span data-stu-id="8a30c-123">Configuring Input Columns</span></span>
 <span data-ttu-id="8a30c-124">Un componente de transformación creado mediante el componente de script tiene una única entrada.</span><span class="sxs-lookup"><span data-stu-id="8a30c-124">A transformation component created by using the Script component has a single input.</span></span>

 <span data-ttu-id="8a30c-125">En la página **Columnas de entrada** del **Editor de transformación Script**, la lista de columnas muestra las columnas disponibles de la salida del componente de nivel superior en el flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="8a30c-125">On the **Input Columns** page of the **Script Transformation Editor**, the columns list shows the available columns from the output of the upstream component in the data flow.</span></span> <span data-ttu-id="8a30c-126">Seleccione las columnas que desee transformar o las columnas a través de las que desee pasar.</span><span class="sxs-lookup"><span data-stu-id="8a30c-126">Select the columns that you want to transform or pass through.</span></span> <span data-ttu-id="8a30c-127">Marque todas las columnas que desee transformar en contexto como de columnas de lectura/escritura.</span><span class="sxs-lookup"><span data-stu-id="8a30c-127">Mark any columns that you want to transform in place as Read/Write.</span></span>

 <span data-ttu-id="8a30c-128">Para obtener más información acerca de la página **Columnas de entrada** del **Editor de transformación Script**, vea [Script Transformation Editor &#40;Input Columns Page&#41;](../script-transformation-editor-input-columns-page.md) (Editor de transformación Script [página Columnas de entrada]).</span><span class="sxs-lookup"><span data-stu-id="8a30c-128">For more information about the **Input Columns** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Input Columns Page&#41;](../script-transformation-editor-input-columns-page.md).</span></span>

### <a name="configuring-inputs-outputs-and-output-columns"></a><span data-ttu-id="8a30c-129">Configurar entradas, salidas y columnas de salidas</span><span class="sxs-lookup"><span data-stu-id="8a30c-129">Configuring Inputs, Outputs, and Output Columns</span></span>
 <span data-ttu-id="8a30c-130">Un componente de transformación admite una o más salidas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-130">A transformation component supports one or more outputs.</span></span>

 <span data-ttu-id="8a30c-131">A menudo, una transformación con salidas asincrónicas tiene dos salidas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-131">Frequently a transformation with asynchronous outputs has two outputs.</span></span> <span data-ttu-id="8a30c-132">Por ejemplo, al contar el número de direcciones ubicadas en una ciudad concreta, es posible que desee pasar los datos de dirección a una salida y enviar el resultado de la agregación a otra salida distinta.</span><span class="sxs-lookup"><span data-stu-id="8a30c-132">For example, when you count the number of addresses located in a specific city, you may want to pass the address data through to one output, while sending the result of the aggregation to another output.</span></span> <span data-ttu-id="8a30c-133">La salida de la agregación también requiere una nueva columna de salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-133">The aggregation output also requires a new output column.</span></span>

 <span data-ttu-id="8a30c-134">En la página **Entradas y salidas** del **Editor de transformación Script**, verá que se ha creado una única salida de forma predeterminada, pero que no se ha creado ninguna columna de salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-134">On the **Inputs and Outputs** page of the **Script Transformation Editor**, you see that a single output has been created by default, but no output columns have been created.</span></span> <span data-ttu-id="8a30c-135">En esta página del editor, puede configurar los elementos siguientes:</span><span class="sxs-lookup"><span data-stu-id="8a30c-135">On this page of the editor, you can configure the following items:</span></span>

-   <span data-ttu-id="8a30c-136">Es posible que desee crear una o más salidas adicionales, como una salida para el resultado de una agregación.</span><span class="sxs-lookup"><span data-stu-id="8a30c-136">You may want to create one or more additional outputs, such as an output for the result of an aggregation.</span></span> <span data-ttu-id="8a30c-137">Use los botones **Agregar salida** y **Quitar salida** para administrar las salidas del componente de transformación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="8a30c-137">Use the **Add Output** and **Remove Output** buttons to manage the outputs of your asynchronous transformation component.</span></span> <span data-ttu-id="8a30c-138">Establezca la propiedad `SynchronousInputID` de cada salida en cero para indicar que la salida no se limita a pasar datos de un componente de nivel superior ni a transformarlos en contexto en las filas y columnas existentes.</span><span class="sxs-lookup"><span data-stu-id="8a30c-138">Set the `SynchronousInputID` property of each output to zero to indicate that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns.</span></span> <span data-ttu-id="8a30c-139">Este valor hace que las salidas sean asincrónicas con respecto a la entrada.</span><span class="sxs-lookup"><span data-stu-id="8a30c-139">It is this setting that makes the outputs asynchronous to the input.</span></span>

-   <span data-ttu-id="8a30c-140">Es posible que desee asignar un nombre descriptivo a la entrada y a las salidas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-140">You may want to assign a friendly name to the input and outputs.</span></span> <span data-ttu-id="8a30c-141">El componente de script utiliza estos nombres para generar las propiedades de descriptor de acceso con tipo que se usarán para hacer referencia a la entrada y las salidas en el script.</span><span class="sxs-lookup"><span data-stu-id="8a30c-141">The Script component uses these names to generate the typed accessor properties that you will use to refer to the input and outputs in your script.</span></span>

-   <span data-ttu-id="8a30c-142">A menudo, una transformación asincrónica agrega columnas al flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="8a30c-142">Frequently an asynchronous transformation adds columns to the data flow.</span></span> <span data-ttu-id="8a30c-143">Cuando la propiedad `SynchronousInputID` de una salida es cero (lo que indica que la salida no se limita a pasar datos de un componente de nivel superior ni a transformarlos en contexto en las filas y columnas existentes), debe agregar y configurar columnas de salida explícitamente en la salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-143">When the `SynchronousInputID` property of an output is zero, indicating that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns, you must add and configure output columns explicitly on the output.</span></span> <span data-ttu-id="8a30c-144">Las columnas de salida no tienen por qué tener los mismos nombres que las columnas de entrada a las que están asignadas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-144">Output columns do not have to have the same names as the input columns to which they are mapped.</span></span>

-   <span data-ttu-id="8a30c-145">Es posible que desee agregar más columnas para incluir información adicional.</span><span class="sxs-lookup"><span data-stu-id="8a30c-145">You may want to add more columns to contain additional information.</span></span> <span data-ttu-id="8a30c-146">Debe escribir su propio código para rellenar de datos las columnas adicionales.</span><span class="sxs-lookup"><span data-stu-id="8a30c-146">You must write your own code to fill the additional columns with data.</span></span> <span data-ttu-id="8a30c-147">Para obtener información sobre cómo reproducir el comportamiento de una salida de error estándar, consulte [Simulating an Error Output for the Script Component](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md) (Simulación de una salida de error para el componente de script).</span><span class="sxs-lookup"><span data-stu-id="8a30c-147">For information about reproducing the behavior of a standard error output, see [Simulating an Error Output for the Script Component](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span></span>

 <span data-ttu-id="8a30c-148">Para obtener más información acerca de la página **Entradas y salidas** del **Editor de transformación Script**, vea [Script Transformation Editor &#40;Inputs and Outputs Page&#41;](../script-transformation-editor-inputs-and-outputs-page.md) (Editor de transformación Script [página Entradas y salidas]).</span><span class="sxs-lookup"><span data-stu-id="8a30c-148">For more information about the **Inputs and Outputs** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Inputs and Outputs Page&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span></span>

### <a name="adding-variables"></a><span data-ttu-id="8a30c-149">Agregar variables</span><span class="sxs-lookup"><span data-stu-id="8a30c-149">Adding Variables</span></span>
 <span data-ttu-id="8a30c-150">Si hay variables existentes cuyos valores quiere usar en el script, puede agregarlas en los campos de propiedades ReadOnlyVariables y ReadWriteVariables de la página **Script** del **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-150">If there are any existing variables whose values you want to use in your script, you can add them in the ReadOnlyVariables and ReadWriteVariables property fields on the **Script** page of the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="8a30c-151">Cuando agregue varias variables a los campos de propiedades, separe sus nombres con comas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-151">When you add multiple variables in the property fields, separate the variable names by commas.</span></span> <span data-ttu-id="8a30c-152">También puede seleccionar varias variables haciendo clic en el botón de puntos suspensivos (**...**) situado junto a los `ReadOnlyVariables` campos de propiedades y y `ReadWriteVariables` , a continuación, seleccionando las variables en el cuadro de diálogo **seleccionar variables** .</span><span class="sxs-lookup"><span data-stu-id="8a30c-152">You can also select multiple variables by clicking the ellipsis (**...**) button next to the `ReadOnlyVariables` and `ReadWriteVariables` property fields, and then selecting the variables in the **Select variables** dialog box.</span></span>

 <span data-ttu-id="8a30c-153">Para obtener información general sobre la forma de usar variables con el componente de script, vea [Using Variables in the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md) (Uso de variables con el componente de script).</span><span class="sxs-lookup"><span data-stu-id="8a30c-153">For general information about how to use variables with the Script component, see [Using Variables in the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span></span>

 <span data-ttu-id="8a30c-154">Para obtener más información acerca de la página **Script** del **Editor de transformación Script**, vea [Script Transformation Editor &#40;Script Page&#41;](../script-transformation-editor-script-page.md) (Editor de transformación Script [página Script]).</span><span class="sxs-lookup"><span data-stu-id="8a30c-154">For more information about the **Script** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Script Page&#41;](../script-transformation-editor-script-page.md).</span></span>

## <a name="scripting-an-asynchronous-transformation-component-in-code-design-mode"></a><span data-ttu-id="8a30c-155">Crear script de un componente de transformación asincrónica en el modo de diseño de código</span><span class="sxs-lookup"><span data-stu-id="8a30c-155">Scripting an Asynchronous Transformation Component in Code-Design Mode</span></span>
 <span data-ttu-id="8a30c-156">Después de haber configurado todos los metadatos para el componente, puede escribir un script personalizado.</span><span class="sxs-lookup"><span data-stu-id="8a30c-156">After you have configured all the metadata for your component, you can write your custom script.</span></span> <span data-ttu-id="8a30c-157">En la página **Script** del **Editor de transformación Script**, haga clic en **Editar script** para abrir el IDE de [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA), donde puede agregar el script personalizado.</span><span class="sxs-lookup"><span data-stu-id="8a30c-157">In the **Script Transformation Editor**, on the **Script** page, click **Edit Script** to open the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE where you can add your custom script.</span></span> <span data-ttu-id="8a30c-158">El lenguaje de scripting que utilice dependerá de si ha seleccionado [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic o [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# como lenguaje de script para la propiedad **ScriptLanguage** en la página **Script**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-158">The scripting language that you use depends on whether you selected [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# as the script language for the **ScriptLanguage** property on the **Script** page.</span></span>

 <span data-ttu-id="8a30c-159">Para obtener información importante aplicable a todos los tipos de componentes creados mediante el componente de script, vea [Coding and Debugging the Script Component](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md) (Programación y depuración del componente de script).</span><span class="sxs-lookup"><span data-stu-id="8a30c-159">For important information that applies to all kinds of components created by using the Script component, see [Coding and Debugging the Script Component](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span></span>

### <a name="understanding-the-auto-generated-code"></a><span data-ttu-id="8a30c-160">Descripción del código generado automáticamente</span><span class="sxs-lookup"><span data-stu-id="8a30c-160">Understanding the Auto-generated Code</span></span>
 <span data-ttu-id="8a30c-161">Al abrir el IDE de VSTA después de crear y configurar un componente de transformación, la clase modificable `ScriptMain` aparece en el editor de código con códigos auxiliares para los métodos ProcessInputRow y CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="8a30c-161">When you open the VSTA IDE after creating and configuring a transformation component, the editable `ScriptMain` class appears in the code editor with stubs for the ProcessInputRow and the CreateNewOutputRows methods.</span></span> <span data-ttu-id="8a30c-162">En la clase ScriptMain escribirá el código personalizado; ProcessInputRow es el método más importante de un componente de transformación.</span><span class="sxs-lookup"><span data-stu-id="8a30c-162">The ScriptMain class is where you will write your custom code, and ProcessInputRow is the most important method in a transformation component.</span></span> <span data-ttu-id="8a30c-163">El método `CreateNewOutputRows` se utiliza con más frecuencia en un componente de origen, que es la forma en que una transformación asincrónica en los dos componentes mencionados debe crear sus propias filas de salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-163">The `CreateNewOutputRows` method is more typically used in a source component, which is like an asynchronous transformation in that both components must create their own output rows.</span></span>

 <span data-ttu-id="8a30c-164">Si abre la ventana **Explorador de proyectos** de VSTA, puede ver que el componente de script también ha generado elementos de `BufferWrapper` proyecto y de solo lectura `ComponentWrapper` .</span><span class="sxs-lookup"><span data-stu-id="8a30c-164">If you open the VSTA **Project Explorer** window, you can see that the Script component has also generated read-only `BufferWrapper` and `ComponentWrapper` project items.</span></span> <span data-ttu-id="8a30c-165">La clase ScriptMain hereda de la clase UserComponent en el `ComponentWrapper` elemento de proyecto.</span><span class="sxs-lookup"><span data-stu-id="8a30c-165">The ScriptMain class inherits from the UserComponent class in the `ComponentWrapper` project item.</span></span>

 <span data-ttu-id="8a30c-166">En tiempo de ejecución, el motor de flujo de datos llama al método PrimeOutput de la `UserComponent` clase, que invalida el <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> método de la <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> clase primaria.</span><span class="sxs-lookup"><span data-stu-id="8a30c-166">At run time, the data flow engine calls the PrimeOutput method in the `UserComponent` class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="8a30c-167">A su vez, el método PrimeOutput llama al método CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="8a30c-167">The PrimeOutput method in turn calls the CreateNewOutputRows method.</span></span>

 <span data-ttu-id="8a30c-168">A continuación, el motor de flujo de datos invoca el método ProcessInput de la clase UserComponent, lo que invalida el método <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> de la clase primaria <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent>.</span><span class="sxs-lookup"><span data-stu-id="8a30c-168">Next, the data flow engine invokes the ProcessInput method in the UserComponent class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="8a30c-169">A su vez, el método ProcessInput usa un bucle para recorrer las filas del búfer de entrada y llama al método ProcessInputRow una vez por cada fila.</span><span class="sxs-lookup"><span data-stu-id="8a30c-169">The ProcessInput method in turn loops through the rows in the input buffer and calls the ProcessInputRow method one time for each row.</span></span>

### <a name="writing-your-custom-code"></a><span data-ttu-id="8a30c-170">Escribir código personalizado</span><span class="sxs-lookup"><span data-stu-id="8a30c-170">Writing Your Custom Code</span></span>
 <span data-ttu-id="8a30c-171">Para terminar de crear un componente de transformación asincrónica personalizado, debe usar el método ProcessInputRow invalidado para procesar los datos de cada fila del búfer de entrada.</span><span class="sxs-lookup"><span data-stu-id="8a30c-171">To finish creating a custom asynchronous transformation component, you must use the overridden ProcessInputRow method to process the data in each row of the input buffer.</span></span> <span data-ttu-id="8a30c-172">Dado que las salidas no son sincrónicas con respecto a la entrada, debe escribir filas de datos explícitamente para las salidas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-172">Because the outputs are not synchronous to the input, you must explicitly write rows of data to the outputs.</span></span>

 <span data-ttu-id="8a30c-173">En una transformación asincrónica, puede usar el método AddRow para agregar filas a la salida, según corresponda, desde los métodos ProcessInputRow o ProcessInput.</span><span class="sxs-lookup"><span data-stu-id="8a30c-173">In an asynchronous transformation, you can use the AddRow method to add rows to the output as appropriate from within the ProcessInputRow or ProcessInput methods.</span></span> <span data-ttu-id="8a30c-174">No es necesario utilizar el método CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="8a30c-174">You do not have to use the CreateNewOutputRows method.</span></span> <span data-ttu-id="8a30c-175">Si escribe una sola fila de resultados (como resultados de agregación) para una salida determinada, puede crear la fila de salida de antemano con el método CreateNewOutputRows y rellenar sus valores más adelante, después de procesar todas las filas de entrada.</span><span class="sxs-lookup"><span data-stu-id="8a30c-175">If you are writing a single row of results, such as aggregation results, to a particular output, you can create the output row beforehand by using the CreateNewOutputRows method, and fill in its values later after processing all input rows.</span></span> <span data-ttu-id="8a30c-176">Sin embargo, no resulta útil crear varias filas en el método CreateNewOutputRows, ya que el componente de script solamente permite usar la fila actual en una entrada o salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-176">However it is not useful to create multiple rows in the CreateNewOutputRows method, because the Script component only lets you use the current row in an input or output.</span></span> <span data-ttu-id="8a30c-177">El método CreateNewOutputRows es más importante en un componente de origen donde no hay filas de entrada que procesar.</span><span class="sxs-lookup"><span data-stu-id="8a30c-177">The CreateNewOutputRows method is more important in a source component where there are no input rows to process.</span></span>

 <span data-ttu-id="8a30c-178">Puede que también desee invalidar el propio método ProcessInput para poder realizar un procesamiento adicional preliminar o final, antes o después de usar un bucle para recorrer el búfer de entrada y llamar a ProcessInputRow para cada fila.</span><span class="sxs-lookup"><span data-stu-id="8a30c-178">You may also want to override the ProcessInput method itself, so that you can do additional preliminary or final processing before or after you loop through the input buffer and call ProcessInputRow for each row.</span></span> <span data-ttu-id="8a30c-179">Por ejemplo, uno de los ejemplos de código de este tema invalida ProcessInput para contar el número de direcciones de una ciudad concreta como ProcessInputRow bucles a través `.` de filas. en el ejemplo se escribe el valor de resumen en la segunda salida una vez procesadas todas las filas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-179">For example, one of the code examples in this topic overrides ProcessInput to count the number of addresses in a specific city as ProcessInputRow loops through rows`.` The example writes the summary value to the second output after all rows have been processed.</span></span> <span data-ttu-id="8a30c-180">El ejemplo completa la salida de ProcessInput porque los búferes de salida ya no están disponibles al llamar a PostExecute.</span><span class="sxs-lookup"><span data-stu-id="8a30c-180">The example completes the output in ProcessInput because the output buffers are no longer available when PostExecute is called.</span></span>

 <span data-ttu-id="8a30c-181">En función de sus requisitos, puede que también desee escribir script en los métodos PreExecute y PostExecute, disponibles en la clase ScriptMain, para realizar un procesamiento preliminar o final.</span><span class="sxs-lookup"><span data-stu-id="8a30c-181">Depending on your requirements, you may also want to write script in the PreExecute and PostExecute methods available in the ScriptMain class to perform any preliminary or final processing.</span></span>

> [!NOTE]
>  <span data-ttu-id="8a30c-182">Si estuviese desarrollando un componente de flujo de datos personalizado partiendo de cero, sería importante que invalidase el método PrimeOutput para almacenar en caché las referencias a los búferes de salida de forma que pudiese agregar filas de datos a los búferes más adelante.</span><span class="sxs-lookup"><span data-stu-id="8a30c-182">If you were developing a custom data flow component from scratch, it would be important to override the PrimeOutput method to cache references to the output buffers so that you could add rows of data to the buffers later.</span></span> <span data-ttu-id="8a30c-183">Esto no es necesario en el componente de script, ya que existe una clase que se genera automáticamente que representa cada búfer de salida en el elemento de proyecto `BufferWrapper`.</span><span class="sxs-lookup"><span data-stu-id="8a30c-183">In the Script component, this is not necessary because you have an automatically generated class representing each output buffer in the `BufferWrapper` project item.</span></span>

## <a name="example"></a><span data-ttu-id="8a30c-184">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="8a30c-184">Example</span></span>
 <span data-ttu-id="8a30c-185">En este ejemplo se muestra el código personalizado que se requiere en la clase ScriptMain para crear un componente de transformación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="8a30c-185">This example demonstrates the custom code that is required in the ScriptMain class to create an asynchronous transformation component.</span></span>

> [!NOTE]
>  <span data-ttu-id="8a30c-186">En estos ejemplos se usa la tabla **Person.Address** de la base de datos de ejemplo **AdventureWorks** y se pasan la primera y la cuarta columna, las columnas **intAddressID** y **nvarchar(30)City**, a través del flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="8a30c-186">These examples use the **Person.Address** table in the **AdventureWorks** sample database and pass its first and fourth columns, the **intAddressID** and **nvarchar(30)City** columns, through the data flow.</span></span> <span data-ttu-id="8a30c-187">Estos mismos datos se usan en los ejemplos de origen, transformación y destino de esta sección.</span><span class="sxs-lookup"><span data-stu-id="8a30c-187">The same data is used in the source, transformation, and destination samples in this section.</span></span> <span data-ttu-id="8a30c-188">Se documentan requisitos previos y suposiciones adicionales para cada ejemplo.</span><span class="sxs-lookup"><span data-stu-id="8a30c-188">Additional prerequisites and assumptions are documented for each example.</span></span>

 <span data-ttu-id="8a30c-189">En este ejemplo se muestra un componente de transformación asincrónica con dos salidas.</span><span class="sxs-lookup"><span data-stu-id="8a30c-189">This example demonstrates an asynchronous transformation component with two outputs.</span></span> <span data-ttu-id="8a30c-190">Esta transformación pasa las columnas **AddressID** y **City** a una salida, al mismo tiempo que cuenta el número de direcciones situadas en una ciudad concreta (Redmond, Washington, EE. UU.) y, a continuación, genera el valor resultante en una segunda salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-190">This transformation passes through the **AddressID** and **City** columns to one output, while it counts the number of addresses located in a specific city (Redmond, Washington, U.S.A.), and then outputs the resulting value to a second output.</span></span>

 <span data-ttu-id="8a30c-191">Si desea ejecutar este código de ejemplo, debe configurar el paquete y el componente de la siguiente forma:</span><span class="sxs-lookup"><span data-stu-id="8a30c-191">If you want to run this sample code, you must configure the package and the component as follows:</span></span>

1.  <span data-ttu-id="8a30c-192">Agregue un nuevo componente de script a la superficie del diseñador de flujo de datos y configúrelo como una transformación.</span><span class="sxs-lookup"><span data-stu-id="8a30c-192">Add a new Script component to the Data Flow designer surface and configure it as a transformation.</span></span>

2.  <span data-ttu-id="8a30c-193">Conecte la salida de un origen o de otra transformación al nuevo componente de transformación en el diseñador.</span><span class="sxs-lookup"><span data-stu-id="8a30c-193">Connect the output of a source or of another transformation to the new transformation component in the designer.</span></span> <span data-ttu-id="8a30c-194">Esta salida debe proporcionar datos de la tabla **Person.Address** de la base de datos de ejemplo **AdventureWorks** que contiene al menos las columnas **AddressID** y **City**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-194">This output should provide data from the **Person.Address** table of the **AdventureWorks** sample database that contains at least the **AddressID** and **City** columns.</span></span>

3.  <span data-ttu-id="8a30c-195">Abra el **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-195">Open the **Script Transformation Editor**.</span></span> <span data-ttu-id="8a30c-196">En la página **Columnas de entrada**, seleccione las columnas **AddressID** y **City**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-196">On the **Input Columns** page, select the **AddressID** and **City** columns.</span></span>

4.  <span data-ttu-id="8a30c-197">En la página **Entradas y salidas**, agregue y configure las columnas de salida **AddressID** y **City** en la primera salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-197">On the **Inputs and Outputs** page, add and configure the **AddressID** and **City** output columns on the first output.</span></span> <span data-ttu-id="8a30c-198">Agregue una segunda salida y una columna de salida para el valor de resumen en la segunda salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-198">Add a second output, and add an output column for the summary value on the second output.</span></span> <span data-ttu-id="8a30c-199">Establezca la propiedad SynchronousInputID de la primera salida en 0, porque este ejemplo copia cada fila de entrada explícitamente en la primera salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-199">Set the SynchronousInputID property of the first output to 0, because this example copies each input row explicitly to the first output.</span></span> <span data-ttu-id="8a30c-200">La propiedad SynchronousInputID de la salida recién creada ya está establecida en 0.</span><span class="sxs-lookup"><span data-stu-id="8a30c-200">The SynchronousInputID property of the newly-created output is already set to 0.</span></span>

5.  <span data-ttu-id="8a30c-201">Cambie el nombre de la entrada, las salidas y la nueva columna de salida por nombres más descriptivos.</span><span class="sxs-lookup"><span data-stu-id="8a30c-201">Rename the input, the outputs, and the new output column to give them more descriptive names.</span></span> <span data-ttu-id="8a30c-202">En el ejemplo se usa **MyAddressInput** como nombre de la entrada, **MyAddressOutput** y **MySummaryOutput** para las salidas y **MyRedmondCount** para la columna de salida de la segunda salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-202">The example uses **MyAddressInput** as the name of the input, **MyAddressOutput** and **MySummaryOutput** for the outputs, and **MyRedmondCount** for the output column on the second output.</span></span>

6.  <span data-ttu-id="8a30c-203">En la página **Script**, haga clic en **Editar script** y escriba el script que se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="8a30c-203">On the **Script** page, click **Edit Script** and enter the script that follows.</span></span> <span data-ttu-id="8a30c-204">A continuación, cierre el entorno de desarrollo de script y el **Editor de transformación Script**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-204">Then close the script development environment and the **Script Transformation Editor**.</span></span>

7.  <span data-ttu-id="8a30c-205">Cree y configure un componente de destino para la primera salida que espere las columnas **AddressID** y **City**, como un destino de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], o el componente de destino de ejemplo que se muestra en [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md) (Crear un destino con el componente de script).</span><span class="sxs-lookup"><span data-stu-id="8a30c-205">Create and configure a destination component for the first output that expects the **AddressID** and **City** columns, such as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] destination, or the sample destination component demonstrated in [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md), .</span></span> <span data-ttu-id="8a30c-206">A continuación, conecte la primera salida de transformación, **MyAddressOutput**, al componente de destino.</span><span class="sxs-lookup"><span data-stu-id="8a30c-206">Then connect the first output of the transformation, **MyAddressOutput**, to the destination component.</span></span> <span data-ttu-id="8a30c-207">Puede crear una tabla de destino ejecutando el siguiente comando [!INCLUDE[tsql](../../includes/tsql-md.md)] en la base de datos **AdventureWorks**:</span><span class="sxs-lookup"><span data-stu-id="8a30c-207">You can create a destination table by running the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command in the **AdventureWorks** database:</span></span>

    ```
    CREATE TABLE [Person].[Address2]([AddressID] [int] NOT NULL,
        [City] [nvarchar](30) NOT NULL)
    ```

8.  <span data-ttu-id="8a30c-208">Cree y configure otro componente de destino para la segunda salida.</span><span class="sxs-lookup"><span data-stu-id="8a30c-208">Create and configure another destination component for the second output.</span></span> <span data-ttu-id="8a30c-209">A continuación, conecte la segunda salida de transformación, **MySummaryOutput**, al componente de destino.</span><span class="sxs-lookup"><span data-stu-id="8a30c-209">Then connect the second output of the transformation, **MySummaryOutput**, to the destination component.</span></span> <span data-ttu-id="8a30c-210">Dado que la segunda salida escribe una única fila con un único valor, puede configurar fácilmente un destino con un administrador de conexiones de archivos planos que se conecta a un nuevo archivo que tiene una única columna.</span><span class="sxs-lookup"><span data-stu-id="8a30c-210">Because the second output writes a single row with a single value, you can easily configure a destination with a Flat File connection manager that connects to a new file that has a single column.</span></span> <span data-ttu-id="8a30c-211">En el ejemplo, esta columna de destino se denomina **MyRedmondCount**.</span><span class="sxs-lookup"><span data-stu-id="8a30c-211">In the example, this destination column is named **MyRedmondCount**.</span></span>

9. <span data-ttu-id="8a30c-212">Ejecute el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="8a30c-212">Run the sample.</span></span>

```vb
Public Class ScriptMain
    Inherits UserComponent

    Private myRedmondAddressCount As Integer

    Public Overrides Sub CreateNewOutputRows()

        MySummaryOutputBuffer.AddRow()

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInput(ByVal Buffer As MyAddressInputBuffer)

        While Buffer.NextRow()
            MyAddressInput_ProcessInputRow(Buffer)
        End While

        If Buffer.EndOfRowset Then
            MyAddressOutputBuffer.SetEndOfRowset()
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount
            MySummaryOutputBuffer.SetEndOfRowset()
        End If

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInputRow(ByVal Row As MyAddressInputBuffer)

        With MyAddressOutputBuffer
            .AddRow()
            .AddressID = Row.AddressID
            .City = Row.City
        End With

        If Row.City.ToUpper = "REDMOND" Then
            myRedmondAddressCount += 1
        End If

    End Sub

End Class
```

```csharp
public class ScriptMain:
    UserComponent

{
    private int myRedmondAddressCount;

    public override void CreateNewOutputRows()
    {

        MySummaryOutputBuffer.AddRow();

    }

    public override void MyAddressInput_ProcessInput(MyAddressInputBuffer Buffer)
    {

        while (Buffer.NextRow())
        {
            MyAddressInput_ProcessInputRow(Buffer);
        }

        if (Buffer.EndOfRowset())
        {
            MyAddressOutputBuffer.SetEndOfRowset();
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount;
            MySummaryOutputBuffer.SetEndOfRowset();
        }

    }

    public override void MyAddressInput_ProcessInputRow(MyAddressInputBuffer Row)
    {

        {
            MyAddressOutputBuffer.AddRow();
            MyAddressOutputBuffer.AddressID = Row.AddressID;
            MyAddressOutputBuffer.City = Row.City;
        }

        if (Row.City.ToUpper() == "REDMOND")
        {
            myRedmondAddressCount += 1;
        }

    }

}

```

<span data-ttu-id="8a30c-213">![Integration Services icono (pequeño)](../media/dts-16.gif "Icono de Integration Services (pequeño)")  **Manténgase al día con Integration Services**</span><span class="sxs-lookup"><span data-stu-id="8a30c-213">![Integration Services icon (small)](../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="8a30c-214">Para obtener las descargas, artículos, ejemplos y vídeos más recientes de Microsoft, así como soluciones seleccionadas de la comunidad, visite la página de [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] en MSDN:</span><span class="sxs-lookup"><span data-stu-id="8a30c-214">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="8a30c-215">Visite la página de Integration Services en MSDN</span><span class="sxs-lookup"><span data-stu-id="8a30c-215">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="8a30c-216">Para recibir notificaciones automáticas de estas actualizaciones, suscríbase a las fuentes RSS disponibles en la página.</span><span class="sxs-lookup"><span data-stu-id="8a30c-216">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="8a30c-217">Consulte también</span><span class="sxs-lookup"><span data-stu-id="8a30c-217">See Also</span></span>
 <span data-ttu-id="8a30c-218">[Descripción de las transformaciones sincrónicas y asincrónicas](../understanding-synchronous-and-asynchronous-transformations.md) [crear una transformación sincrónica con el componente de script](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [desarrollar un componente de transformación personalizado con salidas asincrónicas](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span><span class="sxs-lookup"><span data-stu-id="8a30c-218">[Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md) [Creating a Synchronous Transformation with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [Developing a Custom Transformation Component with Asynchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span></span>


