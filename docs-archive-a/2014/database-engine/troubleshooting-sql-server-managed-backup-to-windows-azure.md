---
title: Solución de problemas de SQL Server copia de seguridad administrada en Azure | Microsoft Docs
description: En este artículo se describen las tareas y las herramientas que puede usar para solucionar los errores que pueden producirse durante la SQL Server copia de seguridad administrada en Microsoft Azure operaciones.
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: a34d35b0-48eb-4ed1-9f19-ea14754650da
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 9c7ed5dd25ed2b02445bfae5eb78ac03b2270552
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87746405"
---
# <a name="troubleshooting-sql-server-managed--backup-to-azure"></a><span data-ttu-id="ee83c-103">Solución de problemas de la copia de seguridad administrada de SQL Server en Azure</span><span class="sxs-lookup"><span data-stu-id="ee83c-103">Troubleshooting SQL Server Managed  Backup to Azure</span></span>
  <span data-ttu-id="ee83c-104">En este tema se describen las tareas y las herramientas que puede usar para solucionar los errores que pueden producirse durante las operaciones de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ee83c-104">This topic describes the tasks and tools you can use to troubleshoot errors that may occur during [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] operations.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="ee83c-105">Información general</span><span class="sxs-lookup"><span data-stu-id="ee83c-105">Overview</span></span>  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="ee83c-106">tiene pasos para solucionar problemas y comprobaciones integrados de modo que, en muchos casos, el propio proceso de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] se ocupa de los errores internos.</span><span class="sxs-lookup"><span data-stu-id="ee83c-106">has built in checks and troubleshooting, so in many cases internal failures are taken care of by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] process itself.</span></span>  
  
 <span data-ttu-id="ee83c-107">Por ejemplo, una eliminación de un archivo de copia de seguridad que da lugar a una interrupción de la cadena de registro que afecta a la capacidad de recuperación: [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] identificará la interrupción en la cadena de registros y programará una copia de seguridad para que se realice inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="ee83c-107">Example of one such case is a deletion of a backup file resulting in a break of the log chain affecting recoverability - [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will identify the break in log chain and schedule a backup to be taken immediately.</span></span> <span data-ttu-id="ee83c-108">Sin embargo, se recomienda supervisar el estado y solucionar los errores que requieran intervención manual.</span><span class="sxs-lookup"><span data-stu-id="ee83c-108">However we recommend that you monitor the status and address any errors that require manual intervention.</span></span>  
  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="ee83c-109">registra los eventos y los errores usando procedimientos almacenados del sistema, vistas del sistema y eventos extendidos.</span><span class="sxs-lookup"><span data-stu-id="ee83c-109">logs events and errors using system stored procedures, system views and extended events.</span></span> <span data-ttu-id="ee83c-110">Las vistas del sistema y los procedimientos almacenados proporcionan información de configuración de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], el estado de las copias de seguridad programadas y también los errores capturados por Eventos extendidos.</span><span class="sxs-lookup"><span data-stu-id="ee83c-110">System views and stored procedures provide [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configuration information, status of backup scheduled backups, and also the errors captured by Extended Events.</span></span> [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="ee83c-111">usa Eventos extendidos para capturar los errores que se usan para solucionar problemas.</span><span class="sxs-lookup"><span data-stu-id="ee83c-111">uses Extended Events to capture the errors to use for troubleshooting.</span></span> <span data-ttu-id="ee83c-112">Además de registrar los eventos, las Directivas de administración inteligente de SQL Server proporcionan un estado de mantenimiento que un trabajo de notificación por correo electrónico usa para la notificación de errores y problemas.</span><span class="sxs-lookup"><span data-stu-id="ee83c-112">In addition to logging events, SQL Server Smart Admin Policies provide a health status which is used by an email notification job to provide notification or errors and issues.</span></span> <span data-ttu-id="ee83c-113">Para obtener más información, consulte [supervisión SQL Server copia de seguridad administrada en Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span><span class="sxs-lookup"><span data-stu-id="ee83c-113">For more information see [Monitor SQL Server Managed Backup to Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span></span>  
  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]<span data-ttu-id="ee83c-114">también usa el mismo registro que se usa cuando se realiza una copia de seguridad manual en Azure Storage (SQL Server copia de seguridad en la dirección URL).</span><span class="sxs-lookup"><span data-stu-id="ee83c-114">also uses the same logging that is used when manually backing up to Azure storage (SQL Server Backup to URL).</span></span> <span data-ttu-id="ee83c-115">Para obtener más información acerca de los problemas relacionados con la copia de seguridad en URL, consulte la sección solución de problemas de [SQL Server procedimientos recomendados y solución de problemas de copia de seguridad en URL](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md) .</span><span class="sxs-lookup"><span data-stu-id="ee83c-115">For more information on Backup to URL related issues, see the troubleshooting section in [SQL Server Backup to URL Best Practices and Troubleshooting](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md)</span></span>  
  
### <a name="general-troubleshooting-steps"></a><span data-ttu-id="ee83c-116">Pasos generales para solucionar problemas</span><span class="sxs-lookup"><span data-stu-id="ee83c-116">General Troubleshooting Steps</span></span>  
  
1.  <span data-ttu-id="ee83c-117">Habilite la notificación por correo electrónico para empezar a recibir mensajes de correo electrónico con los errores y advertencias.</span><span class="sxs-lookup"><span data-stu-id="ee83c-117">Enable Email Notification to start to receive emails for error and warnings.</span></span>  
  
     <span data-ttu-id="ee83c-118">Como alternativa, también puede ejecutar periódicamente `smart_admin.fn_get_health_status` para comprobar los recuentos y los errores agregados.</span><span class="sxs-lookup"><span data-stu-id="ee83c-118">Alternatively, you can also periodically run `smart_admin.fn_get_health_status` to check the aggregated errors and counts.</span></span> <span data-ttu-id="ee83c-119">Por ejemplo, `number_of_invalid_credential_errors` es el número de veces que la copia de seguridad inteligente intentó una copia de seguridad pero obtuvo un error de credencial no válida.</span><span class="sxs-lookup"><span data-stu-id="ee83c-119">For example, `number_of_invalid_credential_errors` is the number of times smart backup attempted a backup but got invalid credential error.</span></span> <span data-ttu-id="ee83c-120">`Number_of_backup_loops` y `number_of_retention_loops` no son errores pero indican que el número de veces que el subproceso de copia de seguridad y el de retención examinaron la lista de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="ee83c-120">`Number_of_backup_loops` and `number_of_retention_loops` are not errors; but they indicate the number of times backup thread and retention thread scanned the list of databases.</span></span> <span data-ttu-id="ee83c-121">Normalmente, cuando @begin_time @end_time no se proporcionan y, la función muestra la información de los últimos 30 minutos y, por lo general, deberíamos ver valores distintos de cero para estas dos columnas.</span><span class="sxs-lookup"><span data-stu-id="ee83c-121">Typically, when @begin_time and @end_time are not provided, the function is showing the information from last 30 minutes, then we should normally see non-zero values for these two columns.</span></span> <span data-ttu-id="ee83c-122">Si son cero, implica que el sistema está sobrecargado o incluso que no responde.</span><span class="sxs-lookup"><span data-stu-id="ee83c-122">If they are zero then it implies system overloaded or even system not responding.</span></span> <span data-ttu-id="ee83c-123">Para obtener más información, consulte la sección **solución de problemas del sistema** más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="ee83c-123">For more information, see **Troubleshooting System Issues** section later in this topic.</span></span>  
  
2.  <span data-ttu-id="ee83c-124">Revise los registros de Eventos extendidos para obtener más detalles sobre los errores y otros eventos asociados.</span><span class="sxs-lookup"><span data-stu-id="ee83c-124">Review the Extended Event logs to learn more details on the errors and other associated events.</span></span>  
  
3.  <span data-ttu-id="ee83c-125">Utilice la información de los registros para solucionar el problema.</span><span class="sxs-lookup"><span data-stu-id="ee83c-125">Use the information in the logs to resolve the issue.</span></span>  <span data-ttu-id="ee83c-126">En caso de un problema o un error del sistema, puede que tenga que reiniciar el servicio del Agente SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ee83c-126">In case of a system issue or error, you may need to restart the service or SQL Server Agent.</span></span>  
  
### <a name="common-causes-of-errors"></a><span data-ttu-id="ee83c-127">Causas comunes de los errores</span><span class="sxs-lookup"><span data-stu-id="ee83c-127">Common Causes of Errors</span></span>  
 <span data-ttu-id="ee83c-128">A continuación se muestra la lista de las causas comunes que provocan errores:</span><span class="sxs-lookup"><span data-stu-id="ee83c-128">Following is the list of common causes resulting in failures:</span></span>  
  
1.  <span data-ttu-id="ee83c-129">**Cambios en la credencial de SQL:** Si cambia el nombre de la credencial usada por [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] , o si se elimina, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] no podrá realizar copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="ee83c-129">**Changes to SQL Credential:** If the name of the credential used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is changed or if it is deleted, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will not be able to take backups.</span></span> <span data-ttu-id="ee83c-130">El cambio se debe aplicar a la configuración de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ee83c-130">The change should be applied to [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configuration settings.</span></span>  
  
2.  <span data-ttu-id="ee83c-131">**Cambios en los valores de clave de acceso de almacenamiento:** Si se cambian los valores de clave de almacenamiento de la cuenta de Azure, pero la credencial de SQL no se actualiza con los nuevos valores, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] se producirá un error al autenticarse en el almacenamiento y no se podrán realizar copias de seguridad de las bases de datos configuradas para usar esta cuenta.</span><span class="sxs-lookup"><span data-stu-id="ee83c-131">**Changes to storage access key values:** If the storage key values are changed for the Azure account, but SQL Credential is not updated with the new values, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will fail when authenticating to the storage, and fails to backup databases configured to use this account.</span></span>  
  
3.  <span data-ttu-id="ee83c-132">**Cambios en la cuenta de Azure Storage:** La eliminación o el cambio de nombre de la cuenta de almacenamiento sin los cambios correspondientes en la credencial SQL provocará [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] un error y no se realizará ninguna copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="ee83c-132">**Changes to Azure Storage Account:** Deleting or renaming storage account without corresponding changes to the SQL Credential will cause [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] to fail and no backups will be taken.</span></span> <span data-ttu-id="ee83c-133">Si elimina una cuenta de almacenamiento, asegúrese de que las bases de datos se configuran de nuevo con la información válida de la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="ee83c-133">If you delete a storage account, ensure that the databases are reconfigured with valid storage account information.</span></span> <span data-ttu-id="ee83c-134">Si se cambia una cuenta de almacenamiento o se cambian los valores de clave, asegúrese de que estos cambios se reflejan en la credencial de SQL que usa [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ee83c-134">If a storage account is renamed or the key values are changed, ensure that these changes are reflected in the SQL Credential used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span>  
  
4.  <span data-ttu-id="ee83c-135">**Cambios en las propiedades de la base de datos:** Los cambios en los modelos de recuperación o en el cambio de nombre pueden hacer que se produzca un error en las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="ee83c-135">**Changes to Database Properties:** Changes to recovery models or changing the name can cause backups to fail.</span></span>  
  
5.  <span data-ttu-id="ee83c-136">**Cambios en el modelo de recuperación:** Si el modelo de recuperación de la base de datos se cambia a simple desde completo u optimizado para cargas masivas de registro, se detendrán las copias de seguridad y se omitirán las bases de datos [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ee83c-136">**Changes to Recovery Model:** If the recovery model of the database is changed to simple from full or bulk-logged, backups will stop, and the databases will be skipped by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="ee83c-137">Para obtener más información, consulte [SQL Server copia de seguridad administrada en Azure: interoperabilidad y coexistencia](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-interoperability-and-coexistence.md)</span><span class="sxs-lookup"><span data-stu-id="ee83c-137">For more information, see [SQL Server Managed Backup to Azure: Interoperability and Coexistence](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-interoperability-and-coexistence.md)</span></span>  
  
### <a name="most-common-error-messages-and-solutions"></a><span data-ttu-id="ee83c-138">Mensajes de error y soluciones más comunes</span><span class="sxs-lookup"><span data-stu-id="ee83c-138">Most Common Error Messages and Solutions</span></span>  
  
1.  <span data-ttu-id="ee83c-139">**Errores al habilitar o configurar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] :**</span><span class="sxs-lookup"><span data-stu-id="ee83c-139">**Errors when enabling or configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]:**</span></span>  
  
     <span data-ttu-id="ee83c-140">Error: "no se pudo obtener acceso a la dirección URL de almacenamiento.... Proporcione una credencial SQL válida... ": puede ver este y otros errores similares relacionados con las credenciales de SQL.</span><span class="sxs-lookup"><span data-stu-id="ee83c-140">Error: " Failed to access the storage URL.... Provide a valid SQL Credential..." : You may see this and other similar errors referring to SQL Credentials.</span></span>  <span data-ttu-id="ee83c-141">En tales casos, revise el nombre de la credencial de SQL que proporcionó, así como la información almacenada en la credencial de SQL: el nombre de la cuenta de almacenamiento y la clave de acceso de almacenamiento, y asegúrese de que son actuales y válidos.</span><span class="sxs-lookup"><span data-stu-id="ee83c-141">In such cases, review the name of the SQL Credential you provided, and also the information stored in the SQL Credential - the storage account name, and the storage access key and make sure that they are current and valid.</span></span>  
  
     <span data-ttu-id="ee83c-142">Error: "... no se puede configurar la base de datos.... como es una base de datos del sistema ": verá este error si intenta habilitar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] para una base de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="ee83c-142">Error: "... cannot configure the database....because it is a system database": You will see this error if you try to enable [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for a system database.</span></span>  [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="ee83c-143">no admite copias de seguridad de bases de datos del sistema.</span><span class="sxs-lookup"><span data-stu-id="ee83c-143">does not support backups for system databases.</span></span>  <span data-ttu-id="ee83c-144">Para configurar la copia de seguridad de una base de datos del sistema, utilice otras tecnologías de copia de seguridad de SQL Server como los planes de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="ee83c-144">To configure backup for a system database use other SQL Server Backup technologies such as maintenance plans.</span></span>  
  
     <span data-ttu-id="ee83c-145">Error: "... Proporcionar un período de retención.... ": puede ver errores relacionados con el período de retención Si no ha especificado un período de retención para la base de datos o la instancia de al configurar estos valores por primera vez.</span><span class="sxs-lookup"><span data-stu-id="ee83c-145">Error:" ... Provide a retention period...." : You may see errors regarding the retention period if you either have not specified a retention period for the database or instance when you are configuring these values for the first time.</span></span> <span data-ttu-id="ee83c-146">También puede ver un error si proporciona un valor distinto de un número entre 1 y 30.</span><span class="sxs-lookup"><span data-stu-id="ee83c-146">You may also see an error if you provide a value other than a number between 1 and 30.</span></span> <span data-ttu-id="ee83c-147">El valor válido para el período de retención es un número entre 1 y 30.</span><span class="sxs-lookup"><span data-stu-id="ee83c-147">The allowed value for the retention period is a number between 1 and 30.</span></span>  
  
2.  <span data-ttu-id="ee83c-148">**Errores de notificación por correo electrónico:**</span><span class="sxs-lookup"><span data-stu-id="ee83c-148">**Email Notification Errors:**</span></span>  
  
     <span data-ttu-id="ee83c-149">Error: "Correo electrónico de base de datos no está habilitado...": verá este error si habilita las notificaciones por correo electrónico, pero Correo electrónico de base de datos no está configurado en la instancia.</span><span class="sxs-lookup"><span data-stu-id="ee83c-149">Error: "Database Mail is not enabled..." - You will see this error if you enable e-mail notifications, but Database Mail is not configured on the instance.</span></span> <span data-ttu-id="ee83c-150">Debe configurar Correo electrónico de base de datos en la instancia para poder recibir la notificación del estado de mantenimiento de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ee83c-150">You must configure Database Mail on the instance to be able to receive notification of the health status of [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="ee83c-151">Para obtener información sobre cómo habilitar correo electrónico de base de datos, vea [configurar correo electrónico de base de datos](../relational-databases/database-mail/configure-database-mail.md).</span><span class="sxs-lookup"><span data-stu-id="ee83c-151">For information about how to enable database mail, see [Configure Database Mail](../relational-databases/database-mail/configure-database-mail.md).</span></span> <span data-ttu-id="ee83c-152">También debe habilitar el Agente SQL Server para utilizar Correo electrónico de base de datos para las notificaciones.</span><span class="sxs-lookup"><span data-stu-id="ee83c-152">You must also enable SQL Server Agent to use Database Mail for notifications.</span></span> <span data-ttu-id="ee83c-153">Para obtener más información, vea [antes de empezar](../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md#BeforeYouBegin).</span><span class="sxs-lookup"><span data-stu-id="ee83c-153">For more information, see [Before You Begin](../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md#BeforeYouBegin).</span></span>  
  
     <span data-ttu-id="ee83c-154">La siguiente es una lista de números de error que podría ver, que están asociados a notificaciones por correo electrónico:</span><span class="sxs-lookup"><span data-stu-id="ee83c-154">Following is a list of error numbers you might see that are associated with email notifications:</span></span>  
  
    -   <span data-ttu-id="ee83c-155">Númeroerror: 45209</span><span class="sxs-lookup"><span data-stu-id="ee83c-155">ErrorNumber: 45209</span></span>  
  
    -   <span data-ttu-id="ee83c-156">Númeroerror: 45210</span><span class="sxs-lookup"><span data-stu-id="ee83c-156">ErrorNumber: 45210</span></span>  
  
    -   <span data-ttu-id="ee83c-157">ErrorNumber: 45211</span><span class="sxs-lookup"><span data-stu-id="ee83c-157">ErrorNumber: 45211</span></span>  
  
3.  <span data-ttu-id="ee83c-158">**Errores de conectividad:**</span><span class="sxs-lookup"><span data-stu-id="ee83c-158">**Connectivity Errors:**</span></span>  
  
    -   <span data-ttu-id="ee83c-159">**Errores relacionados con la conectividad de SQL:** Estos errores se producen cuando hay problemas para conectarse a SQL Server instancia.</span><span class="sxs-lookup"><span data-stu-id="ee83c-159">**Errors Related to SQL Connectivity:** These errors happen when there are issues connecting to SQL Server instance.</span></span> <span data-ttu-id="ee83c-160">Los eventos extendidos exponen estos tipos de errores a través del canal de administración.</span><span class="sxs-lookup"><span data-stu-id="ee83c-160">The extended events expose these type of errors through the admin channel.</span></span> <span data-ttu-id="ee83c-161">Estos son los dos eventos extendidos que puede ver si hay errores relacionados con este tipo de problemas de conectividad:</span><span class="sxs-lookup"><span data-stu-id="ee83c-161">Following are the two extended events that you might see for errors related to this type of connectivity issues:</span></span>  
  
         <span data-ttu-id="ee83c-162">FileRetentionAdminXEvent con event_type = SqlError.</span><span class="sxs-lookup"><span data-stu-id="ee83c-162">FileRetentionAdminXEvent with event_type = SqlError.</span></span> <span data-ttu-id="ee83c-163">Para obtener detalles de este error, busque los valores de error_code, error_message y stack_trace de ese evento.</span><span class="sxs-lookup"><span data-stu-id="ee83c-163">For details of this error, look at the error_code, error_message and stack_trace of that event.</span></span> <span data-ttu-id="ee83c-164">El error_code es el número de error de SqlException.</span><span class="sxs-lookup"><span data-stu-id="ee83c-164">The error_code is the SqlException's error number.</span></span>  
  
         <span data-ttu-id="ee83c-165">SmartBackupAdminXevent con los siguientes mensajes y prefijos de mensaje:</span><span class="sxs-lookup"><span data-stu-id="ee83c-165">SmartBackupAdminXevent with the following messages/message prefixes:</span></span>  
  
         <span data-ttu-id="ee83c-166">*"Se produjo un error interno al configurar SQL Server copia de seguridad administrada en la configuración predeterminada de Azure para la instancia. El error puede ser transitorio. "*</span><span class="sxs-lookup"><span data-stu-id="ee83c-166">*"An internal error occurred while configuring SQL Server Managed Backup to Azure default settings for instance. Error might be transient."*</span></span>  
  
         <span data-ttu-id="ee83c-167">*"Es probable que experimente problemas de conectividad con SQL Server. Omitiendo la base de datos en la iteración actual. "*</span><span class="sxs-lookup"><span data-stu-id="ee83c-167">*"Probably experiencing connectivity issues with SQL Server. Skipping database in the current iteration."*</span></span>  
  
         <span data-ttu-id="ee83c-168">*"Error al consultar la información de uso del registro. El error puede ser transitorio. Omitiendo la base de datos en la iteración actual. "*</span><span class="sxs-lookup"><span data-stu-id="ee83c-168">*"Querying log usage info failed. The failure might be transient. Skipping database in the current iteration."*</span></span>  
  
         <span data-ttu-id="ee83c-169">*"Se encontró una excepción de SQL al cargar los metadatos del agente SSMBackup2WA. El error puede ser transitorio. Se volverá a intentar la operación ".*</span><span class="sxs-lookup"><span data-stu-id="ee83c-169">*"SQL exception encountered while loading SSMBackup2WA agent metadata. The failure might be transient. Operation will be retried."*</span></span>  
  
         <span data-ttu-id="ee83c-170">*"SSMBackup2WA encontró una excepción de SQL... "*</span><span class="sxs-lookup"><span data-stu-id="ee83c-170">*"SSMBackup2WA encountered SQL exception while ... "*</span></span>  
  
    -   <span data-ttu-id="ee83c-171">**Errores al conectarse a la cuenta de almacenamiento:**</span><span class="sxs-lookup"><span data-stu-id="ee83c-171">**Errors Connecting to the storage account:**</span></span>  
  
         <span data-ttu-id="ee83c-172">Las excepciones de almacenamiento se notifican en FileRetentionAdminXEvent con el event_type = XstoreError.</span><span class="sxs-lookup"><span data-stu-id="ee83c-172">Storage exceptions are reported in FileRetentionAdminXEvent with event_type = XstoreError.</span></span> <span data-ttu-id="ee83c-173">Para obtener detalles del error, busque los valores de error_message y stack_trace de ese evento.</span><span class="sxs-lookup"><span data-stu-id="ee83c-173">For details of the error, look at the error_message and stack_trace of that event.</span></span>  
  
         <span data-ttu-id="ee83c-174">Puesto que Copia de seguridad administrada de SQL Server utiliza la tecnología Copia de seguridad en URL subyacente, los errores relacionados con la conectividad al almacenamiento se aplican a ambas funciones.</span><span class="sxs-lookup"><span data-stu-id="ee83c-174">Since SQL Server Managed Backup uses the underlying Backup to URL technology, the errors related to storage connectivity apply to both the features.</span></span> <span data-ttu-id="ee83c-175">Para obtener más información sobre los pasos de solución de problemas, consulte la **sección solución de problemas** de los [procedimientos recomendados y solución de problemas de copia de seguridad en URL de SQL Server](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md) .</span><span class="sxs-lookup"><span data-stu-id="ee83c-175">For more information on troubleshooting steps, see **troubleshooting section** of the [SQL Server Backup to URL Best Practices and Troubleshooting](../relational-databases/backup-restore/sql-server-backup-to-url-best-practices-and-troubleshooting.md) article.</span></span>  
  
### <a name="troubleshooting-system-issues"></a><span data-ttu-id="ee83c-176">Solucionar problemas del sistema</span><span class="sxs-lookup"><span data-stu-id="ee83c-176">Troubleshooting System Issues</span></span>  
 <span data-ttu-id="ee83c-177">Los siguientes son algunos escenarios cuando hay un problema con el sistema (SQL Server, Agente SQL Server) y afecta a [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="ee83c-177">Following are some scenarios when there is an issue with the system (SQL Server, SQL Server Agent) and its effects on [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]:</span></span>  
  
-   <span data-ttu-id="ee83c-178">**Sqlservr.exe deja de responder o deja de funcionar cuando [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] se ejecuta:** si SQL Server deja de funcionar, el Agente SQL se cierra correctamente, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] también se detiene y los eventos se registran en el archivo. out del Agente SQL.</span><span class="sxs-lookup"><span data-stu-id="ee83c-178">**Sqlservr.exe stops responding or stops working when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is running:** If SQL Server stops working, SQL Agent will gracefully shut down, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] also stops and the events are logged in SQL Agent.out file.</span></span>  
  
     <span data-ttu-id="ee83c-179">Si SQL Server deja de responder, los eventos se registran en el canal de administración.</span><span class="sxs-lookup"><span data-stu-id="ee83c-179">If SQL Server stops responding, events are logged in the admin channel.</span></span>  <span data-ttu-id="ee83c-180">Un ejemplo del registro de eventos:</span><span class="sxs-lookup"><span data-stu-id="ee83c-180">An example of the event log:</span></span>  
  
     <span data-ttu-id="ee83c-181">*Error de SQL (el motor no responde u obtener sqlException: SqlException:* </span><span class="sxs-lookup"><span data-stu-id="ee83c-181">*Sql Error (engine not responding or get sqlException: SqlException:* </span></span>  
     <span data-ttu-id="ee83c-182">*el código de error, el mensaje y el seguimiento de seguimiento se mostrarán en el XEvent del canal de administración, junto con información adicional, como:* </span><span class="sxs-lookup"><span data-stu-id="ee83c-182">*error code, message and stacktrace will be displayed in an admin channel xevent, together with some extra information, such as :* </span></span>  
    <span data-ttu-id="ee83c-183">*"Es probable que experimente problemas de conectividad con SQL Server. Omitiendo la base de datos en la iteración actual "*</span><span class="sxs-lookup"><span data-stu-id="ee83c-183">*"Probably experiencing connectivity issues with SQL Server. Skipping database in the current iteration"*</span></span>  
  
-   <span data-ttu-id="ee83c-184">**El Agente SQL deja de responder o deja de funcionar cuando [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] se ejecuta:**</span><span class="sxs-lookup"><span data-stu-id="ee83c-184">**SQL Agent stops responding or stops working when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is running:**</span></span>  
  
     <span data-ttu-id="ee83c-185">Si el Agente SQL deja de funcionar, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] también se detiene y los eventos se registran en el canal de administración.</span><span class="sxs-lookup"><span data-stu-id="ee83c-185">If SQL Agent stops working, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] also stops and events are logged in the admin channel.</span></span> <span data-ttu-id="ee83c-186">Esto es similar a los escenarios en los que SQL Server deja de responder.</span><span class="sxs-lookup"><span data-stu-id="ee83c-186">This is similar to the scenarios when SQL Server stops responding.</span></span>  
  
     <span data-ttu-id="ee83c-187">Si el Agente SQL deja de responder, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] no podrá continuar con las operaciones de copia de seguridad y los eventos se registran en el canal de administración.</span><span class="sxs-lookup"><span data-stu-id="ee83c-187">If SQL Agent stops responding, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will be unable to continue with backup operations, and events are logged in the admin channel.</span></span> <span data-ttu-id="ee83c-188">Un ejemplo del registro de eventos:</span><span class="sxs-lookup"><span data-stu-id="ee83c-188">An example of the event log:</span></span>  
  
     <span data-ttu-id="ee83c-189">*El trabajo deja de responder: Consulte canal de administración xevents* </span><span class="sxs-lookup"><span data-stu-id="ee83c-189">*Job hangs: see admin channel xevents* </span></span>  
    <span data-ttu-id="ee83c-190">*"No se ha recibido una actualización de progreso de SQL Server en más de" + constantes. DBBackupInfoMsgMaxWaitTime + "horas para la copia de seguridad de base de datos.   La copia de seguridad en la nube de SSM seguirá esperando. "*</span><span class="sxs-lookup"><span data-stu-id="ee83c-190">*"A progress update hasn't been received from SQL Server in more than " + Constants.DBBackupInfoMsgMaxWaitTime  + " hours for database backup.   SSM Cloud Backup will continue to wait."*</span></span>  
  
 <span data-ttu-id="ee83c-191">Si ha habilitado la notificación por correo electrónico, recibirá una notificación que incluya el **Número de bucles de copia de seguridad** y el **Número de bucles de retención**.</span><span class="sxs-lookup"><span data-stu-id="ee83c-191">If you have enabled email notification, you will receive a notification which includes **Number of Backup Loops** and **Number of Retention Loops**.</span></span> <span data-ttu-id="ee83c-192">Si el valor devuelto en la notificación para una o ambas columnas es cero, podría ser una indicación de que el sistema no responde.</span><span class="sxs-lookup"><span data-stu-id="ee83c-192">If the value returned in the notification for one or both of these two columns is zero, it could be an indication that the system is not responding.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="ee83c-193">Los procesos internos que generan los resultados del informe suponen que los registros de diagnóstico del motor están en la misma ubicación que el registro de errores del Agente SQL, que de forma predeterminada se encuentra en la misma carpeta que los registros de errores de la instancia de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ee83c-193">The internal processes that generate the results for the report, assumes that the engine diagnostic logs are in the same location of SQL Agent error log, which by default is in the same folder as the error logs of the SQL Server instance.</span></span> <span data-ttu-id="ee83c-194">Si los registros de diagnóstico del motor se mueven a una ubicación distinta de la ubicación del registro de errores del Agente SQL, el sistema no encuentra los registros de diagnóstico de copia de seguridad inteligente y, por tanto, el informe de la notificación por correo electrónico quizás no sea correcto.</span><span class="sxs-lookup"><span data-stu-id="ee83c-194">If the engine diagnostic logs are moved to a location other than SQL Agent error log location, the system is unable to find the smart backup diagnostic logs, and hence the report in the email notification may not be correct.</span></span> <span data-ttu-id="ee83c-195">Por ejemplo, podría ver un valor de **0** en todos los campos notificados, incluido el Número de bucles de copia de seguridad y el Número de bucles de retención.</span><span class="sxs-lookup"><span data-stu-id="ee83c-195">For example, you might see a value of **0** in all the fields reported including the Number of Backup Loops and Number of Retention Loops.</span></span> <span data-ttu-id="ee83c-196">En este caso donde los registros de diagnóstico se mueven a una ubicación diferente, puede no indicar que el sistema no responde, sino que el sistema no encuentra los registros.</span><span class="sxs-lookup"><span data-stu-id="ee83c-196">In this case where the diagnostic logs are moved to a different location, it may not mean that the system is not responding, but that the system is unable to find the logs.</span></span> <span data-ttu-id="ee83c-197">Asegúrese primero de que la ubicación de los registros de diagnóstico y los registros de errores del Agente SQL están en la misma ubicación.</span><span class="sxs-lookup"><span data-stu-id="ee83c-197">Ensure that the location of the diagnostic logs and SQL Agent error logs are at the same location first.</span></span> <span data-ttu-id="ee83c-198">Para comprobar la ubicación actual de los registros de diagnóstico, puede usar [Sys. dm_os_server_diagnostics_log_configurations](/sql/relational-databases/system-dynamic-management-views/sys-dm-os-server-diagnostics-log-configurations).</span><span class="sxs-lookup"><span data-stu-id="ee83c-198">To verify the current location of the diagnostic logs, you can use [sys.dm_os_server_diagnostics_log_configurations](/sql/relational-databases/system-dynamic-management-views/sys-dm-os-server-diagnostics-log-configurations).</span></span> <span data-ttu-id="ee83c-199">La `path` columna devuelve la ubicación actual de los registros de diagnóstico del motor.</span><span class="sxs-lookup"><span data-stu-id="ee83c-199">The `path` column returns the current location of the engine diagnostic logs.</span></span>  <span data-ttu-id="ee83c-200">Debe estar en la misma carpeta que los registros de errores del Agente SQL.</span><span class="sxs-lookup"><span data-stu-id="ee83c-200">It should be in the same folder as the SQL Agent error logs.</span></span> <span data-ttu-id="ee83c-201">Puede obtener la ruta de acceso del registro de errores del Agente SQL mediante el procedimiento almacenado `dbo.sp_get_sqlagent_properties`.</span><span class="sxs-lookup"><span data-stu-id="ee83c-201">You can get SQL Agent error log path using the `dbo.sp_get_sqlagent_properties` stored procedure.</span></span>  
  
 <span data-ttu-id="ee83c-202">Compruebe los registros de eventos extendidos para ver los detalles de los errores.</span><span class="sxs-lookup"><span data-stu-id="ee83c-202">Check the extended event logs to see details of the errors.</span></span> <span data-ttu-id="ee83c-203">Corrija los errores o reinicie el Agente SQL Server para corregir la situación.</span><span class="sxs-lookup"><span data-stu-id="ee83c-203">fix the errors, or restart SQL Server Agent to correct the situation.</span></span>  
  
  
