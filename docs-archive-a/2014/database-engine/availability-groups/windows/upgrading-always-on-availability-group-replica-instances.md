---
title: Actualización y actualización de servidores de grupo de disponibilidad con un tiempo de inactividad y pérdida de datos mínimos | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
ms.assetid: f670af56-dbcc-4309-9119-f919dcad8a65
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 6bac882b93016a430fbcace2d590e6cc087123d2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87750170"
---
# <a name="upgrade-and-update-of-availability-group-servers-with-minimal-downtime-and-data-loss"></a><span data-ttu-id="596dd-102">Actualizar servidores de un grupo de disponibilidad con una pérdida de datos y un tiempo de inactividad mínimos</span><span class="sxs-lookup"><span data-stu-id="596dd-102">Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss</span></span>
  <span data-ttu-id="596dd-103">Al actualizar instancias de servidor de SQL Server 2012 a un Srvice Pack o una versión más reciente, puede reducir el tiempo de inactividad de un grupo de disponibilidad a solo una conmutación por error manual realizando una actualización secuencial.</span><span class="sxs-lookup"><span data-stu-id="596dd-103">When updating or upgrading server instances from SQL Server 2012 to a service pack or a newer version, you can reduce downtime for an availability group to only a single manual failover by performing a sequential update or upgrade.</span></span> <span data-ttu-id="596dd-104">La actualización de las versiones de SQL Server se conoce como adaptación (upgrade) gradual; la actualización de la versión actual de SQL Server con revisiones o Service Packs se conoce como actualización (update) gradual.</span><span class="sxs-lookup"><span data-stu-id="596dd-104">For upgrading SQL Server versions, it is known as rolling upgrade; for updating the current SQL Server version with hotfixes or service packs, it is known as rolling update.</span></span>  
  
 <span data-ttu-id="596dd-105">Este tema limita la explicación únicamente a las adaptaciones y a las actualizaciones de SQL Server (a las que, de aquí en adelante, se hará referencia genéricamente como actualizaciones).</span><span class="sxs-lookup"><span data-stu-id="596dd-105">This topic limits the discussion to SQL Server upgrades/updates only.</span></span> <span data-ttu-id="596dd-106">Para actualizaciones relacionadas con el sistema operativo en las que se ejecutan las instancias de SQL Server de alta disponibilidad, consulte [migración entre clústeres de grupos de disponibilidad AlwaysOn para actualizaciones del sistema operativo](https://msdn.microsoft.com/library/jj873730.aspx) .</span><span class="sxs-lookup"><span data-stu-id="596dd-106">For operating system-related upgrades/updates that the highly-available SQL Server instances are running on, see [Cross-cluster Migration of AlwaysOn Availability Groups for Operating System Upgrades](https://msdn.microsoft.com/library/jj873730.aspx)</span></span>  
  
## <a name="rolling-upgradeupdate-best-practices-for-alwayson-availability-groups"></a><span data-ttu-id="596dd-107">Prácticas recomendadas de las actualizaciones graduales en grupos de disponibilidad AlwasysOn</span><span class="sxs-lookup"><span data-stu-id="596dd-107">Rolling Upgrade/Update Best Practices for AlwaysOn Availability Groups</span></span>  
 <span data-ttu-id="596dd-108">Las siguientes prácticas recomendadas deberían observarse al realizar actualizaciones de servidor a fin de reducir el tiempo de inactividad y la pérdida de datos en los grupos de disponibilidad:</span><span class="sxs-lookup"><span data-stu-id="596dd-108">The following best practices should be observed when performing server upgrades/updates in order to minimize downtime and data loss for your availability groups:</span></span>  
  
-   <span data-ttu-id="596dd-109">Antes de comenzar la actualización gradual,</span><span class="sxs-lookup"><span data-stu-id="596dd-109">Before starting the rolling upgrade/update,</span></span>  
  
    -   <span data-ttu-id="596dd-110">Realice una conmutación por error manual de prueba en al menos una de réplicas de confirmación sincrónica</span><span class="sxs-lookup"><span data-stu-id="596dd-110">Perform a practice manual failover on at least one of your synchronous-commit replicas</span></span>  
  
    -   <span data-ttu-id="596dd-111">Proteja los datos realizando una copia de seguridad de la base de datos completa en cada base de datos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="596dd-111">Protect your data by performing a full database backup on every availability database</span></span>  
  
    -   <span data-ttu-id="596dd-112">Ejecute DBCC CHECKDB en cada base de datos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="596dd-112">Run DBCC CHECKDB on every availability database</span></span>  
  
-   <span data-ttu-id="596dd-113">Actualice siempre los nodos de las réplicas secundarias remotas, después los de las locales y, a continuación, el nodo de la réplica principal en último lugar.</span><span class="sxs-lookup"><span data-stu-id="596dd-113">Always upgrade/update the remote secondary replica nodes first, then local secondary replica nodes next, and the primary replica node last.</span></span>  
  
-   <span data-ttu-id="596dd-114">No se pueden realizar copias de seguridad en una base de datos que está en proceso de actualización.</span><span class="sxs-lookup"><span data-stu-id="596dd-114">Backups cannot occur on a database that is in the process of being upgraded.</span></span>  <span data-ttu-id="596dd-115">Antes de actualizar las réplicas secundarias, configure la preferencia de copia de seguridad automatizada para ejecutar copias de seguridad solo en la réplica primaria.</span><span class="sxs-lookup"><span data-stu-id="596dd-115">Prior to upgrading the secondary replicas, configure the automated backup preference to run backups only on the primary replica.</span></span>  <span data-ttu-id="596dd-116">Antes de actualizar la réplica principal, modifique esta configuración para ejecutar las copias de seguridad solo en las réplicas secundarias.</span><span class="sxs-lookup"><span data-stu-id="596dd-116">Prior to upgrading the primary replica, modify this setting to run backups only on the secondary replicas.</span></span>  
  
-   <span data-ttu-id="596dd-117">Para impedir las conmutaciones por error no intencionadas del grupo de disponibilidad durante el proceso de actualización, quite la conmutación por error de disponibilidad de las réplicas de confirmación sincrónica antes de comenzar.</span><span class="sxs-lookup"><span data-stu-id="596dd-117">To prevent the availability group from unintended failovers during the upgrade/update process, remove availability failover from all synchronous-commit replicas before you begin.</span></span>  
  
-   <span data-ttu-id="596dd-118">No actualice el nodo de la réplica principal antes de conmutar por error el grupo de disponibilidad a un nodo actualizado con una réplica secundaria en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="596dd-118">Do not upgrade the primary replica node before failing over the availability group to an upgraded node with a secondary replica first.</span></span> <span data-ttu-id="596dd-119">De lo contrario, las aplicaciones cliente pueden sufrir un tiempo de inactividad ampliado durante la actualización en la réplica principal.</span><span class="sxs-lookup"><span data-stu-id="596dd-119">Otherwise, client applications may suffer extended downtime during the upgrade/update on the primary replica.</span></span>  
  
-   <span data-ttu-id="596dd-120">Conmute por error el grupo de disponibilidad siempre a un nodo de una réplica secundaria de confirmación sincrónica.</span><span class="sxs-lookup"><span data-stu-id="596dd-120">Always fail over the availability group to a synchronous-commit secondary replica node.</span></span> <span data-ttu-id="596dd-121">Si conmuta por error a una réplica secundaria de confirmación asincrónica, las bases de datos sufrirán la pérdida de datos y el movimiento de datos se suspende automáticamente hasta que reanude de forma manual el movimiento de datos.</span><span class="sxs-lookup"><span data-stu-id="596dd-121">If you fail over to an asynchronous-commit secondary replica, the databases will suffer data loss, and data movement is automatically suspended until you manually resume data movement.</span></span>  
  
-   <span data-ttu-id="596dd-122">No actualice el nodo de la réplica principal antes de actualizar cualquier otro nodo de una réplica secundaria.</span><span class="sxs-lookup"><span data-stu-id="596dd-122">Do not upgrade/update the primary replica node before upgrading/updating any other secondary replica nodes.</span></span> <span data-ttu-id="596dd-123">Una réplica principal actualizada ya no puede entregar registrar a ninguna réplica secundaria que aún no haya sido actualizada a la misma versión.</span><span class="sxs-lookup"><span data-stu-id="596dd-123">An upgraded primary replica can no longer ship logs to any secondary replica that has not yet been upgraded to the same version.</span></span> <span data-ttu-id="596dd-124">Cuando el movimiento de datos a una réplica secundaria se suspenda, no puede producirse la conmutación por error automática para dicha réplica y las bases de datos de disponibilidad son vulnerables ante la pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="596dd-124">When data movement to a secondary replica is suspended, no automatic failover can occur for that replica, and your availability databases are vulnerable to data loss.</span></span>  
  
-   <span data-ttu-id="596dd-125">Ante de conmutar por error un grupo de disponibilidad, compruebe que el estado de sincronización del destino de la conmutaicón es SINCRONIZADO.</span><span class="sxs-lookup"><span data-stu-id="596dd-125">Before failing over an availability group, verify that the synchronization state of the failover target is SYNCHRONIZED.</span></span>  
  
## <a name="rolling-upgradeupdate-process"></a><span data-ttu-id="596dd-126">Proceso de actualización gradual</span><span class="sxs-lookup"><span data-stu-id="596dd-126">Rolling Upgrade/Update Process</span></span>  
 <span data-ttu-id="596dd-127">En la práctica, el proceso exacto dependerá de factores como la topología de implementación de los grupos de disponibilidad y del modo de confirmación de cada réplica.</span><span class="sxs-lookup"><span data-stu-id="596dd-127">In practice, the exact process will depend on factors such as the deployment topology of your availability groups and the commit mode of each replica.</span></span> <span data-ttu-id="596dd-128">Pero, en un escenario más sencillo, una actualización gradual es un proceso de varias fases que en su forma más sencilla implica los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="596dd-128">But in the simplest scenario, a rolling upgrade/update is a multi-stage process that in its simplest form involves the following steps:</span></span>  
  
 <span data-ttu-id="596dd-129">![Actualización de un grupo de disponibilidad en un escenario de HADR](../../media/alwaysonupgrade-ag-hadr.gif "Actualización de un grupo de disponibilidad en un escenario de HADR")</span><span class="sxs-lookup"><span data-stu-id="596dd-129">![Availability Group Upgrade in HADR Scenario](../../media/alwaysonupgrade-ag-hadr.gif "Availability Group Upgrade in HADR Scenario")</span></span>  
  
1.  <span data-ttu-id="596dd-130">Quitar la conmutación por error automática en todas las réplicas de confirmación sincrónica</span><span class="sxs-lookup"><span data-stu-id="596dd-130">Remove automatic failover on all synchronous-commit replicas</span></span>  
  
2.  <span data-ttu-id="596dd-131">Actualizar todas las instancias de servidor remoto que ejecutan réplicas secundarias de confirmación asincrónica</span><span class="sxs-lookup"><span data-stu-id="596dd-131">Upgrade/update all remote server instances running asynchronous-commit secondary replicas</span></span>  
  
3.  <span data-ttu-id="596dd-132">Actualizar todas las instancias de servidor local que no se ejecutan actualmente en la réplica principal</span><span class="sxs-lookup"><span data-stu-id="596dd-132">Upgrade/update the all local server instances that are not currently running the primary replica</span></span>  
  
4.  <span data-ttu-id="596dd-133">Conmutar por error el grupo de disponibilidad de forma manual a una réplica secundaria de confirmación sincrónica</span><span class="sxs-lookup"><span data-stu-id="596dd-133">Manually fail over the availability group to a synchronous-commit secondary replica</span></span>  
  
5.  <span data-ttu-id="596dd-134">Actualizar la instancia de servidor que antes hospedaba la réplica principal</span><span class="sxs-lookup"><span data-stu-id="596dd-134">Upgrade/update the server instance that formerly hosted the primary replica</span></span>  
  
6.  <span data-ttu-id="596dd-135">Configurar los asociados de conmutación por error automática según convenga</span><span class="sxs-lookup"><span data-stu-id="596dd-135">Configure automatic failover partners as desired</span></span>  
  
 <span data-ttu-id="596dd-136">Si es necesario, puede realizar una conmutación por error manual adicional para devolver al grupo de disponibilidad a su configuración original.</span><span class="sxs-lookup"><span data-stu-id="596dd-136">If necessary, you can perform an extra manual failover to return the availability group to its original configuration.</span></span>  
  
## <a name="availability-group-with-one-remote-secondary-replica"></a><span data-ttu-id="596dd-137">Grupo de disponibilidad con una réplica secundaria remota</span><span class="sxs-lookup"><span data-stu-id="596dd-137">Availability Group with One Remote Secondary Replica</span></span>  
 <span data-ttu-id="596dd-138">Si ha implementado un grupo de disponibilidad para la recuperación de desastres, puede que tenga que conmutar por error el grupo de disponibilidad a una réplica secundaria de confirmación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="596dd-138">If you have deployed an availability group only for disaster recovery, you may need to fail over the availability group to an asynchronous-commit secondary replica.</span></span> <span data-ttu-id="596dd-139">Tal configuración se muestra en la ilustración siguiente:</span><span class="sxs-lookup"><span data-stu-id="596dd-139">Such configuration is illustrated by the following figure:</span></span>  
  
 <span data-ttu-id="596dd-140">![Actualización de un grupo de disponibilidad en un escenario de DR](../../media/agupgrade-ag-dr.gif "Actualización de un grupo de disponibilidad en un escenario de DR")</span><span class="sxs-lookup"><span data-stu-id="596dd-140">![Availability Group Upgrade in DR Scenario](../../media/agupgrade-ag-dr.gif "Availability Group Upgrade in DR Scenario")</span></span>  
  
 <span data-ttu-id="596dd-141">En esta situación, debe conmutar por error el grupo de disponibilidad a la réplica secundaria de confirmación asincrónica durante la actualización gradual.</span><span class="sxs-lookup"><span data-stu-id="596dd-141">In this situation, you must fail over the availability group to the asynchronous-commit secondary replica during the rolling upgrade/update.</span></span> <span data-ttu-id="596dd-142">Para impedir la pérdida de datos, cambie el modo de confirmación a confirmación sincrónica y espere a que la réplica secundaria se sincronice antes de conmutar por error al grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="596dd-142">To prevent data loss, change the commit mode to synchronous commit and wait for the secondary replica to be synchronized before you fail over the availability group.</span></span> <span data-ttu-id="596dd-143">Por lo tanto, el proceso de actualización puede ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="596dd-143">Therefore, the rolling upgrade/update process may look as follows:</span></span>  
  
1.  <span data-ttu-id="596dd-144">Actualizar el servidor remoto</span><span class="sxs-lookup"><span data-stu-id="596dd-144">Upgrade/update the remote server</span></span>  
  
2.  <span data-ttu-id="596dd-145">Cambiar el modo de confirmación a confirmación sincrónica</span><span class="sxs-lookup"><span data-stu-id="596dd-145">Change the commit mode to synchronous commit</span></span>  
  
3.  <span data-ttu-id="596dd-146">Esperar hata que el estado de sincronización sea SINCRONIZADO</span><span class="sxs-lookup"><span data-stu-id="596dd-146">Wait until synchronization state is SYNCHRONIZED</span></span>  
  
4.  <span data-ttu-id="596dd-147">Conmutar por error el grupo de disponibilidad al sitio remoto</span><span class="sxs-lookup"><span data-stu-id="596dd-147">Fail over the availability group to the remote site</span></span>  
  
5.  <span data-ttu-id="596dd-148">Actualizar el servidor local (sitio principal)</span><span class="sxs-lookup"><span data-stu-id="596dd-148">Upgrade/update the local (primary site) server</span></span>  
  
6.  <span data-ttu-id="596dd-149">Conmutar por error el grupo de disponibilidad al sitio principal</span><span class="sxs-lookup"><span data-stu-id="596dd-149">Fail over the availability group to the primary site</span></span>  
  
7.  <span data-ttu-id="596dd-150">Cambiar el modo de confirmación a confirmación asincrónica</span><span class="sxs-lookup"><span data-stu-id="596dd-150">Change the commit mode to asynchronous commit</span></span>  
  
 <span data-ttu-id="596dd-151">Dado que el modo de confirmación sincrónica no es una opción recomendada para la sincronización de datos en un sitio remoto, las aplicaciones de cliente pueden apreciar un aumento inmediato en la latencia de las bases de datos tras el cambio de configuración.</span><span class="sxs-lookup"><span data-stu-id="596dd-151">Since the synchronous-commit mode is not a recommended setting for data synchronization to a remote site, client applications may notice an immediate increase in database latency after the setting change.</span></span> <span data-ttu-id="596dd-152">Además, realizar una conmutación por error provocará que todos los mensajes de registro no reconocidos se descarten.</span><span class="sxs-lookup"><span data-stu-id="596dd-152">Moreover, performing a failover will cause all unacknowledged log messages to be discarded.</span></span> <span data-ttu-id="596dd-153">La cantidad de mensajes de registro descartados puede ser bastante grande debido a la alta latencia de red entre dos sitios, lo que ocasiona que los clientes experimenten un gran volumen de errores de transacciones.</span><span class="sxs-lookup"><span data-stu-id="596dd-153">The amount of discarded log messages can be quite large due to the high network latency between the two sites, causing clients to experience a high volume of transactional failure.</span></span> <span data-ttu-id="596dd-154">Puede aminorar el impacto en las aplicaciones cliente si hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="596dd-154">You can minimize impact to client applications by doing the following:</span></span>  
  
-   <span data-ttu-id="596dd-155">Seleccionar cuidadosamente una ventana de mantenimiento durante el tráfico lento de cliente</span><span class="sxs-lookup"><span data-stu-id="596dd-155">Carefully select a maintenance window during low client traffic</span></span>  
  
-   <span data-ttu-id="596dd-156">Mientras actualiza SQL Server en el sitio pincipal, cambiar el modo de disponibilidad de nuevo a la confirmación asincrónica y luego revertir al modo sincrónico cuando esté listo para conmutar por error al sitio principal de nuevo</span><span class="sxs-lookup"><span data-stu-id="596dd-156">While upgrading/updating SQL Server on the primary site, change the availability mode back to asynchronous commit, then revert to synchronous commit when you are ready to fail over to the primary site again</span></span>  
  
## <a name="availability-group-with-failover-cluster-instance-nodes"></a><span data-ttu-id="596dd-157">Grupo de disponibilidad con nodos de instancia del clúster de conmutación por error</span><span class="sxs-lookup"><span data-stu-id="596dd-157">Availability Group with Failover Cluster Instance Nodes</span></span>  
 <span data-ttu-id="596dd-158">Si un grupo de disponibilidad contiene nodos de instancia de clúster de conmutación por error (FCI), debe actualizar los nodos inactivos antes de actualizar los nodos activos.</span><span class="sxs-lookup"><span data-stu-id="596dd-158">If an availability group contains failover cluster instance (FCI) nodes, you should upgrade/update the inactive nodes before you upgrade/update the active nodes.</span></span> <span data-ttu-id="596dd-159">La ilustración siguiente muestra un escenario de grupos de disponibilidad común con FCI para la confirmación asincrónica y una alta disponibilidad local entre los FCI pra la recuperación de desastres remota y la secuencia de actualización.</span><span class="sxs-lookup"><span data-stu-id="596dd-159">The figure below illustrates a common availability group scenario with FCIs for local high availability and asynchronous commit between the FCIs for remote disaster recovery, and the upgrade sequence.</span></span>  
  
 <span data-ttu-id="596dd-160">![Actualización de un grupo de disponibilidad con FCI](../../media/agupgrade-ag-fci-dr.gif "Actualización de un grupo de disponibilidad con FCI")</span><span class="sxs-lookup"><span data-stu-id="596dd-160">![Availability Group Upgrade with FCIs](../../media/agupgrade-ag-fci-dr.gif "Availability Group Upgrade with FCIs")</span></span>  
  
1.  <span data-ttu-id="596dd-161">Actualizar REMOTE2</span><span class="sxs-lookup"><span data-stu-id="596dd-161">Upgrade/update REMOTE2</span></span>  
  
2.  <span data-ttu-id="596dd-162">Conmutar por error FCI2 a REMOTE2</span><span class="sxs-lookup"><span data-stu-id="596dd-162">Fail over FCI2 to REMOTE2</span></span>  
  
3.  <span data-ttu-id="596dd-163">Actualizar REMOTE1</span><span class="sxs-lookup"><span data-stu-id="596dd-163">Upgrade/update REMOTE1</span></span>  
  
4.  <span data-ttu-id="596dd-164">Actualizar PRIMARY2</span><span class="sxs-lookup"><span data-stu-id="596dd-164">Upgrade/update PRIMARY2</span></span>  
  
5.  <span data-ttu-id="596dd-165">Conmutar por error FCI1 a PRIMARY2</span><span class="sxs-lookup"><span data-stu-id="596dd-165">Fail over FCI1 to PRIMARY2</span></span>  
  
6.  <span data-ttu-id="596dd-166">Actualizar PRIMARY1</span><span class="sxs-lookup"><span data-stu-id="596dd-166">Upgrade/update PRIMARY1</span></span>  
  
## <a name="upgradeupdate-sql-server-instances-with-multiple-availability-groups"></a><span data-ttu-id="596dd-167">Actualizar las instancias de SQL Server con varios grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="596dd-167">Upgrade/Update SQL Server Instances with Multiple Availability Groups</span></span>  
 <span data-ttu-id="596dd-168">Si ejecuta varios grupos de disponibilidad con réplicas principales en nodos de servidor independientes (una configuración activa/activa), la ruta de actualización implica más pasos de conmutación por error para presentar una alta disponibilidad en el proceso.</span><span class="sxs-lookup"><span data-stu-id="596dd-168">If you are running multiple availability groups with primary replicas on separate server nodes (an Active/Active configuration), the upgrade/update path involves more failover steps to preserve high availability in the process.</span></span> <span data-ttu-id="596dd-169">Suponga que ejecuta tres grupos de disponibilidad en tres nodos de servidor según se muestra en la tabla siguiente y que todas las réplicas secundarias se ejecutan en el modo de confirmación sincrónica.</span><span class="sxs-lookup"><span data-stu-id="596dd-169">Suppose you are running three availability groups on three server nodes as shown in the following table, and all secondary replicas are running in synchronous-commit mode.</span></span>  
  
|<span data-ttu-id="596dd-170">Grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="596dd-170">Availability Group</span></span>|<span data-ttu-id="596dd-171">Nodo1</span><span class="sxs-lookup"><span data-stu-id="596dd-171">Node1</span></span>|<span data-ttu-id="596dd-172">Nodo2</span><span class="sxs-lookup"><span data-stu-id="596dd-172">Node2</span></span>|<span data-ttu-id="596dd-173">Nodo3</span><span class="sxs-lookup"><span data-stu-id="596dd-173">Node3</span></span>|  
|------------------------|-----------|-----------|-----------|  
|<span data-ttu-id="596dd-174">AG1</span><span class="sxs-lookup"><span data-stu-id="596dd-174">AG1</span></span>|<span data-ttu-id="596dd-175">Principal</span><span class="sxs-lookup"><span data-stu-id="596dd-175">Primary</span></span>|||  
|<span data-ttu-id="596dd-176">AG2</span><span class="sxs-lookup"><span data-stu-id="596dd-176">AG2</span></span>||<span data-ttu-id="596dd-177">Principal</span><span class="sxs-lookup"><span data-stu-id="596dd-177">Primary</span></span>||  
|<span data-ttu-id="596dd-178">AG3</span><span class="sxs-lookup"><span data-stu-id="596dd-178">AG3</span></span>|||<span data-ttu-id="596dd-179">Principal</span><span class="sxs-lookup"><span data-stu-id="596dd-179">Primary</span></span>|  
  
 <span data-ttu-id="596dd-180">Puede ser apropiado en su situación realizar una actualización gradual con equilibrio de carga en la secuencia siguiente:</span><span class="sxs-lookup"><span data-stu-id="596dd-180">It may be appropriate in your situation to perform a load-balanced rolling upgrade/update in the following sequence:</span></span>  
  
1.  <span data-ttu-id="596dd-181">Conmutar por error AG2 a Nodo3 (para liberar Nodo2)</span><span class="sxs-lookup"><span data-stu-id="596dd-181">Fail over AG2 to Node3 (to free up Node2)</span></span>  
  
2.  <span data-ttu-id="596dd-182">Actualizar Nodo2</span><span class="sxs-lookup"><span data-stu-id="596dd-182">Upgrade/update Node2</span></span>  
  
3.  <span data-ttu-id="596dd-183">Conmutar por error AG1 a Nodo2 (para liberar Nodo1)</span><span class="sxs-lookup"><span data-stu-id="596dd-183">Fail over AG1 to Node2 (to free up Node1)</span></span>  
  
4.  <span data-ttu-id="596dd-184">Actualizar Nodo1</span><span class="sxs-lookup"><span data-stu-id="596dd-184">Upgrade/update Node1</span></span>  
  
5.  <span data-ttu-id="596dd-185">Conmutar por error AG2 y AG3 a Nodo1 (para liberar Nodo3)</span><span class="sxs-lookup"><span data-stu-id="596dd-185">Fail over both AG2 and AG3 to Node1 (to free up Node3)</span></span>  
  
6.  <span data-ttu-id="596dd-186">Actualizar Nodo3</span><span class="sxs-lookup"><span data-stu-id="596dd-186">Upgrade/update Node3</span></span>  
  
7.  <span data-ttu-id="596dd-187">No se puede realizar la conmutación por error de AG3 a Nodo3</span><span class="sxs-lookup"><span data-stu-id="596dd-187">Fail over AG3 to Node3</span></span>  
  
 <span data-ttu-id="596dd-188">Esta secuencia de actualización tiene un tiempo de inactividad promedio de menos de dos conmutaciones por error por cada grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="596dd-188">This upgrade/update sequence has an average downtime of less than two failovers per availability group.</span></span> <span data-ttu-id="596dd-189">La configuración resultante se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="596dd-189">The resulting configuration is shown in the table below.</span></span>  
  
|<span data-ttu-id="596dd-190">Grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="596dd-190">Availability Group</span></span>|<span data-ttu-id="596dd-191">Nodo1</span><span class="sxs-lookup"><span data-stu-id="596dd-191">Node1</span></span>|<span data-ttu-id="596dd-192">Nodo2</span><span class="sxs-lookup"><span data-stu-id="596dd-192">Node2</span></span>|<span data-ttu-id="596dd-193">Nodo3</span><span class="sxs-lookup"><span data-stu-id="596dd-193">Node3</span></span>|  
|------------------------|-----------|-----------|-----------|  
|<span data-ttu-id="596dd-194">AG1</span><span class="sxs-lookup"><span data-stu-id="596dd-194">AG1</span></span>||<span data-ttu-id="596dd-195">Principal</span><span class="sxs-lookup"><span data-stu-id="596dd-195">Primary</span></span>||  
|<span data-ttu-id="596dd-196">AG2</span><span class="sxs-lookup"><span data-stu-id="596dd-196">AG2</span></span>|<span data-ttu-id="596dd-197">Principal</span><span class="sxs-lookup"><span data-stu-id="596dd-197">Primary</span></span>|||  
|<span data-ttu-id="596dd-198">AG3</span><span class="sxs-lookup"><span data-stu-id="596dd-198">AG3</span></span>|||<span data-ttu-id="596dd-199">Principal</span><span class="sxs-lookup"><span data-stu-id="596dd-199">Primary</span></span>|  
  
 <span data-ttu-id="596dd-200">Según su implementación concreta, la ruta de actualización puede variar y el tiempo de inactividad que las aplicaciones cliente experimentan puede variar también.</span><span class="sxs-lookup"><span data-stu-id="596dd-200">Based on your specific implementation, your upgrade/update path may vary, and the downtime that client applications experience may vary as well.</span></span>  
  
  
