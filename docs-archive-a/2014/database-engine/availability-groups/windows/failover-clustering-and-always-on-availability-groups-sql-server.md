---
title: Clústeres de conmutación por error y Grupos de disponibilidad AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- clustering [SQL Server]
- Availability Groups [SQL Server], WSFC clusters
- Failover Cluster Instances [SQL Server], see failover clustering [SQL Server]
- quorum [SQL Server]
- failover clustering [SQL Server], AlwaysOn Availability Groups
- Availability Groups [SQL Server], Failover Cluster Instances
ms.assetid: 613bfbf1-9958-477b-a6be-c6d4f18785c3
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 64ee815c2b852849d9506ca6c3fc114d3d0e4935
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87672272"
---
# <a name="failover-clustering-and-alwayson-availability-groups-sql-server"></a><span data-ttu-id="89eec-102">Clúster de conmutación por error y grupos de disponibilidad de AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="89eec-102">Failover Clustering and AlwaysOn Availability Groups (SQL Server)</span></span>
  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]<span data-ttu-id="89eec-103">, la solución de alta disponibilidad y recuperación ante desastres introducida en [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], requiere clústeres de conmutación por error de Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="89eec-103">, the high availability and disaster recovery solution introduced in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], requires Windows Server Failover Clustering (WSFC).</span></span> <span data-ttu-id="89eec-104">Además, aunque [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] no depende de los clústeres de conmutación por error de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , se puede utilizar una instancia de clústeres de conmutación por error (FCI) para hospedar una réplica de disponibilidad para un grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-104">Also, though [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is not dependent upon [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Clustering, you can use a failover clustering instance (FCI) to host an availability replica for an availability group.</span></span> <span data-ttu-id="89eec-105">Es importante conocer el rol de cada tecnología de clústeres y saber qué consideraciones son necesarias cuando se diseña el entorno de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="89eec-105">It is important to know the role of each clustering technology, and to know what considerations are necessary as you design your [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] environment.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="89eec-106">Para obtener información sobre los conceptos de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], vea [Información general de los grupos de disponibilidad AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="89eec-106">For information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] concepts, see [Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span></span>  
  

  
##  <a name="windows-server-failover-clustering-and-availability-groups"></a><a name="WSFC"></a><span data-ttu-id="89eec-107">Clústeres de conmutación por error de Windows Server y grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-107">Windows Server Failover Clustering and Availability Groups</span></span>  
 <span data-ttu-id="89eec-108">La implementación de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requiere un clúster de WSFC (clústeres de conmutación por error de Windows Server).</span><span class="sxs-lookup"><span data-stu-id="89eec-108">Deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requires a Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="89eec-109">Para que una instancia de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]se habilite para [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , debe residir en un nodo de WSFC y el clúster y el nodo de WSFC deben estar en línea.</span><span class="sxs-lookup"><span data-stu-id="89eec-109">To be enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must reside on a WSFC node, and the WSFC cluster and node must be online.</span></span> <span data-ttu-id="89eec-110">Además, cada réplica de disponibilidad de un determinado grupo de disponibilidad debe residir en otro nodo del mismo clúster de WSFC.</span><span class="sxs-lookup"><span data-stu-id="89eec-110">Furthermore, each availability replica of a given availability group must reside on a different node of the same WSFC cluster.</span></span> <span data-ttu-id="89eec-111">La única excepción es que mientras se migra a otro clúster de WSFC, un grupo de disponibilidad puede ocupar temporalmente dos clústeres.</span><span class="sxs-lookup"><span data-stu-id="89eec-111">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="89eec-112">se basa en el clúster de clústeres de conmutación por error de Windows (WSFC) para supervisar y administrar los roles actuales de las réplicas de disponibilidad que pertenecen a un grupo de disponibilidad concreto, así como para determinar cómo afecta un evento de conmutación por error a las réplicas de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-112">relies on the Windows Failover Clustering (WSFC) cluster to monitor and manage the current roles of the availability replicas that belong to a given availability group and to determine how a failover event affects the availability replicas.</span></span> <span data-ttu-id="89eec-113">Por cada grupo de disponibilidad que cree, se creará un grupo de recursos de WSFC.</span><span class="sxs-lookup"><span data-stu-id="89eec-113">A WSFC resource group is created for every availability group that you create.</span></span> <span data-ttu-id="89eec-114">El clúster de WSFC supervisa este grupo de recursos para evaluar el estado de la réplica principal.</span><span class="sxs-lookup"><span data-stu-id="89eec-114">The WSFC cluster monitors this resource group to evaluate the health of the primary replica.</span></span>  
  
 <span data-ttu-id="89eec-115">El quorum para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] se basa en todos los nodos del clúster de WSFC independientemente de si un nodo de clúster determinado hospeda alguna réplica de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-115">The quorum for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is based on all nodes in the WSFC cluster regardless of whether a given cluster node hosts any availability replicas.</span></span> <span data-ttu-id="89eec-116">A diferencia de la creación de reflejo de la base de datos, no hay ningún rol testigo en [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="89eec-116">In contrast to database mirroring, there is no witness role in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>  
  
 <span data-ttu-id="89eec-117">Los votos de quórum de nodos del clúster determinan el estado general de un clúster de WSFC.</span><span class="sxs-lookup"><span data-stu-id="89eec-117">The overall health of a WSFC cluster is determined by the votes of quorum of nodes in the cluster.</span></span> <span data-ttu-id="89eec-118">Si el clúster de WSFC se queda sin conexión debido a un desastre no planeado, o a un error persistente de hardware o de comunicaciones, se necesita la intervención manual del administrador.</span><span class="sxs-lookup"><span data-stu-id="89eec-118">If the WSFC cluster goes offline because of an unplanned disaster, or due to a persistent hardware or communications failure, manual administrative intervention is required.</span></span> <span data-ttu-id="89eec-119">Un administrador de clústeres de Windows Server o de WSFC necesitará forzar un quórum y volver a poner en línea los nodos del clúster superviviente en una configuración sin tolerancia a errores.</span><span class="sxs-lookup"><span data-stu-id="89eec-119">A Windows Server or WSFC cluster administrator will need to force a quorum and then bring the surviving cluster nodes back online in a non-fault-tolerant configuration.</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="89eec-120">son subclaves del clúster de WSFC.</span><span class="sxs-lookup"><span data-stu-id="89eec-120">registry keys are subkeys of the WSFC cluster.</span></span> <span data-ttu-id="89eec-121">Si elimina y vuelve a crear un clúster de WSFC, debe deshabilitar y volver a habilitar la característica de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] en cada instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] que hospedaba una réplica de disponibilidad en el clúster de WSFC original.</span><span class="sxs-lookup"><span data-stu-id="89eec-121">If you delete and re-create a WSFC cluster, you must disable and re-enable the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature on each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosted an availability replica on the original WSFC cluster.</span></span>  
  
 <span data-ttu-id="89eec-122">Para obtener información sobre cómo ejecutar [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] en nodos de clústeres de conmutación por error de Windows Server (WSFC) y sobre el cuórum de WSFC, vea [Clústeres de conmutación por error de Windows Server &#40;WSFC&#41; con SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="89eec-122">For information about running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on Windows Server Failover Clustering (WSFC) nodes and about WSFC quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
### <a name="cross-cluster-migration-of-alwayson-availability-groups-for-os-upgrade"></a><span data-ttu-id="89eec-123">Migración entre clústeres de grupos de disponibilidad AlwaysOn para la actualización del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="89eec-123">Cross-Cluster Migration of AlwaysOn Availability Groups for OS Upgrade</span></span>  
 <span data-ttu-id="89eec-124">A partir de [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)], [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] admite la migración entre clústeres de grupos de disponibilidad para las implementaciones en un nuevo clúster de Clústeres de conmutación por error de Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="89eec-124">Beginning with [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)], [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] supports cross-cluster migration of availability groups for deployments to a new Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="89eec-125">Una migración entre clústeres mueve un grupo de disponibilidad o un lote de grupos de disponibilidad al nuevo clúster de WSFC de destino con un tiempo de inactividad mínimo.</span><span class="sxs-lookup"><span data-stu-id="89eec-125">A cross-cluster migration moves one availability group or a batch of availability groups to the new, destination WSFC cluster with minimal downtime.</span></span> <span data-ttu-id="89eec-126">El proceso de migración entre clústeres le permite mantener los contratos de nivel de servicio (SLA) al actualizar a un clúster de [!INCLUDE[win8srv](../../../includes/win8srv-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="89eec-126">The cross-cluster migration process enables you to maintain your service level agreements (SLAs) when upgrading to a [!INCLUDE[win8srv](../../../includes/win8srv-md.md)] cluster.</span></span> [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] <span data-ttu-id="89eec-127">(o una versión posterior) debe estar instalado y habilitado para AlwaysOn en el clúster de WSFC de destino.</span><span class="sxs-lookup"><span data-stu-id="89eec-127">(or a later version) must be installed and enabled for AlwaysOn on the destination WSFC cluster.</span></span> <span data-ttu-id="89eec-128">El éxito de una migración entre clústeres depende de un planeamiento y una preparación exhaustivos del clúster de WSFC de destino.</span><span class="sxs-lookup"><span data-stu-id="89eec-128">The success of a cross-cluster migration depends on thorough planning and preparation of the destination WSFC cluster.</span></span>  
  
 <span data-ttu-id="89eec-129">Para obtener más información, vea [Migración entre clústeres de grupos de disponibilidad AlwaysOn para la actualización del sistema operativo](https://msdn.microsoft.com/library/jj873730.aspx).</span><span class="sxs-lookup"><span data-stu-id="89eec-129">For more information, see [Cross-Cluster Migration of AlwaysOn Availability Groups for OS Upgrade](https://msdn.microsoft.com/library/jj873730.aspx).</span></span>  
  
##  <a name="ssnoversion-failover-cluster-instances-fcis-and-availability-groups"></a><a name="SQLServerFC"></a> <span data-ttu-id="89eec-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Instancias de clúster de conmutación por error (FCI) y grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Cluster Instances (FCIs) and Availability Groups</span></span>  
 <span data-ttu-id="89eec-131">Puede configurar un segundo nivel de conmutación por error en el nivel de instancia de servidor si implementa los clústeres de conmutación por error de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] junto con el clúster de WSFC.</span><span class="sxs-lookup"><span data-stu-id="89eec-131">You can set up a second layer of failover at the server-instance level by implementing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering together with the WSFC cluster.</span></span> <span data-ttu-id="89eec-132">Una réplica de disponibilidad se puede hospedar en una instancia independiente de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o una instancia de FCI.</span><span class="sxs-lookup"><span data-stu-id="89eec-132">An availability replica can be hosted by either a standalone instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or an FCI instance.</span></span> <span data-ttu-id="89eec-133">Solo un asociado de FCI puede hospedar una réplica para un grupo de disponibilidad dado.</span><span class="sxs-lookup"><span data-stu-id="89eec-133">Only one FCI partner can host a replica for a given availability group.</span></span> <span data-ttu-id="89eec-134">Cuando una réplica de disponibilidad se ejecuta en una instancia de clúster de conmutación por error (FCI), la lista de posibles propietarios del grupo de disponibilidad contendrá solo el nodo de FCI activo.</span><span class="sxs-lookup"><span data-stu-id="89eec-134">When an availability replica is running on an FCI, the possible owners list for the availability group will contain only the active FCI node.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="89eec-135">no depende de ninguna forma de almacenamiento compartido.</span><span class="sxs-lookup"><span data-stu-id="89eec-135">does not depend on any form of shared storage.</span></span> <span data-ttu-id="89eec-136">Sin embargo, si usa una instancia de clúster de conmutación por error (FCI) de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] para hospedar una o varias réplicas de disponibilidad, cada una de las FCI requerirá almacenamiento compartido según la instalación típica de la instancia de clúster de conmutación por error de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="89eec-136">However, if you use a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI) to host one or more availability replicas, each of those FCIs will require shared storage as per standard SQL Server failover cluster instance installation.</span></span>  
  
 <span data-ttu-id="89eec-137">Para más información sobre los requisitos previos adicionales, vea la sección "Requisitos previos y restricciones para usar una instancia de clúster de conmutación por error (FCI) de SQL Server para hospedar una réplica de disponibilidad" de [Requisitos previos, restricciones y recomendaciones para grupos de disponibilidad AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="89eec-137">For more information about additional prerequisites, see the "Prerequisites and Restrictions for Using a SQL Server Failover Cluster Instance (FCI) to Host an Availability Replica" section of [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
### <a name="comparison-of-failover-cluster-instances-and-availability-groups"></a><span data-ttu-id="89eec-138">Comparación de las instancias de clúster de conmutación por error y los grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-138">Comparison of Failover Cluster Instances and Availability Groups</span></span>  
 <span data-ttu-id="89eec-139">Independientemente del número de nodos de la FCI, una FCI completa hospeda una sola réplica en un grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-139">Regardless of the number of nodes in the FCI, an entire FCI hosts a single replica within an availability group.</span></span> <span data-ttu-id="89eec-140">En la tabla siguiente se describen las diferencias conceptuales entre los nodos en una FCI y las réplicas en un grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-140">The following table describes the distinctions in concepts between nodes in an FCI and replicas within an availability group.</span></span>  
  
||<span data-ttu-id="89eec-141">Nodos en una FCI</span><span class="sxs-lookup"><span data-stu-id="89eec-141">Nodes within an FCI</span></span>|<span data-ttu-id="89eec-142">Réplicas en un grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-142">Replicas within an availability group</span></span>|  
|-|-------------------------|-------------------------------------------|  
|<span data-ttu-id="89eec-143">**Usa el clúster de WSFC**</span><span class="sxs-lookup"><span data-stu-id="89eec-143">**Uses WSFC cluster**</span></span>|<span data-ttu-id="89eec-144">Sí</span><span class="sxs-lookup"><span data-stu-id="89eec-144">Yes</span></span>|<span data-ttu-id="89eec-145">Sí</span><span class="sxs-lookup"><span data-stu-id="89eec-145">Yes</span></span>|  
|<span data-ttu-id="89eec-146">**Nivel de protección**</span><span class="sxs-lookup"><span data-stu-id="89eec-146">**Protection level**</span></span>|<span data-ttu-id="89eec-147">Instancia</span><span class="sxs-lookup"><span data-stu-id="89eec-147">Instance</span></span>|<span data-ttu-id="89eec-148">Base de datos</span><span class="sxs-lookup"><span data-stu-id="89eec-148">Database</span></span>|  
|<span data-ttu-id="89eec-149">**Tipo de almacenamiento**</span><span class="sxs-lookup"><span data-stu-id="89eec-149">**Storage type**</span></span>|<span data-ttu-id="89eec-150">Compartido</span><span class="sxs-lookup"><span data-stu-id="89eec-150">Shared</span></span>|<span data-ttu-id="89eec-151">No compartidos</span><span class="sxs-lookup"><span data-stu-id="89eec-151">Non-shared</span></span><br /><br /> <span data-ttu-id="89eec-152">Tenga en cuenta que mientras las réplicas de un grupo de disponibilidad no comparten almacenamiento, una réplica hospedada por una FCI usa una solución de almacenamiento compartido de acuerdo con esa FCI.</span><span class="sxs-lookup"><span data-stu-id="89eec-152">Note that while the replicas in an availability group do not share storage, a replica that is hosted by an FCI uses a shared storage solution as required by that FCI.</span></span> <span data-ttu-id="89eec-153">La solución de almacenamiento es compartida solo por los nodos en la FCI y no entre las réplicas del grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-153">The storage solution is shared only by nodes within the FCI and not between replicas of the availability group.</span></span>|  
|<span data-ttu-id="89eec-154">**Soluciones de almacenamiento**</span><span class="sxs-lookup"><span data-stu-id="89eec-154">**Storage solutions**</span></span>|<span data-ttu-id="89eec-155">Se adjuntan directamente, SAN, puntos de montaje, SMB</span><span class="sxs-lookup"><span data-stu-id="89eec-155">Direct attached, SAN, mount points, SMB</span></span>|<span data-ttu-id="89eec-156">Depende del tipo de nodo</span><span class="sxs-lookup"><span data-stu-id="89eec-156">Depends on node type</span></span>|  
|<span data-ttu-id="89eec-157">**Secundarios legibles**</span><span class="sxs-lookup"><span data-stu-id="89eec-157">**Readable secondaries**</span></span>|<span data-ttu-id="89eec-158">No\*</span><span class="sxs-lookup"><span data-stu-id="89eec-158">No\*</span></span>|<span data-ttu-id="89eec-159">Sí</span><span class="sxs-lookup"><span data-stu-id="89eec-159">Yes</span></span>|  
|<span data-ttu-id="89eec-160">**Opciones aplicables de la directiva de conmutación por error**</span><span class="sxs-lookup"><span data-stu-id="89eec-160">**Applicable failover policy settings**</span></span>|<span data-ttu-id="89eec-161">Quórum de WSFC</span><span class="sxs-lookup"><span data-stu-id="89eec-161">WSFC quorum</span></span><br /><br /> <span data-ttu-id="89eec-162">Específico de FCI</span><span class="sxs-lookup"><span data-stu-id="89eec-162">FCI-specific</span></span><br /><br /> <span data-ttu-id="89eec-163">Configuración de grupo de disponibilidad\*\*</span><span class="sxs-lookup"><span data-stu-id="89eec-163">Availability group settings\*\*</span></span>|<span data-ttu-id="89eec-164">Quórum de WSFC</span><span class="sxs-lookup"><span data-stu-id="89eec-164">WSFC quorum</span></span><br /><br /> <span data-ttu-id="89eec-165">Configuración de grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-165">Availability group settings</span></span>|  
|<span data-ttu-id="89eec-166">**Recursos conmutados por error**</span><span class="sxs-lookup"><span data-stu-id="89eec-166">**Failed-over resources**</span></span>|<span data-ttu-id="89eec-167">Servidor, instancia y base de datos</span><span class="sxs-lookup"><span data-stu-id="89eec-167">Server, instance, and database</span></span>|<span data-ttu-id="89eec-168">Solo base de datos</span><span class="sxs-lookup"><span data-stu-id="89eec-168">Database only</span></span>|  
  
 <span data-ttu-id="89eec-169">\*Mientras que las réplicas secundarias sincrónicas de un grupo de disponibilidad se ejecutan siempre en las instancias respectivas de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , los nodos secundarios de una FCI no han iniciado realmente las instancias respectivas de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] y, por lo tanto, no son legibles.</span><span class="sxs-lookup"><span data-stu-id="89eec-169">\*Whereas synchronous secondary replicas in an availability group are always running on their respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances, secondary nodes in an FCI actually have not started their respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances and are therefore not readable.</span></span> <span data-ttu-id="89eec-170">En una FCI, un nodo secundario inicia la instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cuando la propiedad del grupo de recursos se le transfiere durante una conmutación por error de FCI.</span><span class="sxs-lookup"><span data-stu-id="89eec-170">In an FCI, a secondary node starts its [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance only when the resource group ownership is transferred to it during an FCI failover.</span></span> <span data-ttu-id="89eec-171">Sin embargo, en el nodo de FCI activo, cuando una base de datos hospedada por FCI pertenece a un grupo de disponibilidad, si la réplica de disponibilidad local se ejecuta como réplica secundaria legible, la base de datos es legible.</span><span class="sxs-lookup"><span data-stu-id="89eec-171">However, on the active FCI node, when an FCI-hosted database belongs to an availability group, if the local availability replica is running as a readable secondary replica, the database is readable.</span></span>  
  
 <span data-ttu-id="89eec-172">\*\*La configuración de la directiva de conmutación por error del grupo de disponibilidad se aplica a todas las réplicas, ya estén hospedadas en una instancia independiente o una instancia de FCI.</span><span class="sxs-lookup"><span data-stu-id="89eec-172">\*\*Failover policy settings for the availability group apply to all replicas, whether it is hosted in a standalone instance or an FCI instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="89eec-173">Para obtener más información acerca del **número de nodos** en los clústeres de conmutación por error y **grupos de disponibilidad AlwaysOn** para diferentes ediciones de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , vea [características compatibles con las ediciones de SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) ( https://go.microsoft.com/fwlink/?linkid=232473) .</span><span class="sxs-lookup"><span data-stu-id="89eec-173">For more information about **Number of nodes** within Failover Clustering and **AlwaysOn Availability Groups** for different editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) (https://go.microsoft.com/fwlink/?linkid=232473).</span></span>  
  
### <a name="considerations-for-hosting-an-availability-replica-on-an-fci"></a><span data-ttu-id="89eec-174">Consideraciones para hospedar una réplica de disponibilidad en una FCI</span><span class="sxs-lookup"><span data-stu-id="89eec-174">Considerations for hosting an Availability Replica on an FCI</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="89eec-175">Si tiene previsto hospedar una réplica de disponibilidad en una instancia de clúster de conmutación por error (FCI) de SQL Server, asegúrese de que los nodos de host de Windows Server 2008 cumplen con los requisitos previos y las restricciones de AlwaysOn para las instancias de clúster de conmutación por error (FCI).</span><span class="sxs-lookup"><span data-stu-id="89eec-175">If you plan to host an availability replica on a SQL Server Failover Cluster Instance (FCI), ensure that the Windows Server 2008 host nodes meet the AlwaysOn prerequisites and restrictions for Failover Cluster Instances (FCIs).</span></span> <span data-ttu-id="89eec-176">Para más información, vea [Requisitos previos, restricciones y recomendaciones para grupos de disponibilidad AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="89eec-176">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="89eec-177">Las instancias de clúster de conmutación por error (FCI) no admiten la conmutación automática por error de grupos de disponibilidad; por lo tanto, todas las réplicas de disponibilidad hospedadas por un FCI solo se pueden configurar para la conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="89eec-177">Failover Cluster Instances (FCIs) do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can only be configured for manual failover.</span></span>  
  
 <span data-ttu-id="89eec-178">Es posible que necesite configurar un clúster de conmutación por error de Windows Server (WSFC) para incluir los discos compartidos que no están disponibles en todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="89eec-178">You might need to configure a Windows Server Failover Clustering (WSFC) cluster to include shared disks that are not available on all nodes.</span></span> <span data-ttu-id="89eec-179">Por ejemplo, considere un clúster de WSFC en dos centros de datos con tres nodos.</span><span class="sxs-lookup"><span data-stu-id="89eec-179">For example, consider a WSFC cluster across two data centers with three nodes.</span></span> <span data-ttu-id="89eec-180">Dos de los nodos hospedan una instancia de clúster de conmutación por error (FCI) de SQL Server en el centro de datos principal y tienen acceso a los mismos discos compartidos.</span><span class="sxs-lookup"><span data-stu-id="89eec-180">Two of the nodes host a SQL Server failover clustering instance (FCI) in the primary data center and have access to the same shared disks.</span></span> <span data-ttu-id="89eec-181">El tercer nodo hospeda una instancia independiente de SQL Server en otro centro de datos y no tiene acceso a los discos compartidos desde el centro de datos principal.</span><span class="sxs-lookup"><span data-stu-id="89eec-181">The third node hosts a stand-alone instance of SQL Server in a different data center and does not have access to the shared disks from the primary data center.</span></span> <span data-ttu-id="89eec-182">Esta configuración de clúster de WSFC admite la implementación de un grupo de disponibilidad si la FCI hospeda la réplica principal y la instancia independiente hospeda la réplica secundaria.</span><span class="sxs-lookup"><span data-stu-id="89eec-182">This WSFC cluster configuration supports the deployment of an availability group if the FCI hosts the primary replica and the stand-alone instance hosts the secondary replica.</span></span>  
  
 <span data-ttu-id="89eec-183">Al elegir una FCI para hospedar una réplica de disponibilidad para un grupo de disponibilidad determinado, asegúrese de que una conmutación por error de FCI no puede hacer que un único nodo de WSFC intente hospedar dos réplicas de disponibilidad para el mismo grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-183">When choosing an FCI to host an availability replica for a given availability group, ensure that an FCI failover could not potentially cause a single WSFC node to attempt to host two availability replicas for the same availability group.</span></span>  
  
 <span data-ttu-id="89eec-184">El escenario de ejemplo siguiente muestra cómo podría producir problemas esta configuración:</span><span class="sxs-lookup"><span data-stu-id="89eec-184">The following example scenario illustrates how this configuration could lead to problems:</span></span>  
  
 <span data-ttu-id="89eec-185">Marcel configura un clúster de WSFC con dos nodos, `NODE01` y `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="89eec-185">Marcel configures two a WSFC cluster with two nodes, `NODE01` and `NODE02`.</span></span> <span data-ttu-id="89eec-186">Instala una instancia de clúster de conmutación por error de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , `fciInstance1`, en `NODE01` y `NODE02` , donde `NODE01` es el propietario actual de `fciInstance1`.</span><span class="sxs-lookup"><span data-stu-id="89eec-186">He installs a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance, `fciInstance1`, on both `NODE01` and `NODE02` where `NODE01` is the current owner for `fciInstance1`.</span></span>  
 <span data-ttu-id="89eec-187">En `NODE02`, Marcel instala otra instancia de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], `Instance3`, que es una instancia independiente.</span><span class="sxs-lookup"><span data-stu-id="89eec-187">On `NODE02`, Marcel installs another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], `Instance3`, which is a stand-alone instance.</span></span>  
 <span data-ttu-id="89eec-188">En `NODE01`, Marcel habilita fciInstance1 para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="89eec-188">On `NODE01`, Marcel enables fciInstance1 for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="89eec-189">En `NODE02`, habilita `Instance3` para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="89eec-189">On `NODE02`, he enables `Instance3` for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="89eec-190">A continuación, configura un grupo de disponibilidad para el que `fciInstance1` hospeda la réplica principal e `Instance3` hospeda la réplica secundaria.</span><span class="sxs-lookup"><span data-stu-id="89eec-190">Then he sets up an availability group for which `fciInstance1` hosts the primary replica, and `Instance3` hosts the secondary replica.</span></span>  
 <span data-ttu-id="89eec-191">En algún momento `fciInstance1` deja de estar disponible en `NODE01`y el clúster de WSFC produce una conmutación por error de `fciInstance1` a `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="89eec-191">At some point `fciInstance1` becomes unavailable on `NODE01`, and the WSFC cluster causes a failover of `fciInstance1` to `NODE02`.</span></span> <span data-ttu-id="89eec-192">Después de la conmutación por error, `fciInstance1` es una instancia habilitada para [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]que se ejecuta en el rol principal de `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="89eec-192">After the failover, `fciInstance1` is a [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]-enabled instance running under the primary role on `NODE02`.</span></span> <span data-ttu-id="89eec-193">Sin embargo, `Instance3` reside ahora en el mismo nodo de WSFC que `fciInstance1`.</span><span class="sxs-lookup"><span data-stu-id="89eec-193">However, `Instance3` now resides on the same WSFC node as `fciInstance1`.</span></span> <span data-ttu-id="89eec-194">Esto infringe la restricción de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="89eec-194">This violates the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] constraint.</span></span>  
 <span data-ttu-id="89eec-195">Para corregir el problema que este escenario produce, la instancia independiente, `Instance3`, debe residir en otro nodo del mismo clúster de WSFC que `NODE01` y `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="89eec-195">To correct the problem that this scenario presents, the stand-alone instance, `Instance3`, must reside on another node in the same WSFC cluster as `NODE01` and `NODE02`.</span></span>  
  
 <span data-ttu-id="89eec-196">Para más información sobre los clústeres de conmutación por error de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], vea [Instancias de clúster de conmutación por error de AlwaysOn &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="89eec-196">For more information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering, see [AlwaysOn Failover Cluster Instances &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span></span>  
  
##  <a name="restrictions-on-using-the-wsfc-failover-cluster-manager-with-availability-groups"></a><a name="FCMrestrictions"></a><span data-ttu-id="89eec-197">Restricciones en el uso del Administrador de clústeres de conmutación por error WSFC con grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-197">Restrictions on Using The WSFC Failover Cluster Manager with Availability Groups</span></span>  
 <span data-ttu-id="89eec-198">No use el Administrador de clústeres de conmutación por error para manipular grupos de disponibilidad, por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="89eec-198">Do not use the Failover Cluster Manager to manipulate availability groups, for example:</span></span>  
  
-   <span data-ttu-id="89eec-199">No agregue ni quite recursos en el servicio en clúster (grupo de recursos) para el grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-199">Do not add or remove resources in the clustered service (resource group) for the availability group.</span></span>  
  
-   <span data-ttu-id="89eec-200">No cambie las propiedades de los grupos de disponibilidad, como los propietarios posibles y los propietarios preferidos.</span><span class="sxs-lookup"><span data-stu-id="89eec-200">Do not change any availability group properties, such as the possible owners and preferred owners.</span></span> <span data-ttu-id="89eec-201">El grupo de disponibilidad establece automáticamente estas propiedades.</span><span class="sxs-lookup"><span data-stu-id="89eec-201">These properties are set automatically by the availability group.</span></span>  
  
-   <span data-ttu-id="89eec-202">No use el Administrador de clústeres de conmutación por error para mover los grupos de disponibilidad a otros nodos o para conmutar los grupos de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="89eec-202">Do not use the Failover Cluster Manager to move availability groups to different nodes or to fail over availability groups.</span></span> <span data-ttu-id="89eec-203">El Administrador de clústeres de conmutación por error no conoce el estado de sincronización de las réplicas de disponibilidad y hacer esto puede conducir a un tiempo de inactividad extendido.</span><span class="sxs-lookup"><span data-stu-id="89eec-203">The Failover Cluster Manager is not aware of the synchronization status of the availability replicas, and doing so can lead to extended downtime.</span></span> <span data-ttu-id="89eec-204">Debe usar [!INCLUDE[tsql](../../../includes/tsql-md.md)] o [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="89eec-204">You must use [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span>  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="89eec-205">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="89eec-205">Related Content</span></span>  
  
-   <span data-ttu-id="89eec-206">**Blogs:**</span><span class="sxs-lookup"><span data-stu-id="89eec-206">**Blogs:**</span></span>  
  
     [<span data-ttu-id="89eec-207">Configurar el clúster de conmutación por error de Windows para SQL Server (grupo de disponibilidad o FCI) con seguridad limitada</span><span class="sxs-lookup"><span data-stu-id="89eec-207">Configure Windows Failover Clustering for SQL Server (Availability Group or FCI) with Limited Security</span></span>](https://blogs.msdn.com/b/sqlalwayson/archive/2012/06/05/configure-windows-failover-clustering-for-sql-server-availability-group-or-fci-with-limited-security.aspx)  
  
     [<span data-ttu-id="89eec-208">Blogs del equipo de AlwaysOn de SQL Server: el blog oficial del equipo de AlwaysOn de SQL Server</span><span class="sxs-lookup"><span data-stu-id="89eec-208">SQL Server AlwaysOn Team Blogs: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
     [<span data-ttu-id="89eec-209">Blogs de los ingenieros de SQL Server de CSS</span><span class="sxs-lookup"><span data-stu-id="89eec-209">CSS SQL Server Engineers Blogs</span></span>](https://blogs.msdn.com/b/psssql/)  
  
-   <span data-ttu-id="89eec-210">**Notas del producto:**</span><span class="sxs-lookup"><span data-stu-id="89eec-210">**Whitepapers:**</span></span>  
  
     [<span data-ttu-id="89eec-211">Guía de la arquitectura de AlwaysOn: generar una solución de alta disponibilidad y recuperación ante desastres mediante instancias de clúster de conmutación por error y grupos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="89eec-211">AlwaysOn Architecture Guide: Building a High Availability and Disaster Recovery Solution by Using Failover Cluster Instances and Availability Groups</span></span>](https://msdn.microsoft.com/library/jj215886.aspx)  
  
     [<span data-ttu-id="89eec-212">Guía de soluciones AlwaysOn de Microsoft SQL Server para lograr alta disponibilidad y recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="89eec-212">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
     [<span data-ttu-id="89eec-213">Notas del producto de Microsoft para SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="89eec-213">Microsoft White Papers for SQL Server 2012</span></span>](https://msdn.microsoft.com/library/hh403491.aspx)  
  
     [<span data-ttu-id="89eec-214">Notas del producto del equipo de asesoramiento al cliente de SQL Server</span><span class="sxs-lookup"><span data-stu-id="89eec-214">SQL Server Customer Advisory Team Whitepapers</span></span>](http://sqlcat.com/)  
  
## <a name="see-also"></a><span data-ttu-id="89eec-215">Consulte también</span><span class="sxs-lookup"><span data-stu-id="89eec-215">See Also</span></span>  
 <span data-ttu-id="89eec-216">[Información general de Grupos de disponibilidad AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) [habilitar y deshabilitar grupos de disponibilidad AlwaysOn](enable-and-disable-always-on-availability-groups-sql-server.md) &#40;SQL Server&#41;[supervisar grupos de disponibilidad &#40;Transact-SQL&#41;](monitor-availability-groups-transact-sql.md)</span><span class="sxs-lookup"><span data-stu-id="89eec-216">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md) [Monitor Availability Groups &#40;Transact-SQL&#41;](monitor-availability-groups-transact-sql.md)</span></span>  
 [<span data-ttu-id="89eec-217">Instancias de clúster de conmutación por error de AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="89eec-217">AlwaysOn Failover Cluster Instances &#40;SQL Server&#41;</span></span>](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md) 
  
  
