---
title: 'SQL Server copia de seguridad administrada en Azure: interoperabilidad y coexistencia | Microsoft Docs'
description: En este artículo se describe SQL Server copia de seguridad administrada para Microsoft Azure la interoperabilidad y la coexistencia con varias características de SQL Server 2014.
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: 78fb78ed-653f-45fe-a02a-a66519bfee1b
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 2e2839fc4755fe47504e42e5058a5da117888900
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87746404"
---
# <a name="sql-server-managed-backup-to-azure-interoperability-and-coexistence"></a><span data-ttu-id="0b6f8-103">Copia de seguridad administrada de SQL Server en Azure: interoperabilidad y coexistencia</span><span class="sxs-lookup"><span data-stu-id="0b6f8-103">SQL Server Managed Backup to Azure: Interoperability and Coexistence</span></span>
  <span data-ttu-id="0b6f8-104">En este tema se describen la interoperabilidad y la coexistencia de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] con varias características de [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0b6f8-104">This topic describes [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] interoperability and coexistence with several features in [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="0b6f8-105">Estas características son: Grupos de disponibilidad AlwaysOn, creación de reflejo de la base de datos, planes de mantenimiento de copia de seguridad, trasvase de registros, copias de seguridad ad hoc, separar base de datos y quitar base de datos.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-105">These features include the following: AlwaysOn Availability Groups, Database Mirroring, Backup Maintenance Plans, Log Shipping, Ad hoc backups, Detach Database, and Drop Database.</span></span>  
  
### <a name="alwayson-availability-groups"></a><span data-ttu-id="0b6f8-106">Grupos de disponibilidad AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="0b6f8-106">AlwaysOn Availability Groups</span></span>  
 <span data-ttu-id="0b6f8-107">Grupos de disponibilidad AlwaysOn que están configurados como una solución solo de Azure admitida para [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0b6f8-107">AlwaysOn Availability Groups that are configured as an Azure-only solution supported for [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="0b6f8-108">Las configuraciones solo en local o Grupo de disponibilidad AlwaysOn híbrido no se admiten.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-108">On-premises only, or Hybrid AlwaysOn Availability Group configurations are not supported.</span></span> <span data-ttu-id="0b6f8-109">Para obtener más información y otras consideraciones, consulte [configuración de SQL Server copia de seguridad administrada en Azure para grupos de disponibilidad](../../2014/database-engine/setting-up-sql-server-managed-backup-to-windows-azure-for-availability-groups.md) .</span><span class="sxs-lookup"><span data-stu-id="0b6f8-109">For more information and other considerations, see [Setting up SQL Server Managed Backup to Azure for Availability Groups](../../2014/database-engine/setting-up-sql-server-managed-backup-to-windows-azure-for-availability-groups.md)</span></span>  
  
### <a name="database-mirroring"></a><span data-ttu-id="0b6f8-110">Creación de reflejo de la base de datos</span><span class="sxs-lookup"><span data-stu-id="0b6f8-110">Database Mirroring</span></span>  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="0b6f8-111">solo se admite en la base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-111">is supported only on the principal database.</span></span> <span data-ttu-id="0b6f8-112">Si configura tanto la entidad de seguridad como el reflejo para utilizar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], la base de datos reflejada se omite y no se realiza su copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-112">If both the principal and the mirror are configured to use [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], the mirrored database is skipped and will not be backed up.</span></span> <span data-ttu-id="0b6f8-113">Sin embargo, en caso de conmutación por error, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] iniciará el proceso de copia de seguridad una vez que el reflejo haya completado la conmutación de roles y esté en línea.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-113">However, in the event of a failover, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will start the backup process after the mirror has completed role switching and is online.</span></span> <span data-ttu-id="0b6f8-114">Las copias de seguridad se almacenarán en un nuevo contenedor en este caso.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-114">The backups will be stored in a new container in this case.</span></span> <span data-ttu-id="0b6f8-115">Si el reflejo no está configurado para utilizar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], en caso de que se produzca una conmutación por error, no se realiza ninguna copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-115">If the mirror is not configured to use [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], in the event of a failover, no backups are taken.</span></span> <span data-ttu-id="0b6f8-116">Se recomienda configurar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] tanto en la entidad de seguridad como en el reflejo de modo que las copias de seguridad continúen en caso de que se produzca una conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-116">We recommend that you configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] on both the principal and the mirror so backups continue in the event of a failover.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="0b6f8-117">Si va a crear una base de datos reflejada en una instancia con la configuración predeterminada de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], puede ser preferible deshabilitar los valores predeterminados de la instancia de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], por lo que no se aplican a la base de datos reflejada, y después volver a habilitar los valores predeterminados de la instancia tras configurar la entidad de seguridad y el reflejo.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-117">If you are creating a mirrored database on an instance with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] default settings, it may be preferable to disable [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] instance defaults, so they are not applied to the mirrored database, and then re-enable the instance defaults after configuring the Principal and the Mirror.</span></span>  
  
### <a name="maintenance-plan"></a><span data-ttu-id="0b6f8-118">Plan de mantenimiento</span><span class="sxs-lookup"><span data-stu-id="0b6f8-118">Maintenance Plan</span></span>  
 <span data-ttu-id="0b6f8-119">No se permite el uso de planes de mantenimiento para crear copias de seguridad de una base de datos cuando se habilita [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0b6f8-119">Using Maintenance Plans for creating backups for a database when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is enabled is not supported.</span></span> <span data-ttu-id="0b6f8-120">Los planes de mantenimiento ocasionarán que la cadena de registros se interrumpa y [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] no pueda admitir la capacidad de recuperación garantizada de la base de datos durante la restauración.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-120">Maintenance plans will cause broken log chain and [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] may not be able to support a guaranteed recoverability of the database during restore.</span></span> <span data-ttu-id="0b6f8-121">Esto también se aplica cuando [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] está habilitado en el nivel de instancia.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-121">This also applies when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is enabled at the instance level.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="0b6f8-122">Se admiten planes de mantenimiento con copias de seguridad de solo copia con [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configurado para la misma base de datos o instancia.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-122">Maintenance Plans with Copy Only backups is supported with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configured for the same database or instance.</span></span>  
  
### <a name="log-shipping"></a><span data-ttu-id="0b6f8-123">Trasvase de registros</span><span class="sxs-lookup"><span data-stu-id="0b6f8-123">Log Shipping</span></span>  
 <span data-ttu-id="0b6f8-124">No puede configurar el trasvase de registros y [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] para la misma base de datos al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-124">You cannot configure Log Shipping and [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the same database at the same time.</span></span> <span data-ttu-id="0b6f8-125">Si hace esto, afectará a las capacidades de recuperación de la base de datos con cualquier funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-125">Doing so will affect the recoverability of the database using either functionality.</span></span>  
  
### <a name="ad-hoc-backups-using-transact-sql-and-sql-server-management-studio"></a><span data-ttu-id="0b6f8-126">Copias de seguridad ad hoc con Transact-SQL y SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="0b6f8-126">Ad Hoc Backups Using Transact-SQL and SQL Server Management Studio</span></span>  
 <span data-ttu-id="0b6f8-127">Las copias de seguridad ad hoc o de una vez creadas fuera de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] con Transact-SQL o SQL Server Management Studio pueden afectar al proceso de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] según el tipo de copia de seguridad y los medios de almacenamiento utilizados.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-127">Ad hoc or one time backups created outside [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] using Transact-SQL or SQL Server Management Studio may affect the [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] process depending on the type of backup and the storage media used.</span></span> <span data-ttu-id="0b6f8-128">Las copias de seguridad de registros en una cuenta de almacenamiento de Azure diferente de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] la que usa, o cualquier otro destino que sea el servicio de Azure BLOB Storage, producirán una interrupción de la cadena de registros.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-128">Log backups to a different Azure storage account than what [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is using, or any other destination than the Azure Blob storage service, will cause a log chain break.</span></span> <span data-ttu-id="0b6f8-129">Se recomienda usar el procedimiento almacenado [smart_admin. sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) para iniciar una copia de seguridad en las bases de datos que tienen [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] habilitado.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-129">We recommend that you use the [smart_admin.sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) stored procedure to initiate a backup on databases that have [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled.</span></span> <span data-ttu-id="0b6f8-130">Puede iniciar una base de datos completa o la copia de seguridad de registros mediante este procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-130">You can initiate either a full database or log backup using this stored procedure.</span></span>  
  
### <a name="drop-database-and-detach-database"></a><span data-ttu-id="0b6f8-131">Quitar la base de datos y separar la base de datos</span><span class="sxs-lookup"><span data-stu-id="0b6f8-131">Drop Database and Detach Database</span></span>  
 <span data-ttu-id="0b6f8-132">Si se quita o se separa una base de datos que tenga habilitada [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], aunque no se pueda realizar copias de seguridad adicionales, las copias de seguridad anteriores permanecen en el almacenamiento hasta que haya transcurrido el período de retención, momento en que las copias de seguridad se purgarán.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-132">If a database that has [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled is detached or dropped, although no additional backups are possible, the previous backups remain in the storage until the retention period has elapsed, at which point the backups will be purged.</span></span>  
  
### <a name="changes-to-recovery-model"></a><span data-ttu-id="0b6f8-133">Cambios del modelo de recuperación</span><span class="sxs-lookup"><span data-stu-id="0b6f8-133">Changes to Recovery Model</span></span>  
  
-   <span data-ttu-id="0b6f8-134">Si cambia el modelo de recuperación de una base de datos de **simple** a **completo** o de **registro masivo**, tiene la opción de configurar [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] para la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-134">If you change the recovery model of a database from **Simple** to **Full** or **Bulk-Logged**, you have the option of configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the database.</span></span> <span data-ttu-id="0b6f8-135">Se considerará una base de datos nueva desde la perspectiva de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0b6f8-135">This will be considered like a new database from [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] perspective.</span></span>  
  
-   <span data-ttu-id="0b6f8-136">Si cambia el modelo de recuperación de una base de datos de **completo** o de **registro masivo** a **simple**, que tiene [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] habilitada, las operaciones de copia de seguridad ya no estarán programadas.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-136">If you change the recovery model of a database from **Full** or **Bulk-Logged** to **Simple**, that has [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled, backup operations will no longer be scheduled.</span></span> <span data-ttu-id="0b6f8-137">La configuración del periodo de retención estará todavía activa y los archivos de copia de seguridad permanecerán en la cuenta de almacenamiento hasta que haya transcurrido el período de retención.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-137">The retention period setting will still be active and backup files will remain in the storage account until the retention period has elapsed.</span></span> <span data-ttu-id="0b6f8-138">Si desea conservar las copias de seguridad, se recomienda descargar los archivos en una cuenta de almacenamiento diferente o en una ubicación local.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-138">If you want to retain the backups, we recommend that you download the files either to a different storage account or to an on-premises location.</span></span> <span data-ttu-id="0b6f8-139">Los valores de configuración se conservan y se pueden reutilizar si el modelo de recuperación se vuelve a establecer en **completo** u optimizado para **cargas masivas de** datos.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-139">The configuration settings are retained and can be reused if the recovery model is set back to **Full** or **Bulk-Logged** again.</span></span>  
  
### <a name="log-backups-using-other-backup-tools-or-custom-scripts"></a><span data-ttu-id="0b6f8-140">Copias de seguridad de registros con otras herramientas de copia de seguridad o scripts personalizados</span><span class="sxs-lookup"><span data-stu-id="0b6f8-140">Log Backups Using Other Backup Tools or Custom Scripts</span></span>  
 <span data-ttu-id="0b6f8-141">Dos copias de seguridad cualesquiera que estén configuradas para realizar copias de seguridad de registros en la misma base de datos interrumpirán la cadena de registro de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-141">Any two backups that are configured to perform log backups on the same database will cause break in the backup log chain.</span></span> <span data-ttu-id="0b6f8-142">Aunque [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] intente remediar la interrupción en la cadena de copias de seguridad programando copias de seguridad completas cuando se detecta una interrupción en la cadena, ello significa actualizar continuamente las interrupciones y las copias de seguridad de registros periódicas realizadas por las dos herramientas competidoras.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-142">Although [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will attempt to remedy the break in the backup chain by scheduling full backups when a break in chain is detected, this means keeping up continuously with periodic breaks and log backups performed by two competing tools.</span></span> <span data-ttu-id="0b6f8-143">También puede afectar a la capacidad de recuperación de la base de datos, ya que no se puede esperar que ninguna herramienta tenga un conjunto completo de copias de seguridad en orden.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-143">This can also potentially affect the recoverability of the database since no one tool can be expected to have a full set of backup in sequence.</span></span> <span data-ttu-id="0b6f8-144">Aunque esto se aplica a dos características o herramientas cualesquiera que realizan copias de seguridad de registros, resulta útil ver ejemplos específicos como se describe a continuación.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-144">Although this applies to any two features or tools performing log backups,, it is useful to call out specific examples as described below.</span></span> <span data-ttu-id="0b6f8-145">También es la base de los problemas de configuración de planes de mantenimiento o del trasvase de registros, como se ha descrito en secciones anteriores de este tema.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-145">This is also the basis for the issues with configuring maintenance plans or log shipping as described in earlier sections of this topic.</span></span>  
  
 <span data-ttu-id="0b6f8-146">**Copias de seguridad basadas en Data Protection Manager (DPM):** Microsoft Data Protection Manager permite realizar copias de seguridad completas e incrementales.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-146">**Data Protection Manager (DPM) based backups:** Microsoft Data Protection Manager allows you to do full and incremental backups.</span></span> <span data-ttu-id="0b6f8-147">Las copias de seguridad incrementales son copias de seguridad de registros que realizan un truncamiento del registro después de crear una copia de seguridad de registros T.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-147">The incremental backups are log backups that do perform a log truncation after creating a T-log backup.</span></span> <span data-ttu-id="0b6f8-148">Por tanto, no se admite la configuración de DPM y [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] para la misma base de datos.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-148">So configuring both DPM and [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the same database is not supported.</span></span>  
  
 <span data-ttu-id="0b6f8-149">**Scripts o herramientas de terceros:** Cualquier herramienta o scripts de terceros que realicen copias de seguridad de registros que produzcan el truncamiento del registro no es compatible con [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] y no se admite.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-149">**Third Party Tools or Scripts:** Any third party tool or scripts that perform log backups causing log truncation is incompatible with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], and is not supported.</span></span>  
  
 <span data-ttu-id="0b6f8-150">Si ha [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] habilitado para una instancia de base de datos y desea realizar una copia de seguridad ad hoc, puede usar el [smart_admin. Sp_backup_on_demand &#40;TRANSACT-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) procedimiento almacenado como se describe en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-150">If you have [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled for a database instance, and you want to take an ad hoc backup you can either use the [smart_admin.sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) stored procedure as described in the earlier section.</span></span> <span data-ttu-id="0b6f8-151">Si también tiene necesidad de programar o hacer copias de seguridad periódicamente fuera de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], puede utilizar la Copia de seguridad de solo copia.</span><span class="sxs-lookup"><span data-stu-id="0b6f8-151">If you also have a need to schedule or un backups periodically outside of [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], you can use the Copy Only Backup.</span></span>  <span data-ttu-id="0b6f8-152">Para obtener más información, vea [Copias de seguridad de solo copia &#40;SQL Server&#41;](../relational-databases/backup-restore/copy-only-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="0b6f8-152">For more information, see [Copy-Only Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/copy-only-backups-sql-server.md).</span></span>  
  
  
