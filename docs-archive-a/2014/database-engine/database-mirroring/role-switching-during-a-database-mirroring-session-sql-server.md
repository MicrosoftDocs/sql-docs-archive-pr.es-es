---
title: Conmutación de roles durante una sesión de creación de reflejo de la base de datos (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
- mirroring partners [SQL Server]
- failover [SQL Server]
- failover partners [SQL Server]
- database mirroring [SQL Server], partners
- partners in database mirroring sessions [SQL Server]
- failover [SQL Server], database mirroring
- database mirroring [SQL Server], failover
ms.assetid: a782d60d-0373-4386-bd77-9ec192553700
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5e16adbad2106d623279edf9d443eae3755c7be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87746492"
---
# <a name="role-switching-during-a-database-mirroring-session-sql-server"></a><span data-ttu-id="3aedd-102">Conmutación de roles durante una sesión de creación de reflejo de la base de datos (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="3aedd-102">Role Switching During a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="3aedd-103">En el contexto de una sesión de creación de reflejo de la base de datos, los roles principal y reflejado suelen ser intercambiables en un proceso conocido como *conmutación de roles*.</span><span class="sxs-lookup"><span data-stu-id="3aedd-103">Within the context of a database mirroring session, the principal and mirror roles are typically interchangeable in a process known as *role switching*.</span></span> <span data-ttu-id="3aedd-104">En la conmutación de roles, el servidor reflejado actúa como el *asociado de conmutación por error* para el servidor principal al asumir el rol principal, y al recuperar su copia de la base de datos y ponerla en línea como la nueva base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-104">In role switching, the mirror server acts as the *failover partner* for the principal server, taking over the principal role, recovering its copy of the database and bringing it online as the new principal database.</span></span> <span data-ttu-id="3aedd-105">El servidor principal anterior, cuando esté disponible, asumirá el rol reflejado y su base de datos se convertirá en la nueva base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-105">The former principal server, when available, assumes the mirror role, and its database becomes the new mirror database.</span></span> <span data-ttu-id="3aedd-106">Potencialmente, los roles pueden conmutarse como respuesta a varios errores o con fines administrativos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-106">Potentially, the roles can switch back and forth either in response to multiple failures or for administrative purposes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3aedd-107">En este tema se supone que está familiarizado con los modos operativos de creación de reflejo de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-107">This topic assumes that you are familiar with the database mirroring operating modes.</span></span> <span data-ttu-id="3aedd-108">Para más información, consulte [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-108">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="3aedd-109">En la siguiente ilustración se muestran los asociados de creación de reflejo **Partner_A** y **Partner_B**en el proceso de conmutación de los roles principal y reflejo durante una serie de conmutaciones por error automáticas o manuales.</span><span class="sxs-lookup"><span data-stu-id="3aedd-109">The following illustration shows mirroring partners, **Partner_A** and **Partner_B**, switching the principal and mirror roles over a series of automatic or manual failovers.</span></span>  
  
 <span data-ttu-id="3aedd-110">![Dos intercambios de asociados entre roles](../media/dbm-roleswitching.gif "Dos intercambios de asociados entre roles")</span><span class="sxs-lookup"><span data-stu-id="3aedd-110">![Partners switching twice between roles](../media/dbm-roleswitching.gif "Partners switching twice between roles")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3aedd-111">Tras una conmutación de roles, los trabajos que se ejecutaron en la anterior base de datos principal se deben recrear en el nuevo servidor principal para que se ejecuten allí.</span><span class="sxs-lookup"><span data-stu-id="3aedd-111">After a role switch, jobs that ran on the former principal database must be recreated on the new principal server to run there.</span></span> <span data-ttu-id="3aedd-112">Para obtener más información, vea [Administración de inicios de sesión y trabajos tras la conmutación de roles &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-112">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="3aedd-113">Existen tres tipos de conmutación de roles: conmutación automática por error, conmutación por error manual y servicio forzado (con posible pérdida de datos).</span><span class="sxs-lookup"><span data-stu-id="3aedd-113">Three types of role switching exist: automatic failover, manual failover, and forced service (with possible data loss).</span></span> <span data-ttu-id="3aedd-114">La compatibilidad con cada forma depende del modo operativo de la sesión.</span><span class="sxs-lookup"><span data-stu-id="3aedd-114">Support for each form depends on the operating mode of the session.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3aedd-115">Si no está familiarizado con estos modos operativos, vea [Modos de funcionamiento de la creación de reflejo de la base de datos](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-115">If you are unfamiliar with these operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="3aedd-116">**Conmutación por error manual**</span><span class="sxs-lookup"><span data-stu-id="3aedd-116">**Manual failover**</span></span>  
  
     <span data-ttu-id="3aedd-117">El modo de alta seguridad admite la conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-117">High-safety mode supports manual failover.</span></span> <span data-ttu-id="3aedd-118">Al sincronizar la base de datos, su propietario puede iniciar una conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-118">Whenever the database is synchronized, the database owner can initiate a manual failover.</span></span>  
  
     <span data-ttu-id="3aedd-119">La conmutación por error manual se proporciona con fines administrativos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-119">Manual failover is provided for administrative purposes.</span></span> <span data-ttu-id="3aedd-120">Para obtener más información, vea [Conmutación por error manual](#ManualFailover), más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="3aedd-120">For more information, see [Manual Failover](#ManualFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="3aedd-121">**Conmutación por error automática**</span><span class="sxs-lookup"><span data-stu-id="3aedd-121">**Automatic failover**</span></span>  
  
     <span data-ttu-id="3aedd-122">En presencia de un testigo, el modo de alta seguridad admite la conmutación automática por error.</span><span class="sxs-lookup"><span data-stu-id="3aedd-122">In the presence of a witness, high-safety mode supports automatic failover.</span></span> <span data-ttu-id="3aedd-123">La conmutación automática por error solo se produce con la pérdida del servidor principal cuando el testigo y el servidor reflejado siguen conectados entre sí y la base de datos ya está sincronizada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-123">Automatic failover occurs only on the loss of the principal server when the witness and mirror server are still connected to each other and the database is already synchronized.</span></span> <span data-ttu-id="3aedd-124">Para obtener más información, vea [Conmutación automática por error](#AutomaticFailover), más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="3aedd-124">For more information, see [Automatic Failover](#AutomaticFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="3aedd-125">**Servicio forzado (con posible pérdida de datos)**</span><span class="sxs-lookup"><span data-stu-id="3aedd-125">**Forced service (with possible data loss)**</span></span>  
  
     <span data-ttu-id="3aedd-126">Se permite forzar el servicio en modo de alta seguridad si no hay ningún testigo definido y en modo de alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="3aedd-126">Forcing service is supported in high-safety mode when no witness is set and in high-performance mode.</span></span> <span data-ttu-id="3aedd-127">Al perderse el servidor principal, el propietario de la base de datos puede hacer que ésta esté disponible forzando el servicio en el servidor reflejado (con posible pérdida de datos).</span><span class="sxs-lookup"><span data-stu-id="3aedd-127">On the loss of the principal server, the database owner can make the database available by forcing service to the mirror server (with possible data loss).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-128">Se recomienda establecer la propiedad WITNESS en OFF en modo de alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="3aedd-128">We recommend that the WITNESS property be set to OFF in high-performance mode.</span></span> <span data-ttu-id="3aedd-129">De lo contrario, para poner la base de datos en línea, el servidor reflejado debe estar conectado al testigo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-129">Otherwise, to bring the database online, the mirror server must connected to the witness.</span></span>  
  
     <span data-ttu-id="3aedd-130">Para obtener más información, vea [Servicio forzado (con posible pérdida de datos)](#ForcedService), más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="3aedd-130">For more information, see [Forced Service (with Possible Data Loss)](#ForcedService), later in this topic.</span></span>  
  
 <span data-ttu-id="3aedd-131">En la siguiente tabla se resumen las formas de conmutación por error admitidas en cada uno de los modos operativos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-131">The following table summarizes which forms of failover are supported under each of the operating modes.</span></span>  
  
||<span data-ttu-id="3aedd-132">Alto rendimiento</span><span class="sxs-lookup"><span data-stu-id="3aedd-132">High performance</span></span>|<span data-ttu-id="3aedd-133">Modo de alta seguridad sin ningún testigo</span><span class="sxs-lookup"><span data-stu-id="3aedd-133">High-safety mode without a witness</span></span>|<span data-ttu-id="3aedd-134">Modo de alta seguridad con un testigo</span><span class="sxs-lookup"><span data-stu-id="3aedd-134">High-safety mode with a witness</span></span>|  
|-|----------------------|-----------------------------------------|--------------------------------------|  
|<span data-ttu-id="3aedd-135">Conmutación por error automática</span><span class="sxs-lookup"><span data-stu-id="3aedd-135">Automatic failover</span></span>|<span data-ttu-id="3aedd-136">No</span><span class="sxs-lookup"><span data-stu-id="3aedd-136">No</span></span>|<span data-ttu-id="3aedd-137">No</span><span class="sxs-lookup"><span data-stu-id="3aedd-137">No</span></span>|<span data-ttu-id="3aedd-138">Sí</span><span class="sxs-lookup"><span data-stu-id="3aedd-138">Yes</span></span>|  
|<span data-ttu-id="3aedd-139">Conmutación por error manual</span><span class="sxs-lookup"><span data-stu-id="3aedd-139">Manual failover</span></span>|<span data-ttu-id="3aedd-140">No</span><span class="sxs-lookup"><span data-stu-id="3aedd-140">No</span></span>|<span data-ttu-id="3aedd-141">Sí</span><span class="sxs-lookup"><span data-stu-id="3aedd-141">Yes</span></span>|<span data-ttu-id="3aedd-142">Sí</span><span class="sxs-lookup"><span data-stu-id="3aedd-142">Yes</span></span>|  
|<span data-ttu-id="3aedd-143">Servicio forzado</span><span class="sxs-lookup"><span data-stu-id="3aedd-143">Forced service</span></span>|<span data-ttu-id="3aedd-144">Sí</span><span class="sxs-lookup"><span data-stu-id="3aedd-144">Yes</span></span>|<span data-ttu-id="3aedd-145">Sí</span><span class="sxs-lookup"><span data-stu-id="3aedd-145">Yes</span></span>|<span data-ttu-id="3aedd-146">No</span><span class="sxs-lookup"><span data-stu-id="3aedd-146">No</span></span>|  
  
 <span data-ttu-id="3aedd-147">Tras una conmutación de roles, deben existir ciertos metadatos en ambos asociados para garantizar que todos los usuarios de bases de datos puedan tener acceso a la nueva base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-147">After a role switch, certain metadata must exist on both partners to ensure that all of the database users can access the new principal database.</span></span> <span data-ttu-id="3aedd-148">Además, se deben crear los trabajos de copia de seguridad en el nuevo servidor principal para garantizar que se siga realizando una copia de seguridad de la base de datos de acuerdo con su programación periódica.</span><span class="sxs-lookup"><span data-stu-id="3aedd-148">In addition, backup jobs must be created on the new principal server, to ensure that the database continues to be backed up on its regular schedule.</span></span> <span data-ttu-id="3aedd-149">Para obtener más información, vea [Administración de inicios de sesión y trabajos tras la conmutación de roles &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-149">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="3aedd-150">Durante una conmutación de roles, la cantidad de tiempo que la creación de reflejo de la base de datos estará sin servicio depende del tipo de conmutación de roles y de la causa.</span><span class="sxs-lookup"><span data-stu-id="3aedd-150">During a role switch, the amount of time that database mirroring will be out of service depends on the type of role switching and on the cause.</span></span> <span data-ttu-id="3aedd-151">Para obtener más información, vea [Calcular la interrupción del servicio durante la conmutación de roles &#40;creación de reflejo de la base de datos&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-151">For more information, see [Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span></span>  
  
##  <a name="manual-failover"></a><a name="ManualFailover"></a> <span data-ttu-id="3aedd-152">Manual Failover</span><span class="sxs-lookup"><span data-stu-id="3aedd-152">Manual Failover</span></span>  
 <span data-ttu-id="3aedd-153">La conmutación por error manual desconecta los clientes de la base de datos e invierte los roles de los asociados.</span><span class="sxs-lookup"><span data-stu-id="3aedd-153">Manual failover disconnects the clients from the database and reverses the roles of the partners.</span></span> <span data-ttu-id="3aedd-154">El modo de alta seguridad es el único que admite la conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-154">Only high-safety mode supports manual failover.</span></span>  
  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="AvailabilityDuringUpgrades"></a> <span data-ttu-id="3aedd-155">Mantener la disponibilidad durante las actualizaciones</span><span class="sxs-lookup"><span data-stu-id="3aedd-155">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="3aedd-156">El administrador de la base de datos puede utilizar la conmutación por error manual para actualizar hardware o software sin sacrificar la disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="3aedd-156">The database administrator can use manual failover for upgrading hardware or software without sacrificing availability.</span></span> <span data-ttu-id="3aedd-157">Para utilizar la creación de reflejo de la base de datos para las actualizaciones de software, el servidor reflejado y/o el sistema deben haber recibido ya las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="3aedd-157">To use database mirroring for software upgrades, the mirror server and/or system must have already received the upgrades.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3aedd-158">La creación de reflejo de la base de datos podrá realizar una actualización gradual, pero no está garantizado, ya que no se conocen los cambios futuros.</span><span class="sxs-lookup"><span data-stu-id="3aedd-158">Database mirroring should be able to do a rolling upgrade, but this is not guaranteed, because future changes are unknown.</span></span> <span data-ttu-id="3aedd-159">Para más información, consulte [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-159">For more information, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span></span>  
  
 <span data-ttu-id="3aedd-160">En la ilustración siguiente se muestra un ejemplo del uso de la conmutación por error manual para mantener la disponibilidad de la base de datos mientras se actualiza una instancia de servidor de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-160">The following figure illustrates an instance of using manual failover to maintain database availability while you upgrade a database server instance.</span></span> <span data-ttu-id="3aedd-161">Cuando se ha completado la actualización, un administrador puede realizar la conmutación por error para volver a la instancia de servidor original.</span><span class="sxs-lookup"><span data-stu-id="3aedd-161">When the upgrade is completed, an administrator may optionally fail over back to the original server instance.</span></span> <span data-ttu-id="3aedd-162">Esto resulta útil cuando el administrador desea detener la sesión de creación de reflejos y utilizar el servidor reflejado en cualquier otro lugar.</span><span class="sxs-lookup"><span data-stu-id="3aedd-162">This is useful when the administrator wants to stop the mirroring session and use the mirror server elsewhere.</span></span> <span data-ttu-id="3aedd-163">De este modo, se puede utilizar repetidamente una única instancia de servidor al actualizar una serie de instancias de servidor de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-163">In this way, a single server instance can be used repeatedly when updating a series of database server instances.</span></span>  
  
 <span data-ttu-id="3aedd-164">![Conmutación por error manual planeada](../media/dbm-failovmanuplanned.gif "Conmutación por error manual planeada")</span><span class="sxs-lookup"><span data-stu-id="3aedd-164">![Planned manual failover](../media/dbm-failovmanuplanned.gif "Planned manual failover")</span></span>  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ConditionsForManualFo"></a> <span data-ttu-id="3aedd-165">Condiciones requeridas para una conmutación por error manual</span><span class="sxs-lookup"><span data-stu-id="3aedd-165">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="3aedd-166">La conmutación por error manual exige establecer la seguridad de la transacción en FULL (es decir, modo de alta seguridad).</span><span class="sxs-lookup"><span data-stu-id="3aedd-166">Manual failover requires transaction safety to be set to FULL (that is, high-safety mode).</span></span> <span data-ttu-id="3aedd-167">Cuando los asociados están conectados y la base de datos ya está sincronizada, se admite la conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-167">When the partners are connected and the database is already synchronized, manual failover is supported.</span></span>  
  
###  <a name="how-manual-failover-works"></a><a name="HowManualFoWorks"></a> <span data-ttu-id="3aedd-168">Cómo funciona la conmutación por error manual</span><span class="sxs-lookup"><span data-stu-id="3aedd-168">How Manual Failover Works</span></span>  
 <span data-ttu-id="3aedd-169">La conmutación por error manual inicia la siguiente secuencia de acciones:</span><span class="sxs-lookup"><span data-stu-id="3aedd-169">Manual failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="3aedd-170">El servidor principal desconecta los clientes de la base de datos principal, envía el final del registro al servidor reflejado y, como preparación para cambiar al rol reflejado, establece el estado de creación de reflejo en SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="3aedd-170">The principal server disconnects clients from the principal database, sends the tail of the log to the mirror server, and, in preparation for switching to the mirror role, sets the mirroring state to SYNCHRONIZING.</span></span>  
  
2.  <span data-ttu-id="3aedd-171">El servidor reflejado registra el número de flujo de registro (LSN) de la última entrada de registro recibida desde el servidor principal como el LSN de la conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-171">The mirror server records the log sequence number (LSN) of the last log record received from the principal as the failover LSN.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-172">Para ver este LSN, seleccione la columna **mirroring_failover_lsn** en [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3aedd-172">To view this LSN, select the **mirroring_failover_lsn** column from [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span></span>  
  
3.  <span data-ttu-id="3aedd-173">Si hay algún registro esperando en la cola de puesta al día, el servidor reflejado deja de poner al día la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-173">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span> <span data-ttu-id="3aedd-174">La cantidad de tiempo que se necesita para ello depende de la velocidad del sistema, la carga de trabajo reciente y la cantidad de registro en la cola rehecha.</span><span class="sxs-lookup"><span data-stu-id="3aedd-174">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the redo queue.</span></span> <span data-ttu-id="3aedd-175">Para un modo de funcionamiento sincrónico, el tiempo de conmutación por error se puede regular limitando el tamaño de la cola rehecha.</span><span class="sxs-lookup"><span data-stu-id="3aedd-175">For a synchronous operating mode, the failover time can be regulated by limiting the size of the redo queue.</span></span> <span data-ttu-id="3aedd-176">Sin embargo, esto puede hacer que el servidor principal se ralentice para permitir que el servidor reflejado no se retrase.</span><span class="sxs-lookup"><span data-stu-id="3aedd-176">However, this can cause the principal server to slow down to allow the mirror server to keep up.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-177">Para conocer el tamaño actual de la cola rehecha, use el contador de rendimiento **Cola rehecha** en el objeto de rendimiento de creación de reflejo de la base de datos (para obtener más información, vea [Supervisar la creación de reflejo de la base de datos &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span><span class="sxs-lookup"><span data-stu-id="3aedd-177">To learn the current size of the redo queue, use the **Redo Queue** performance counter in the database mirroring performance object (for more information, see [Monitoring Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span></span>  
  
4.  <span data-ttu-id="3aedd-178">El servidor reflejado pasa a ser el nuevo servidor principal, y el que antes era el servidor principal se convierte en el nuevo servidor reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-178">The mirror server becomes the new principal server, and the former principal server becomes the new mirror server.</span></span>  
  
5.  <span data-ttu-id="3aedd-179">El nuevo servidor principal revierte todas las transacciones no confirmadas y pone en línea su copia de la base de datos como la base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-179">The new principal server rolls back any uncommitted transactions and brings its copy of the database online as the principal database.</span></span>  
  
6.  <span data-ttu-id="3aedd-180">El servidor principal anterior asume el rol reflejado, y la anterior base de datos principal se convierte en la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-180">The former principal takes on the mirror role, and the former principal database becomes the mirror database.</span></span> <span data-ttu-id="3aedd-181">El nuevo servidor reflejado vuelve a sincronizar rápidamente la nueva base de datos reflejada con la nueva base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-181">The new mirror server quickly resynchronizes the new mirror database with the new principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-182">Tan pronto como el nuevo servidor reflejado haya resincronizado las bases de datos, la conmutación por error vuelve a ser posible, pero en la dirección inversa.</span><span class="sxs-lookup"><span data-stu-id="3aedd-182">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="3aedd-183">Tras la conmutación por error, los clientes deben volver a conectarse a la base de datos principal actual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-183">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="3aedd-184">Para más información, consulte [Conectar clientes a una sesión de creación de reflejo de la base de datos &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-184">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
 <span data-ttu-id="3aedd-185">**Para iniciar la conmutación por error manual**</span><span class="sxs-lookup"><span data-stu-id="3aedd-185">**To initiate manual failover**</span></span>  
  
-   [<span data-ttu-id="3aedd-186">Realizar manualmente la conmutación por error de una sesión de creación de reflejo de la base de datos &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-186">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
-   <span data-ttu-id="3aedd-187">[Realizar una conmutación por error manualmente de una sesión de creación de reflejo de la base de datos &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-187">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="3aedd-188">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="3aedd-188">Automatic Failover</span></span>  
 <span data-ttu-id="3aedd-189">La conmutación automática por error solo se admite en sesiones de creación de reflejo de la base de datos que se ejecutan con un testigo en modo de alta seguridad (*modo de alta seguridad con conmutación automática por error*).</span><span class="sxs-lookup"><span data-stu-id="3aedd-189">Automatic failover is supported only in database mirroring sessions running with a witness in high-safety mode (*high-safety mode with automatic failover*).</span></span> <span data-ttu-id="3aedd-190">En modo de alta seguridad con conmutación automática por error, una vez que se ha sincronizado la base de datos, si la base de datos principal deja de estar disponible, se produce la conmutación automática por error.</span><span class="sxs-lookup"><span data-stu-id="3aedd-190">In high-safety mode with automatic failover, once the database is synchronized, if the principal database becomes unavailable, an automatic failover occurs.</span></span> <span data-ttu-id="3aedd-191">La conmutación automática por error hace que el servidor reflejado asuma el rol de servidor principal y ponga en línea su copia de la base de datos como base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-191">An automatic failover causes the mirror server to take over the role of principal server and bring its copy of the database online as the principal database.</span></span> <span data-ttu-id="3aedd-192">El hecho de que se requiera la sincronización de la base de datos evita que se pierdan datos durante la conmutación por error, dado que cada transacción confirmada en la base de datos principal también se confirma en la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-192">Requiring that the database be synchronized prevents data loss during failover, because every transaction committed on the principal database is also committed on the mirror database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3aedd-193">Para que la conmutación automática por error mejore la confiabilidad, las bases de datos reflejada y principal deben residir en equipos diferentes.</span><span class="sxs-lookup"><span data-stu-id="3aedd-193">For automatic failover to improve reliability, the mirror and principal databases must reside on different computers.</span></span>  
  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="ConditionsForAutoFo"></a> <span data-ttu-id="3aedd-194">Condiciones requeridas para una conmutación automática por error</span><span class="sxs-lookup"><span data-stu-id="3aedd-194">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="3aedd-195">La conmutación automática por error requiere las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="3aedd-195">Automatic failover requires the following conditions:</span></span>  
  
-   <span data-ttu-id="3aedd-196">La sesión de creación de reflejo de la base de datos debe ejecutarse en modo de alta seguridad y debe poseer un testigo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-196">The database mirroring session must be running in high-safety mode and must possess a witness.</span></span> <span data-ttu-id="3aedd-197">Para más información, consulte [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-197">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="3aedd-198">La base de datos reflejada ya debe estar sincronizada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-198">The mirror database must already be synchronized.</span></span> <span data-ttu-id="3aedd-199">Esto garantiza que toda la parte del registro que se haya enviado al servidor reflejado se haya escrito en el disco.</span><span class="sxs-lookup"><span data-stu-id="3aedd-199">This guarantees that all of the log sent to the mirror server has been written to disk.</span></span>  
  
-   <span data-ttu-id="3aedd-200">El servidor principal ha perdido la comunicación con el resto de la configuración del reflejo de la base de datos, mientras que el servidor reflejado y el testigo conservan el quórum.</span><span class="sxs-lookup"><span data-stu-id="3aedd-200">The principal server has lost communication with the rest of the database mirroring configuration, while the mirror and witness retain quorum.</span></span> <span data-ttu-id="3aedd-201">Sin embargo, si todas las instancias de servidor pierden la comunicación, y el testigo y el servidor reflejado la recuperan después, no se produce la conmutación automática por error.</span><span class="sxs-lookup"><span data-stu-id="3aedd-201">If all server instances lose communication, however, and the witness and the mirror server later regain communication, automatic failover does not occur.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-202">Para más información, vea [Cuórum: cómo un testigo afecta a la disponibilidad de la base de datos &#40;creación de reflejo de la base de datos&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-202">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
-   <span data-ttu-id="3aedd-203">El servidor reflejado ha detectado la pérdida del servidor principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-203">The mirror server has detected the loss of the principal server.</span></span>  
  
     <span data-ttu-id="3aedd-204">El modo en que el servidor reflejado detecta un error en el servidor principal depende de si éste es un error de software o de hardware.</span><span class="sxs-lookup"><span data-stu-id="3aedd-204">How the mirror server detects a failure of the principal server depends on whether it is a hard or soft failure.</span></span> <span data-ttu-id="3aedd-205">Para más información, consulte [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-205">For more information, see [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="3aedd-206">Cómo funciona la conmutación automática por error</span><span class="sxs-lookup"><span data-stu-id="3aedd-206">How Automatic Failover Works</span></span>  
 <span data-ttu-id="3aedd-207">Si se cumplen las condiciones anteriores, la conmutación automática por error inicia la siguiente secuencia de acciones:</span><span class="sxs-lookup"><span data-stu-id="3aedd-207">Under the preceding conditions, automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="3aedd-208">Si el servidor principal sigue en funcionamiento, cambiará el estado de la base de datos principal a DISCONNECTED y desconectará a todos los clientes de la base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-208">If the principal server is still running, it changes the state of the principal database to DISCONNECTED and disconnects all clients from the principal database.</span></span>  
  
2.  <span data-ttu-id="3aedd-209">Los servidores testigo y reflejado registran que el servidor principal no está disponible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-209">The witness and mirror servers register that the principal server is unavailable.</span></span>  
  
3.  <span data-ttu-id="3aedd-210">Si hay algún registro esperando en la cola de puesta al día, el servidor reflejado deja de poner al día la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-210">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-211">La cantidad de tiempo que requiere la aplicación del registro depende de la velocidad del sistema, la carga de trabajo reciente y la cantidad de registro en la cola de puesta al día.</span><span class="sxs-lookup"><span data-stu-id="3aedd-211">The amount of time required to apply the log depends on the speed of the system, the recent work load, and the amount of log in the redo queue.</span></span>  
  
4.  <span data-ttu-id="3aedd-212">La base de datos reflejada anterior pasa a estar en línea como la nueva base de datos principal, y la recuperación limpia todas las transacciones no confirmadas revirtiéndolas lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-212">The former mirror database moves online as the new principal database, and recovery cleans up all uncommitted transactions by rolling them back as quickly as possible.</span></span> <span data-ttu-id="3aedd-213">Los bloqueos aíslan esas transacciones.</span><span class="sxs-lookup"><span data-stu-id="3aedd-213">Locks isolate those transactions.</span></span>  
  
5.  <span data-ttu-id="3aedd-214">Cuando el servidor principal anterior se reincorpora a la sesión, reconoce que su asociado de conmutación por error ahora tiene el rol principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-214">When the former principal server rejoins the session, it recognizes that its failover partner now owns the principal role.</span></span> <span data-ttu-id="3aedd-215">El servidor principal anterior asume el rol reflejado, con lo que su base de datos pasa a ser la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-215">The former principal server takes on the role of mirror, making its database the mirror database.</span></span> <span data-ttu-id="3aedd-216">El nuevo servidor reflejado sincroniza la nueva base de datos reflejada con la base de datos principal lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-216">The new mirror server synchronizes the new mirror database with the principal database as quickly as possible.</span></span> <span data-ttu-id="3aedd-217">Tan pronto como el nuevo servidor reflejado haya resincronizado las bases de datos, la conmutación por error vuelve a ser posible, pero en la dirección inversa.</span><span class="sxs-lookup"><span data-stu-id="3aedd-217">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="3aedd-218">En la siguiente ilustración se muestra una sola instancia de conmutación automática por error.</span><span class="sxs-lookup"><span data-stu-id="3aedd-218">The following illustration shows a single instance of automatic failover.</span></span>  
  
 <span data-ttu-id="3aedd-219">![Conmutación por error automática](../media/dbm-failovauto1round.gif "Conmutación por error automática")</span><span class="sxs-lookup"><span data-stu-id="3aedd-219">![Automatic failover](../media/dbm-failovauto1round.gif "Automatic failover")</span></span>  
  
 <span data-ttu-id="3aedd-220">Inicialmente, los tres servidores están conectados (es decir, la sesión tiene un quórum completo).</span><span class="sxs-lookup"><span data-stu-id="3aedd-220">Initially, all three servers are connected (the session has full quorum).</span></span> <span data-ttu-id="3aedd-221">**Partner_A** es el servidor principal y **Partner_B** , el servidor reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-221">**Partner_A** is the principal server and **Partner_B** is the mirror server.</span></span> <span data-ttu-id="3aedd-222">**Partner_A** (o la base de datos principal en **Partner_A**) pasa a no estar disponible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-222">**Partner_A** (or the principal database on **Partner_A**) becomes unavailable.</span></span> <span data-ttu-id="3aedd-223">El testigo y **Partner_B** reconocen que el servidor principal ya no está disponible y la sesión conserva el cuórum.</span><span class="sxs-lookup"><span data-stu-id="3aedd-223">The witness and **Partner_B** both recognize that the principal is no longer available the session retains quorum.</span></span> <span data-ttu-id="3aedd-224">**Partner_B** se convierte en el servidor principal y hace que su copia de la base de datos esté disponible como la nueva base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-224">**Partner_B** becomes the principal server and makes its copy of the database available as the new principal database.</span></span> <span data-ttu-id="3aedd-225">Finalmente, **Partner_A** se vuelve a conectar a la sesión y descubre que **Partner_B** posee ahora el rol principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-225">Eventually, **Partner_A** reconnects to the session and discovers that **Partner_B** now owns the principal role.</span></span> <span data-ttu-id="3aedd-226">Por tanto,**Partner_A** asume el rol reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-226">**Partner_A** then takes on the mirror role.</span></span>  
  
 <span data-ttu-id="3aedd-227">Tras la conmutación por error, los clientes deben volver a conectarse a la base de datos principal actual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-227">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="3aedd-228">Para más información, consulte [Conectar clientes a una sesión de creación de reflejo de la base de datos &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-228">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3aedd-229">Las transacciones que se han preparado mediante el Coordinador de transacciones distribuidas de [!INCLUDE[msCoName](../../includes/msconame-md.md)] , pero que aún no están confirmadas en el momento de la conmutación por error, se consideran anuladas tras la conmutación por error de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-229">Transactions that have been prepared using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator but are still not committed when a failover occurs, are considered aborted after the database has failed over.</span></span>  
  
###  <a name="to-disable-automatic-failover-sql-server-management-studio"></a><a name="DisableAutoSSMS"></a> <span data-ttu-id="3aedd-230">Para deshabilitar la conmutación automática por error (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="3aedd-230">To Disable Automatic Failover (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="3aedd-231">Abra la página **Creación de reflejo** de Propiedades de la base de datos y cambie el modo de funcionamiento seleccionando una de las opciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="3aedd-231">Open the **Database PropertiesMirroring** page, and change the operating mode by selecting one of the following options:</span></span>  
  
-   <span data-ttu-id="3aedd-232">**Seguridad alta sin conmutación automática por error (sincrónico)**</span><span class="sxs-lookup"><span data-stu-id="3aedd-232">**High safety without automatic failover (synchronous)**</span></span>  
  
     <span data-ttu-id="3aedd-233">En este modo, la base de datos sigue estando sincronizada y la conmutación manual por error sigue siendo posible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-233">In this mode, the database continues to be synchronized, and manual failover remains possible.</span></span>  
  
-   <span data-ttu-id="3aedd-234">**Rendimiento alto (asincrónico)**</span><span class="sxs-lookup"><span data-stu-id="3aedd-234">**High performance (asynchronous)**</span></span>  
  
     <span data-ttu-id="3aedd-235">En este modo, la base de datos reflejada podría ir un poco retrasada con respecto a la base de datos principal y la conmutación manual por error no es posible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-235">In this mode, the mirror database might lag somewhat behind the principal database, and manual failover is no longer possible.</span></span>  
  
### <a name="to-disable-automatic-failover-using-transact-sql"></a><span data-ttu-id="3aedd-236">Para deshabilitar la conmutación automática por error (mediante Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="3aedd-236">To Disable Automatic Failover (Using Transact-SQL)</span></span>  
 <span data-ttu-id="3aedd-237">En cualquier punto de una sesión de creación de reflejo de la base de datos, el propietario de la base de datos puede deshabilitar la conmutación automática por error desactivando el testigo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-237">At any point in a database mirroring session, the database owner can disable automatic failover by turning off the witness.</span></span>  
  
 <span data-ttu-id="3aedd-238">**Para desactivar el testigo**</span><span class="sxs-lookup"><span data-stu-id="3aedd-238">**To turn off the witness**</span></span>  
  
-   [<span data-ttu-id="3aedd-239">Quitar el testigo de una sesión de creación de reflejo de la base de datos &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-239">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
    > [!NOTE]  
    >  <span data-ttu-id="3aedd-240">Desactivar el testigo mientras se mantiene la seguridad de las transacciones completa pone la sesión en modo de alta seguridad sin conmutación automática por error.</span><span class="sxs-lookup"><span data-stu-id="3aedd-240">Turning off the witness while retaining full transaction safety puts the session into high-safety mode without automatic failover.</span></span>  
  
##  <a name="forced-service-with-possible-data-loss"></a><a name="ForcedService"></a> <span data-ttu-id="3aedd-241">Forced Service (with Possible Data Loss)</span><span class="sxs-lookup"><span data-stu-id="3aedd-241">Forced Service (with Possible Data Loss)</span></span>  
 <span data-ttu-id="3aedd-242">La creación de reflejo de base de datos permite forzar el servicio (con posible pérdida de datos) como método de recuperación de desastres para permitir el uso de un servidor reflejado como servidor en espera activa.</span><span class="sxs-lookup"><span data-stu-id="3aedd-242">Database mirroring provides forcing service (with possible data loss) as a disaster recovery method to allow you to use a mirror server as a warm standby server.</span></span> <span data-ttu-id="3aedd-243">Solo se puede forzar el servicio si el servidor principal se desconecta del servidor reflejado en una sesión de creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-243">Forcing service is possible only if the principal server is disconnected from the mirror server in a mirroring session.</span></span> <span data-ttu-id="3aedd-244">Puesto que forzar el servicio puede suponer una posible pérdida de datos, se debe hacer con precaución y moderación.</span><span class="sxs-lookup"><span data-stu-id="3aedd-244">Because forcing service risks possible data loss, it should be used cautiously and sparingly.</span></span>  
  
 <span data-ttu-id="3aedd-245">La compatibilidad con el servicio forzado depende del modo de funcionamiento y del estado de la sesión, según se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="3aedd-245">Support for forced service depends on the operating mode and the state of the session, as follows:</span></span>  
  
-   <span data-ttu-id="3aedd-246">Generalmente, el modo de alto rendimiento permite forzar el servicio siempre que el servidor principal esté desconectado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-246">Typically, high-performance mode supports forcing service whenever the principal server is disconnected.</span></span> <span data-ttu-id="3aedd-247">Sin embargo, aunque es innecesario, puede existir un testigo para una sesión en modo de alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="3aedd-247">However, though unnecessary, a witness can exist for a high-performance mode session.</span></span> <span data-ttu-id="3aedd-248">En este caso, forzar el servicio requiere que el servidor reflejado y el testigo estén conectados entre sí.</span><span class="sxs-lookup"><span data-stu-id="3aedd-248">In this case, forcing service requires that the mirror server and witness are connected to each other.</span></span>  
  
-   <span data-ttu-id="3aedd-249">El modo de alta seguridad sin conmutación automática por error permite forzar el servicio siempre que el servidor principal esté desconectado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-249">High-safety mode without automatic failover supports forcing service whenever the principal server is disconnected.</span></span>  
  
-   <span data-ttu-id="3aedd-250">El modo de alta seguridad con conmutación automática por error permite forzar el servicio siempre que el servidor reflejado y el testigo estén conectados entre sí y ninguno de ellos esté conectado al servidor principal (siempre que el servidor reflejado no estuviera en el proceso para revertir la base de datos reflejada cuando se conectó por última vez al principal).</span><span class="sxs-lookup"><span data-stu-id="3aedd-250">High-safety mode with automatic failover supports forcing service whenever the mirror server and witness are connected to each other and neither is connected to the principal server (as long as the mirror server was not in the process of rolling back the mirror database when it was last connected to the principal).</span></span>  
  
 <span data-ttu-id="3aedd-251">Se recomienza que el servicio solo se fuerce si es necesario restaurarlo en la base de datos inmediatamente y es aceptable el riesgo de perder algunos datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-251">We recommend forcing service only if you must restore service to the database immediately and are willing to risk losing data.</span></span> <span data-ttu-id="3aedd-252">El efecto de forzar el servicio es similar a quitar la creación de reflejo, excepto en que al forzar el servicio se facilita volver a sincronizar las bases de datos cuando se reanuda la creación de reflejo, con el riesgo de la posible pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-252">The effect of forcing service is similar to removing mirroring, except that forcing service facilitates resynchronizing the databases when mirroring is resumed, at the risk of possible data loss.</span></span> <span data-ttu-id="3aedd-253">Al forzar el servicio se inicia una transición sin problemas del rol principal a la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-253">Forcing service initiates a smooth transition of the principal role to the mirror database.</span></span> <span data-ttu-id="3aedd-254">El servidor reflejado asume el rol de servidor principal y ofrece su copia de la base de datos a los clientes inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="3aedd-254">The mirror server assumes the role of principal server and immediately serves its copy of the database to clients.</span></span> <span data-ttu-id="3aedd-255">La nueva base de datos principal se ejecuta sin reflejar (es decir, se ejecuta expuesta).</span><span class="sxs-lookup"><span data-stu-id="3aedd-255">The new principal database runs without a mirror (that is, it runs exposed).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3aedd-256">Si el servidor principal simplemente se desconecta de la sesión de creación de reflejo de la base de datos y sigue ejecutándose, algunos clientes podrían continuar teniendo acceso a la base de datos principal original.</span><span class="sxs-lookup"><span data-stu-id="3aedd-256">If the principal server was merely disconnected from the database mirroring session and is still running, some clients might continue to access the original principal database.</span></span> <span data-ttu-id="3aedd-257">Antes de forzar el servicio, es importante impedir que los clientes tengan acceso al servidor principal original.</span><span class="sxs-lookup"><span data-stu-id="3aedd-257">Before you force service, it is important to prevent clients from accessing the original principal server.</span></span> <span data-ttu-id="3aedd-258">De lo contrario, una vez forzado el servicio, la base de datos principal original y la base de datos principal actual podrían actualizarse independientemente.</span><span class="sxs-lookup"><span data-stu-id="3aedd-258">Otherwise, after service is forced, the original principal database and the current principal database could be updated independently of the other.</span></span>  
  
  
  
###  <a name="typical-case-of-forced-service"></a><a name="TypicalCaseFS"></a> <span data-ttu-id="3aedd-259">Caso típico de servicio forzado</span><span class="sxs-lookup"><span data-stu-id="3aedd-259">Typical Case of Forced Service</span></span>  
 <span data-ttu-id="3aedd-260">En la figura siguiente se ilustra un caso típico de servicio forzado (con posible pérdida de datos).</span><span class="sxs-lookup"><span data-stu-id="3aedd-260">The following figure illustrates a typical case of forced service (with possible data loss).</span></span>  
  
 <span data-ttu-id="3aedd-261">![Servicio forzado con posible pérdida de datos](../media/dbm-forced-service.gif "Servicio forzado con posible pérdida de datos")</span><span class="sxs-lookup"><span data-stu-id="3aedd-261">![Forcing service with possible data loss](../media/dbm-forced-service.gif "Forcing service with possible data loss")</span></span>  
  
 <span data-ttu-id="3aedd-262">En la figura, el servidor principal original, **Partner_A**, deja de estar disponible para el servidor reflejado, **Partner_B**, lo que ocasiona la desconexión de la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-262">In the figure, the original principal server, **Partner_A**, becomes unavailable to the mirror server, **Partner_B**, causing the mirror database to be disconnected.</span></span> <span data-ttu-id="3aedd-263">Después de asegurarse de que el servidor **Partner_A** no está disponible para los clientes, el administrador de base de datos fuerza el servicio, con posible pérdida de datos, en el servidor **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="3aedd-263">After ensuring that **Partner_A** is not available to clients, the database administrator forces service, with possible data loss, on **Partner_B**.</span></span> <span data-ttu-id="3aedd-264">**Partner_B** se convierte en el servidor principal y se ejecuta con la base de datos *expuesta* (sin reflejo).</span><span class="sxs-lookup"><span data-stu-id="3aedd-264">**Partner_B** becomes the principal server and runs with the database *exposed* (that is, unmirrored).</span></span> <span data-ttu-id="3aedd-265">En este momento, los clientes pueden volver a conectarse a **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="3aedd-265">At this point, clients can reconnect to **Partner_B**.</span></span>  
  
 <span data-ttu-id="3aedd-266">Cuando **Partner_A** está disponible, se vuelve a conectar al nuevo servidor principal, con lo que se vuelve a unir a la sesión y asume el rol reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-266">When **Partner_A** becomes available, it reconnects to the new principal server, rejoining the session and assuming the mirror role.</span></span> <span data-ttu-id="3aedd-267">La sesión de creación de reflejo se suspende inmediatamente, sin haber sincronizado la nueva base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-267">The mirroring session is suspended immediately, without having synchronized the new mirror database.</span></span> <span data-ttu-id="3aedd-268">Al suspender la sesión, se permite al administrador de la base de datos decidir si reanudarla o, en casos extremos, quitar la creación de reflejo e intentar salvar los datos desde la antigua base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-268">Suspending the session allows the database administrator to decide whether to resume the session or, in extreme cases, remove mirroring and attempt to salvage data from the former principal database.</span></span> <span data-ttu-id="3aedd-269">En este caso, el administrador de la base de datos elige reanudar la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-269">In this case, the database administrator chooses to resume mirroring.</span></span> <span data-ttu-id="3aedd-270">En este momento, **Partner_A** asume el rol de servidor reflejado y revierte la base de datos principal anterior hasta el momento en que se produjo la última transacción que se sincronizó correctamente; si alguna transacción confirmada no se grabó en el disco en el servidor reflejado antes de forzar el servicio, se pierde.</span><span class="sxs-lookup"><span data-stu-id="3aedd-270">At that point, **Partner_A** takes over the role of mirror server and rolls back the former principal database to the point in time of the last successfully synchronized transaction; if any committed transactions were not written to disk on the mirror server before service was forced, they are lost.</span></span> <span data-ttu-id="3aedd-271">**Partner_A** revierte entonces la nueva base de datos reflejada y aplica los cambios establecidos en la nueva base de datos principal desde que el anterior servidor reflejado se convirtió en el nuevo servidor principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-271">**Partner_A** then rolls forward the new mirror database by applying any changes made on the new principal database since the former mirror server became the new principal server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3aedd-272">Si bien el modo de alto rendimiento no necesita ningún testigo, si se configura uno, solo es posible forzar el servicio si el testigo está actualmente conectado al servidor reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-272">Although high-performance mode does not require a witness, if one is configured, forcing service is possible only if the witness is currently connected to the mirror server.</span></span>  
  
###  <a name="risks-of-forcing-service"></a><a name="FSrisks"></a> <span data-ttu-id="3aedd-273">Riesgos de forzar el servicio</span><span class="sxs-lookup"><span data-stu-id="3aedd-273">Risks of Forcing Service</span></span>  
 <span data-ttu-id="3aedd-274">Es esencial tener en cuenta que si se fuerza el servicio se pueden perder datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-274">It is essential to understand that forcing service can cause data loss.</span></span> <span data-ttu-id="3aedd-275">La pérdida de datos es posible porque el servidor reflejado no se puede comunicar con el principal y, por lo tanto, no puede garantizar que las dos bases de datos estén sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="3aedd-275">Data loss is possible because the mirror server cannot communicate with the principal server and, therefore, cannot guarantee that the two databases are synchronized.</span></span> <span data-ttu-id="3aedd-276">Al forzar el servicio se inicia una nueva bifurcación de recuperación.</span><span class="sxs-lookup"><span data-stu-id="3aedd-276">Forcing service starts a new recovery fork.</span></span> <span data-ttu-id="3aedd-277">Puesto que la base de datos principal original y la base de datos reflejada están en bifurcaciones de recuperación diferentes, cada base de datos contiene ahora datos que no contiene la otra: la base de datos principal original contiene los cambios que aún no hayan sido enviados desde su cola de envío a la base de datos reflejada anterior (el registro sin enviar); la base de datos reflejada anterior contiene los cambios que se hayan producido después de forzar el servicio.</span><span class="sxs-lookup"><span data-stu-id="3aedd-277">Because the original principal database and mirror database are on different recovery forks, each database now contains data that the other database does not: the original principal database contains whatever changes were not yet sent from its send queue to the former mirror database (the unsent log); the former mirror database contains whatever changes occur after service was forced.</span></span>  
  
 <span data-ttu-id="3aedd-278">Si el servicio se fuerza debido a que el servidor principal no funcionó, la posible pérdida de datos depende de si no se envió ningún registro de transacciones al servidor reflejado antes del problema.</span><span class="sxs-lookup"><span data-stu-id="3aedd-278">If service is forced because the principal server has failed, potential data loss is depends on whether any transaction logs were not sent to the mirror server before the failure.</span></span> <span data-ttu-id="3aedd-279">En el modo de alta seguridad, esto solo es posible hasta que se sincroniza la base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-279">Under high-safety mode, this is possible only until the mirror database becomes synchronized.</span></span> <span data-ttu-id="3aedd-280">En el modo de alto rendimiento, la acumulación del registro sin enviar siempre es una posibilidad.</span><span class="sxs-lookup"><span data-stu-id="3aedd-280">Under the high-performance mode, accumulated unsent log is always a possibility.</span></span>  
  
 <span data-ttu-id="3aedd-281">Las implicaciones derivadas de forzar el servicio dependen en parte de si la sesión tiene un testigo:</span><span class="sxs-lookup"><span data-stu-id="3aedd-281">The implications of forcing service depend partly on whether the session has a witness:</span></span>  
  
-   <span data-ttu-id="3aedd-282">En ausencia de un testigo, el servicio se puede forzar si los asociados se desconectan, por ejemplo, debido a que se interrumpa su conexión de red.</span><span class="sxs-lookup"><span data-stu-id="3aedd-282">In the absence of a witness, service can be forced if the partners become disconnected, for example, because their network connection is broken.</span></span> <span data-ttu-id="3aedd-283">Si el servidor principal original se sigue ejecutando, ambos asociados tienen el rol principal.</span><span class="sxs-lookup"><span data-stu-id="3aedd-283">If the original principal server is still running, both partners own the principal role.</span></span> <span data-ttu-id="3aedd-284">Los clientes que se conecten al nuevo servidor principal tendrán acceso a la versión actual de la base de datos, mientras que los clientes que se conecten al servidor principal original tendrán acceso a la base de datos principal original.</span><span class="sxs-lookup"><span data-stu-id="3aedd-284">Clients connecting to the new principal server will access the current version of the database, while clients connecting to the original principal server will access the original principal database.</span></span> <span data-ttu-id="3aedd-285">Esta situación aumenta la posibilidad de perder los datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-285">This situation increases the potential for data loss.</span></span> <span data-ttu-id="3aedd-286">Si se permite a los asociados volver a conectarse, el servidor principal original asume el rol de servidor reflejado y cambia el estado de su base de datos a "recuperando" antes de que se suspenda la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-286">If the partners are allowed to reconnect, the original principal server assumes the mirror role and changes the status of its database to "recovering," before mirroring is suspended.</span></span> <span data-ttu-id="3aedd-287">Si la sesión se reanuda, se pierden las transacciones de la base de datos principal original cuyo registro estuviera en la cola de envío en el momento de la desconexión más reciente.</span><span class="sxs-lookup"><span data-stu-id="3aedd-287">If the session is resumed, transactions on the original principal database whose log was in the send queue as of the most recent disconnection are lost.</span></span> <span data-ttu-id="3aedd-288">Además, también se pierde cualquier transacción que se produzca después de forzar el servicio.</span><span class="sxs-lookup"><span data-stu-id="3aedd-288">In addition, any the transactions that occurred after service was forced are also lost.</span></span>  
  
-   <span data-ttu-id="3aedd-289">En presencia de un testigo, si el servidor reflejado se desconecta tanto del servidor principal como del testigo, siempre que los dos últimos permanezcan conectados entre sí, el principal se ejecuta expuesto.</span><span class="sxs-lookup"><span data-stu-id="3aedd-289">In the presence of a witness, if the mirror server is disconnected from both the principal server and the witness, as long as the latter two remain connected to each other, the principal runs exposed.</span></span> <span data-ttu-id="3aedd-290">Si el servidor principal se desconecta entonces del testigo, deja de atender a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-290">If the principal server then becomes disconnected from the witness, it stops serving the database.</span></span> <span data-ttu-id="3aedd-291">Después, si el servidor reflejado vuelve a conectarse al testigo, es posible forzar el servicio.</span><span class="sxs-lookup"><span data-stu-id="3aedd-291">Thereafter, if the mirror server reconnects to the witness, forcing service becomes possible.</span></span> <span data-ttu-id="3aedd-292">Si se fuerza el servicio, todos los cambios realizados mientras el servidor principal original se ejecutaba expuesto se perderán si éste vuelve a conectarse.</span><span class="sxs-lookup"><span data-stu-id="3aedd-292">If service is forced, all the changes made while the original principal server was running exposed will be lost if the original principal server reconnects.</span></span>  
  
 <span data-ttu-id="3aedd-293">Para obtener más información, vea [Administrar la potencial pérdida de datos](#ManageDataLoss), más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="3aedd-293">For more information, see [Managing the Potential Data Loss](#ManageDataLoss), later in this topic.</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ManageDataLoss"></a> <span data-ttu-id="3aedd-294">Administrar la potencial pérdida de datos</span><span class="sxs-lookup"><span data-stu-id="3aedd-294">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="3aedd-295">Después de forzar el servicio, una vez que el servidor principal anterior está disponible, siempre que su base de datos no esté dañada, se puede intentar administrar la posible pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-295">After service is forced, once the former principal server is available, assuming that its database is undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="3aedd-296">El enfoque disponible para administrar la posible pérdida de datos depende de si el servidor principal original se ha vuelto a conectar a su asociado o se ha vuelto a unir a la sesión de creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-296">The available approach for managing potential data loss depends on whether the original principal server has reconnected to its partner and rejoined the mirroring session.</span></span> <span data-ttu-id="3aedd-297">Suponiendo que el servidor principal original pueda tener acceso a la nueva instancia principal, la reconexión se produce de forma automática y transparente.</span><span class="sxs-lookup"><span data-stu-id="3aedd-297">Assuming that the original principal server can access the new principal instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-principal-server-has-reconnected"></a><span data-ttu-id="3aedd-298">El servidor principal original se ha vuelto a conectar</span><span class="sxs-lookup"><span data-stu-id="3aedd-298">The Original Principal Server Has Reconnected</span></span>  
 <span data-ttu-id="3aedd-299">Generalmente, después de un problema, cuando el servidor principal original se reinicia, se vuelve a conectar rápidamente a su asociado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-299">Typically, after a failure, when the original principal server restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="3aedd-300">Al reconectarse, el servidor principal original se convierte en el servidor reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-300">On reconnecting, the original principal server becomes the mirror server.</span></span> <span data-ttu-id="3aedd-301">Su base de datos se convierte en la base de datos reflejada y entra en el estado de recuperación antes de suspenderse la sesión.</span><span class="sxs-lookup"><span data-stu-id="3aedd-301">Its database becomes the mirror database and enters the recovering state before the session is suspended.</span></span> <span data-ttu-id="3aedd-302">La base de datos reflejada no se revertirá a menos que se reanude la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-302">The mirror database will not be not rolled back unless you resume mirroring.</span></span>  
  
 <span data-ttu-id="3aedd-303">Sin embargo, la recuperación de la base de datos es inaccesible; por lo tanto, no se puede inspeccionar para evaluar qué datos se perderían si se reanudara la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-303">However, the recovering database is inaccessible; therefore, you cannot inspect it to evaluate what data would be lost if you were to resume mirroring.</span></span> <span data-ttu-id="3aedd-304">Por lo tanto, la decisión de si reanudar o quitar el reflejo depende de si se está dispuesto a aceptar de algún modo la pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-304">Therefore, the decision on whether to resume or remove mirroring depends on whether you are willing to accept any data loss at all.</span></span>  
  
-   <span data-ttu-id="3aedd-305">Si la pérdida de datos sería inaceptable, debe quitar la creación de reflejo para salvarlos.</span><span class="sxs-lookup"><span data-stu-id="3aedd-305">If losing any data would be unacceptable, you should remove mirroring to salvage them.</span></span>  
  
     <span data-ttu-id="3aedd-306">Quitar la creación de reflejo permitiría al administrador de la base de datos recuperar la base de datos principal original e intentar recuperar los datos que se hubieran perdido.</span><span class="sxs-lookup"><span data-stu-id="3aedd-306">Removing mirroring would allow the database administrator to recover the original principal database and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="3aedd-307">Sin embargo, cuando la base de datos reflejada anterior vuelva a ponerse en línea, los asociados anteriores atenderán a bases de datos diferentes con el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="3aedd-307">However, when the former mirror database comes online, the former partners will be serving divergent databases with the same name.</span></span> <span data-ttu-id="3aedd-308">El administrador de la base de datos tiene que hacer que una de las bases de datos esté inaccesible para los clientes con el fin de evitar una mayor diferencia de la base de datos e impedir problemas de conmutación por error del cliente.</span><span class="sxs-lookup"><span data-stu-id="3aedd-308">The database administrator needs to make one of the databases inaccessible to clients to avoid further divergence of the database and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="3aedd-309">Si la pérdida de datos fuera aceptable, podría reanudar la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-309">If losing any data would be acceptable, you can resume mirroring.</span></span>  
  
     <span data-ttu-id="3aedd-310">Al reanudar la creación de reflejo, la nueva base de datos reflejada se revierte como primer paso para sincronizarla.</span><span class="sxs-lookup"><span data-stu-id="3aedd-310">Resuming mirroring causes the new mirror database to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="3aedd-311">Si alguna entrada del registro estuviera esperando en la cola de envío en el momento del problema, se perderían las transacciones correspondientes, incluso si se hubieran confirmado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-311">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-principal-server-has-not-reconnected"></a><span data-ttu-id="3aedd-312">El servidor principal original no se ha vuelto a conectar</span><span class="sxs-lookup"><span data-stu-id="3aedd-312">The Original Principal Server Has Not Reconnected</span></span>  
 <span data-ttu-id="3aedd-313">Si puede impedir temporalmente que el servidor principal original se vuelva a conectar a través de la red al nuevo servidor principal, puede inspeccionar la base de datos principal original para evaluar qué datos se perderían si se reanudara la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-313">If you can temporarily prevent the original principal server from reconnecting over the network to the new principal server, you can inspect the original principal database to evaluate what data would be lost if mirroring were resumed.</span></span>  
  
-   <span data-ttu-id="3aedd-314">Si la posible pérdida de datos es aceptable</span><span class="sxs-lookup"><span data-stu-id="3aedd-314">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="3aedd-315">Permita que el servidor principal original se vuelva a conectar a su asociado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-315">Allow the original principal server to reconnect to its partner.</span></span> <span data-ttu-id="3aedd-316">La reconexión ocasiona la suspensión de la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-316">Reconnecting causes mirroring to be suspended.</span></span> <span data-ttu-id="3aedd-317">Para continuar con la creación de reflejo, simplemente reanude la sesión.</span><span class="sxs-lookup"><span data-stu-id="3aedd-317">To proceed with mirroring, simply resume the session.</span></span> <span data-ttu-id="3aedd-318">El servidor principal anterior asume el rol de servidor reflejado.</span><span class="sxs-lookup"><span data-stu-id="3aedd-318">The former principal server assumes the mirror role.</span></span> <span data-ttu-id="3aedd-319">El nuevo servidor reflejado descarta la bifurcación de recuperación original, con lo que se pierden las transacciones que no se hubieran enviado al servidor reflejado anterior o que éste no hubiera recibido.</span><span class="sxs-lookup"><span data-stu-id="3aedd-319">The new mirror server drops the original recovery fork, losing any transactions that were never sent to or received by the former mirror server.</span></span>  
  
-   <span data-ttu-id="3aedd-320">Si la pérdida de datos es inaceptable</span><span class="sxs-lookup"><span data-stu-id="3aedd-320">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="3aedd-321">Si la base de datos principal original contiene datos esenciales que se perderían si se reanudara la sesión, puede quitar la creación de reflejo para preservar los datos del servidor principal original.</span><span class="sxs-lookup"><span data-stu-id="3aedd-321">If the original principal database contains critical data that would be lost if you resumed the session, you can preserve the data on the original principal server by removing mirroring.</span></span> <span data-ttu-id="3aedd-322">Recomendamos que intente realizar una copia de seguridad del registro después del error de la base de datos principal en este momento.</span><span class="sxs-lookup"><span data-stu-id="3aedd-322">We recommend that you attempt to back up the tail of the principal's log at this point.</span></span> <span data-ttu-id="3aedd-323">Luego puede actualizar la base de datos principal actual (la base de datos reflejada anterior) exportando los datos que desea salvar de la base de datos principal original e importándolos a la base de datos principal actual.</span><span class="sxs-lookup"><span data-stu-id="3aedd-323">Then, you can update the current principal (the former mirror database) by exporting the data you want to salvage from the original principal database and importing it into the current principal database.</span></span> <span data-ttu-id="3aedd-324">Se recomienda realizar una copia de seguridad completa de la base de datos actualizada tan pronto como sea posible.</span><span class="sxs-lookup"><span data-stu-id="3aedd-324">We recommend taking a full database backup of the updated database as quickly as possible.</span></span>  
  
     <span data-ttu-id="3aedd-325">Para restablecer la creación de reflejo con la base de datos actualizada como la base de datos principal inicial, utilice esta copia de seguridad (y al menos una copia de seguridad del registro posterior) para crear una base de datos reflejada.</span><span class="sxs-lookup"><span data-stu-id="3aedd-325">To re-establish mirroring with the updated database as the initial principal database, use this backup (and least one subsequent log backup) to create a new mirror database.</span></span> <span data-ttu-id="3aedd-326">Se debe aplicar cada copia de seguridad del registro tomada después de quitar la creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-326">Every log backup taken after mirroring was removed must be applied.</span></span> <span data-ttu-id="3aedd-327">Por lo tanto, se recomienda retrasar otras copias de seguridad de registros adicionales de la base de datos principal hasta que se inicie la sesión de creación de reflejo.</span><span class="sxs-lookup"><span data-stu-id="3aedd-327">Therefore, we recommend delaying additional log backups of the principal database until the new mirroring session starts.</span></span>  
  
###  <a name="related-tasks-for-managing-a-forced-failover"></a><a name="RelatedTasksForFS"></a> <span data-ttu-id="3aedd-328">Tareas relacionadas para administrar una conmutación por error forzada</span><span class="sxs-lookup"><span data-stu-id="3aedd-328">Related Tasks For Managing a Forced Failover</span></span>  
 <span data-ttu-id="3aedd-329">**Para forzar el servicio**</span><span class="sxs-lookup"><span data-stu-id="3aedd-329">**To force service**</span></span>  
  
-   <span data-ttu-id="3aedd-330">[Forzar el servicio en una sesión de creación de reflejo de la base de datos &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="3aedd-330">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span></span>  
  
 <span data-ttu-id="3aedd-331">**Para reanudar la creación de reflejo de la base de datos**</span><span class="sxs-lookup"><span data-stu-id="3aedd-331">**To resume database mirroring**</span></span>  
  
-   [<span data-ttu-id="3aedd-332">Pausar o reanudar una sesión de creación de reflejo de la base de datos &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-332">Pause or Resume a Database Mirroring Session &#40;SQL Server&#41;</span></span>](pause-or-resume-a-database-mirroring-session-sql-server.md)  
  
 <span data-ttu-id="3aedd-333">**Para crear una nueva base de datos reflejada**</span><span class="sxs-lookup"><span data-stu-id="3aedd-333">**To create a new mirror database**</span></span>  
  
 [<span data-ttu-id="3aedd-334">Preparar una base de datos reflejada para la creación de reflejo &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-334">Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;</span></span>](prepare-a-mirror-database-for-mirroring-sql-server.md)  
  
 <span data-ttu-id="3aedd-335">**Para iniciar la creación de reflejo de la base de datos**</span><span class="sxs-lookup"><span data-stu-id="3aedd-335">**To start up database mirroring**</span></span>  
  
-   [<span data-ttu-id="3aedd-336">Configurar la creación de reflejo de la base de datos &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-336">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="3aedd-337">Establecer una sesión de creación de reflejo de la base de datos mediante la autenticación de Windows &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-337">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="3aedd-338">Consulte también</span><span class="sxs-lookup"><span data-stu-id="3aedd-338">See Also</span></span>  
 <span data-ttu-id="3aedd-339">[Calcular la interrupción del servicio durante la conmutación de roles &#40;creación de reflejo de la base de datos&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="3aedd-339">[Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span></span>  
 <span data-ttu-id="3aedd-340">[Posibles errores durante la creación de reflejo de la base de datos](possible-failures-during-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="3aedd-340">[Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md) </span></span>  
 <span data-ttu-id="3aedd-341">[Conectar clientes a una sesión de creación de reflejo de la base de datos &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="3aedd-341">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="3aedd-342">[Testigo de creación de reflejo de la base de datos](database-mirroring-witness.md) </span><span class="sxs-lookup"><span data-stu-id="3aedd-342">[Database Mirroring Witness](database-mirroring-witness.md) </span></span>  
 <span data-ttu-id="3aedd-343">[Restauraciones de base de datos completas &#40;modelo de recuperación completa&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="3aedd-343">[Complete Database Restores &#40;Full Recovery Model&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="3aedd-344">[Modos de funcionamiento de la creación de reflejo de la base de datos](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="3aedd-344">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="3aedd-345">Estados de creación de reflejo &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3aedd-345">Mirroring States &#40;SQL Server&#41;</span></span>](mirroring-states-sql-server.md)  
  
  
