---
title: SQL Server 2014 arquitectura y administración de registros de transacciones | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 4d1a4f97-3fe4-44af-9d4f-f884a6eaa457
author: rothja
ms.author: jroth
ms.openlocfilehash: 8d32950d94bff22d6549c468e8fe8db3f30fd09a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87663820"
---
# <a name="sql-server-2014-transaction-log-architecture-and-management"></a><span data-ttu-id="b9cf8-102">Arquitectura y administración de registros de transacciones de SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="b9cf8-102">SQL Server 2014 Transaction Log Architecture and Management</span></span>

<span data-ttu-id="b9cf8-103">**Se aplica a:** SQL Server (a partir de 2008)</span><span class="sxs-lookup"><span data-stu-id="b9cf8-103">**Applies to:** SQL Server (starting with 2008)</span></span>

  <span data-ttu-id="b9cf8-104">Todas las bases de datos de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] tienen un registro de transacciones que graba todas las transacciones y las modificaciones que cada transacción realiza en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-104">Every [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database has a transaction log that records all transactions and the database modifications that are made by each transaction.</span></span> <span data-ttu-id="b9cf8-105">El registro de transacciones es un componente esencial de la base de datos y, si se produce un error del sistema, podría ser necesario para volver a poner la base de datos en un estado coherente.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-105">The transaction log is a critical component of the database and, if there is a system failure, the transaction log might be required to bring your database back to a consistent state.</span></span> <span data-ttu-id="b9cf8-106">Esta guía proporciona información acerca de la arquitectura física y lógica del registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-106">This guide provides information about the physical and logical architecture of the transaction log.</span></span> <span data-ttu-id="b9cf8-107">Comprender la arquitectura puede mejorar la eficacia en la administración de registros de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-107">Understanding the architecture can improve your effectiveness in managing transaction logs.</span></span>  

  
##  <a name="transaction-log-logical-architecture"></a><a name="Logical_Arch"></a><span data-ttu-id="b9cf8-108">Arquitectura lógica del registro de transacciones</span><span class="sxs-lookup"><span data-stu-id="b9cf8-108">Transaction Log Logical Architecture</span></span>  

 <span data-ttu-id="b9cf8-109">El registro de transacciones de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] funciona desde el punto de vista lógico como si fuese una cadena de entradas de registro.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-109">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] transaction log operates logically as if the transaction log is a string of log records.</span></span> <span data-ttu-id="b9cf8-110">Cada entrada del registro está identificada por un número de flujo de registro (LSN, Log Sequence Number).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-110">Each log record is identified by a log sequence number (LSN).</span></span> <span data-ttu-id="b9cf8-111">Las nuevas entradas del registro se escriben al final lógico del registro con un LSN mayor que el de las entradas anteriores.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-111">Each new log record is written to the logical end of the log with an LSN that is higher than the LSN of the record before it.</span></span> <span data-ttu-id="b9cf8-112">Las entradas del registro se almacenan en la secuencia en la que se crean.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-112">Log records are stored in a serial sequence as they are created.</span></span> <span data-ttu-id="b9cf8-113">Cada entrada del registro contiene el Id. de la transacción a la que pertenece.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-113">Each log record contains the ID of the transaction that it belongs to.</span></span> <span data-ttu-id="b9cf8-114">Por cada transacción, las entradas del registro asociadas a dicha transacción se vinculan individualmente en una cadena con punteros hacia atrás, para acelerar así la reversión de la transacción.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-114">For each transaction, all log records associated with the transaction are individually linked in a chain using backward pointers that speed the rollback of the transaction.</span></span>  
  
 <span data-ttu-id="b9cf8-115">Los registros de modificaciones de datos registran la operación lógica llevada a cabo o las imágenes anterior y posterior de los datos modificados.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-115">Log records for data modifications record either the logical operation performed or they record the before and after images of the modified data.</span></span> <span data-ttu-id="b9cf8-116">La imagen anterior es una copia de los datos antes de llevar a cabo la operación; la imagen posterior es una copia de los datos después de haber realizado la operación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-116">The before image is a copy of the data before the operation is performed; the after image is a copy of the data after the operation has been performed.</span></span>  
  
 <span data-ttu-id="b9cf8-117">Los pasos para recuperar una operación dependen del tipo de registro:</span><span class="sxs-lookup"><span data-stu-id="b9cf8-117">The steps to recover an operation depend on the type of log record:</span></span>  
  
-   <span data-ttu-id="b9cf8-118">Registro de la operación lógica</span><span class="sxs-lookup"><span data-stu-id="b9cf8-118">Logical operation logged</span></span>  
  
    -   <span data-ttu-id="b9cf8-119">Para poner al día la operación lógica, se vuelve a ejecutar la operación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-119">To roll the logical operation forward, the operation is performed again.</span></span>  
  
    -   <span data-ttu-id="b9cf8-120">Para revertir la operación lógica, se ejecuta la operación lógica inversa.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-120">To roll the logical operation back, the reverse logical operation is performed.</span></span>  
  
-   <span data-ttu-id="b9cf8-121">Registro de las imágenes anterior y posterior</span><span class="sxs-lookup"><span data-stu-id="b9cf8-121">Before and after image logged</span></span>  
  
    -   <span data-ttu-id="b9cf8-122">Para poner al día la operación, se aplica la imagen posterior.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-122">To roll the operation forward, the after image is applied.</span></span>  
  
    -   <span data-ttu-id="b9cf8-123">Para revertir la operación, se aplica la imagen anterior.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-123">To roll the operation back, the before image is applied.</span></span>  
  
 <span data-ttu-id="b9cf8-124">En el registro de transacciones se registran muchos tipos de operaciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-124">Many types of operations are recorded in the transaction log.</span></span> <span data-ttu-id="b9cf8-125">Entre las operaciones se incluyen:</span><span class="sxs-lookup"><span data-stu-id="b9cf8-125">These operations include:</span></span>  
  
-   <span data-ttu-id="b9cf8-126">El inicio y el final de cada transacción.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-126">The start and end of each transaction.</span></span>  
  
-   <span data-ttu-id="b9cf8-127">Todas las modificaciones de los datos (inserción, actualización y eliminación).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-127">Every data modification (insert, update, or delete).</span></span> <span data-ttu-id="b9cf8-128">Esto incluye las modificaciones de las tablas, incluidas las tablas del sistema, hechas por procedimientos almacenados del sistema o por instrucciones del lenguaje de definición de datos (DDL).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-128">This includes changes by system stored procedures or data definition language (DDL) statements to any table, including system tables.</span></span>  
  
-   <span data-ttu-id="b9cf8-129">Las asignaciones o cancelaciones de asignación de páginas y extensiones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-129">Every extent and page allocation or deallocation.</span></span>  
  
-   <span data-ttu-id="b9cf8-130">La creación o eliminación de una tabla o un índice.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-130">Creating or dropping a table or index.</span></span>  
  
 <span data-ttu-id="b9cf8-131">También se registran las operaciones de reversión.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-131">Rollback operations are also logged.</span></span> <span data-ttu-id="b9cf8-132">Cada transacción reserva espacio en el registro de transacciones para asegurarse de que existe suficiente espacio de registro para admitir una reversión provocada por una instrucción de reversión explícita o cuando se produce un error.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-132">Each transaction reserves space on the transaction log to make sure that enough log space exists to support a rollback that is caused by either an explicit rollback statement or if an error is encountered.</span></span> <span data-ttu-id="b9cf8-133">La cantidad de espacio reservado depende de las operaciones realizadas en la transacción, pero normalmente equivale a la cantidad de espacio empleado para registrar cada operación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-133">The amount of space reserved depends on the operations performed in the transaction, but generally it is equal to the amount of space used to log each operation.</span></span> <span data-ttu-id="b9cf8-134">Este espacio reservado se libera cuando se completa la transacción.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-134">This reserved space is freed when the transaction is completed.</span></span>  
  
 <span data-ttu-id="b9cf8-135"> La sección del archivo de registro a partir de la primera entrada de registro que debe estar presente para una reversión correcta en toda la base de datos hasta la última entrada de registro escrita se denomina parte activa del registro o *registro activo*.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-135">The section of the log file from the first log record that must be present for a successful database-wide rollback to the last-written log record is called the active part of the log, or the *active log*.</span></span> <span data-ttu-id="b9cf8-136">Esta es la sección del registro necesaria para una recuperación completa de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-136">This is the section of the log required to a full recovery of the database.</span></span> <span data-ttu-id="b9cf8-137">No se puede truncar ninguna parte del registro activo.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-137">No part of the active log can ever be truncated.</span></span> <span data-ttu-id="b9cf8-138">El número de secuencia de registro (LSN) de este primer registro se denomina el LSN de recuperación mínimo (*MinLSN*).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-138">The log sequence number (LSN) of this first log record is known as the minimum recovery LSN (*MinLSN*).</span></span>  
  
##  <a name="transaction-log-physical-architecture"></a><a name="physical_arch"></a> <span data-ttu-id="b9cf8-139">Arquitectura física del registro de transacciones</span><span class="sxs-lookup"><span data-stu-id="b9cf8-139">Transaction Log Physical Architecture</span></span>  

 <span data-ttu-id="b9cf8-140">El registro de transacciones de una base de datos está asignado a uno o varios archivos físicos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-140">The transaction log in a database maps over one or more physical files.</span></span> <span data-ttu-id="b9cf8-141">Conceptualmente, el archivo de registro es una cadena de entradas de registro.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-141">Conceptually, the log file is a string of log records.</span></span> <span data-ttu-id="b9cf8-142">Físicamente, la secuencia de entradas del registro se almacena de forma eficaz en el conjunto de archivos físicos que implementa el registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-142">Physically, the sequence of log records is stored efficiently in the set of physical files that implement the transaction log.</span></span> <span data-ttu-id="b9cf8-143">Cada base de datos debe tener al menos un archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-143">There must be at least one log file for each database.</span></span>  
  
 <span data-ttu-id="b9cf8-144">[!INCLUDE[ssDEnoversion](../includes/ssdenoversion-md.md)] segmenta cada archivo de registro físico internamente en una serie de archivos de registro virtuales.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-144">The [!INCLUDE[ssDEnoversion](../includes/ssdenoversion-md.md)] divides each physical log file internally into a number of virtual log files.</span></span> <span data-ttu-id="b9cf8-145">Los archivos de registro virtuales no tienen un tamaño fijo y no hay un número fijo de archivos de registro virtuales para un archivo de registro físico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-145">Virtual log files have no fixed size, and there is no fixed number of virtual log files for a physical log file.</span></span> <span data-ttu-id="b9cf8-146">[!INCLUDE[ssDE](../includes/ssde-md.md)] elige dinámicamente el tamaño de los archivos de registro virtuales al crear o ampliar los archivos de registro.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-146">The [!INCLUDE[ssDE](../includes/ssde-md.md)] chooses the size of the virtual log files dynamically while it is creating or extending log files.</span></span> <span data-ttu-id="b9cf8-147">[!INCLUDE[ssDE](../includes/ssde-md.md)] intenta mantener un número reducido de archivos virtuales.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-147">The [!INCLUDE[ssDE](../includes/ssde-md.md)] tries to maintain a small number of virtual files.</span></span> <span data-ttu-id="b9cf8-148">El tamaño de los archivos virtuales después de ampliar un archivo de registro equivale a la suma del tamaño del registro existente y el tamaño del nuevo incremento del archivo.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-148">The size of the virtual files after a log file has been extended is the sum of the size of the existing log and the size of the new file increment.</span></span> <span data-ttu-id="b9cf8-149">El tamaño o número de archivos de registro virtuales no lo pueden configurar ni establecer los administradores.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-149">The size or number of virtual log files cannot be configured or set by administrators.</span></span>  
  
 <span data-ttu-id="b9cf8-150">Los archivos de registro virtuales solo afectan al rendimiento del sistema si se definen archivos de registros físicos mediante valores pequeños para *size* y *growth_increment* .</span><span class="sxs-lookup"><span data-stu-id="b9cf8-150">The only time virtual log files affect system performance is if the physical log files are defined by small *size* and *growth_increment* values.</span></span> <span data-ttu-id="b9cf8-151">El valor *size* es el tamaño inicial del archivo de registro y el valor de *growth_increment* es la cantidad de espacio que se agrega al archivo cada vez que se necesita más espacio.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-151">The *size* value is the initial size for the log file and the *growth_increment* value is the amount of space added to the file every time new space is required.</span></span> <span data-ttu-id="b9cf8-152">Si los archivos de registro crecen hasta un tamaño grande debido a muchos incrementos pequeños, tendrán numerosos archivos de registro virtuales.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-152">If the log files grow to a large size because of many small increments, they will have many virtual log files.</span></span> <span data-ttu-id="b9cf8-153">Esto puede retrasar el inicio de la base de datos, así como las operaciones de copias de seguridad y restauración del registro.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-153">This can slow down database startup and also log backup and restore operations.</span></span> <span data-ttu-id="b9cf8-154">Se recomienda que los archivos de registro se definan con un valor *size* cercano al tamaño final necesario y que tengan también un valor de *growth_increment* relativamente alto.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-154">We recommend that you assign log files a *size* value close to the final size required, and also have a relatively large *growth_increment* value.</span></span> <span data-ttu-id="b9cf8-155">Para obtener más información sobre estos parámetros, consulte [Opciones File y Filegroup de ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-155">For more information about these parameters, see [ALTER DATABASE File and Filegroup Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span></span>  
  
 <span data-ttu-id="b9cf8-156">El registro de transacciones es un archivo de registro circular.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-156">The transaction log is a wrap-around file.</span></span> <span data-ttu-id="b9cf8-157">Considere, por ejemplo, una base de datos con un archivo de registro físico dividido en cuatro archivos de registros virtuales.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-157">For example, consider a database with one physical log file divided into four virtual log files.</span></span> <span data-ttu-id="b9cf8-158">Cuando se crea la base de datos, el archivo de registro lógico empieza en el principio del archivo de registro físico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-158">When the database is created, the logical log file begins at the start of the physical log file.</span></span> <span data-ttu-id="b9cf8-159">Las nuevas entradas del registro se agregan al final del registro lógico y se expanden hacia el final del archivo físico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-159">New log records are added at the end of the logical log and expand toward the end of the physical log.</span></span> <span data-ttu-id="b9cf8-160">El truncamiento del registro libera los registros virtuales cuyas entradas son anteriores al número de flujo de registro de recuperación mínimo (MinLSN).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-160">Log truncation frees any virtual logs whose records all appear in front of the minimum recovery log sequence number (MinLSN).</span></span> <span data-ttu-id="b9cf8-161">*MinLSN* es el número de flujo de registro de la entrada del registro más antigua necesaria para una reversión correcta de toda la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-161">The *MinLSN* is the log sequence number of the oldest log record that is required for a successful database-wide rollback.</span></span> <span data-ttu-id="b9cf8-162">El registro de transacciones de ejemplo sería similar al de la siguiente ilustración.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-162">The transaction log in the example database would look similar to the one in the following illustration.</span></span>  
  
 <span data-ttu-id="b9cf8-163">![Archivo de registro dividido en cuatro archivos de registro virtuales](media/tranlog3.gif "Archivo de registro dividido en cuatro archivos de registro virtuales")</span><span class="sxs-lookup"><span data-stu-id="b9cf8-163">![Log file divided into four virtual log files](media/tranlog3.gif "Log file divided into four virtual log files")</span></span>  
  
 <span data-ttu-id="b9cf8-164">Cuando el final del registro lógico llega al final del archivo de registro físico, las nuevas entradas del registro se escriben al principio del archivo de registro físico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-164">When the end of the logical log reaches the end of the physical log file, the new log records wrap around to the start of the physical log file.</span></span>  
  
 <span data-ttu-id="b9cf8-165">![Las entradas de registro saltan al inicio del archivo de registro](media/tranlog4.gif "Las entradas de registro saltan al inicio del archivo de registro")</span><span class="sxs-lookup"><span data-stu-id="b9cf8-165">![Log records wrap around to start of log file](media/tranlog4.gif "Log records wrap around to start of log file")</span></span>  
  
 <span data-ttu-id="b9cf8-166">El ciclo se repite indefinidamente, siempre que el final del registro lógico no alcance el inicio del registro lógico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-166">This cycle repeats endlessly, as long as the end of the logical log never reaches the beginning of the logical log.</span></span> <span data-ttu-id="b9cf8-167">Si las entradas antiguas se truncan con la frecuencia suficiente para disponer siempre de espacio para todas las nuevas entradas de registro que se van a crear hasta el próximo punto de comprobación, el registro no se llena nunca.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-167">If the old log records are truncated frequently enough to always leave sufficient room for all the new log records created through the next checkpoint, the log never fills.</span></span> <span data-ttu-id="b9cf8-168">Sin embargo, si el final del registro lógico llega al principio del registro lógico, se produce una de estas dos situaciones:</span><span class="sxs-lookup"><span data-stu-id="b9cf8-168">However, if the end of the logical log does reach the start of the logical log, one of two things occurs:</span></span>  
  
-   <span data-ttu-id="b9cf8-169">Si el registro tiene habilitada la opción FILEGROWTH y hay espacio disponible en el disco, el archivo se amplía en la cantidad especificada en el parámetro *growth_increment* y las nuevas entradas del registro se escriben en la extensión.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-169">If the FILEGROWTH setting is enabled for the log and space is available on the disk, the file is extended by the amount specified in the *growth_increment* parameter and the new log records are added to the extension.</span></span> <span data-ttu-id="b9cf8-170">Para obtener más información sobre la opción FILEGROWTH, consulte [Opciones File y Filegroup de ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-170">For more information about the FILEGROWTH setting, see [ALTER DATABASE File and Filegroup Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span></span>  
  
-   <span data-ttu-id="b9cf8-171">Si la opción FILEGROWTH no está habilitada o el disco que almacena el archivo de registro tiene menos espacio disponible que la cantidad especificada en *growth_increment*, se genera el error 9002.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-171">If the FILEGROWTH setting is not enabled, or the disk that is holding the log file has less free space than the amount specified in *growth_increment*, an 9002 error is generated.</span></span>  
  
 <span data-ttu-id="b9cf8-172">Si el registro contiene varios archivos de registro físicos, el registro lógico pasará por todos los archivos de registro físicos antes de volver a empezar por el principio del primer archivo de registro físico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-172">If the log contains multiple physical log files, the logical log will move through all the physical log files before it wraps back to the start of the first physical log file.</span></span>  
  
### <a name="log-truncation"></a><span data-ttu-id="b9cf8-173">Truncamiento del registro</span><span class="sxs-lookup"><span data-stu-id="b9cf8-173">Log Truncation</span></span>  

 <span data-ttu-id="b9cf8-174">El truncamiento del registro es esencial para evitar que se llene.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-174">Log truncation is essential to keep the log from filling.</span></span> <span data-ttu-id="b9cf8-175">El truncamiento del registro elimina los archivos de registro virtuales inactivos del registro de transacciones lógico de una base de datos de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , liberando espacio en el registro lógico para que lo reutilice el registro de transacciones físico.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-175">Log truncation deletes inactive virtual log files from the logical transaction log of a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database, freeing space in the logical log for reuse by the physical transaction log.</span></span> <span data-ttu-id="b9cf8-176">Si no se truncara nunca un registro de transacciones, acabaría ocupando todo el espacio de disco asignado a sus archivo de registro físicos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-176">If a transaction log were never truncated, it would eventually fill all the disk space that is allocated to its physical log files.</span></span> <span data-ttu-id="b9cf8-177">Sin embargo, para que se pueda truncar el registro, se debe realizar primero una operación de punto de comprobación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-177">However, before the log can be truncated, a checkpoint operation must occur.</span></span> <span data-ttu-id="b9cf8-178">Un punto de comprobación escribe en el disco las páginas modificadas en memoria actuales (denominadas páginas desfasadas) y la información del registro de transacciones de la memoria.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-178">A checkpoint writes the current in-memory modified pages (known as dirty pages) and transaction log information from memory to disk.</span></span> <span data-ttu-id="b9cf8-179">Cuando se lleva a cabo el punto de comprobación, la parte inactiva del registro de transacciones se marca como reutilizable.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-179">When the checkpoint is performed, the inactive portion of the transaction log is marked as reusable.</span></span> <span data-ttu-id="b9cf8-180">A partir de ese momento, se puede liberar la parte inactiva mediante el truncamiento del registro.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-180">Thereafter, the inactive portion can be freed by log truncation.</span></span> <span data-ttu-id="b9cf8-181">Para obtener más información sobre los puntos de comprobación, consulte [Puntos de comprobación de base de datos &#40;SQL Server&#41;](../relational-databases/logs/database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-181">For more information about checkpoints, see [Database Checkpoints &#40;SQL Server&#41;](../relational-databases/logs/database-checkpoints-sql-server.md).</span></span>  
  
 <span data-ttu-id="b9cf8-182">En la siguiente ilustración se muestra un registro de transacciones antes y después del truncamiento.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-182">The following illustrations show a transaction log before and after truncation.</span></span> <span data-ttu-id="b9cf8-183">En la primera ilustración se muestra un registro de transacciones que no se ha truncado nunca.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-183">The first illustration shows a transaction log that has never been truncated.</span></span> <span data-ttu-id="b9cf8-184">El registro lógico tiene actualmente cuatro archivos de registro virtuales en uso.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-184">Currently, four virtual log files are in use by the logical log.</span></span> <span data-ttu-id="b9cf8-185">El registro lógico comienza al principio del primer archivo de registro virtual y finaliza en el registro virtual 4.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-185">The logical log starts at the front of the first virtual log file and ends at virtual log 4.</span></span> <span data-ttu-id="b9cf8-186">El registro de MinLSN está en el registro virtual 3.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-186">The MinLSN record is in virtual log 3.</span></span> <span data-ttu-id="b9cf8-187">Los registros virtuales 1 y 2 solo contienen entradas de registro inactivas.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-187">Virtual log 1 and virtual log 2 contain only inactive log records.</span></span> <span data-ttu-id="b9cf8-188">Estas entradas pueden truncarse.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-188">These records can be truncated.</span></span> <span data-ttu-id="b9cf8-189">El registro virtual 5 no se utiliza aún y no forma parte del registro lógico actual.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-189">Virtual log 5 is still unused and is not part of the current logical log.</span></span>  
  
 <span data-ttu-id="b9cf8-190">![Registro de transacciones con cuatro registros virtuales](media/tranlog2.gif "Registro de transacciones con cuatro registros virtuales")</span><span class="sxs-lookup"><span data-stu-id="b9cf8-190">![Transaction log with four virtual logs](media/tranlog2.gif "Transaction log with four virtual logs")</span></span>  
  
 <span data-ttu-id="b9cf8-191">En la segunda ilustración se muestra el registro después del truncamiento.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-191">The second illustration shows how the log appears after being truncated.</span></span> <span data-ttu-id="b9cf8-192">Se han liberado los registros virtuales 1 y 2 para su reutilización.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-192">Virtual log 1 and virtual log 2 have been freed for reuse.</span></span> <span data-ttu-id="b9cf8-193">El registro lógico comienza ahora al principio del registro virtual 3.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-193">The logical log now starts at the beginning of virtual log 3.</span></span> <span data-ttu-id="b9cf8-194">El registro virtual 5 no se utiliza aún y no forma parte del registro lógico actual.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-194">Virtual log 5 is still unused, and it is not part of the current logical log.</span></span>  
  
 <span data-ttu-id="b9cf8-195">![Archivo de registro dividido en cuatro archivos de registro virtuales](media/tranlog3.gif "Archivo de registro dividido en cuatro archivos de registro virtuales")</span><span class="sxs-lookup"><span data-stu-id="b9cf8-195">![Log file divided into four virtual log files](media/tranlog3.gif "Log file divided into four virtual log files")</span></span>  
  
 <span data-ttu-id="b9cf8-196">El truncamiento del registro se produce automáticamente después de los eventos siguientes, excepto cuando se retrasa por alguna razón:</span><span class="sxs-lookup"><span data-stu-id="b9cf8-196">Log truncation occurs automatically after the following events, except when delayed for some reason:</span></span>  
  
-   <span data-ttu-id="b9cf8-197">En el modelo de recuperación simple, después de un punto de comprobación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-197">Under the simple recovery model, after a checkpoint.</span></span>  
  
-   <span data-ttu-id="b9cf8-198">Bajo el modelo de recuperación completa o el modelo de recuperación optimizado para cargas masivas de registros, después de una copia de seguridad del registro, si un punto de comprobación ha producirse desde la copia de seguridad anterior.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-198">Under the full recovery model or bulk-logged recovery model, after a log backup, if a checkpoint has occurred since the previous backup.</span></span>  
  
 <span data-ttu-id="b9cf8-199">El truncamiento del registro se puede retrasar por diferentes factores.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-199">Log truncation can be delayed by a variety of factors.</span></span> <span data-ttu-id="b9cf8-200">En caso de un retraso largo en el truncamiento del registro, el registro de transacciones se puede llenar.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-200">In the event of a long delay in log truncation, the transaction log can fill up.</span></span> <span data-ttu-id="b9cf8-201">Para obtener más información, vea [factores que pueden retrasar el truncamiento del registro](../relational-databases/logs/the-transaction-log-sql-server.md#FactorsThatDelayTruncation) y [solucionar problemas de un registro de transacciones lleno &#40;SQL Server Error 9002&#41;](../relational-databases/logs/troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-201">For information, see [Factors That Can Delay Log Truncation](../relational-databases/logs/the-transaction-log-sql-server.md#FactorsThatDelayTruncation) and [Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;](../relational-databases/logs/troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span></span>  
  
##  <a name="write-ahead-transaction-log"></a><a name="WAL"></a><span data-ttu-id="b9cf8-202">Registro de transacciones de escritura previa</span><span class="sxs-lookup"><span data-stu-id="b9cf8-202">Write-Ahead Transaction Log</span></span>  

 <span data-ttu-id="b9cf8-203">En esta sección se describe el rol que desempeña el registro de transacciones de escritura anticipada en la grabación de modificaciones de datos en disco.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-203">This section describes the role of the write-ahead transaction log in recording data modifications to disk.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="b9cf8-204">usa un registro de escritura anticipada (WAL) que garantiza que ninguna modificación de datos se escribe en el disco antes que la entrada de registro asociada.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-204">uses a write-ahead log (WAL), which guarantees that no data modifications are written to disk before the associated log record is written to disk.</span></span> <span data-ttu-id="b9cf8-205">Así se mantienen las propiedades ACID para una transacción.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-205">This maintains the ACID properties for a transaction.</span></span>  
  
 <span data-ttu-id="b9cf8-206">Para entender cómo funciona el registro de escritura anticipada, es importante saber cómo se escriben los datos modificados en el disco.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-206">To understand how the write-ahead log works, it is important for you to know how modified data is written to disk.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="b9cf8-207">mantiene una caché del búfer que lee las páginas de datos cuando estos deben recuperarse.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-207">maintains a buffer cache into which it reads data pages when data must be retrieved.</span></span> <span data-ttu-id="b9cf8-208">Cuando se modifica una página en la caché del búfer, no se vuelve a escribir inmediatamente en el disco; en su lugar, la página se marca como *desfasada*.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-208">When a page is modified in the buffer cache, it is not immediately written back to disk; instead, the page is marked as *dirty*.</span></span> <span data-ttu-id="b9cf8-209">Una página de datos puede tener más de una escritura lógica antes de que se escriba físicamente en el disco.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-209">A data page can have more than one logical write made before it is physically written to disk.</span></span> <span data-ttu-id="b9cf8-210">Para cada escritura lógica, se inserta una entrada del registro de transacciones en la caché del registro que registra la modificación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-210">For each logical write, a transaction log record is inserted in the log cache that records the modification.</span></span> <span data-ttu-id="b9cf8-211">Las entradas del registro se tienen que escribir en el disco antes de que la página desfasada asociada se quite de la caché del búfer y se escriba en el disco.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-211">The log records must be written to disk before the associated dirty page is removed from the buffer cache and written to disk.</span></span> <span data-ttu-id="b9cf8-212">El proceso de punto de comprobación examina periódicamente la caché del búfer en busca de búferes con páginas de una base de datos especificada y escribe todas las páginas desfasadas en el disco.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-212">The checkpoint process periodically scans the buffer cache for buffers with pages from a specified database and writes all dirty pages to disk.</span></span> <span data-ttu-id="b9cf8-213">Los puntos de comprobación permiten ahorrar tiempo en una recuperación posterior al crear un punto en el que se garantiza que todas las páginas desfasadas se hayan escrito en el disco.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-213">Checkpoints save time during a later recovery by creating a point at which all dirty pages are guaranteed to have been written to disk.</span></span>  
  
 <span data-ttu-id="b9cf8-214">A la escritura en el disco de una página de datos modificada desde la caché del búfer se le llama vaciar la página.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-214">Writing a modified data page from the buffer cache to disk is called flushing the page.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="b9cf8-215">tiene una lógica que evita que una página desfasada se vacíe antes de que se escriba la entrada del registro asociada.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-215">has logic that prevents a dirty page from being flushed before the associated log record is written.</span></span> <span data-ttu-id="b9cf8-216">Las entradas de registro se escriben en el disco cuando las transacciones se confirman.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-216">Log records are written to disk when the transactions are committed.</span></span>  
  
##  <a name="transaction-log-backups"></a><a name="Backups"></a><span data-ttu-id="b9cf8-217">Copias de seguridad del registro de transacciones</span><span class="sxs-lookup"><span data-stu-id="b9cf8-217">Transaction Log Backups</span></span>  

 <span data-ttu-id="b9cf8-218">En esta sección se presentan conceptos acerca de cómo realizar copias de seguridad y restaurar (aplicar) registros de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-218">This section presents concepts about how to back up and restore (apply) transaction logs.</span></span> <span data-ttu-id="b9cf8-219">En los modelos de recuperación completa y de recuperación optimizada para cargas masivas de registros, es necesario realizar copias de seguridad periódicas de los registros de transacciones (*copias de seguridad de registros*) para recuperar datos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-219">Under the full and bulk-logged recovery models, taking routine backups of transaction logs (*log backups*) is necessary for recovering data.</span></span> <span data-ttu-id="b9cf8-220">Puede realizar una copia de seguridad del registro mientras se está ejecutando cualquier copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-220">You can back up the log while any full backup is running.</span></span> <span data-ttu-id="b9cf8-221">Para obtener más información sobre modelos de recuperación, consulte [Realizar copias de seguridad y restaurar bases de datos de SQL Server](../relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases.md).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-221">For more information about recovery models, see [Back Up and Restore of SQL Server Databases](../relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases.md).</span></span>  
  
 <span data-ttu-id="b9cf8-222">Antes de crear la primera copia de seguridad de registros, debe crear una copia de seguridad completa, como una copia de seguridad de la base de datos o la primera de un conjunto completo de copias de seguridad de archivos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-222">Before you can create the first log backup, you must create a full backup, such as a database backup or the first in a set of file backups.</span></span> <span data-ttu-id="b9cf8-223">La restauración de una base de datos utilizando únicamente copias de seguridad de archivos puede llegar a ser un proceso complejo.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-223">Restoring a database by using only file backups can become complex.</span></span> <span data-ttu-id="b9cf8-224">Por lo tanto, es recomendable que comience con una copia de seguridad de la base de datos completa si es posible.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-224">Therefore, we recommend that you start with a full database backup when you can.</span></span> <span data-ttu-id="b9cf8-225">Posteriormente, será necesario realizar copias de seguridad del registro de transacciones con regularidad.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-225">Thereafter, backing up the transaction log regularly is necessary.</span></span> <span data-ttu-id="b9cf8-226">De esta forma, no solo se minimiza el riesgo de pérdida de trabajo, sino que también se permite el truncamiento del registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-226">This not only minimizes work-loss exposure but also enables truncation of the transaction log.</span></span> <span data-ttu-id="b9cf8-227">Normalmente, el registro de transacciones se trunca tras cada copia de seguridad de registros convencional.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-227">Typically, the transaction log is truncated after every conventional log backup.</span></span>  
  
 <span data-ttu-id="b9cf8-228">Es aconsejable realizar copias de seguridad de registros suficientemente regulares para ajustarse a los requisitos de su empresa, específicamente a la tolerancia a la pérdida de trabajo que una unidad de registro dañada podría provocar.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-228">We recommend taking frequent enough log backups to support your business requirements, specifically your tolerance for work loss such as might be caused by a damaged log drive.</span></span> <span data-ttu-id="b9cf8-229">La frecuencia adecuada para realizar copias de seguridad de registros varía en función de la tolerancia al riesgo de pérdida de trabajo y, por otra parte, de la cantidad de copias de seguridad de registros que puede almacenar, administrar y, potencialmente, restaurar.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-229">The appropriate frequency for taking log backups depends on your tolerance for work-loss exposure balanced by how many log backups you can store, manage, and, potentially, restore.</span></span> <span data-ttu-id="b9cf8-230">Una copia de seguridad de registros cada 15 ó 30 minutos puede ser suficiente.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-230">Taking a log backup every 15 to 30 minutes might be enough.</span></span> <span data-ttu-id="b9cf8-231">Si su empresa necesita minimizar el riesgo de pérdida de trabajo, piense en la posibilidad de realizar copias de seguridad de registros más frecuentemente.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-231">If your business requires that you minimize work-loss exposure, consider taking log backups more frequently.</span></span> <span data-ttu-id="b9cf8-232">La existencia de copias de seguridad más frecuentes de los registros tiene la ventaja añadida de aumentar la frecuencia de truncamiento del registro, lo que genera archivos de registro menores.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-232">More frequent log backups have the added advantage of increasing the frequency of log truncation, resulting in smaller log files.</span></span>  
  
 <span data-ttu-id="b9cf8-233">Para limitar el número de copias de seguridad del registro que necesita restaurar, es esencial que realice una copia de seguridad de sus datos periódicamente.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-233">To limit the number of log backups that you need to restore, it is essential to routinely back up your data.</span></span> <span data-ttu-id="b9cf8-234">Por ejemplo, podría programar una copia de seguridad completa de la base de datos cada semana y copias de seguridad diferenciales de la base de datos a diario.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-234">For example, you might schedule a weekly full database backup and daily differential database backups.</span></span>  
  
### <a name="the-log-chain"></a><span data-ttu-id="b9cf8-235">La cadena de registros</span><span class="sxs-lookup"><span data-stu-id="b9cf8-235">The Log Chain</span></span>  

 <span data-ttu-id="b9cf8-236">Una secuencia continua de copias de seguridad de registros se denomina *cadena de registros*.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-236">A continuous sequence of log backups is called a *log chain*.</span></span> <span data-ttu-id="b9cf8-237">Una cadena de registros empieza con una copia de seguridad completa de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-237">A log chain starts with a full backup of the database.</span></span> <span data-ttu-id="b9cf8-238">Normalmente, una cadena de registro nueva solo empieza cuando se realiza la primera copia de seguridad de la base de datos o después de que se cambie del modelo de recuperación simple al modelo de recuperación completa o al modelo de recuperación optimizado para cargas masivas de registros.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-238">Usually, a new log chain is only started when the database is backed up for the first time or after the recovery model is switched from simple recovery to full or bulk-logged recovery.</span></span> <span data-ttu-id="b9cf8-239">A menos que se elija sobrescribir los conjuntos de copia de seguridad existentes al crear una copia de seguridad completa de la base de datos, la cadena de registros existente permanece intacta.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-239">Unless you choose to overwrite existing backup sets when creating a full database backup, the existing log chain remains intact.</span></span> <span data-ttu-id="b9cf8-240">Con la cadena de registros intacta, se puede restaurar la base de datos a partir de cualquier copia de seguridad completa de la base de datos del conjunto de medios, seguida de todas las copias de seguridad de los registros subsiguientes hasta el punto de recuperación.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-240">With the log chain intact, you can restore your database from any full database backup in the media set, followed by all subsequent log backups up through your recovery point.</span></span> <span data-ttu-id="b9cf8-241">El punto de recuperación puede ser el final de la última copia de seguridad de registros o un punto de recuperación concreto de cualquiera de las copias de seguridad de registros.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-241">The recovery point could be the end of the last log backup or a specific recovery point in any of the log backups.</span></span> <span data-ttu-id="b9cf8-242">Para obtener más información, vea [Copias de seguridad del registro de transacciones &#40;SQL Server&#41;](../relational-databases/backup-restore/transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-242">For more information, see [Transaction Log Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/transaction-log-backups-sql-server.md).</span></span>  
  
 <span data-ttu-id="b9cf8-243">Para restaurar una base de datos al momento del error, es preciso que la cadena de registros esté intacta.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-243">To restore a database up to the point of failure, the log chain must be intact.</span></span> <span data-ttu-id="b9cf8-244">De esta forma, es necesario que una secuencia ininterrumpida de las copias de seguridad del registro de transacciones se extienda hasta el momento del error.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-244">That is, an unbroken sequence of transaction log backups must extend up to the point of failure.</span></span> <span data-ttu-id="b9cf8-245">El lugar en el que esta secuencia de registros debe comenzar depende del tipo de copias de seguridad de datos que esté restaurando: de base de datos, parcial o de archivos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-245">Where this sequence of log must start depends on the type of data backups you are restoring: database, partial, or file.</span></span> <span data-ttu-id="b9cf8-246">En las copias de seguridad de base de datos o parciales, la secuencia de copias de seguridad de registros debe extenderse desde el final de la copia de seguridad de base de datos o parcial.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-246">For a database or partial backup, the sequence of log backups must extend from the end of a database or partial backup.</span></span> <span data-ttu-id="b9cf8-247">En un conjunto de copia de seguridad de archivos, la secuencia de copias de seguridad de registros debe comenzar desde el principio del conjunto completo de copias de seguridad de archivos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-247">For a set of file backups, the sequence of log backups must extend from the start of a full set of file backups.</span></span> <span data-ttu-id="b9cf8-248">Para obtener más información, vea [Aplicar copias de seguridad del registro de transacciones &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-248">For more information, see [Apply Transaction Log Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span></span>  
  
### <a name="restore-log-backups"></a><span data-ttu-id="b9cf8-249">Restaurar copias de seguridad de registros</span><span class="sxs-lookup"><span data-stu-id="b9cf8-249">Restore Log Backups</span></span>  

 <span data-ttu-id="b9cf8-250">Al restaurar una copia de seguridad de registros se ponen al día los cambios que se registraron en el registro de transacciones para volver a crear el estado exacto de la base de datos en el momento en que se inició la operación de copia de seguridad de registros.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-250">Restoring a log backup rolls forward the changes that were recorded in the transaction log to re-create the exact state of the database at the time the log backup operation started.</span></span> <span data-ttu-id="b9cf8-251">Al restaurar una base de datos, será necesario restaurar las copias de seguridad de registros creadas tras la copia de seguridad de la base de datos completa que esté restaurando o al principio de la primera copia de seguridad de archivos que esté restaurando.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-251">When you restore a database, you will have to restore the log backups that were created after the full database backup that you restore, or from the start of the first file backup that you restore.</span></span> <span data-ttu-id="b9cf8-252">Normalmente, se debe restaurar una serie de copias de seguridad de registros hasta llegar al punto de recuperación después de haber restaurado la copia de seguridad de los datos o la copia de seguridad diferencial más recientes.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-252">Typically, after you restore the most recent data or differential backup, you must restore a series of log backups until you reach your recovery point.</span></span> <span data-ttu-id="b9cf8-253">A continuación, se realiza la recuperación de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-253">Then, you recover the database.</span></span> <span data-ttu-id="b9cf8-254">De esta manera, todas las transacciones que estaban incompletas cuando comenzó la recuperación se revertirán y la base de datos se conectará.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-254">This rolls back all transactions that were incomplete when the recovery started and brings the database online.</span></span> <span data-ttu-id="b9cf8-255">Una vez recuperada la base de datos, ya no es posible restaurar más copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-255">After the database has been recovered, you cannot restore any more backups.</span></span> <span data-ttu-id="b9cf8-256">Para obtener más información, vea [Aplicar copias de seguridad del registro de transacciones &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="b9cf8-256">For more information, see [Apply Transaction Log Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span></span>  
  
## <a name="additional-reading"></a><span data-ttu-id="b9cf8-257">Lectura adicional</span><span class="sxs-lookup"><span data-stu-id="b9cf8-257">Additional Reading</span></span>  

 <span data-ttu-id="b9cf8-258">Se recomiendan los artículos y libros siguientes para obtener información adicional sobre el registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b9cf8-258">We recommend the following articles and books for additional information about the transaction log.</span></span>  
  
 [<span data-ttu-id="b9cf8-259">Descripción del registro y la recuperación en SQL Server por Paul Randall</span><span class="sxs-lookup"><span data-stu-id="b9cf8-259">Understanding Logging and Recovery in SQL Server by Paul Randall</span></span>](https://technet.microsoft.com/magazine/2009.02.logging.aspx)  
  
 [<span data-ttu-id="b9cf8-260">Administración de registros de transacciones de SQL Server por Tony Davis y Gail Shaw</span><span class="sxs-lookup"><span data-stu-id="b9cf8-260">SQL Server Transaction Log Management by Tony Davis and Gail Shaw</span></span>](http://www.simple-talk.com/books/sql-books/sql-server-transaction-log-management-by-tony-davis-and-gail-shaw/)  
  
  
