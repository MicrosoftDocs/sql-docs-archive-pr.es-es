---
title: Administrar pasos de trabajo | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server replication]
- job steps [SQL Server Agent]
- jobs [SQL Server Agent], Integration Services package step
- executable programs as job steps
- operating systems [SQL Server], job steps
- Transact-SQL job step
- job steps [Transact-SQL]
- Integration Services packages, job steps
- replication job steps [SQL Server]
- logs [SQL Server], jobs
- SQL Server Agent jobs, job steps
- ActiveX scripting jobs [SQL Server]
- job steps [Analysis Services]
ms.assetid: 51352afc-a0a4-428b-8985-f9e58bb57c31
author: stevestein
ms.author: sstein
ms.openlocfilehash: 7362df13956e44b73d6984691e882bec2f39a1e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87674533"
---
# <a name="manage-job-steps"></a><span data-ttu-id="2ffa0-102">Administrar pasos de trabajo</span><span class="sxs-lookup"><span data-stu-id="2ffa0-102">Manage Job Steps</span></span>
  <span data-ttu-id="2ffa0-103">Los pasos de trabajo son acciones que el trabajo realiza en una base de datos o en un servidor.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-103">A job step is an action that the job takes on a database or a server.</span></span> <span data-ttu-id="2ffa0-104">Cada trabajo debe estar formado por un paso, como mínimo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-104">Every job must have at least one job step.</span></span> <span data-ttu-id="2ffa0-105">Los pasos de trabajo pueden ser:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-105">Job steps can be:</span></span>  
  
-   <span data-ttu-id="2ffa0-106">Programas ejecutables y comandos del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-106">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="2ffa0-107">instrucciones, incluidos los procedimientos almacenados y los procedimientos almacenados extendidos.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-107">statements, including stored procedures and extended stored procedures.</span></span>  
  
-   <span data-ttu-id="2ffa0-108">Scripts de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-108">PowerShell scripts.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="2ffa0-109">Scripts de ActiveX.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-109">ActiveX scripts.</span></span>  
  
-   <span data-ttu-id="2ffa0-110">Tareas de replicación.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-110">Replication tasks.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="2ffa0-111">tareas.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-111">tasks.</span></span>  
  
-   [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="2ffa0-112">paquetes.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-112">packages.</span></span>  
  
 <span data-ttu-id="2ffa0-113">Todos los pasos de trabajo se ejecutan en un contexto de seguridad determinado.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-113">Every job step runs in a specific security context.</span></span> <span data-ttu-id="2ffa0-114">Si en el paso de trabajo se especifica un proxy, se ejecuta en el contexto de seguridad de la credencial del proxy.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-114">If the job step specifies a proxy, the job step runs in the security context of the credential for the proxy.</span></span> <span data-ttu-id="2ffa0-115">Si en el paso de trabajo no se especifica un proxy, se ejecuta en el contexto de la cuenta de servicio del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2ffa0-115">If a job step does not specify a proxy, the job step runs in the context of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="2ffa0-116">Solo los miembros del rol fijo de servidor sysadmin pueden crear trabajos en los que no se especifique un proxy de forma explícita.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-116">Only members of the sysadmin fixed server role can create jobs that do not explicitly specify a proxy.</span></span>  
  
 <span data-ttu-id="2ffa0-117">Puesto que los pasos de trabajo se ejecutan en el contexto de un usuario específico de [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, dicho usuario debe disponer de los permisos y la configuración necesarios para que se ejecute el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-117">Because job steps run in the context of a specific [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows user, that user must have the permissions and configuration necessary for the job step to execute.</span></span> <span data-ttu-id="2ffa0-118">Por ejemplo, si crea un trabajo que requiere una letra de unidad o una ruta de acceso UNC (Convención de nomenclatura universal), los pasos de trabajo se pueden ejecutar con la cuenta de usuario de Windows durante la comprobación de las tareas.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-118">For example, if you create a job that requires a drive letter or a Universal Naming Convention (UNC) path, the job steps may run under your Windows user account while testing the tasks.</span></span> <span data-ttu-id="2ffa0-119">Sin embargo, el usuario de Windows para el paso de trabajo debe tener también los permisos y configuraciones de letra de unidad necesarios, o acceso a la unidad requerida.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-119">However, the Windows user for the job step must also have the necessary permissions, drive letter configurations, or access to the required drive.</span></span> <span data-ttu-id="2ffa0-120">De lo contrario, se producirá un error en el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-120">Otherwise, the job step fails.</span></span> <span data-ttu-id="2ffa0-121">Para evitar este problema, asegúrese de que el proxy para cada paso de trabajo dispone de los permisos necesarios para la tarea que realiza dicho paso.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-121">To prevent this problem, ensure that the proxy for each job step has the necessary permissions for the task that the job step performs.</span></span> <span data-ttu-id="2ffa0-122">Para obtener más información, vea [Security Center para SQL Server motor de base de datos y Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-122">For more information, see [Security Center for SQL Server Database Engine and Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span></span>  
  
## <a name="job-step-logs"></a><span data-ttu-id="2ffa0-123">Registros de pasos de trabajo</span><span class="sxs-lookup"><span data-stu-id="2ffa0-123">Job Step Logs</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2ffa0-124">El Agente puede escribir el resultado de algunos pasos de trabajo en un archivo del sistema operativo o en la tabla sysjobstepslogs de la base de datos msdb.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-124">Agent can write output from some job steps either to an operating system file or to the sysjobstepslogs table in the msdb database.</span></span> <span data-ttu-id="2ffa0-125">Los siguientes tipos de pasos de trabajo pueden escribir la salida en los siguientes destinos:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-125">The following job step types can write output to both destinations:</span></span>  
  
-   <span data-ttu-id="2ffa0-126">Programas ejecutables y comandos del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-126">Executable programs and operating system commands.</span></span>  
  
-   <span data-ttu-id="2ffa0-127">Instrucciones[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2ffa0-127">[!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="2ffa0-128">tareas.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-128">tasks.</span></span>  
  
 <span data-ttu-id="2ffa0-129">Solo los pasos de trabajo que ejecutan los usuarios que son miembros del rol fijo de servidor sysadmin pueden escribir la salida en archivos del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-129">Only job steps that are executed by users who are members of the sysadmin fixed server role can write job step output to operating system files.</span></span> <span data-ttu-id="2ffa0-130">Si los pasos de trabajo son ejecutados por usuarios que son miembros de los roles fijos de base de datos SQLAgentUserRole, SQLAgentReaderRole o SQLAgentOperatorRole de la base de datos msdb, la salida de dichos pasos solo se puede escribir en la tabla sysjobstepslogs.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-130">If job steps are executed by users who are members of the SQLAgentUserRole, SQLAgentReaderRole, or the SQLAgentOperatorRole fixed database roles in the msdb database, then the output from these job steps can be written only to the sysjobstepslogs table.</span></span>  
  
 <span data-ttu-id="2ffa0-131">Los registros de pasos de trabajo se eliminan automáticamente al eliminar los trabajos o pasos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-131">Job step logs are automatically deleted when jobs or job steps are deleted.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2ffa0-132">El registro de pasos de trabajo de tareas de replicación y paquetes de [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] lo controla el subsistema respectivo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-132">Replication task and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step logging is handled by their respective subsystem.</span></span> <span data-ttu-id="2ffa0-133">No se puede utilizar el Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] para configurar el registro de pasos de trabajo para estos tipos de pasos.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-133">You cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to configure jog step logging for these types of job steps.</span></span>  
  
## <a name="executable-programs-and-operating-system-commands-as-job-steps"></a><span data-ttu-id="2ffa0-134">Programas ejecutables y comandos del sistema operativo como pasos de trabajo</span><span class="sxs-lookup"><span data-stu-id="2ffa0-134">Executable Programs and Operating-System Commands As Job Steps</span></span>  
 <span data-ttu-id="2ffa0-135">Los programas ejecutables y comandos del sistema operativo se pueden utilizar como pasos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-135">Executable programs and operating-system commands can be used as job steps.</span></span> <span data-ttu-id="2ffa0-136">Los archivos pueden tener las extensiones .bat, .cmd, .com o .exe.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-136">These files may have .bat, .cmd, .com, or .exe file extensions.</span></span>  
  
 <span data-ttu-id="2ffa0-137">Si utiliza un programa ejecutable o un comando del sistema operativo como paso de trabajo, debe especificar:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-137">When you use an executable program or an operating-system command as a job step, you must specify:</span></span>  
  
-   <span data-ttu-id="2ffa0-138">El código de salida del proceso que se devuelve si el comando se ha ejecutado correctamente.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-138">The process exit code returned if the command was successful.</span></span>  
  
-   <span data-ttu-id="2ffa0-139">El comando que se debe ejecutar.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-139">The command to execute.</span></span> <span data-ttu-id="2ffa0-140">Para ejecutar un comando del sistema operativo, se trata simplemente del propio comando.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-140">To execute an operating system command, this is simply the command itself.</span></span> <span data-ttu-id="2ffa0-141">En un programa externo, es el nombre del programa y los argumentos para el programa, por ejemplo: **C:\Archivos de programa\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span><span class="sxs-lookup"><span data-stu-id="2ffa0-141">For an external program, this is the name of the program and the arguments to the program, for example: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2ffa0-142">Debe proporcionar la ruta de acceso completa del archivo ejecutable si éste no se encuentra en un directorio especificado en la ruta de acceso del sistema o la ruta de acceso del usuario con el que se ejecuta el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-142">You must provide the full path to the executable if the executable is not located in a directory specified in the system path or the path for the user that the job step runs as.</span></span>  
  
## <a name="transact-sql-job-steps"></a><span data-ttu-id="2ffa0-143">Pasos de trabajo Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="2ffa0-143">Transact-SQL Job Steps</span></span>  
 <span data-ttu-id="2ffa0-144">Al crear un paso de trabajo de [!INCLUDE[tsql](../../includes/tsql-md.md)] , debe:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-144">When you create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step, you must:</span></span>  
  
-   <span data-ttu-id="2ffa0-145">Identificar la base de datos en la que se ejecutará el trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-145">Identify the database in which to run the job.</span></span>  
  
-   <span data-ttu-id="2ffa0-146">Escribir la instrucción [!INCLUDE[tsql](../../includes/tsql-md.md)] que se debe ejecutar.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-146">Type the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to execute.</span></span> <span data-ttu-id="2ffa0-147">La instrucción puede llamar a un procedimiento almacenado o un procedimiento almacenado extendido.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-147">The statement may call a stored procedure or an extended stored procedure.</span></span>  
  
 <span data-ttu-id="2ffa0-148">Opcionalmente, puede abrir un archivo [!INCLUDE[tsql](../../includes/tsql-md.md)] existente que actúe como comando para el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-148">Optionally, you can open an existing [!INCLUDE[tsql](../../includes/tsql-md.md)] file as the command for the job step.</span></span>  
  
 [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="2ffa0-149">los pasos de trabajo de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] no usan cuentas de proxy del Agente.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-149">job steps do not use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxies.</span></span> <span data-ttu-id="2ffa0-150">En lugar de ello, el paso de trabajo se ejecuta como el propietario del paso de trabajo, o como la cuenta de servicio del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] si el propietario del paso de trabajo es miembro del rol fijo de servidor sysadmin.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-150">Instead, the job step runs as the owner of the job step, or as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account if the owner of the job step is a member of the sysadmin fixed server role.</span></span> <span data-ttu-id="2ffa0-151">Los miembros del rol fijo de servidor sysadmin también pueden especificar que los pasos de trabajo de [!INCLUDE[tsql](../../includes/tsql-md.md)] se ejecuten en el contexto de otro usuario mediante el parámetro *database_user_name* del procedimiento almacenado sp_add_jobstep.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-151">Members of the sysadmin fixed server role can also specify that [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps run under the context of another user by using the *database_user_name* parameter of the sp_add_jobstep stored procedure.</span></span> <span data-ttu-id="2ffa0-152">Para obtener más información, vea [sp_add_jobstep &#40;&#41;de Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-152">For more information, see [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2ffa0-153">Un solo paso de trabajo de [!INCLUDE[tsql](../../includes/tsql-md.md)] puede contener varios lotes.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-153">A single [!INCLUDE[tsql](../../includes/tsql-md.md)] job step can contain multiple batches.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="2ffa0-154">los pasos de trabajo pueden contener comandos GO incrustados.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-154">job steps can contain embedded GO commands.</span></span>  
  
## <a name="powershell-scripting-job-steps"></a><span data-ttu-id="2ffa0-155">Pasos de trabajo de scripts de PowerShell</span><span class="sxs-lookup"><span data-stu-id="2ffa0-155">PowerShell Scripting Job Steps</span></span>  
 <span data-ttu-id="2ffa0-156">Al crear un paso de trabajo de script de PowerShell, es preciso especificar una de estas dos cosas como comando para dicho paso:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-156">When you create a PowerShell script job step, you must specify one of two things as the command for the step:</span></span>  
  
-   <span data-ttu-id="2ffa0-157">El texto de un script de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-157">The text of a PowerShell script.</span></span>  
  
-   <span data-ttu-id="2ffa0-158">El archivo de script de PowerShell que se desea abrir.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-158">An existing PowerShell script file to be opened.</span></span>  
  
 <span data-ttu-id="2ffa0-159">El [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] subsistema de PowerShell del agente abre una sesión de PowerShell y carga los [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Complementos de PowerShell. El script de PowerShell que se usa como comando de paso de trabajo puede hacer referencia al [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] proveedor y a los cmdlets de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell subsystem opens a PowerShell session and loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The PowerShell script used as the job step command can reference the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider and cmdlets.</span></span> <span data-ttu-id="2ffa0-160">Para más información sobre cómo escribir scripts de PowerShell mediante los complementos de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell, consulte [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-160">For more information about writing PowerShell scripts using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins, see the [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span></span>  
  
## <a name="activex-scripting-job-steps"></a><span data-ttu-id="2ffa0-161">Pasos de trabajo de scripts ActiveX</span><span class="sxs-lookup"><span data-stu-id="2ffa0-161">ActiveX Scripting Job Steps</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2ffa0-162">El paso de trabajo de scripts ActiveX se quitará del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en una versión futura de [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2ffa0-162">The ActiveX scripting job step will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2ffa0-163">Evite utilizar esta característica en nuevos trabajos de desarrollo y tenga previsto modificar las aplicaciones que actualmente la utilizan.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-163">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>  
  
 <span data-ttu-id="2ffa0-164">Al crear un paso de trabajo de scripts ActiveX, debe realizar las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-164">When you create an ActiveX scripting job step, you must:</span></span>  
  
-   <span data-ttu-id="2ffa0-165">Identificar el lenguaje de scripts en el que se ha escrito el paso de trabajo</span><span class="sxs-lookup"><span data-stu-id="2ffa0-165">Identify the scripting language in which the job step is written.</span></span>  
  
-   <span data-ttu-id="2ffa0-166">Escribir el script ActiveX</span><span class="sxs-lookup"><span data-stu-id="2ffa0-166">Write the ActiveX script.</span></span>  
  
 <span data-ttu-id="2ffa0-167">También puede abrir un archivo de scripts ActiveX existente y utilizarlo como comando para el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-167">You can also open an existing ActiveX script file as the command for the job step.</span></span> <span data-ttu-id="2ffa0-168">Opcionalmente, los comandos de los scripts ActiveX se pueden compilar externamente (por ejemplo, mediante Microsoft Visual Basic) y, después, ejecutarse como programas ejecutables.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-168">Alternatively, ActiveX script commands can be externally compiled (for example, using Microsoft Visual Basic) and then run as executable programs.</span></span>  
  
 <span data-ttu-id="2ffa0-169">Si el comando del paso de trabajo es un script ActiveX, puede utilizar el objeto SQLActiveScriptHost para imprimir la salida en el registro de historial del paso de trabajo o para crear objetos COM.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-169">When a job step command is an ActiveX script, you can use the SQLActiveScriptHost object to print output to the job step history log or create COM objects.</span></span> <span data-ttu-id="2ffa0-170">SQLActiveScriptHost es un objeto global que el sistema host del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] introduce en el espacio de nombres de scripts.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-170">SQLActiveScriptHost is a global object that is introduced by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent hosting system into the script name space.</span></span> <span data-ttu-id="2ffa0-171">El objeto tiene dos métodos (Print y CreateObject).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-171">The object has two methods (Print and CreateObject).</span></span> <span data-ttu-id="2ffa0-172">En el siguiente ejemplo se muestra cómo funcionan los scripts ActiveX en Visual Basic Scripting Edition (VBScript).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-172">The following example shows how ActiveX scripting works in Visual Basic Scripting Edition (VBScript).</span></span>  
  
```  
' VBScript example for ActiveX Scripting job step  
' Create a Dmo.Server object. The object connects to the  
' server on which the script is running.  
  
Set oServer = CreateObject("SQLDmo.SqlServer")  
oServer.LoginSecure = True  
oServer.Connect "(local)"  
'Disconnect and destroy the server object  
oServer.DisConnect  
Set oServer = nothing
```  
  
## <a name="replication-job-steps"></a><span data-ttu-id="2ffa0-173">Pasos de trabajos de replicación</span><span class="sxs-lookup"><span data-stu-id="2ffa0-173">Replication Job Steps</span></span>  
 <span data-ttu-id="2ffa0-174">Si crea publicaciones y suscripciones con replicación, se crean trabajos de replicación de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-174">When you create publications and subscriptions using replication, replication jobs are created by default.</span></span> <span data-ttu-id="2ffa0-175">El tipo de replicación (de instantáneas, transaccional o de mezcla) y las opciones utilizadas determinan el tipo de trabajo que se crea.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-175">The type of job created is determined by the type of replication (snapshot, transactional, or merge) and the options used.</span></span>  
  
 <span data-ttu-id="2ffa0-176">Los pasos de trabajo de replicación activan uno de los siguientes agentes de réplica:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-176">Replication job steps activate one of these replication agents:</span></span>  
  
-   <span data-ttu-id="2ffa0-177">Agente de instantáneas (trabajo Instantánea)</span><span class="sxs-lookup"><span data-stu-id="2ffa0-177">Snapshot Agent (Snapshot job)</span></span>  
  
-   <span data-ttu-id="2ffa0-178">Agente de registro del LOG  (trabajo Lector del registro)</span><span class="sxs-lookup"><span data-stu-id="2ffa0-178">Log Reader Agent (LogReader job)</span></span>  
  
-   <span data-ttu-id="2ffa0-179">Agente de distribución (trabajo Distribución)</span><span class="sxs-lookup"><span data-stu-id="2ffa0-179">Distribution Agent (Distribution job)</span></span>  
  
-   <span data-ttu-id="2ffa0-180">Agente de mezcla (trabajo Mezcla)</span><span class="sxs-lookup"><span data-stu-id="2ffa0-180">Merge Agent (Merge job)</span></span>  
  
-   <span data-ttu-id="2ffa0-181">Agente de lectura de cola (trabajo Lectura de cola)</span><span class="sxs-lookup"><span data-stu-id="2ffa0-181">Queue Reader Agent (QueueReader job)</span></span>  
  
 <span data-ttu-id="2ffa0-182">Cuando esté configurada la replicación, puede especificar que los agentes de replicación se ejecuten de una de estas tres maneras: continuamente tras iniciar el Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , a petición o según una programación.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-182">When replication is set up, you can specify to run the replication agents in one of three ways: continuously after [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is started, on demand, or according to a schedule.</span></span> <span data-ttu-id="2ffa0-183">Para más información sobre los agentes de replicación, consulte [Información general sobre los agentes de replicación](../../relational-databases/replication/agents/replication-agents-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-183">For more information about replication agents, see [Replication Agents Overview](../../relational-databases/replication/agents/replication-agents-overview.md).</span></span>  
  
## <a name="analysis-services-job-steps"></a><span data-ttu-id="2ffa0-184">Pasos de trabajo de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="2ffa0-184">Analysis Services Job Steps</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2ffa0-185">El Agente admite dos tipos distintos de pasos de trabajo de Analysis Services: pasos de trabajo de comando y pasos de trabajo de consulta.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-185">Agent supports two distinct types of Analysis Services job steps, command job steps, and query job steps.</span></span>  
  
### <a name="analysis-services-command-job-steps"></a><span data-ttu-id="2ffa0-186">Pasos de trabajo de comando de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="2ffa0-186">Analysis Services Command Job Steps</span></span>  
 <span data-ttu-id="2ffa0-187">Al crear un paso de trabajo de comando de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , debe:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-187">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command job step, you must:</span></span>  
  
-   <span data-ttu-id="2ffa0-188">Identificar el servidor OLAP de la base de datos en el que se ejecutará el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-188">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="2ffa0-189">Escribir la instrucción que se debe ejecutar.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-189">Type the statement to execute.</span></span> <span data-ttu-id="2ffa0-190">Esta instrucción debe ser XML para el método [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute**.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-190">The statement must be an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute** method.</span></span> <span data-ttu-id="2ffa0-191">Puede que la instrucción no contenga un elemento SOAP completo o un XML para el método [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover**.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-191">The statement may not contain a complete SOAP envelope or an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover** method.</span></span> <span data-ttu-id="2ffa0-192">Observe que, mientras que [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] es compatible con los sobres SOAP completos y con el método **Discover** , los pasos de trabajo del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] no lo son.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-192">Notice that, while [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports complete SOAP envelopes and the **Discover** method, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps do not.</span></span>  
  
### <a name="analysis-services-query-job-steps"></a><span data-ttu-id="2ffa0-193">Pasos de trabajo de consulta de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="2ffa0-193">Analysis Services Query Job Steps</span></span>  
 <span data-ttu-id="2ffa0-194">Al crear un paso de trabajo de consulta de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , debe:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-194">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query job step, you must:</span></span>  
  
-   <span data-ttu-id="2ffa0-195">Identificar el servidor OLAP de la base de datos en el que se ejecutará el paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-195">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="2ffa0-196">Escribir la instrucción que se debe ejecutar.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-196">Type the statement to execute.</span></span> <span data-ttu-id="2ffa0-197">La instrucción debe ser una consulta de expresiones multidimensionales (MDX).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-197">The statement must be a multidimensional expressions (MDX) query.</span></span>  
  
 <span data-ttu-id="2ffa0-198">Para obtener más información sobre MDX, consulte [aspectos básicos de las consultas mdx &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-198">For more information on MDX, see [MDX Query Fundamentals &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span></span>  
  
## <a name="integration-services-packages"></a><span data-ttu-id="2ffa0-199">Paquetes de Integration Services</span><span class="sxs-lookup"><span data-stu-id="2ffa0-199">Integration Services Packages</span></span>  
 <span data-ttu-id="2ffa0-200">Al crear un paso de trabajo de paquete de [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , debe realizar las operaciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="2ffa0-200">When you create an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step, you must do the following:</span></span>  
  
-   <span data-ttu-id="2ffa0-201">Identificar el origen del paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-201">Identify the source of the package.</span></span>  
  
-   <span data-ttu-id="2ffa0-202">Identificar la ubicación del paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-202">Identify the location of the package.</span></span>  
  
-   <span data-ttu-id="2ffa0-203">Identificar los archivos de configuración si son necesarios para el paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-203">If configuration files are required for the package, identify the configuration files.</span></span>  
  
-   <span data-ttu-id="2ffa0-204">Identificar los archivos de comandos si son necesarios para el paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-204">If command files are required for the package, identify the command files.</span></span>  
  
-   <span data-ttu-id="2ffa0-205">Identificar la comprobación que se debe utilizar para el paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-205">Identify the verification to use for the package.</span></span> <span data-ttu-id="2ffa0-206">Por ejemplo, puede especificar que el paquete debe estar firmado o que debe tener un Id. de paquete específico.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-206">For example, you can specify that the package must be signed, or that the package must have a specific package ID.</span></span>  
  
-   <span data-ttu-id="2ffa0-207">Identificar los orígenes de datos del paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-207">Identify the data sources for the package.</span></span>  
  
-   <span data-ttu-id="2ffa0-208">Identificar los proveedores de registro del paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-208">Identify the log providers for the package.</span></span>  
  
-   <span data-ttu-id="2ffa0-209">Especificar las variables y los valores que se deben establecer para ejecutar el paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-209">Specify variables and values to set before running the package.</span></span>  
  
-   <span data-ttu-id="2ffa0-210">Identificar las opciones de ejecución.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-210">Identify execution options.</span></span>  
  
-   <span data-ttu-id="2ffa0-211">Agregar o modificar las opciones de línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-211">Add or modify command-line options.</span></span>  
  
 <span data-ttu-id="2ffa0-212">Tenga en cuenta que si implementó el paquete en el catálogo de SSIS y especifica **Catálogo de SSIS** como origen del paquete, gran parte de esta información de configuración se obtiene automáticamente del paquete.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-212">Note that if you deployed the package to the SSIS Catalog and you specify **SSIS Catalog** as the package source, much of this configuration information is obtained automatically from the package.</span></span> <span data-ttu-id="2ffa0-213">En la pestaña **Configuración** puede especificar el entorno, los valores de parámetro, los valores del administrador de conexiones, las invalidaciones de propiedad y si el paquete se ejecuta en un entorno en tiempo de ejecución de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-213">Under the **Configuration** tab you can specify the environment, parameter values, connection manager values, property overrides, and whether the package runs in a 32-bit runtime environment.</span></span>  
  
 <span data-ttu-id="2ffa0-214">Para más información sobre cómo crear pasos de trabajo que ejecutan paquetes de [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , consulte [Trabajos del Agente SQL Server para paquetes](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span><span class="sxs-lookup"><span data-stu-id="2ffa0-214">For more information about creating job steps that run [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [SQL Server Agent Jobs for Packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="2ffa0-215">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="2ffa0-215">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="2ffa0-216">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="2ffa0-216">**Description**</span></span>|<span data-ttu-id="2ffa0-217">**Tema.**</span><span class="sxs-lookup"><span data-stu-id="2ffa0-217">**Topic**</span></span>|  
|<span data-ttu-id="2ffa0-218">Describe cómo crear un paso de trabajo con un programa ejecutable.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-218">Describes how to create a job step with an executable program.</span></span>|[<span data-ttu-id="2ffa0-219">Crear un paso de trabajo CmdExec</span><span class="sxs-lookup"><span data-stu-id="2ffa0-219">Create a CmdExec Job Step</span></span>](create-a-cmdexec-job-step.md)|  
|<span data-ttu-id="2ffa0-220">Describe cómo restablecer los permisos del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2ffa0-220">Describes how to reset [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent permissions.</span></span>|[<span data-ttu-id="2ffa0-221">Configure a User to Create and Manage SQL Server Agent Jobs</span><span class="sxs-lookup"><span data-stu-id="2ffa0-221">Configure a User to Create and Manage SQL Server Agent Jobs</span></span>](configure-a-user-to-create-and-manage-sql-server-agent-jobs.md)|  
|<span data-ttu-id="2ffa0-222">Describe cómo crear un paso de trabajo de [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2ffa0-222">Describes how to create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step.</span></span>|[<span data-ttu-id="2ffa0-223">Create a Transact-SQL Job Step</span><span class="sxs-lookup"><span data-stu-id="2ffa0-223">Create a Transact-SQL Job Step</span></span>](create-a-transact-sql-job-step.md)|  
|<span data-ttu-id="2ffa0-224">Describe cómo definir opciones para los pasos de trabajo Transact-SQL del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-224">Describes how to define options for Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Transact-SQL job steps.</span></span>|[<span data-ttu-id="2ffa0-225">Define Transact-SQL Job Step Options</span><span class="sxs-lookup"><span data-stu-id="2ffa0-225">Define Transact-SQL Job Step Options</span></span>](define-transact-sql-job-step-options.md)|  
|<span data-ttu-id="2ffa0-226">Describe cómo crear un paso de trabajo de script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-226">Describes how to create an ActiveX script job step.</span></span>|[<span data-ttu-id="2ffa0-227">Create an ActiveX Script Job Step</span><span class="sxs-lookup"><span data-stu-id="2ffa0-227">Create an ActiveX Script Job Step</span></span>](create-an-activex-script-job-step.md)|  
|<span data-ttu-id="2ffa0-228">Describe cómo crear y definir pasos de trabajo del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] que ejecutan comandos y consultas de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-228">Describes how to create and define [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps that execute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services commands and queries.</span></span>|[<span data-ttu-id="2ffa0-229">Create an Analysis Services Job Step</span><span class="sxs-lookup"><span data-stu-id="2ffa0-229">Create an Analysis Services Job Step</span></span>](create-an-analysis-services-job-step.md)|  
|<span data-ttu-id="2ffa0-230">Describe la acción que [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] debe realizar si se produce un error durante la ejecución del trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-230">Describes what action [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should take if a failure occurs during job execution.</span></span>|[<span data-ttu-id="2ffa0-231">Set Job Step Success or Failure Flow</span><span class="sxs-lookup"><span data-stu-id="2ffa0-231">Set Job Step Success or Failure Flow</span></span>](set-job-step-success-or-failure-flow.md)|  
|<span data-ttu-id="2ffa0-232">Describe cómo ver detalles de pasos de trabajo en el cuadro de diálogo Propiedades de paso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="2ffa0-232">Describes how to view job step details in the Job Step Properties dialog.</span></span>|[<span data-ttu-id="2ffa0-233">View Job Step Information</span><span class="sxs-lookup"><span data-stu-id="2ffa0-233">View Job Step Information</span></span>](view-job-step-information.md)|  
|<span data-ttu-id="2ffa0-234">Describe cómo eliminar un registro de pasos de trabajo del Agente [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2ffa0-234">Describes how to delete a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job step log.</span></span>|[<span data-ttu-id="2ffa0-235">Delete a Job Step Log</span><span class="sxs-lookup"><span data-stu-id="2ffa0-235">Delete a Job Step Log</span></span>](delete-a-job-step-log.md)|  
  
## <a name="see-also"></a><span data-ttu-id="2ffa0-236">Consulte también</span><span class="sxs-lookup"><span data-stu-id="2ffa0-236">See Also</span></span>  
 <span data-ttu-id="2ffa0-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="2ffa0-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span></span>  
 <span data-ttu-id="2ffa0-238">[Crear trabajos](create-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="2ffa0-238">[Create Jobs](create-jobs.md) </span></span>  
 [<span data-ttu-id="2ffa0-239">sp_add_job &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="2ffa0-239">sp_add_job &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql)  
