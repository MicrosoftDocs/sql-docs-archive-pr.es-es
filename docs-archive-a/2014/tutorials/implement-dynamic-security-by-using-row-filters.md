---
title: Implementar la seguridad dinámica mediante filtros de fila | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 8bf03c45-caf5-4eda-9314-e4f8f24a159f
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: 09a15f818f57d7a9d808c89ced41b285536a7883
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87663238"
---
# <a name="implement-dynamic-security-by-using-row-filters"></a><span data-ttu-id="f7603-102">Implementar seguridad dinámica utilizando filtros de filas</span><span class="sxs-lookup"><span data-stu-id="f7603-102">Implement Dynamic Security by Using Row Filters</span></span>
  <span data-ttu-id="f7603-103">En esta lección complementaria, creará un rol adicional que implemente seguridad dinámica.</span><span class="sxs-lookup"><span data-stu-id="f7603-103">In this supplemental lesson, you will create an additional role that implements dynamic security.</span></span> <span data-ttu-id="f7603-104">La seguridad dinámica proporciona seguridad de nivel de fila en función del identificador de inicio de sesión o del nombre de usuario de la persona que tenga la sesión iniciada.</span><span class="sxs-lookup"><span data-stu-id="f7603-104">Dynamic security provides row-level security based on the user name or login id of the user currently logged on.</span></span> <span data-ttu-id="f7603-105">Para obtener más información, consulte [Roles &#40;SSAS tabular&#41;](https://docs.microsoft.com/analysis-services/tabular-models/roles-ssas-tabular).</span><span class="sxs-lookup"><span data-stu-id="f7603-105">To learn more, see [Roles &#40;SSAS Tabular&#41;](https://docs.microsoft.com/analysis-services/tabular-models/roles-ssas-tabular).</span></span>  
  
 <span data-ttu-id="f7603-106">Para implementar la seguridad dinámica, debe agregar una tabla al modelo que contiene los nombres de usuario de Windows de los usuarios que pueden crear una conexión al modelo como un origen de datos y examinar los objetos y datos del modelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-106">To implement dynamic security, you must add a table to your model containing the Windows user names of those users that can create a connection to the model as a data source and browse model objects and data.</span></span> <span data-ttu-id="f7603-107">El modelo que se crea con este tutorial está en el contexto de Adventure Works Corp.; sin embargo, para completar esta lección, debe agregar una tabla que contenga usuarios de su propio dominio.</span><span class="sxs-lookup"><span data-stu-id="f7603-107">The model you create using this tutorial is in the context of Adventure Works Corp.; however, in order to complete this lesson, you must add a table containing users from your own domain.</span></span> <span data-ttu-id="f7603-108">No necesitará contraseñas para los nombres de usuario que se van a agregar.</span><span class="sxs-lookup"><span data-stu-id="f7603-108">You will not need the passwords for the user names that will be added.</span></span> <span data-ttu-id="f7603-109">Para crear una tabla de seguridad de empleados, con una pequeña muestra de usuarios de su propio dominio, utilizará la función de pegar para pegar datos de empleados de una hoja de cálculo de Excel.</span><span class="sxs-lookup"><span data-stu-id="f7603-109">To create an Employee Security table, with a small sample of users from your own domain, you will use the Paste feature, pasting employee data from an Excel spreadsheet.</span></span> <span data-ttu-id="f7603-110">En un escenario real, la tabla que contiene los nombres de usuario que agrega a un modelo utilizaría normalmente una tabla de una base de datos real como origen de datos; por ejemplo, una tabla dimEmployee real.</span><span class="sxs-lookup"><span data-stu-id="f7603-110">In a real-world scenario, the table containing user names you add to a model would typically use a table from an actual database as a data source; for example, a real dimEmployee table.</span></span>  
  
 <span data-ttu-id="f7603-111">Para implementar la seguridad dinámica, usará dos nuevas funciones de DAX: función de [nombre de usuario &#40;&#41;Dax](/dax/username-function-dax) y [función VALORBUSCAR &#40;&#41;Dax ](/dax/lookupvalue-function-dax).</span><span class="sxs-lookup"><span data-stu-id="f7603-111">In order to implement dynamic security, you will use two new DAX functions: [USERNAME Function &#40;DAX&#41;](/dax/username-function-dax) and [LOOKUPVALUE Function &#40;DAX&#41;](/dax/lookupvalue-function-dax).</span></span> <span data-ttu-id="f7603-112">Estas funciones, aplicadas en una fórmula de filtro de fila, se definen en un nuevo rol.</span><span class="sxs-lookup"><span data-stu-id="f7603-112">These functions, applied in a row filter formula, are defined in a new role.</span></span> <span data-ttu-id="f7603-113">Con la función LOOKUPVALUE, la fórmula especifica un valor de la tabla Employee Security y pasa ese valor a la función USERNAME, que especifica el nombre del usuario que ha iniciado sesión como perteneciente a este rol.</span><span class="sxs-lookup"><span data-stu-id="f7603-113">Using the LOOKUPVALUE function, the formula specifies a value from the Employee Security table and then passes that value to the USERNAME function, which specifies the user name of the user logged on belongs to this role.</span></span> <span data-ttu-id="f7603-114">El usuario puede examinar solo los datos especificados por los filtros de fila del rol.</span><span class="sxs-lookup"><span data-stu-id="f7603-114">The user can then browse only data specified by the role's row filters.</span></span> <span data-ttu-id="f7603-115">En este escenario, especificará que los empleados de ventas solo podrán examinar los datos de ventas por Internet de los territorios de ventas de los que son miembros.</span><span class="sxs-lookup"><span data-stu-id="f7603-115">In this scenario, you will specify that sales employees can only browse internet sales data for the sales territories in which they are a member.</span></span>  
  
 <span data-ttu-id="f7603-116">Para completar esta lección complementaria, realizará una serie de tareas.</span><span class="sxs-lookup"><span data-stu-id="f7603-116">In order to complete this supplemental lesson, you will complete a series of tasks.</span></span> <span data-ttu-id="f7603-117">Las tareas que solo se realizan en este escenario de modelo tabular de Adventure Works, pero no que se aplicarían necesariamente a un escenario real, se identifican como tales.</span><span class="sxs-lookup"><span data-stu-id="f7603-117">Those tasks that are unique to this Adventure Works tabular model scenario, but would not necessarily apply to a real-world scenario are identified as such.</span></span> <span data-ttu-id="f7603-118">Cada tarea incluye información adicional que describe el propósito de la tarea.</span><span class="sxs-lookup"><span data-stu-id="f7603-118">Each task includes additional information describing the purpose of the task.</span></span>  
  
 <span data-ttu-id="f7603-119">Tiempo estimado para completar esta lección: **30 minutos**</span><span class="sxs-lookup"><span data-stu-id="f7603-119">Estimated time to complete this lesson: **30 minutes**</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="f7603-120">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="f7603-120">Prerequisites</span></span>  
 <span data-ttu-id="f7603-121">Este tema de la lección complementaria forma parte de un tutorial de modelado tabular, que debe completar en orden.</span><span class="sxs-lookup"><span data-stu-id="f7603-121">This supplemental lesson topic is part of a tabular modeling tutorial, which should be completed in order.</span></span> <span data-ttu-id="f7603-122">Antes de realizar las tareas de esta lección complementaria, debe haber completado todas las lecciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="f7603-122">Before performing the tasks in this supplemental lesson, you should have completed all previous lessons.</span></span>  
  
## <a name="add-the-dimsalesterritory-table-to-the-aw-internet-sales-tabular-model-project"></a><span data-ttu-id="f7603-123">Agregar la tabla dimSalesTerritory al proyecto de modelo tabular AW Internet Sales</span><span class="sxs-lookup"><span data-stu-id="f7603-123">Add the dimSalesTerritory table to the AW Internet Sales Tabular Model Project</span></span>  
 <span data-ttu-id="f7603-124">Para implementar la seguridad dinámica en este escenario de ejemplo Adventure Works, debe agregar dos tablas adicionales al modelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-124">In order to implement dynamic security for this Adventure Works scenario, you must add two additional tables to your model.</span></span> <span data-ttu-id="f7603-125">La primera tabla que agregará es dimSalesTerritory (como Sales Territory) procedente de la misma base de datos AdventureWorksDW.</span><span class="sxs-lookup"><span data-stu-id="f7603-125">The first table you will add is dimSalesTerritory (as Sales Territory) from the same AdventureWorksDW database.</span></span> <span data-ttu-id="f7603-126">Aplicará posteriormente un filtro de fila a la tabla Sales Territory que define los datos concretos que el usuario que ha iniciado sesión puede examinar.</span><span class="sxs-lookup"><span data-stu-id="f7603-126">You will later apply a row filter to the Sales Territory table that defines the particular data the logged on user can browse.</span></span>  
  
#### <a name="to-add-the-dimsalesterritory-table"></a><span data-ttu-id="f7603-127">Para agregar la tabla dimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="f7603-127">To add the dimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="f7603-128">En [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], haga clic en el menú **Modelo** y, a continuación, en **Conexiones existentes**.</span><span class="sxs-lookup"><span data-stu-id="f7603-128">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click on the **Model** menu, and then click **Existing Connections**.</span></span>  
  
2.  <span data-ttu-id="f7603-129">En el cuadro de diálogo **Conexiones existentes** , compruebe que esté seleccionada la conexión al origen de datos **BD de Adventure Works de SQL** y haga clic en **Abrir**.</span><span class="sxs-lookup"><span data-stu-id="f7603-129">In the **Existing Connections** dialog box, verify the **Adventure Works DB from SQL** data source connection is selected, and then click **Open**.</span></span>  
  
     <span data-ttu-id="f7603-130">Si aparece el cuadro de diálogo Credenciales de suplantación, escriba las credenciales de suplantación que usó en la lección 2 sobre incorporación de datos.</span><span class="sxs-lookup"><span data-stu-id="f7603-130">If the Impersonation Credentials dialog box appears, type the impersonation credentials you used in Lesson 2: Add Data.</span></span>  
  
3.  <span data-ttu-id="f7603-131">En la página **Elegir cómo importar los datos** , deje seleccionada la opción **Seleccionar en una lista de tablas y vistas para elegir los datos a importar** y haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="f7603-131">On the **Choose How to Import the Data** page, leave **Select from a list of tables and views to choose the data to import** selected, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="f7603-132">En la página **Seleccionar tablas y vistas** , seleccione la tabla **DimSalesTerritory** .</span><span class="sxs-lookup"><span data-stu-id="f7603-132">On the **Select Tables and Views** page, select the **DimSalesTerritory** table.</span></span>  
  
5.  <span data-ttu-id="f7603-133">En la columna Nombre descriptivo, escriba **Sales Territory**.</span><span class="sxs-lookup"><span data-stu-id="f7603-133">In the Friendly Name column, type **Sales Territory**.</span></span>  
  
6.  <span data-ttu-id="f7603-134">Haga clic en **Vista previa y filtro**.</span><span class="sxs-lookup"><span data-stu-id="f7603-134">Click **Preview and Filter**.</span></span>  
  
7.  <span data-ttu-id="f7603-135">Anule la selección de la columna **SalesTerritoryAlternateKey** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-135">Deselect the **SalesTerritoryAlternateKey** column, and then click **Ok**.</span></span>  
  
8.  <span data-ttu-id="f7603-136">En la página **Seleccionar tablas y vistas** , haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-136">On the **Select Tables and Views** page, click **Finish**.</span></span>  
  
     <span data-ttu-id="f7603-137">Las nueva tabla se agregarán al final del área de trabajo del modelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-137">The new table will be added to the model workspace.</span></span> <span data-ttu-id="f7603-138">Los objetos y datos de la tabla de origen dimSalesTerritory se importan a la nueva tabla Sales Territory del modelo tabular AW Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="f7603-138">Objects and data from the source dimSalesTerritory table are then imported into the new Sales Territory table in your AW Internet Sales Tabular Model.</span></span>  
  
9. <span data-ttu-id="f7603-139">Una vez importada la tabla, haga clic en **Cerrar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-139">After the table has been imported, click **Close**.</span></span>  
  
## <a name="give-the-columns-friendly-names"></a><span data-ttu-id="f7603-140">Proporcionar nombres descriptivos a las columnas</span><span class="sxs-lookup"><span data-stu-id="f7603-140">Give the Columns Friendly Names</span></span>  
 <span data-ttu-id="f7603-141">En esta tarea, cambiará el nombre de las columnas de la tabla Sales Territory para darles un nombre descriptivo.</span><span class="sxs-lookup"><span data-stu-id="f7603-141">In this task, you will rename the columns in the Sales Territory table, giving them friendly names.</span></span> <span data-ttu-id="f7603-142">No siempre es necesario proporcionar nombres descriptivos de tablas y/o columnas; sin embargo, facilita la navegación de su proyecto de modelo por el diseñador de modelos y los usuarios pueden explorar más fácilmente los objetos y los datos del modelo en una lista de campos de la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7603-142">It is not always necessary to give tables and/or columns friendly names; however, it does make your model project easier to navigate in the model designer as well as for users browsing model objects and data in a client application field list.</span></span>  
  
#### <a name="to-rename-columns-in-the-sales-territory-table"></a><span data-ttu-id="f7603-143">Para cambiar el nombre de las columnas de la tabla Sales Territory</span><span class="sxs-lookup"><span data-stu-id="f7603-143">To rename Columns in the Sales Territory Table</span></span>  
  
-   <span data-ttu-id="f7603-144">En el diseñador de modelos, cambie el nombre a las columnas de la tabla **Sales Territory** :</span><span class="sxs-lookup"><span data-stu-id="f7603-144">In the model designer, rename the columns in the **Sales Territory** table:</span></span>  
  
     <span data-ttu-id="f7603-145">**Sales Territory**</span><span class="sxs-lookup"><span data-stu-id="f7603-145">**Sales Territory**</span></span>  
  
    |<span data-ttu-id="f7603-146">Nombre de origen</span><span class="sxs-lookup"><span data-stu-id="f7603-146">Source Name</span></span>|<span data-ttu-id="f7603-147">Nombre descriptivo</span><span class="sxs-lookup"><span data-stu-id="f7603-147">Friendly Name</span></span>|  
    |-----------------|-------------------|  
    |<span data-ttu-id="f7603-148">SalesTerritoryKey</span><span class="sxs-lookup"><span data-stu-id="f7603-148">SalesTerritoryKey</span></span>|<span data-ttu-id="f7603-149">Sales Territory Id</span><span class="sxs-lookup"><span data-stu-id="f7603-149">Sales Territory Id</span></span>|  
    |<span data-ttu-id="f7603-150">SalesTerritoryRegion</span><span class="sxs-lookup"><span data-stu-id="f7603-150">SalesTerritoryRegion</span></span>|<span data-ttu-id="f7603-151">Región del territorio de ventas</span><span class="sxs-lookup"><span data-stu-id="f7603-151">Sales Territory Region</span></span>|  
    |<span data-ttu-id="f7603-152">SalesTerritoryCountry</span><span class="sxs-lookup"><span data-stu-id="f7603-152">SalesTerritoryCountry</span></span>|<span data-ttu-id="f7603-153">País del territorio de ventas</span><span class="sxs-lookup"><span data-stu-id="f7603-153">Sales Territory Country</span></span>|  
    |<span data-ttu-id="f7603-154">SalesTerritoryGroup</span><span class="sxs-lookup"><span data-stu-id="f7603-154">SalesTerritoryGroup</span></span>|<span data-ttu-id="f7603-155">Grupo de territorios de ventas</span><span class="sxs-lookup"><span data-stu-id="f7603-155">Sales Territory Group</span></span>|  
  
## <a name="add-a-table-with-user-name-data"></a><span data-ttu-id="f7603-156">Incorporación de una tabla con datos de nombres de usuario</span><span class="sxs-lookup"><span data-stu-id="f7603-156">Add a table with user name data</span></span>  
 <span data-ttu-id="f7603-157">Puesto que la tabla dimEmployee de la base de datos de ejemplo AdventureWorksDW contiene usuarios del dominio AdventureWorks, y esos nombres de usuario no existen en su propio entorno, debe crear una tabla en el modelo que contenga una pequeña muestra (tres) de usuarios reales de su organización.</span><span class="sxs-lookup"><span data-stu-id="f7603-157">Because the dimEmployee table in the AdventureWorksDW sample database contains users from the AdventureWorks domain, and those user names do not exist in your own environment, you must create a table in your model that contains a small sample (three) of actual users from your organization.</span></span> <span data-ttu-id="f7603-158">Agregará después estos usuarios al nuevo rol como miembros.</span><span class="sxs-lookup"><span data-stu-id="f7603-158">You will then add these users as members to the new role.</span></span> <span data-ttu-id="f7603-159">No necesita las contraseñas de los nombres de usuario de ejemplo, pero necesitará nombres de usuario de Windows reales de su propio dominio.</span><span class="sxs-lookup"><span data-stu-id="f7603-159">You do not need the passwords for the sample user names, but you will need actual Windows user names from your own domain.</span></span>  
  
#### <a name="to-add-an-employee-security-table"></a><span data-ttu-id="f7603-160">Para agregar una tabla de seguridad de empleados</span><span class="sxs-lookup"><span data-stu-id="f7603-160">To add an Employee Security table</span></span>  
  
1.  <span data-ttu-id="f7603-161">Abra Microsoft Excel para crear una hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="f7603-161">Open Microsoft Excel, creating a new worksheet.</span></span>  
  
2.  <span data-ttu-id="f7603-162">Copie la siguiente tabla, incluida la fila de encabezado y, luego, péguela en la hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="f7603-162">Copy the following table, including the header row, and then paste it into the worksheet.</span></span>  
  
    |<span data-ttu-id="f7603-163">Employee Id</span><span class="sxs-lookup"><span data-stu-id="f7603-163">Employee Id</span></span>|<span data-ttu-id="f7603-164">Sales Territory Id</span><span class="sxs-lookup"><span data-stu-id="f7603-164">Sales Territory Id</span></span>|<span data-ttu-id="f7603-165">Nombre</span><span class="sxs-lookup"><span data-stu-id="f7603-165">First Name</span></span>|<span data-ttu-id="f7603-166">Apellido</span><span class="sxs-lookup"><span data-stu-id="f7603-166">Last Name</span></span>|<span data-ttu-id="f7603-167">Login Id</span><span class="sxs-lookup"><span data-stu-id="f7603-167">Login Id</span></span>|  
    |-----------------|------------------------|----------------|---------------|--------------|  
    |<span data-ttu-id="f7603-168">1</span><span class="sxs-lookup"><span data-stu-id="f7603-168">1</span></span>|<span data-ttu-id="f7603-169">2</span><span class="sxs-lookup"><span data-stu-id="f7603-169">2</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
    |<span data-ttu-id="f7603-170">1</span><span class="sxs-lookup"><span data-stu-id="f7603-170">1</span></span>|<span data-ttu-id="f7603-171">3</span><span class="sxs-lookup"><span data-stu-id="f7603-171">3</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
    |<span data-ttu-id="f7603-172">2</span><span class="sxs-lookup"><span data-stu-id="f7603-172">2</span></span>|<span data-ttu-id="f7603-173">4</span><span class="sxs-lookup"><span data-stu-id="f7603-173">4</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
    |<span data-ttu-id="f7603-174">3</span><span class="sxs-lookup"><span data-stu-id="f7603-174">3</span></span>|<span data-ttu-id="f7603-175">5</span><span class="sxs-lookup"><span data-stu-id="f7603-175">5</span></span>|\<user first name>|\<user last name>|\<domain\username>|  
  
3.  <span data-ttu-id="f7603-176">En la nueva hoja de cálculo, reemplace el nombre, el apellido, y el dominio\nombreUsuario con los nombres y los id. de inicio de sesión de tres usuarios de su organización.</span><span class="sxs-lookup"><span data-stu-id="f7603-176">In the new worksheet, replace the first name, last name, and domain\username with the names and login ids of three users in your organization.</span></span> <span data-ttu-id="f7603-177">Coloque el mismo usuario en las dos primeras filas, para el Employee Id 1.</span><span class="sxs-lookup"><span data-stu-id="f7603-177">Put the same user on the first two rows, for Employee Id 1.</span></span> <span data-ttu-id="f7603-178">Esto mostrará que este usuario pertenece a más de un territorio de ventas.</span><span class="sxs-lookup"><span data-stu-id="f7603-178">This will show this user belongs to more than one sales territory.</span></span> <span data-ttu-id="f7603-179">Deje los campos Employee Id y Sales Territory Id como están.</span><span class="sxs-lookup"><span data-stu-id="f7603-179">Leave the Employee Id and Sales Territory Id fields as they are.</span></span>  
  
4.  <span data-ttu-id="f7603-180">Guarde la hoja de cálculo como `Sample Employee` .</span><span class="sxs-lookup"><span data-stu-id="f7603-180">Save the worksheet as `Sample Employee`.</span></span>  
  
5.  <span data-ttu-id="f7603-181">En la hoja de cálculo, seleccione todas las celdas con datos de empleados, incluidos los encabezados, haga clic con el botón derecho en los datos seleccionados y, después, haga clic en **Copiar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-181">In the worksheet, select all of the cells with employee data, including the headers, then right click the selected data, and then click **Copy**.</span></span>  
  
6.  <span data-ttu-id="f7603-182">En [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], haga clic en el menú **Edición** y, después, en **Pegar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-182">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click the **Edit** menu, and then click **Paste**.</span></span>  
  
     <span data-ttu-id="f7603-183">Si la opción Pegar aparece deshabilitada, haga clic en cualquier columna de una tabla de la ventana del diseñador de modelos, haga clic en el menú **Edición** y, después, haga clic en **Pegar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-183">If Paste is greyed out, click any column in any table in the model designer window, and then click the **Edit** menu, and then click **Paste**.</span></span>  
  
7.  <span data-ttu-id="f7603-184">En el cuadro de diálogo **vista previa de pegado** , en **nombre de tabla**, escriba `Employee Security` .</span><span class="sxs-lookup"><span data-stu-id="f7603-184">In the **Paste Preview** dialog box, in **Table Name**, type `Employee Security`.</span></span>  
  
8.  <span data-ttu-id="f7603-185">En **Datos que se van a pegar**, compruebe que los datos incluyen todos los datos y encabezados de usuario de la hoja de cálculo Empleado de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="f7603-185">In **Data to be pasted**, verify the data includes all of the user data and headers from the Sample Employee worksheet.</span></span>  
  
9. <span data-ttu-id="f7603-186">Compruebe que la casilla **Usar primera fila como encabezados de columna** está activada y, luego, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-186">Verify **Use first row as column headers** is checked, and then click **Ok**.</span></span>  
  
     <span data-ttu-id="f7603-187">Se crea una nueva tabla denominada Employee Security con los datos de empleado copiados de la hoja de cálculo Empleado de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="f7603-187">A new table named Employee Security with employee data copied from the Sample Employee worksheet is created.</span></span>  
  
## <a name="create-relationships-between-internet-sales-geography-and-sales-territory-table"></a><span data-ttu-id="f7603-188">Crear relaciones entre las tablas Internet Sales, Geography y Sales Territory</span><span class="sxs-lookup"><span data-stu-id="f7603-188">Create Relationships Between Internet Sales, Geography, and Sales Territory table</span></span>  
 <span data-ttu-id="f7603-189">Todas las tablas Internet sales, Geography y territorio de ventas contienen una columna común, ID. de territorio de ventas. La columna ID. de territorio de ventas de la tabla territorio de ventas contiene valores con un identificador diferente para cada territorio de ventas.</span><span class="sxs-lookup"><span data-stu-id="f7603-189">The Internet Sales, Geography, and Sales Territory table all contain a common column, Sales Territory Id. The Sales Territory Id column in the Sales Territory table contains values with a different Id for each sales territory.</span></span>  
  
#### <a name="to-create-relationships-between-the-internet-sales-geography-and-the-sales-territory-table"></a><span data-ttu-id="f7603-190">Para crear relaciones entre las tablas Internet Sales, Geography y Sales Territory</span><span class="sxs-lookup"><span data-stu-id="f7603-190">To create relationships between the Internet Sales, Geography, and the Sales Territory table</span></span>  
  
1.  <span data-ttu-id="f7603-191">En el diseñador de modelos, en la vista de diagrama, en la tabla **Geography** , haga clic en la columna **Sales Territory Id** y manténgala seleccionada, arrastre el cursor hasta la columna **Sales Territory Id** de la tabla **Sales Territory** y suéltelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-191">In the model designer, in Diagram View, in the **Geography** table, click and hold on the **Sales Territory Id** column, then drag the cursor to the **Sales Territory Id** column in the **Sales Territory** table, and then release.</span></span>  
  
2.  <span data-ttu-id="f7603-192">En la tabla **Internet Sales** , haga clic en la columna **Sales Territory Id** y manténgala seleccionada, arrastre el cursor hasta la columna **Sales Territory Id** de la tabla **Sales Territory** y suéltelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-192">In the **Internet Sales** table, click and hold on the **Sales Territory Id** column, then drag the cursor to the **Sales Territory Id** column in the **Sales Territory** table, and then release.</span></span>  
  
     <span data-ttu-id="f7603-193">Observe que la propiedad Active de esta relación es False, lo que significa que está inactiva.</span><span class="sxs-lookup"><span data-stu-id="f7603-193">Notice the Active property for this relationship is False, meaning it is inactive.</span></span> <span data-ttu-id="f7603-194">Esto se debe a que la tabla Internet Sales tiene ya otra relación activa que se utiliza en las medidas.</span><span class="sxs-lookup"><span data-stu-id="f7603-194">This is because the Internet Sales table already has another active relationship that is used in measures.</span></span>  
  
## <a name="hide-the-employee-security-table-from-client-applications"></a><span data-ttu-id="f7603-195">Ocultar la tabla Employee Security en las aplicaciones cliente</span><span class="sxs-lookup"><span data-stu-id="f7603-195">Hide the Employee Security Table from Client Applications</span></span>  
 <span data-ttu-id="f7603-196">En esta tarea, ocultará la tabla Employee Security y la dejará de aparecer en la lista de campos de una aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7603-196">In this task, you will hide the Employee Security table, keeping it from appearing in a client application's field list.</span></span> <span data-ttu-id="f7603-197">Tenga en cuenta que ocultar una tabla no significa protegerla.</span><span class="sxs-lookup"><span data-stu-id="f7603-197">Keep in-mind that hiding a table does not secure it.</span></span> <span data-ttu-id="f7603-198">Los usuarios podrán seguir consultando los datos de la tabla Employee Security si saben cómo hacerlo.</span><span class="sxs-lookup"><span data-stu-id="f7603-198">Users can still query Employee Security table data if they know how.</span></span> <span data-ttu-id="f7603-199">Para proteger los datos de la tabla Employee Security e impedir que los usuarios puedan consultar sus datos, aplicará un filtro en una tarea posterior.</span><span class="sxs-lookup"><span data-stu-id="f7603-199">In order to secure the Employee Security table data, preventing users from being able to query any of its data, you will apply a filter in a later task.</span></span>  
  
#### <a name="to-hide-the-employee-table-from-client-applications"></a><span data-ttu-id="f7603-200">Para ocultar la tabla Employee Security en las aplicaciones cliente</span><span class="sxs-lookup"><span data-stu-id="f7603-200">To hide the Employee Table from client applications</span></span>  
  
-   <span data-ttu-id="f7603-201">En el Diseñador de modelos, en la vista de diagrama, haga clic con el botón derecho en el encabezado de tabla **Empleado** y, luego, haga clic en **Ocultar en herramientas cliente**.</span><span class="sxs-lookup"><span data-stu-id="f7603-201">In the model designer, in Diagram View, right-click the **Employee** table heading, and then click **Hide from Client Tools**.</span></span>  
  
## <a name="create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="f7603-202">Creación de un rol de usuario Empleados de ventas por territorio</span><span class="sxs-lookup"><span data-stu-id="f7603-202">Create a Sales Employees by Territory user role</span></span>  
 <span data-ttu-id="f7603-203">En esta tarea, creará un rol de usuario.</span><span class="sxs-lookup"><span data-stu-id="f7603-203">In this task, you will create a new user role.</span></span> <span data-ttu-id="f7603-204">Este rol incluirá un filtro de fila que define qué filas de la tabla Sales Territory estarán visibles para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="f7603-204">This role will include a row filter defining which rows of the Sales Territory table are visible to users.</span></span> <span data-ttu-id="f7603-205">El filtro se aplicará en una dirección de relación de uno-a muchos para el resto de las tablas relacionadas con Sales Territory.</span><span class="sxs-lookup"><span data-stu-id="f7603-205">The filter is then applied in the one-to many relationship direction to all other tables related to Sales Territory.</span></span> <span data-ttu-id="f7603-206">También aplicará un filtro sencillo que proteja la tabla Seguridad de los empleados de las consultas por parte de cualquier usuario que sea miembro del rol.</span><span class="sxs-lookup"><span data-stu-id="f7603-206">You will also apply a simple filter that secures the entire Employee Security table from being queryable by any user that is a member of the role.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f7603-207">El rol Empleados de ventas por territorio que creará en esta lección permitirá a los miembros examinar (o consultar) solo los datos de ventas del territorio de ventas al que pertenecen.</span><span class="sxs-lookup"><span data-stu-id="f7603-207">The Sales Employees by Territory role you create in this lesson restricts members to browse (or query) only sales data for the sales territory to which they belong.</span></span> <span data-ttu-id="f7603-208">Si agrega un usuario como miembro al rol de empleados de ventas por territorio que también existe como miembro del rol creado en [Lección 12: Crear roles](../analysis-services/lesson-11-create-roles.md), obtendrá una combinación de permisos.</span><span class="sxs-lookup"><span data-stu-id="f7603-208">If you add a user as a member to the Sales Employees by Territory role that also exists as a member in a role created in [Lesson 12: Create Roles](../analysis-services/lesson-11-create-roles.md), you will get a combination of permissions.</span></span> <span data-ttu-id="f7603-209">Cuando un usuario es miembro de varios roles, los permisos y filtros de fila definidos para cada rol son acumulativos.</span><span class="sxs-lookup"><span data-stu-id="f7603-209">When a user is a member of multiple roles, the permissions, and row filters defined for each role are cumulative.</span></span> <span data-ttu-id="f7603-210">Es decir, el usuario tendrá los mayores permisos determinados por la combinación de roles.</span><span class="sxs-lookup"><span data-stu-id="f7603-210">That is, the user will have the greater permissions determined by the combination of roles.</span></span>  
  
#### <a name="to-create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="f7603-211">Procedimiento para crear un rol de usuario Empleados de ventas por territorio</span><span class="sxs-lookup"><span data-stu-id="f7603-211">To create a Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="f7603-212">En [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], haga clic en el menú **Modelo** y luego haga clic en **Roles**.</span><span class="sxs-lookup"><span data-stu-id="f7603-212">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click the **Model** menu, and then click **Roles**.</span></span>  
  
2.  <span data-ttu-id="f7603-213">En el cuadro de diálogo **Administrador de roles** , haga clic en **Nuevo**.</span><span class="sxs-lookup"><span data-stu-id="f7603-213">In the **Role Manager** dialog box, click **New**.</span></span>  
  
     <span data-ttu-id="f7603-214">Se agrega a la lista un nuevo rol con el permiso Ninguno.</span><span class="sxs-lookup"><span data-stu-id="f7603-214">A new role with the None permission is added to the list.</span></span>  
  
3.  <span data-ttu-id="f7603-215">Haga clic en el nuevo rol y, a continuación, en la columna **nombre** , cambie el nombre del rol a `Sales Employees by Territory` .</span><span class="sxs-lookup"><span data-stu-id="f7603-215">Click on the new role, and then in the **Name** column, rename the role to `Sales Employees by Territory`.</span></span>  
  
4.  <span data-ttu-id="f7603-216">En la columna **Permisos**, haga clic en la lista desplegable y, luego, seleccione el permiso **Lectura**.</span><span class="sxs-lookup"><span data-stu-id="f7603-216">In the **Permissions** column, click the dropdown list, and then select the **Read** permission.</span></span>  
  
5.  <span data-ttu-id="f7603-217">Haga clic en la pestaña **Miembros** y luego en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-217">Click on the **Members** tab, and then click **Add**.</span></span>  
  
6.  <span data-ttu-id="f7603-218">En el cuadro de diálogo **Seleccionar usuario o grupo** , en **Escribir los nombres de objeto para seleccionar**, escriba el primer nombre de usuario de ejemplo que ha usado al crear la tabla Employee Security.</span><span class="sxs-lookup"><span data-stu-id="f7603-218">In the **Select User or Group** dialog box, in **Enter the object named to select**, type the first sample user name you used when creating the Employee Security table.</span></span> <span data-ttu-id="f7603-219">Haga clic en **Comprobar nombres** para comprobar que el nombre de usuario es válido y, luego, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-219">Click **Check Names** to verify the user name is valid, and then click **Ok**.</span></span>  
  
     <span data-ttu-id="f7603-220">Repita este paso, agregando los otros nombres de usuario de ejemplo que utilizó al crear la tabla Employee Security.</span><span class="sxs-lookup"><span data-stu-id="f7603-220">Repeat this step, adding the other sample user names you used when creating the Employee Security table.</span></span>  
  
7.  <span data-ttu-id="f7603-221">Haga clic en la pestaña **Filtros de fila** .</span><span class="sxs-lookup"><span data-stu-id="f7603-221">Click on the **Row Filters** tab.</span></span>  
  
8.  <span data-ttu-id="f7603-222">En la `Employee Security` tabla, en la columna **filtro Dax** , escriba la siguiente fórmula.</span><span class="sxs-lookup"><span data-stu-id="f7603-222">For the `Employee Security` table, in the **DAX Filter** column, type the following formula.</span></span>  
  
     `=FALSE()`  
  
     <span data-ttu-id="f7603-223">Cuando termine de crear la fórmula, presione ENTRAR.</span><span class="sxs-lookup"><span data-stu-id="f7603-223">When you have finished building the formula, press ENTER.</span></span>  
  
     <span data-ttu-id="f7603-224">Esta fórmula especifica que todas las columnas se resolverán según la condición booleana false; por lo tanto, ningún miembro del rol de usuario de empleados de ventas por territorio podrá consultar las columnas de la tabla Employee Security.</span><span class="sxs-lookup"><span data-stu-id="f7603-224">This formula specifies that all columns resolve to the false Boolean condition; therefore, no columns for the Employee Security table can be queried by a member of the Sales Employees by Territory user role.</span></span>  
  
9. <span data-ttu-id="f7603-225">Para la tabla **Sales Territory** , escriba la siguiente fórmula.</span><span class="sxs-lookup"><span data-stu-id="f7603-225">For the **Sales Territory** table, type the following formula.</span></span>  
  
     `='Sales Territory'[Sales Territory Id]=LOOKUPVALUE('Employee Security'[Sales Territory Id], 'Employee Security'[Login Id], USERNAME(), 'Employee Security'[Sales Territory Id], 'Sales Territory'[Sales Territory Id])`  
  
     <span data-ttu-id="f7603-226">Cuando termine de crear la fórmula, presione ENTRAR.</span><span class="sxs-lookup"><span data-stu-id="f7603-226">When you have finished building the formula, press ENTER.</span></span>  
  
     <span data-ttu-id="f7603-227">En esta fórmula, la función LOOKUPVALUE devuelve todos los valores de la columna Employee Security[Sales Territory Id], donde Employee Security[Login Id] coincide con el nombre de usuario actual que ha iniciado sesión en Windows y Employee Security[Sales Territory Id] coincide con Sales Territory[Sales Territory Id].</span><span class="sxs-lookup"><span data-stu-id="f7603-227">In this formula, the LOOKUPVALUE function returns all values for the Employee Security[Sales Territory Id] column, where the Employee Security[Login Id] is the same as the current logged on Windows user name, and Employee Security[Sales Territory Id] is the same as the Sales Territory[Sales Territory Id].</span></span>  
  
     <span data-ttu-id="f7603-228">A continuación, se utiliza el conjunto de identificadores del territorio de ventas devueltos por LOOKUPVALUE para limitar las filas que se muestran en la tabla de territorio de ventas.</span><span class="sxs-lookup"><span data-stu-id="f7603-228">The set of Sales Territory IDs returned by LOOKUPVALUE is then used to restrict the rows shown in the Sales Territory table.</span></span> <span data-ttu-id="f7603-229">Solo se mostrarán las filas donde el Id. de territorio de ventas de la fila sea el conjunto de identificadores devueltos por la función LOOKUPVALUE.</span><span class="sxs-lookup"><span data-stu-id="f7603-229">Only rows where the Sales Territory ID for the row is in the set of IDs returned by the LOOKUPVALUE function are displayed.</span></span>  
  
10. <span data-ttu-id="f7603-230">En el cuadro de diálogo Administrador de roles, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-230">In the Role Manager dialog box, click **Ok**.</span></span>  
  
## <a name="test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="f7603-231">Prueba del rol de usuario Empleados de ventas por territorio</span><span class="sxs-lookup"><span data-stu-id="f7603-231">Test the Sales Employees by Territory User Role</span></span>  
 <span data-ttu-id="f7603-232">En esta tarea, utilizará la característica Analizar en Excel de [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)] para probar la eficacia de los empleados de ventas por el rol usuario Territorio.</span><span class="sxs-lookup"><span data-stu-id="f7603-232">In this task, you will use the Analyze in Excel feature in [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)] to test the efficacy of the Sales Employees by Territory user role.</span></span> <span data-ttu-id="f7603-233">Especificará uno de los nombres de usuario que ha agregado a la tabla Employee Security como miembro del rol.</span><span class="sxs-lookup"><span data-stu-id="f7603-233">You will specify one of the user names you added to the Employee Security table and as a member of the role.</span></span> <span data-ttu-id="f7603-234">Este nombre de usuario se utilizará como el nombre de usuario efectivo en la conexión creada entre Excel y el modelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-234">This user name will then be used as the effective user name in the connection created between Excel and the model.</span></span>  
  
#### <a name="to-test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="f7603-235">Procedimiento para probar el rol de usuario Empleados de ventas por territorio</span><span class="sxs-lookup"><span data-stu-id="f7603-235">To test the Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="f7603-236">En [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], haga clic en el menú **Modelo** y después en **Analizar en Excel**.</span><span class="sxs-lookup"><span data-stu-id="f7603-236">In [!INCLUDE[ssBIDevStudio](../includes/ssbidevstudio-md.md)], click the **Model** menu, and then click **Analyze in Excel**.</span></span>  
  
2.  <span data-ttu-id="f7603-237">En el cuadro de diálogo **Analizar en Excel**, en **Especifique el nombre de usuario o rol que se va a usar al conectarse al modelo**, seleccione **Otro usuario de Windows**. Después, haga clic en **Examinar**.</span><span class="sxs-lookup"><span data-stu-id="f7603-237">In the **Analyze in Excel** dialog box, in **Specify the user name or role to use to connect to the model**, select **Other Windows User**, and then click **Browse**.</span></span>  
  
3.  <span data-ttu-id="f7603-238">En el cuadro de diálogo **Seleccionar usuario o grupo** , en **Escriba el nombre del objeto que desea seleccionar**, escriba uno de los nombres de usuario que se incluyeron en la tabla de empleados y luego haga clic en **Comprobar nombres**.</span><span class="sxs-lookup"><span data-stu-id="f7603-238">In the **Select User or Group** dialog box, in **Enter the object name to select**, type one of the user names you included in the Employee table, and then click **Check Names**.</span></span>  
  
4.  <span data-ttu-id="f7603-239">Haga clic en **Aceptar** para cerrar el **Seleccionar usuario o grupo** cuadro de diálogo y, a continuación, haga clic en **Aceptar** para cerrar el **analizar en Excel** cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="f7603-239">Click **Ok** to close the **Select User or Group** dialog box, and then click **Ok** to close the **Analyze in Excel** dialog box.</span></span>  
  
     <span data-ttu-id="f7603-240">Se abrirá Excel con un nuevo libro.</span><span class="sxs-lookup"><span data-stu-id="f7603-240">Excel will open with a new workbook.</span></span> <span data-ttu-id="f7603-241">Se crea automáticamente una tabla dinámica.</span><span class="sxs-lookup"><span data-stu-id="f7603-241">A Pivot table is automatically created.</span></span> <span data-ttu-id="f7603-242">La lista de campos de tabla dinámica incluye todos la mayoría de campos de datos disponibles en su nuevo modelo.</span><span class="sxs-lookup"><span data-stu-id="f7603-242">The Pivot Table Field List includes most of the data fields available in your new model.</span></span>  
  
     <span data-ttu-id="f7603-243">Observe que la tabla Employee Security no está visible en la lista de campos de la tabla dinámica.</span><span class="sxs-lookup"><span data-stu-id="f7603-243">Notice the Employee Security table is not visible in the Pivot Table Field List.</span></span> <span data-ttu-id="f7603-244">Esto se debe a que eligió ocultar esta tabla de las herramientas cliente en una tarea anterior.</span><span class="sxs-lookup"><span data-stu-id="f7603-244">This is because you chose to hide this table from client tools in a previous task.</span></span>  
  
5.  <span data-ttu-id="f7603-245">En la **lista de campos de tabla dinámica** , en **∑ Internet Sales** (medidas), seleccione la medida **Internet Total Sales** .</span><span class="sxs-lookup"><span data-stu-id="f7603-245">In the **Pivot Table Field** list, in **∑ Internet Sales** (measures), select the **Internet Total Sales** measure.</span></span> <span data-ttu-id="f7603-246">La medida se agregará a los campos **Valores** .</span><span class="sxs-lookup"><span data-stu-id="f7603-246">The measure will be entered into the **Values** fields.</span></span>  
  
6.  <span data-ttu-id="f7603-247">En la **lista de campos de tabla dinámica** , seleccione la columna **Sales Territory Id** de la tabla **Sales Territory** .</span><span class="sxs-lookup"><span data-stu-id="f7603-247">In the **Pivot Table Field** list, select the **Sales Territory Id** column from the **Sales Territory** table.</span></span> <span data-ttu-id="f7603-248">La columna se agregará a los campos **Etiquetas de fila** .</span><span class="sxs-lookup"><span data-stu-id="f7603-248">The column will be entered into the **Row Labels** fields.</span></span>  
  
     <span data-ttu-id="f7603-249">Tenga en cuenta que las cifras de ventas por Internet solo aparecen para la región a la que pertenece el nombre de usuario efectivo que usó.</span><span class="sxs-lookup"><span data-stu-id="f7603-249">Notice Internet sales figures appear only for the one region to which the effective user name you used belongs.</span></span> <span data-ttu-id="f7603-250">Si selecciona otra columna; por ejemplo, City, en la tabla Geography como un campo de etiqueta de fila, solo se mostrarán las ciudades del territorio de ventas al que el usuario efectivo pertenece.</span><span class="sxs-lookup"><span data-stu-id="f7603-250">If you select another column; for example, City, from the Geography table as Row Label field, only cities in the sales territory to which the effective user belongs are displayed.</span></span>  
  
     <span data-ttu-id="f7603-251">Este usuario no podrá examinar o consultar los datos de ventas por Internet para otros territorios distintos de aquel al que pertenece, porque el filtro de fila definido para la tabla Sales Territory en el rol de usuario de empleados de ventas por territorio protege eficazmente los datos relacionados con otros territorios de ventas.</span><span class="sxs-lookup"><span data-stu-id="f7603-251">This user cannot browse or query any Internet sales data for territories other than the one they belong because the row filter defined for the Sales Territory table in the Sales Employees by Territory user role effectively secures data for all data related to other sales territories.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7603-252">Consulte también</span><span class="sxs-lookup"><span data-stu-id="f7603-252">See Also</span></span>  
 <span data-ttu-id="f7603-253">[Función USERNAME &#40;&#41;DAX](/dax/username-function-dax) </span><span class="sxs-lookup"><span data-stu-id="f7603-253">[USERNAME Function &#40;DAX&#41;](/dax/username-function-dax) </span></span>  
 <span data-ttu-id="f7603-254">[Función VALORBUSCAR &#40;DAX&#41;](/dax/lookupvalue-function-dax) </span><span class="sxs-lookup"><span data-stu-id="f7603-254">[LOOKUPVALUE Function &#40;DAX&#41;](/dax/lookupvalue-function-dax) </span></span>  
 [<span data-ttu-id="f7603-255">Función CUSTOMDATA &#40;DAX&#41;</span><span class="sxs-lookup"><span data-stu-id="f7603-255">CUSTOMDATA Function &#40;DAX&#41;</span></span>](/dax/customdata-function-dax)  
  
  
