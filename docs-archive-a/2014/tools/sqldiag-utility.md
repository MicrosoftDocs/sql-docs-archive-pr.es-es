---
title: SQLdiag, utilidad | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: tools-other
ms.topic: conceptual
helpviewer_keywords:
- command prompt utilities [SQL Server], SQLdiag
- stopping diagnostic collection
- storing diagnostic information
- performance [SQL Server], diagnostic collection
- diagnostic records [SQL Server]
- scripts [SQL Server], diagnostic collection
- logs [SQL Server], diagnostic collection
- starting diagnostic collection
- clustered instance of SQL Server
- monitoring performance [SQL Server], diagnostic collection
- security [SQL Server], diagnostic collection
- SQLDIAG service
- space [SQL Server], diagnostic collection
- SQLdiag utility
- disk space [SQL Server], diagnostic collection
- configuration files [SQL Server]
- automatic diagnostic collection
- clusters [SQL Server], diagnostic collection
ms.assetid: 45ba1307-33d1-431e-872c-a6e4556f5ff2
author: stevestein
ms.author: sstein
ms.openlocfilehash: 0559e0b2261ed5ba1c9c384608d04194d685f695
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87743738"
---
# <a name="sqldiag-utility"></a><span data-ttu-id="541ba-102">SQLdiag , utilidad</span><span class="sxs-lookup"><span data-stu-id="541ba-102">SQLdiag Utility</span></span>
  <span data-ttu-id="541ba-103">La utilidad **SQLdiag** es una herramienta de recopilación de diagnósticos de uso general que se puede ejecutar como una aplicación de consola o como un servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-103">The **SQLdiag** utility is a general purpose diagnostics collection utility that can be run as a console application or as a service.</span></span> <span data-ttu-id="541ba-104">Puede usar **SQLdiag** para recopilar los archivos de datos y de registro de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] y otros tipos de servidores, y para supervisar los servidores a lo largo del tiempo o solucionar problemas específicos de los mismos.</span><span class="sxs-lookup"><span data-stu-id="541ba-104">You can use **SQLdiag** to collect logs and data files from [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] and other types of servers, and use it to monitor your servers over time or troubleshoot specific problems with your servers.</span></span> <span data-ttu-id="541ba-105">**SQLdiag** se ha diseñado para acelerar y simplificar la recopilación de información de diagnóstico para los Servicios de soporte técnico de [!INCLUDE[msCoName](../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="541ba-105">**SQLdiag** is intended to expedite and simplify diagnostic information gathering for [!INCLUDE[msCoName](../includes/msconame-md.md)] Customer Support Services.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-106">Esta utilidad podría modificarse y las aplicaciones o scripts que dependen del comportamiento o de los argumentos de su línea de comandos podrían no funcionar correctamente en versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="541ba-106">This utility may be changed, and applications or scripts that rely on its command line arguments or behavior may not work correctly in future releases.</span></span>  
  
 <span data-ttu-id="541ba-107">**SQLdiag** puede recopilar los siguientes tipos de información de diagnóstico:</span><span class="sxs-lookup"><span data-stu-id="541ba-107">**SQLdiag** can collect the following types of diagnostic information:</span></span>  
  
-   <span data-ttu-id="541ba-108">Registros de rendimiento de Windows</span><span class="sxs-lookup"><span data-stu-id="541ba-108">Windows performance logs</span></span>  
  
-   <span data-ttu-id="541ba-109">Registros de eventos de Windows</span><span class="sxs-lookup"><span data-stu-id="541ba-109">Windows event logs</span></span>  
  
-   [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] <span data-ttu-id="541ba-110">seguimientos</span><span class="sxs-lookup"><span data-stu-id="541ba-110">traces</span></span>  
  
-   [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="541ba-111">información de bloqueo</span><span class="sxs-lookup"><span data-stu-id="541ba-111">blocking information</span></span>  
  
-   [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="541ba-112">información de configuración</span><span class="sxs-lookup"><span data-stu-id="541ba-112">configuration information</span></span>  
  
 <span data-ttu-id="541ba-113">Puede especificar los tipos de información que quiere que **SQLdiag** recopile si modifica el archivo de configuración SQLDiag.xml, que se describe en la siguiente sección.</span><span class="sxs-lookup"><span data-stu-id="541ba-113">You can specify what types of information you want **SQLdiag** to collect by editing the configuration file SQLDiag.xml, which is described in a following section.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="541ba-114">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="541ba-114">Syntax</span></span>  
  
```  
  
      sqldiag   
     { [/?] }  
     |  
     { [/I configuration_file]  
       [/O output_folder_path]  
       [/Psupport_folder_path]  
       [/Noutput_folder_management_option]  
       [/Mmachine1 [ machine2machineN]| @machinelistfile]  
       [/Cfile_compression_type]  
       [/B [+]start_time]  
       [/E [+]stop_time]  
       [/ASQLdiag_application_name]  
       [/T { tcp [ ,port ] | np | lpc } ]  
       [/Q] [/G] [/R] [/U] [/L] [/X] }  
     |  
     { [START | STOP | STOP_ABORT] }  
     |  
     { [START | STOP | STOP_ABORT] /ASQLdiag_application_name }  
```  
  
## <a name="arguments"></a><span data-ttu-id="541ba-115">Argumentos</span><span class="sxs-lookup"><span data-stu-id="541ba-115">Arguments</span></span>  
 <span data-ttu-id="541ba-116">**/?**</span><span class="sxs-lookup"><span data-stu-id="541ba-116">**/?**</span></span>  
 <span data-ttu-id="541ba-117">Muestra información de uso.</span><span class="sxs-lookup"><span data-stu-id="541ba-117">Displays usage information.</span></span>  
  
 <span data-ttu-id="541ba-118">**/I** _configuration_file_</span><span class="sxs-lookup"><span data-stu-id="541ba-118">**/I** _configuration_file_</span></span>  
 <span data-ttu-id="541ba-119">Establece el archivo de configuración que usará **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-119">Sets the configuration file for **SQLdiag** to use.</span></span> <span data-ttu-id="541ba-120">De forma predeterminada, **/I** está establecido en SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="541ba-120">By default, **/I** is set to SQLDiag.Xml.</span></span>  
  
 <span data-ttu-id="541ba-121">**/O** _output_folder_path_</span><span class="sxs-lookup"><span data-stu-id="541ba-121">**/O** _output_folder_path_</span></span>  
 <span data-ttu-id="541ba-122">Redirige la salida de **SQLdiag** a la carpeta especificada.</span><span class="sxs-lookup"><span data-stu-id="541ba-122">Redirects **SQLdiag** output to the specified folder.</span></span> <span data-ttu-id="541ba-123">Si no se especifica la opción **/O** , la salida de **SQLdiag** se escribe en una subcarpeta denominada SQLDIAG en la carpeta de inicio de **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-123">If the **/O** option is not specified, **SQLdiag** output is written to a subfolder named SQLDIAG under the **SQLdiag** startup folder.</span></span> <span data-ttu-id="541ba-124">Si no existe la carpeta SQLDIAG, **SQLdiag** intenta crearla.</span><span class="sxs-lookup"><span data-stu-id="541ba-124">If the SQLDIAG folder does not exist, **SQLdiag** attempts to create it.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-125">La ubicación de la carpeta de salida es relativa a la ubicación de la carpeta Support que se puede especificar con **/P**.</span><span class="sxs-lookup"><span data-stu-id="541ba-125">The output folder location is relative to the support folder location that can be specified with **/P**.</span></span> <span data-ttu-id="541ba-126">Para definir una ubicación completamente distinta de la carpeta de salida, especifique la ruta de acceso completa del directorio para **/O**.</span><span class="sxs-lookup"><span data-stu-id="541ba-126">To set an entirely different location for the output folder, specify the full directory path for **/O**.</span></span>  
  
 <span data-ttu-id="541ba-127">**/P** _support_folder_path_</span><span class="sxs-lookup"><span data-stu-id="541ba-127">**/P** _support_folder_path_</span></span>  
 <span data-ttu-id="541ba-128">Define la ruta de la carpeta Support.</span><span class="sxs-lookup"><span data-stu-id="541ba-128">Sets the support folder path.</span></span> <span data-ttu-id="541ba-129">De forma predeterminada, **/P** está establecido en la carpeta en que reside el ejecutable **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-129">By default, **/P** is set to the folder where the **SQLdiag** executable resides.</span></span> <span data-ttu-id="541ba-130">La carpeta Support contiene los archivos de compatibilidad de **SQLdiag** , como el archivo de configuración XML, los scripts Transact-SQL y otros archivos que usa la utilidad durante la recopilación de diagnósticos.</span><span class="sxs-lookup"><span data-stu-id="541ba-130">The support folder contains **SQLdiag** support files, such as the XML configuration file, Transact-SQL scripts, and other files that the utility uses during diagnostics collection.</span></span> <span data-ttu-id="541ba-131">Si usa esta opción para especificar una ruta de acceso alternativa a los archivos de compatibilidad, **SQLdiag** copiará automáticamente los archivos de compatibilidad que necesita en la carpeta especificada, si todavía no existen.</span><span class="sxs-lookup"><span data-stu-id="541ba-131">If you use this option to specify an alternate support files path, **SQLdiag** will automatically copy the support files it requires to the specified folder if they do not already exist.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-132">Para establecer la carpeta actual como ruta de acceso de la carpeta Support, especifique **%cd%** en la línea de comandos como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="541ba-132">To set your current folder as the support path, specify **%cd%** on the command line as follows:</span></span>  
>   
>  <span data-ttu-id="541ba-133">**SQLDIAG /P %cd%**</span><span class="sxs-lookup"><span data-stu-id="541ba-133">**SQLDIAG /P %cd%**</span></span>  
  
 <span data-ttu-id="541ba-134">**/N** _output_folder_management_option_</span><span class="sxs-lookup"><span data-stu-id="541ba-134">**/N** _output_folder_management_option_</span></span>  
 <span data-ttu-id="541ba-135">Establece si **SQLdiag** sobrescribe o cambia el nombre de la carpeta de salida cuando se inicia.</span><span class="sxs-lookup"><span data-stu-id="541ba-135">Sets whether **SQLdiag** overwrites or renames the output folder when it starts up.</span></span> <span data-ttu-id="541ba-136">Opciones disponibles:</span><span class="sxs-lookup"><span data-stu-id="541ba-136">Available options:</span></span>  
  
 <span data-ttu-id="541ba-137">1 = Sobrescribe la carpeta de salida (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="541ba-137">1 = Overwrites the output folder (default)</span></span>  
  
 <span data-ttu-id="541ba-138">2 = Cuando se inicia **SQLdiag** , cambia el nombre de la carpeta de salida a SQLDIAG_00001, SQLDIAG_00002, etc.</span><span class="sxs-lookup"><span data-stu-id="541ba-138">2 = When **SQLdiag** starts up, it renames the output folder to SQLDIAG_00001, SQLDIAG_00002, and so on.</span></span> <span data-ttu-id="541ba-139">Una vez cambiado el nombre de la carpeta de salida actual, **SQLdiag** escribe la salida en la carpeta de salida predeterminada SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="541ba-139">After renaming the current output folder, **SQLdiag** writes output to the default output folder SQLDIAG.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-140">**SQLdiag** no anexa la salida a la carpeta de salida actual cuando se inicia.</span><span class="sxs-lookup"><span data-stu-id="541ba-140">**SQLdiag** does not append output to the current output folder when it starts up.</span></span> <span data-ttu-id="541ba-141">Solo puede sobrescribir la carpeta de salida predeterminada (opción 1) o cambiar el nombre de la carpeta (opción 2) y, a continuación, escribir la salida en la nueva carpeta de salida predeterminada denominada SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="541ba-141">It can only overwrite the default output folder (option 1) or rename the folder (option 2), and then it writes output to the new default output folder named SQLDIAG.</span></span>  
  
 <span data-ttu-id="541ba-142">**/M** _machine1_ [ *machine2 \* \* machinen*] |*@machinelistfile*</span><span class="sxs-lookup"><span data-stu-id="541ba-142">**/M** _machine1_ [ *machine2\*\*machineN*] | *@machinelistfile*</span></span>  
 <span data-ttu-id="541ba-143">Invalida los equipos especificados en el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="541ba-143">Overrides the machines specified in the configuration file.</span></span> <span data-ttu-id="541ba-144">De forma predeterminada, el archivo de configuración es SQLDiag.Xml, o se establece con el parámetro **/I** .</span><span class="sxs-lookup"><span data-stu-id="541ba-144">By default the configuration file is SQLDiag.Xml, or is set with the **/I** parameter.</span></span> <span data-ttu-id="541ba-145">Al especificar más de un equipo, separe cada nombre de equipo con un espacio.</span><span class="sxs-lookup"><span data-stu-id="541ba-145">When specifying more than one machine, separate each machine name with a space.</span></span>  
  
 <span data-ttu-id="541ba-146">*@machinelistfile*El uso de especifica un nombre de archivo de la lista de máquinas que se almacenará en el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="541ba-146">Using *@machinelistfile* specifies a machine list filename to be stored in the configuration file.</span></span>  
  
 <span data-ttu-id="541ba-147">**/C** _file_compression_type_</span><span class="sxs-lookup"><span data-stu-id="541ba-147">**/C** _file_compression_type_</span></span>  
 <span data-ttu-id="541ba-148">Establece el tipo de compresión de archivo que se usa en los archivos de la carpeta de salida de **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-148">Sets the type of file compression used on the **SQLdiag** output folder files.</span></span> <span data-ttu-id="541ba-149">Opciones disponibles:</span><span class="sxs-lookup"><span data-stu-id="541ba-149">Available options:</span></span>  
  
 <span data-ttu-id="541ba-150">0 = ninguno (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="541ba-150">0 = none (default)</span></span>  
  
 <span data-ttu-id="541ba-151">1 = utiliza la compresión NTFS</span><span class="sxs-lookup"><span data-stu-id="541ba-151">1 = uses NTFS compression</span></span>  
  
 <span data-ttu-id="541ba-152">**/B** [ **+** ]*start_time*</span><span class="sxs-lookup"><span data-stu-id="541ba-152">**/B** [**+**]*start_time*</span></span>  
 <span data-ttu-id="541ba-153">Especifica la fecha y la hora en que se empiezan a recopilar los datos de diagnóstico en el siguiente formato:</span><span class="sxs-lookup"><span data-stu-id="541ba-153">Specifies the date and time to start collecting diagnostic data in the following format:</span></span>  
  
 <span data-ttu-id="541ba-154">AAAAMMDD_HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="541ba-154">YYYYMMDD_HH:MM:SS</span></span>  
  
 <span data-ttu-id="541ba-155">La hora se especifica usando el reloj de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="541ba-155">The time is specified using 24-hour notation.</span></span> <span data-ttu-id="541ba-156">Por ejemplo, 2:00 p.m.</span><span class="sxs-lookup"><span data-stu-id="541ba-156">For example, 2:00 P.M.</span></span> <span data-ttu-id="541ba-157">se debe especificar como **14:00:00**.</span><span class="sxs-lookup"><span data-stu-id="541ba-157">should be specified as **14:00:00**.</span></span>  
  
 <span data-ttu-id="541ba-158">Use **+** sin la fecha (solo HH:MM:SS) para especificar una hora que sea relativa a la fecha y la hora actuales.</span><span class="sxs-lookup"><span data-stu-id="541ba-158">Use **+** without the date (HH:MM:SS only) to specify a time that is relative to the current date and time.</span></span> <span data-ttu-id="541ba-159">Por ejemplo, si especifica **/B +02:00:00**, **SQLdiag** esperará 2 horas antes de empezar a recopilar información.</span><span class="sxs-lookup"><span data-stu-id="541ba-159">For example, if you specify **/B +02:00:00**, **SQLdiag** will wait 2 hours before it starts collecting information.</span></span>  
  
 <span data-ttu-id="541ba-160">No inserte ningún espacio entre **+** y el valor de *start_time*especificado.</span><span class="sxs-lookup"><span data-stu-id="541ba-160">Do not insert a space between **+** and the specified *start_time*.</span></span>  
  
 <span data-ttu-id="541ba-161">Si especifica una hora de inicio que se encuentra en el pasado, **SQLdiag** cambia forzosamente la fecha de inicio para que la fecha y la hora de inicio se encuentren en el futuro.</span><span class="sxs-lookup"><span data-stu-id="541ba-161">If you specify a start time that is in the past, **SQLdiag** forcibly changes the start date so the start date and time are in the future.</span></span> <span data-ttu-id="541ba-162">Por ejemplo, si especifica **/B 01:00:00** y la hora actual es 08:00:00, **SQLdiag** cambia forzosamente la fecha de inicio para que sea el día siguiente.</span><span class="sxs-lookup"><span data-stu-id="541ba-162">For example, if you specify **/B 01:00:00** and the current time is 08:00:00, **SQLdiag** forcibly changes the start date so that the start date is the next day.</span></span>  
  
 <span data-ttu-id="541ba-163">Tenga en cuenta que **SQLdiag** usa la hora local del equipo en el que se ejecuta la utilidad.</span><span class="sxs-lookup"><span data-stu-id="541ba-163">Note that **SQLdiag** uses the local time on the computer where the utility is running.</span></span>  
  
 <span data-ttu-id="541ba-164">**/E** [ **+** ]*stop_time*</span><span class="sxs-lookup"><span data-stu-id="541ba-164">**/E** [**+**]*stop_time*</span></span>  
 <span data-ttu-id="541ba-165">Especifica la fecha y la hora en que se dejan de recopilar los datos de diagnóstico en el siguiente formato:</span><span class="sxs-lookup"><span data-stu-id="541ba-165">Specifies the date and time to stop collecting diagnostic data in the following format:</span></span>  
  
 <span data-ttu-id="541ba-166">AAAAMMDD_HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="541ba-166">YYYYMMDD_HH:MM:SS</span></span>  
  
 <span data-ttu-id="541ba-167">La hora se especifica usando el reloj de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="541ba-167">The time is specified using 24-hour notation.</span></span> <span data-ttu-id="541ba-168">Por ejemplo, 2:00 p.m.</span><span class="sxs-lookup"><span data-stu-id="541ba-168">For example, 2:00 P.M.</span></span> <span data-ttu-id="541ba-169">se debe especificar como **14:00:00**.</span><span class="sxs-lookup"><span data-stu-id="541ba-169">should be specified as **14:00:00**.</span></span>  
  
 <span data-ttu-id="541ba-170">Use **+** sin la fecha (solo HH:MM:SS) para especificar una hora que sea relativa a la fecha y la hora actuales.</span><span class="sxs-lookup"><span data-stu-id="541ba-170">Use **+** without the date (HH:MM:SS only) to specify a time that is relative to the current date and time.</span></span> <span data-ttu-id="541ba-171">Por ejemplo, si especifica una hora de inicio y una hora de finalización mediante **/B +02:00:00 /E +03:00:00**, **SQLdiag** espera 2 horas para empezar a recopilar información y después recopila información durante 3 horas antes de detenerse y cerrarse.</span><span class="sxs-lookup"><span data-stu-id="541ba-171">For example, if you specify a start time and end time by using **/B +02:00:00 /E +03:00:00**, **SQLdiag** waits 2 hours before it starts collecting information, then collects information for 3 hours before it stops and exits.</span></span> <span data-ttu-id="541ba-172">Si no se especifica **/B** , **SQLdiag** empieza a recopilar información de diagnóstico inmediatamente y finaliza en la fecha y la hora especificadas por **/E**.</span><span class="sxs-lookup"><span data-stu-id="541ba-172">If **/B** is not specified, **SQLdiag** starts collecting diagnostics immediately and ends at the date and time specified by **/E**.</span></span>  
  
 <span data-ttu-id="541ba-173">No inserte ningún espacio entre **+** y el valor especificado de *start_time* o *end_time*.</span><span class="sxs-lookup"><span data-stu-id="541ba-173">Do not insert a space between **+** and the specified *start_time* or *end_time*.</span></span>  
  
 <span data-ttu-id="541ba-174">Tenga en cuenta que **SQLdiag** usa la hora local del equipo en el que se ejecuta la utilidad.</span><span class="sxs-lookup"><span data-stu-id="541ba-174">Note that **SQLdiag** uses the local time on the computer where the utility is running.</span></span>  
  
 <span data-ttu-id="541ba-175">**/A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="541ba-175">**/A** _SQLdiag_application_name_</span></span>  
 <span data-ttu-id="541ba-176">Permite la ejecución de varias instancias de la utilidad **SQLdiag** en la misma instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="541ba-176">Enables running multiple instances of the **SQLdiag** utility against the same [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="541ba-177">Cada *SQLdiag_application_name* identifica una instancia diferente de **SQLdiag**.</span><span class="sxs-lookup"><span data-stu-id="541ba-177">Each *SQLdiag_application_name* identifies a different instance of **SQLdiag**.</span></span> <span data-ttu-id="541ba-178">No existe ninguna relación entre una instancia de *SQLdiag_application_name* y un nombre de instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="541ba-178">No relationship exists between a *SQLdiag_application_name* instance and a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance name.</span></span>  
  
 <span data-ttu-id="541ba-179">*SQLdiag_application_name* se puede usar para iniciar o detener una instancia concreta del servicio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-179">*SQLdiag_application_name* can be used to start or stop a specific instance of the **SQLdiag** service.</span></span>  
  
 <span data-ttu-id="541ba-180">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="541ba-180">For example:</span></span>  
  
 <span data-ttu-id="541ba-181">**SQLDIAG START /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="541ba-181">**SQLDIAG START /A** _SQLdiag_application_name_</span></span>  
  
 <span data-ttu-id="541ba-182">También se puede usar con la opción **/R** para registrar una instancia concreta de **SQLdiag** como servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-182">It can also be used with the **/R** option to register a specific instance of **SQLdiag** as a service.</span></span> <span data-ttu-id="541ba-183">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="541ba-183">For example:</span></span>  
  
 <span data-ttu-id="541ba-184">**SQLDIAG /R /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="541ba-184">**SQLDIAG /R /A** _SQLdiag_application_name_</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-185">**SQLdiag** agrega el prefijo DIAG$ de forma automática al nombre de instancia especificado para *SQLdiag_application_name*.</span><span class="sxs-lookup"><span data-stu-id="541ba-185">**SQLdiag** automatically prefixes DIAG$ to the instance name specified for *SQLdiag_application_name*.</span></span> <span data-ttu-id="541ba-186">De este modo, se proporciona un nombre de servicio significativo si se registra **SQLdiag** como servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-186">This provides a sensible service name if you register **SQLdiag** as a service.</span></span>  
  
 <span data-ttu-id="541ba-187">/T { tcp [ ,*port* ] | np | lpc }</span><span class="sxs-lookup"><span data-stu-id="541ba-187">/T { tcp [ ,*port* ] | np | lpc }</span></span>  
 <span data-ttu-id="541ba-188">Se conecta a una instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] con el protocolo especificado.</span><span class="sxs-lookup"><span data-stu-id="541ba-188">Connects to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] using the specified protocol.</span></span>  
  
 <span data-ttu-id="541ba-189">tcp [,*port*]</span><span class="sxs-lookup"><span data-stu-id="541ba-189">tcp [,*port*]</span></span>  
 <span data-ttu-id="541ba-190">TCP/IP (Protocolo de control de transmisión/protocolo de Internet).</span><span class="sxs-lookup"><span data-stu-id="541ba-190">Transmission Control Protocol/Internet Protocol (TCP/IP).</span></span> <span data-ttu-id="541ba-191">Si lo desea, puede especificar un número de puerto para la conexión.</span><span class="sxs-lookup"><span data-stu-id="541ba-191">You can optionally specify a port number for the connection.</span></span>  
  
 <span data-ttu-id="541ba-192">np</span><span class="sxs-lookup"><span data-stu-id="541ba-192">np</span></span>  
 <span data-ttu-id="541ba-193">Canalizaciones con nombre.</span><span class="sxs-lookup"><span data-stu-id="541ba-193">Named pipes.</span></span> <span data-ttu-id="541ba-194">De manera predeterminada, la instancia predeterminada de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] escucha en la canalización con nombre: `\\.\pipe\sql\query` y en `\\.\pipe\MSSQL$<instancename>\sql\query` para una instancia con nombre.</span><span class="sxs-lookup"><span data-stu-id="541ba-194">By default, the default instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] listens on named pipe `\\.\pipe\sql\query` and `\\.\pipe\MSSQL$<instancename>\sql\query` for a named instance.</span></span> <span data-ttu-id="541ba-195">No puede conectar a una instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] usando un nombre de canalización alternativa.</span><span class="sxs-lookup"><span data-stu-id="541ba-195">You cannot connect to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] by using an alternate pipe name.</span></span>  
  
 <span data-ttu-id="541ba-196">lpc</span><span class="sxs-lookup"><span data-stu-id="541ba-196">lpc</span></span>  
 <span data-ttu-id="541ba-197">Llamada a procedimiento local.</span><span class="sxs-lookup"><span data-stu-id="541ba-197">Local procedure call.</span></span> <span data-ttu-id="541ba-198">Este protocolo de memoria compartida está disponible si el cliente se está conectando a una instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] del mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="541ba-198">This shared memory protocol is available if the client is connecting to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] on the same computer.</span></span>  
  
 <span data-ttu-id="541ba-199">**/Q**</span><span class="sxs-lookup"><span data-stu-id="541ba-199">**/Q**</span></span>  
 <span data-ttu-id="541ba-200">Ejecuta **SQLdiag** en modo silencioso.</span><span class="sxs-lookup"><span data-stu-id="541ba-200">Runs **SQLdiag** in quiet mode.</span></span> <span data-ttu-id="541ba-201">**/Q** suprime todos los mensajes, como los de contraseña.</span><span class="sxs-lookup"><span data-stu-id="541ba-201">**/Q** suppresses all prompts, such as password prompts.</span></span>  
  
 <span data-ttu-id="541ba-202">**/G**</span><span class="sxs-lookup"><span data-stu-id="541ba-202">**/G**</span></span>  
 <span data-ttu-id="541ba-203">Ejecuta **SQLdiag** en modo genérico.</span><span class="sxs-lookup"><span data-stu-id="541ba-203">Runs **SQLdiag** in generic mode.</span></span> <span data-ttu-id="541ba-204">Cuando se especifica **/G** , al iniciarse **SQLdiag** , no aplica las comprobaciones de conectividad de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ni si el usuario es miembro del rol fijo de servidor **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="541ba-204">When **/G** is specified, on startup **SQLdiag** does not enforce [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] connectivity checks or verify that the user is a member of the **sysadmin** fixed server role.</span></span> <span data-ttu-id="541ba-205">En su lugar, **SQLdiag** consulta con Windows para determinar si un usuario tiene los derechos adecuados para recopilar cada diagnóstico solicitado.</span><span class="sxs-lookup"><span data-stu-id="541ba-205">Instead, **SQLdiag** defers to Windows to determine whether a user has the appropriate rights to gather each requested diagnostic.</span></span>  
  
 <span data-ttu-id="541ba-206">Si no se especifica **/G** , **SQLdiag** comprueba si el usuario es miembro del grupo **Administradores** de Windows y no recopila diagnósticos de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] si el usuario no es miembro del grupo **Administradores** .</span><span class="sxs-lookup"><span data-stu-id="541ba-206">If **/G** is not specified, **SQLdiag** checks to determine whether the user is a member of the Windows **Administrators** group, and will not collect [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] diagnostics if the user is not an **Administrators** group member.</span></span>  
  
 <span data-ttu-id="541ba-207">**/R**</span><span class="sxs-lookup"><span data-stu-id="541ba-207">**/R**</span></span>  
 <span data-ttu-id="541ba-208">Registra **SQLdiag** como servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-208">Registers **SQLdiag** as a service.</span></span> <span data-ttu-id="541ba-209">Cualquier argumento de la línea de comandos que se especifique al registrar **SQLdiag** como servicio se guarda para futuras ejecuciones del servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-209">Any command line arguments that are specified when you register **SQLdiag** as a service are preserved for future runs of the service.</span></span>  
  
 <span data-ttu-id="541ba-210">Cuando se registra **SQLdiag** como servicio, el nombre predeterminado del servicio es SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="541ba-210">When **SQLdiag** is registered as a service, the default service name is SQLDIAG.</span></span> <span data-ttu-id="541ba-211">Puede modificar el nombre de servicio con el argumento **/A** .</span><span class="sxs-lookup"><span data-stu-id="541ba-211">You can change the service name by using the **/A** argument.</span></span>  
  
 <span data-ttu-id="541ba-212">Use el argumento de línea de comandos **START** para iniciar el servicio:</span><span class="sxs-lookup"><span data-stu-id="541ba-212">Use the **START** command line argument to start the service:</span></span>  
  
 <span data-ttu-id="541ba-213">**SQLDIAG START**</span><span class="sxs-lookup"><span data-stu-id="541ba-213">**SQLDIAG START**</span></span>  
  
 <span data-ttu-id="541ba-214">También puede usar el comando **net start** para iniciar el servicio:</span><span class="sxs-lookup"><span data-stu-id="541ba-214">You can also use the **net start** command to start the service:</span></span>  
  
 <span data-ttu-id="541ba-215">**net start SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="541ba-215">**net start SQLDIAG**</span></span>  
  
 <span data-ttu-id="541ba-216">**/U**</span><span class="sxs-lookup"><span data-stu-id="541ba-216">**/U**</span></span>  
 <span data-ttu-id="541ba-217">Elimina del Registro **SQLdiag** como servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-217">Unregisters **SQLdiag** as a service.</span></span>  
  
 <span data-ttu-id="541ba-218">Use también el argumento **/A** si elimina del Registro una instancia con nombre de **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-218">Use the **/A** argument also if unregistering a named **SQLdiag** instance.</span></span>  
  
 <span data-ttu-id="541ba-219">**/L**</span><span class="sxs-lookup"><span data-stu-id="541ba-219">**/L**</span></span>  
 <span data-ttu-id="541ba-220">Ejecuta **SQLdiag** en modo continuo cuando se especifica además una hora de inicio o de finalización con los argumentos **/B** o **/E** , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="541ba-220">Runs **SQLdiag** in continuous mode when a start time or end time is also specified with the **/B** or **/E** arguments, respectively.</span></span> <span data-ttu-id="541ba-221">**SQLdiag** se reinicia automáticamente después de que se detenga la recopilación de diagnósticos debido a un cierre programado.</span><span class="sxs-lookup"><span data-stu-id="541ba-221">**SQLdiag** automatically restarts after diagnostics collection stops due to a scheduled shutdown.</span></span> <span data-ttu-id="541ba-222">Por ejemplo, con los argumentos **/E** o **/X** .</span><span class="sxs-lookup"><span data-stu-id="541ba-222">For example, by using the **/E** or the **/X** arguments.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-223">**SQLdiag** omite el argumento **/L** si no se especifica una hora de inicio o de finalización con los argumentos de la línea de comandos **/B** y **/E** .</span><span class="sxs-lookup"><span data-stu-id="541ba-223">**SQLdiag** ignores the **/L** argument if a start time or end time is not specified by using the **/B** and **/E** command line arguments.</span></span>  
  
 <span data-ttu-id="541ba-224">El uso de **/L** no implica el modo de servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-224">Using **/L** does not imply the service mode.</span></span> <span data-ttu-id="541ba-225">Para usar **/L** cuando se ejecuta **SQLdiag** como servicio, especifíquelo en la línea de comandos al registrar el servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-225">To use **/L** when running **SQLdiag** as a service, specify it on the command line when you register the service.</span></span>  
  
 <span data-ttu-id="541ba-226">**/X**</span><span class="sxs-lookup"><span data-stu-id="541ba-226">**/X**</span></span>  
 <span data-ttu-id="541ba-227">Ejecuta **SQLdiag** en modo de instantánea.</span><span class="sxs-lookup"><span data-stu-id="541ba-227">Runs **SQLdiag** in snapshot mode.</span></span> <span data-ttu-id="541ba-228">**SQLdiag** toma una instantánea de todos los diagnósticos configurados y después se cierra automáticamente.</span><span class="sxs-lookup"><span data-stu-id="541ba-228">**SQLdiag** takes a snapshot of all configured diagnostics and then shuts down automatically.</span></span>  
  
 <span data-ttu-id="541ba-229">**START** | **STOP** | **STOP_ABORT**</span><span class="sxs-lookup"><span data-stu-id="541ba-229">**START** | **STOP** | **STOP_ABORT**</span></span>  
 <span data-ttu-id="541ba-230">Inicia o detiene el servicio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-230">Starts or stops the **SQLdiag** service.</span></span> <span data-ttu-id="541ba-231">**STOP_ABORT** obliga al servicio a cerrarse lo más rápido posible sin terminar la recopilación de diagnósticos que está realizando.</span><span class="sxs-lookup"><span data-stu-id="541ba-231">**STOP_ABORT** forces the service to shut down as quickly as possible without finishing collection of diagnostics it is currently collecting.</span></span>  
  
 <span data-ttu-id="541ba-232">Cuando se emplean estos argumentos de control del servicio, deben ser los primeros argumentos utilizados en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-232">When these service control arguments are used, they must be the first argument used on the command line.</span></span> <span data-ttu-id="541ba-233">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="541ba-233">For example:</span></span>  
  
 <span data-ttu-id="541ba-234">**SQLDIAG START**</span><span class="sxs-lookup"><span data-stu-id="541ba-234">**SQLDIAG START**</span></span>  
  
 <span data-ttu-id="541ba-235">El argumento **/A** , que especifica una instancia con nombre de **SQLdiag**, es el único que se puede usar con **START**, **STOP**o **STOP_ABORT** para controlar una instancia específica del servicio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-235">Only the **/A** argument, which specifies a named instance of **SQLdiag**, can be used with **START**, **STOP**, or **STOP_ABORT** to control a specific instance of the **SQLdiag** service.</span></span> <span data-ttu-id="541ba-236">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="541ba-236">For example:</span></span>  
  
 <span data-ttu-id="541ba-237">**SQLDIAG START /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="541ba-237">**SQLDIAG START /A** _SQLdiag_application_name_</span></span>  
  
## <a name="security-requirements"></a><span data-ttu-id="541ba-238">Requisitos de seguridad</span><span class="sxs-lookup"><span data-stu-id="541ba-238">Security Requirements</span></span>  
 <span data-ttu-id="541ba-239">A menos que **SQLdiag** se ejecute en modo genérico (especificando el argumento de la línea de comandos **/G** ), el usuario que ejecuta **SQLdiag** debe ser miembro del grupo **Administradores** de Windows y del rol fijo de servidor [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sysadmin**.</span><span class="sxs-lookup"><span data-stu-id="541ba-239">Unless **SQLdiag** is run in generic mode (by specifying the **/G** command line argument), the user who runs **SQLdiag** must be a member of the Windows **Administrators** group and a member of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sysadmin** fixed server role.</span></span> <span data-ttu-id="541ba-240">De forma predeterminada, **SQLdiag** conecta con [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] mediante la autenticación de Windows, pero también admite la autenticación de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="541ba-240">By default, **SQLdiag** connects to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] by using Windows Authentication, but it also supports [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication.</span></span>  
  
## <a name="performance-considerations"></a><span data-ttu-id="541ba-241">Consideraciones de rendimiento</span><span class="sxs-lookup"><span data-stu-id="541ba-241">Performance Considerations</span></span>  
 <span data-ttu-id="541ba-242">Los efectos sobre el rendimiento de la ejecución de **SQLdiag** dependen del tipo de datos de diagnóstico cuya recopilación se haya configurado.</span><span class="sxs-lookup"><span data-stu-id="541ba-242">The performance effects of running **SQLdiag** depend on the type of diagnostic data you have configured it to collect.</span></span> <span data-ttu-id="541ba-243">Por ejemplo, si ha configurado **SQLdiag** para recopilar la información de seguimiento de [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , cuanto mayor sea el número de clases de eventos de las que decida realizar un seguimiento, más se verá afectado el rendimiento del servidor.</span><span class="sxs-lookup"><span data-stu-id="541ba-243">For example, if you have configured **SQLdiag** to collect [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] tracing information, the more event classes you choose to trace, the more your server performance is affected.</span></span>  
  
 <span data-ttu-id="541ba-244">El impacto sobre el rendimiento de la ejecución de **SQLdiag** es aproximadamente equivalente a la suma de los costos de recopilar los diagnósticos configurados por separado.</span><span class="sxs-lookup"><span data-stu-id="541ba-244">The performance impact of running **SQLdiag** is approximately equivalent to the sum of the costs of collecting the configured diagnostics separately.</span></span> <span data-ttu-id="541ba-245">Por ejemplo, si recopila un seguimiento con **SQLdiag** , incurrirá en el mismo costo de rendimiento que si lo recopila con [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="541ba-245">For example, collecting a trace with **SQLdiag** incurs the same performance cost as collecting it with [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="541ba-246">El impacto que el uso de **SQLdiag** tiene sobre el rendimiento es mínimo.</span><span class="sxs-lookup"><span data-stu-id="541ba-246">The performance impact of using **SQLdiag** is negligible.</span></span>  
  
## <a name="required-disk-space"></a><span data-ttu-id="541ba-247">Espacio en disco requerido</span><span class="sxs-lookup"><span data-stu-id="541ba-247">Required Disk Space</span></span>  
 <span data-ttu-id="541ba-248">Dado que **SQLdiag** puede recopilar diferentes tipos de información de diagnóstico, el espacio libre en disco necesario para ejecutar **SQLdiag** varía.</span><span class="sxs-lookup"><span data-stu-id="541ba-248">Because **SQLdiag** can collect different types of diagnostic information, the free disk space that is required to run **SQLdiag** varies.</span></span> <span data-ttu-id="541ba-249">La cantidad de información de diagnóstico recopilada depende de la naturaleza y del volumen de la carga de trabajo que el servidor está procesando y puede oscilar entre unos pocos megabytes o varios gigabytes.</span><span class="sxs-lookup"><span data-stu-id="541ba-249">The amount of diagnostic information collected depends on the nature and volume of the workload that the server is processing and may range from a few megabytes to several gigabytes.</span></span>  
  
## <a name="configuration-files"></a><span data-ttu-id="541ba-250">Archivos de configuración</span><span class="sxs-lookup"><span data-stu-id="541ba-250">Configuration Files</span></span>  
 <span data-ttu-id="541ba-251">Durante el inicio, **SQLdiag** lee el archivo de configuración y los argumentos de la línea de comandos que se han especificado.</span><span class="sxs-lookup"><span data-stu-id="541ba-251">On startup, **SQLdiag** reads the configuration file and the command line arguments that have been specified.</span></span> <span data-ttu-id="541ba-252">Puede especificar los tipos de información de diagnóstico que **SQLdiag** recopila en el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="541ba-252">You specify the types of diagnostic information that **SQLdiag** collects in the configuration file.</span></span> <span data-ttu-id="541ba-253">De forma predeterminada, **SQLdiag** usa el archivo de configuración SQLDiag.Xml, que se extrae cada vez que se ejecuta la herramienta y se encuentra ubicado en la carpeta de inicio de la utilidad **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-253">By default, **SQLdiag** uses the SQLDiag.Xml configuration file, which is extracted each time the tool runs and is located in the **SQLdiag** utility startup folder.</span></span> <span data-ttu-id="541ba-254">El archivo de configuración usa el esquema XML, SQLDiag_schema.xsd, que también se extrae en el directorio de inicio de la utilidad desde el archivo ejecutable cada vez que se ejecuta **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-254">The configuration file uses the XML schema, SQLDiag_schema.xsd, which is also extracted into the utility startup directory from the executable file each time **SQLdiag** runs.</span></span>  
  
### <a name="editing-the-configuration-files"></a><span data-ttu-id="541ba-255">Editar los archivos de configuración</span><span class="sxs-lookup"><span data-stu-id="541ba-255">Editing the Configuration Files</span></span>  
 <span data-ttu-id="541ba-256">Puede copiar y editar SQLDiag.Xml para cambiar los tipos de datos de diagnóstico que **SQLdiag** recopila.</span><span class="sxs-lookup"><span data-stu-id="541ba-256">You can copy and edit SQLDiag.Xml to change the types of diagnostic data that **SQLdiag** collects.</span></span> <span data-ttu-id="541ba-257">Cuando edite el archivo de configuración, use siempre un editor XML que pueda validar dicho archivo comparándolo con su esquema XML, como por ejemplo, [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)].</span><span class="sxs-lookup"><span data-stu-id="541ba-257">When editing the configuration file always use an XML editor that can validate the configuration file against its XML schema, such as [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)].</span></span> <span data-ttu-id="541ba-258">No debe editar SQLDiag.Xml directamente.</span><span class="sxs-lookup"><span data-stu-id="541ba-258">You should not edit SQLDiag.Xml directly.</span></span> <span data-ttu-id="541ba-259">En su lugar, realice una copia de SQLDiag.Xml y cambie su nombre por otro nombre de archivo en la misma carpeta.</span><span class="sxs-lookup"><span data-stu-id="541ba-259">Instead, make a copy of SQLDiag.Xml and rename it to a new file name in the same folder.</span></span> <span data-ttu-id="541ba-260">Después, edite el nuevo archivo y use el argumento **/I** para pasarlo a **SQLdiag**.</span><span class="sxs-lookup"><span data-stu-id="541ba-260">Then edit the new file, and use the **/I** argument to pass it to **SQLdiag**.</span></span>  
  
#### <a name="editing-the-configuration-file-when-sqldiag-runs-as-a-service"></a><span data-ttu-id="541ba-261">Editar el archivo de configuración cuando SQLdiag se ejecuta como servicio</span><span class="sxs-lookup"><span data-stu-id="541ba-261">Editing the Configuration File When SQLdiag Runs as a Service</span></span>  
 <span data-ttu-id="541ba-262">Si ya ha ejecutado **SQLdiag** como servicio y necesita editar el archivo de configuración, elimine del Registro el servicio SQLDIAG. Para ello, especifique el argumento de la línea de comandos **/U** y después vuelva a registrar el servicio mediante el argumento de la línea de comandos **/R** .</span><span class="sxs-lookup"><span data-stu-id="541ba-262">If you have already run **SQLdiag** as a service and need to edit the configuration file, unregister the SQLDIAG service by specifying the **/U** command line argument and then re-register the service by using the **/R** command line argument.</span></span> <span data-ttu-id="541ba-263">Si elimina el servicio del registro y lo vuelve a registrar, se eliminará la información de configuración antigua que se almacenó en caché en el Registro de Windows.</span><span class="sxs-lookup"><span data-stu-id="541ba-263">Unregistering and re-registering the service removes old configuration information that was cached in the Windows registry.</span></span>  
  
## <a name="output-folder"></a><span data-ttu-id="541ba-264">Carpeta de salida</span><span class="sxs-lookup"><span data-stu-id="541ba-264">Output Folder</span></span>  
 <span data-ttu-id="541ba-265">Si no especifica una carpeta de salida con el argumento **/O** , **SQLdiag** crea una subcarpeta denominada SQLDIAG en la carpeta de inicio de **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-265">If you do not specify an output folder with the **/O** argument, **SQLdiag** creates a subfolder named SQLDIAG under the **SQLdiag** startup folder.</span></span> <span data-ttu-id="541ba-266">Para la recopilación de información de diagnóstico que implica un elevado volumen de seguimientos, como [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , asegúrese de que la carpeta de salida se encuentra en una unidad local con espacio suficiente para almacenar la salida del diagnóstico solicitado.</span><span class="sxs-lookup"><span data-stu-id="541ba-266">For diagnostic information collection that involves high volume tracing, such as [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , make sure that the output folder is on a local drive with enough space to store the requested diagnostic output.</span></span>  
  
 <span data-ttu-id="541ba-267">Cuando se reinicia **SQLdiag** , sobrescribe el contenido de la carpeta de salida.</span><span class="sxs-lookup"><span data-stu-id="541ba-267">When **SQLdiag** is restarted, it overwrites the contents of the output folder.</span></span> <span data-ttu-id="541ba-268">Para evitarlo, especifique **/N 2** en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-268">To avoid this, specify **/N 2** on the command line.</span></span>  
  
## <a name="data-collection-process"></a><span data-ttu-id="541ba-269">Proceso de recopilación de datos</span><span class="sxs-lookup"><span data-stu-id="541ba-269">Data Collection Process</span></span>  
 <span data-ttu-id="541ba-270">Cuando se inicia **SQLdiag** , realiza las comprobaciones de inicialización necesarias para recopilar los datos de diagnóstico que se han especificado en SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="541ba-270">When **SQLdiag** starts, it performs the initialization checks necessary to collect the diagnostic data that have been specified in SQLDiag.Xml.</span></span> <span data-ttu-id="541ba-271">Este proceso puede tardar varios segundos.</span><span class="sxs-lookup"><span data-stu-id="541ba-271">This process may take several seconds.</span></span> <span data-ttu-id="541ba-272">Una vez que **SQLdiag** ha empezado a recopilar los datos de diagnóstico cuando se ejecuta como aplicación de consola, se muestra un mensaje que informa de que se ha iniciado la recopilación de **SQLdiag** y de que puede pulsar CTRL+C para detenerla.</span><span class="sxs-lookup"><span data-stu-id="541ba-272">After **SQLdiag** has started collecting diagnostic data when it is run as a console application, a message displays informing you that **SQLdiag** collection has started and that you can press CTRL+C to stop it.</span></span> <span data-ttu-id="541ba-273">Cuando **SQLdiag** se ejecuta como servicio, se escribe un mensaje similar en el registro de eventos de Windows.</span><span class="sxs-lookup"><span data-stu-id="541ba-273">When **SQLdiag** is run as a service, a similar message is written to the Windows event log.</span></span>  
  
 <span data-ttu-id="541ba-274">Si usa **SQLdiag** para diagnosticar un problema que puede reproducir, espere hasta que reciba este mensaje antes de reproducir el problema en el servidor.</span><span class="sxs-lookup"><span data-stu-id="541ba-274">If you are using **SQLdiag** to diagnose a problem that you can reproduce, wait until you receive this message before you reproduce the problem on your server.</span></span>  
  
 <span data-ttu-id="541ba-275">**SQLdiag** recopila la mayor parte de los datos de diagnóstico en paralelo.</span><span class="sxs-lookup"><span data-stu-id="541ba-275">**SQLdiag** collects most diagnostic data in parallel.</span></span> <span data-ttu-id="541ba-276">Para recopilar toda la información de diagnóstico se conecta con herramientas, como la utilidad [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sqlcmd** o el procesador de comandos de Windows, excepto cuando la información se recopila de los registros de rendimiento y de los registros de eventos de Windows.</span><span class="sxs-lookup"><span data-stu-id="541ba-276">All diagnostic information is collected by connecting to tools, such as the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sqlcmd** utility or the Windows command processor, except when information is collected from Windows performance logs and event logs.</span></span> <span data-ttu-id="541ba-277">**SQLdiag** usa un subproceso de trabajo por cada equipo para supervisar la recopilación de datos de diagnóstico de esas otras herramientas y, a menudo, espera simultáneamente a que varias herramientas completen su proceso.</span><span class="sxs-lookup"><span data-stu-id="541ba-277">**SQLdiag** uses one worker thread per computer to monitor the diagnostic data collection of these other tools, often simultaneously waiting for several tools to complete.</span></span> <span data-ttu-id="541ba-278">Durante el proceso de recopilación, **SQLdiag** enruta la salida de cada diagnóstico a la carpeta de salida.</span><span class="sxs-lookup"><span data-stu-id="541ba-278">During the collection process, **SQLdiag** routes the output from each diagnostic to the output folder.</span></span>  
  
## <a name="stopping-data-collection"></a><span data-ttu-id="541ba-279">Detener la recopilación de datos</span><span class="sxs-lookup"><span data-stu-id="541ba-279">Stopping Data Collection</span></span>  
 <span data-ttu-id="541ba-280">Cuando **SQLdiag** empieza a recopilar los datos de diagnóstico, continua haciéndolo a menos que el usuario lo detenga o que se configure para que se detenga a una hora especificada.</span><span class="sxs-lookup"><span data-stu-id="541ba-280">After **SQLdiag** starts collecting diagnostic data, it continues to do so unless you stop it or it is configured to stop at a specified time.</span></span> <span data-ttu-id="541ba-281">Puede configurar **SQLdiag** para que se detenga a una hora especificada mediante el argumento **/E** , que permite especificar una hora de detención, o mediante el argumento **/X** , que hace que **SQLdiag** se ejecute en el modo de instantánea.</span><span class="sxs-lookup"><span data-stu-id="541ba-281">You can configure **SQLdiag** to stop at a specified time by using the **/E** argument, which allows you to specify a stop time, or by using the **/X** argument, which causes **SQLdiag** to run in snapshot mode.</span></span>  
  
 <span data-ttu-id="541ba-282">Cuando **SQLdiag** se detenga, detendrá todos los diagnósticos que haya iniciado.</span><span class="sxs-lookup"><span data-stu-id="541ba-282">When **SQLdiag** stops, it stops all diagnostics it has started.</span></span> <span data-ttu-id="541ba-283">Por ejemplo, detiene los seguimientos de [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] que estaba recopilando, deja de ejecutar los scripts de [!INCLUDE[tsql](../includes/tsql-md.md)] que estaba ejecutando y detiene los subprocesos que ha generado durante la recopilación de datos.</span><span class="sxs-lookup"><span data-stu-id="541ba-283">For example, it stops [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] traces it was collecting, it stops executing [!INCLUDE[tsql](../includes/tsql-md.md)] scripts it was running, and it stops any sub processes it has spawned during data collection.</span></span> <span data-ttu-id="541ba-284">Una vez completada la recopilación de datos de diagnóstico, **SQLdiag** se cierra.</span><span class="sxs-lookup"><span data-stu-id="541ba-284">After diagnostic data collection has completed, **SQLdiag** exits.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-285">No se permite pausar el servicio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-285">Pausing the **SQLdiag** service is not supported.</span></span> <span data-ttu-id="541ba-286">Si intenta pausar el servicio **SQLdiag** , se detiene cuando finaliza la recopilación de los diagnósticos que estaba recopilando cuando se pausó.</span><span class="sxs-lookup"><span data-stu-id="541ba-286">If you attempt to pause the **SQLdiag** service, it stops after it finishes collecting the diagnostics that it was collecting when you paused it.</span></span> <span data-ttu-id="541ba-287">Si reinicia **SQLdiag** después de detenerlo, la aplicación se reinicia y sobrescribe el contenido de la carpeta de salida.</span><span class="sxs-lookup"><span data-stu-id="541ba-287">If you restart **SQLdiag** after stopping it, the application restarts and overwrites the output folder.</span></span> <span data-ttu-id="541ba-288">Para evitar sobrescribir la carpeta de salida, especifique **/N 2** en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-288">To avoid overwriting the output folder, specify **/N 2** on the command line.</span></span>  
  
 <span data-ttu-id="541ba-289">**Para detener SQLdiag cuando se ejecuta como aplicación de consola**</span><span class="sxs-lookup"><span data-stu-id="541ba-289">**To stop SQLdiag when running as a console application**</span></span>  
  
 <span data-ttu-id="541ba-290">Si está ejecutando **SQLdiag** como aplicación de consola, pulse CTRL+C en la ventana de la consola en la que se está ejecutando **SQLdiag** para detenerlo.</span><span class="sxs-lookup"><span data-stu-id="541ba-290">If you are running **SQLdiag** as a console application, press CTRL+C in the console window where **SQLdiag** is running to stop it.</span></span> <span data-ttu-id="541ba-291">Tras pulsar CTRL+C, se muestra un mensaje en la ventana de la consola que le informa de que la recopilación de datos de **SQLDiag** está finalizando y de que debe esperar hasta que se cierre el proceso, lo que puede tardar varios minutos.</span><span class="sxs-lookup"><span data-stu-id="541ba-291">After you press CTRL+C, a message displays in the console window informing you that **SQLDiag** data collection is ending, and that you should wait until the process shuts down, which may take several minutes.</span></span>  
  
 <span data-ttu-id="541ba-292">Presione CTRL+C dos veces para terminar todos los procesos de diagnóstico secundarios y cierre la aplicación inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="541ba-292">Press Ctrl+C twice to terminate all child diagnostic processes and immediately terminate the application.</span></span>  
  
 <span data-ttu-id="541ba-293">**Para detener SQLdiag cuando se ejecuta como servicio**</span><span class="sxs-lookup"><span data-stu-id="541ba-293">**To stop SQLdiag when running as a service**</span></span>  
  
 <span data-ttu-id="541ba-294">Si ejecuta **SQLdiag** como servicio, ejecute **SQLDiag STOP** en la carpeta de inicio de **SQLdiag** para detenerlo.</span><span class="sxs-lookup"><span data-stu-id="541ba-294">If you are running **SQLdiag** as a service, run **SQLDiag STOP** in the **SQLdiag** startup folder to stop it.</span></span>  
  
 <span data-ttu-id="541ba-295">Si ejecuta varias instancias de **SQLdiag** en el mismo equipo, también puede pasar el nombre de instancia de **SQLdiag** a la línea de comandos cuando detenga el servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-295">If you are running multiple instances of **SQLdiag** on the same computer, you can also pass the **SQLdiag** instance name to on the command line when you stop the service.</span></span> <span data-ttu-id="541ba-296">Por ejemplo, para detener una instancia de **SQLdiag** denominada Instance1, use la siguiente sintaxis:</span><span class="sxs-lookup"><span data-stu-id="541ba-296">For example, to stop a **SQLdiag** instance named Instance1, use the following syntax:</span></span>  
  
```  
SQLDIAG STOP /A Instance1  
```  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-297">**/A** es el único argumento de la línea de comandos que se puede usar con **START**, **STOP**o **STOP_ABORT**.</span><span class="sxs-lookup"><span data-stu-id="541ba-297">**/A** is the only command-line argument that can be used with **START**, **STOP**, or **STOP_ABORT**.</span></span> <span data-ttu-id="541ba-298">Si necesita especificar una instancia con nombre de **SQLdiag** con uno de los verbos de control del servicio, especifique **/A** tras el verbo de control en la línea de comandos como se muestra en el ejemplo de sintaxis anterior.</span><span class="sxs-lookup"><span data-stu-id="541ba-298">If you need to specify a named instance of **SQLdiag** with one of the service control verbs, specify **/A** after the control verb on the command line as shown in the previous syntax example.</span></span> <span data-ttu-id="541ba-299">Cuando se emplean estos verbos de control, deben ser los primeros argumentos utilizados en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-299">When control verbs are used, they must be the first argument on the command line.</span></span>  
  
 <span data-ttu-id="541ba-300">Para detener el servicio lo más rápido posible, ejecute **SQLDIAG STOP_ABORT** en la carpeta de inicio de la utilidad.</span><span class="sxs-lookup"><span data-stu-id="541ba-300">To stop the service as quickly as possible, run **SQLDIAG STOP_ABORT** in the utility startup folder.</span></span> <span data-ttu-id="541ba-301">Este comando anula todas las recopilaciones de diagnósticos en curso sin esperar a que terminen de ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="541ba-301">This command aborts any diagnostics collecting currently being performed without waiting for them to finish.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-302">Use **SQLDiag STOP** o **SQLDIAG STOP_ABORT** para detener el servicio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-302">Use **SQLDiag STOP** or **SQLDIAG STOP_ABORT** to stop the **SQLdiag** service.</span></span> <span data-ttu-id="541ba-303">No use la consola Servicios de Windows para detener **SQLdiag** u otros servicios de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="541ba-303">Do not use the Windows Services Console to stop **SQLdiag** or other [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] services.</span></span>  
  
## <a name="automatically-starting-and-stopping-sqldiag"></a><span data-ttu-id="541ba-304">Iniciar y detener automáticamente SQLdiag</span><span class="sxs-lookup"><span data-stu-id="541ba-304">Automatically Starting and Stopping SQLdiag</span></span>  
 <span data-ttu-id="541ba-305">Para iniciar y detener automáticamente la recopilación de datos de diagnóstico a una hora especificada, use los argumentos **/b**_start_time_ y **/e**_stop_time_ mediante la notación de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="541ba-305">To automatically start and stop diagnostic data collection at a specified time, use the **/B**_start_time_ and **/E**_stop_time_ arguments, using 24-hour notation.</span></span> <span data-ttu-id="541ba-306">Por ejemplo, si está solucionando un problema que suele aparecer a las 02:00:00 aproximadamente, puede configurar **SQLdiag** para empezar a recopilar automáticamente datos de diagnóstico a la 01:00 y dejar de recopilarlos a las 03:00:00.</span><span class="sxs-lookup"><span data-stu-id="541ba-306">For example, if you are troubleshooting a problem that consistently appears at approximately 02:00:00, you can configure **SQLdiag** to automatically start collecting diagnostic data at 01:00 and automatically stop at 03:00:00.</span></span> <span data-ttu-id="541ba-307">Use los argumentos **/B** y **/E** para especificar la hora de inicio y detención.</span><span class="sxs-lookup"><span data-stu-id="541ba-307">Use the **/B** and **/E** arguments to specify the start and stop time.</span></span> <span data-ttu-id="541ba-308">Utilice la notación de 24 horas para especificar una hora y una fecha de inicio y de finalización exactas con el formato AAAAMMDD_HH:MM:SS.</span><span class="sxs-lookup"><span data-stu-id="541ba-308">Use 24-hour notation to specify an exact start and stop date and time with the format YYYYMMDD_HH:MM:SS.</span></span> <span data-ttu-id="541ba-309">Para especificar una hora de inicio o detención relativa, anteponga **+** a la hora de inicio o de detención y omita la parte de la fecha (AAAAMMDD_) como se muestra en el siguiente ejemplo, lo que hace que **SQLdiag** espere 1 hora antes de empezar a recopilar información; después recopila la información durante 3 horas hasta que se detiene y se cierra:</span><span class="sxs-lookup"><span data-stu-id="541ba-309">To specify a relative start or stop time, prefix the start and stop time with **+** and omit the date portion (YYYYMMDD_) as shown in the following example, which causes **SQLdiag** to wait 1 hour before it starts collecting information, then it collects information for 3 hours before it stops and exits:</span></span>  
  
```  
sqldiag /B +01:00:00 /E +03:00:00  
```  
  
 <span data-ttu-id="541ba-310">Cuando se especifica un valor *start_time* relativo, **SQLdiag** se inicia a una hora relativa respecto a la hora y la fecha actuales.</span><span class="sxs-lookup"><span data-stu-id="541ba-310">When a relative *start_time* is specified, **SQLdiag** starts at a time that is relative to the current date and time.</span></span> <span data-ttu-id="541ba-311">Cuando se especifica un valor *end_time* relativo, **SQLdiag** finaliza a una hora relativa respecto al valor *start_time*especificado.</span><span class="sxs-lookup"><span data-stu-id="541ba-311">When a relative *end_time* is specified, **SQLdiag** ends at a time that is relative to the specified *start_time*.</span></span> <span data-ttu-id="541ba-312">Si la hora o la fecha de inicio y de finalización que ha especificado corresponden al pasado, **SQLdiag** cambiará forzosamente la fecha de inicio para que la fecha y la hora de inicio correspondan al futuro.</span><span class="sxs-lookup"><span data-stu-id="541ba-312">If the start or end date and time that you have specified is in the past, **SQLdiag** forcibly changes the start date so that the start date and time are in the future.</span></span>  
  
 <span data-ttu-id="541ba-313">Esto tiene importantes implicaciones para las fechas de inicio y de finalización que elija.</span><span class="sxs-lookup"><span data-stu-id="541ba-313">This has important implications on the start and end dates you choose.</span></span> <span data-ttu-id="541ba-314">Considere el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="541ba-314">Consider the following example:</span></span>  
  
```  
sqldiag /B +01:00:00 /E 08:30:00  
```  
  
 <span data-ttu-id="541ba-315">Si la hora actual es 08:00, la hora de finalización termina antes de que empiece la recopilación de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="541ba-315">If the current time is 08:00, the end time passes before diagnostic collection actually begins.</span></span> <span data-ttu-id="541ba-316">Dado que **SQLDiag** ajusta automáticamente las fechas de inicio y de finalización al día siguiente cuando corresponden al pasado, en este ejemplo, la recopilación de diagnósticos se inicia a las 09:00 de hoy (se ha especificado una hora de inicio relativa con **+** ) y continúa hasta las 08:30 del día siguiente.</span><span class="sxs-lookup"><span data-stu-id="541ba-316">Because **SQLDiag** automatically adjusts start and end dates to the next day when they occur in the past, in this example diagnostic collection starts at 09:00 today (a relative start time has been specified with **+**) and continues collecting until 08:30 the following morning.</span></span>  
  
### <a name="stopping-and-restarting-sqldiag-to-collect-daily-diagnostics"></a><span data-ttu-id="541ba-317">Detener y reiniciar SQLdiag para que recopile diagnósticos diariamente</span><span class="sxs-lookup"><span data-stu-id="541ba-317">Stopping and Restarting SQLdiag to Collect Daily Diagnostics</span></span>  
 <span data-ttu-id="541ba-318">Para recopilar diariamente un conjunto de diagnósticos especificado sin tener que iniciar y detener manualmente **SQLdiag**, use el argumento **/L** .</span><span class="sxs-lookup"><span data-stu-id="541ba-318">To collect a specified set of diagnostics on a daily basis without having to manually start and stop **SQLdiag**, use the **/L** argument.</span></span> <span data-ttu-id="541ba-319">El argumento **/L** hace que **SQLdiag** se ejecute de forma continua al reiniciarse automáticamente después de un cierre programado.</span><span class="sxs-lookup"><span data-stu-id="541ba-319">The **/L** argument causes **SQLdiag** to run continuously by automatically restarting itself after a scheduled shutdown.</span></span> <span data-ttu-id="541ba-320">Cuando se especifica **/L** y **SQLdiag** se detiene porque ha llegado la hora de finalización especificada con el argumento **/E** , o se detiene porque se está ejecutando en el modo de instantánea con el argumento **/X** , **SQLdiag** se reinicia en vez de cerrarse.</span><span class="sxs-lookup"><span data-stu-id="541ba-320">When **/L** is specified, and **SQLdiag** stops because it has reached the end time specified with the **/E** argument, or it stops because it is being run in snapshot mode by using the **/X** argument, **SQLdiag** restarts instead of exiting.</span></span>  
  
 <span data-ttu-id="541ba-321">En el siguiente ejemplo se especifica que **SQLdiag** se ejecute en modo continuo para que se reinicie automáticamente después de recopilar los datos de diagnóstico entre las 03:00:00 y las 05:00:00.</span><span class="sxs-lookup"><span data-stu-id="541ba-321">The following example specifies that **SQLdiag** run in continuous mode to automatically restart after diagnostic data collecting occurs between 03:00:00 and 05:00:00.</span></span>  
  
```  
sqldiag /B 03:00:00 /E 05:00:00 /L  
```  
  
 <span data-ttu-id="541ba-322">En el siguiente ejemplo se especifica que **SQLdiag** se ejecute en modo continuo para que se reinicie automáticamente después de tomar una instantánea de datos de diagnóstico a las 03:00:00.</span><span class="sxs-lookup"><span data-stu-id="541ba-322">The following example specifies that **SQLdiag** run in continuous mode to automatically restart after taking a diagnostic data snapshot at 03:00:00.</span></span>  
  
```  
sqldiag /B 03:00:00 /X /L  
```  
  
## <a name="running-sqldiag-as-a-service"></a><span data-ttu-id="541ba-323">Ejecutar SQLdiag como servicio</span><span class="sxs-lookup"><span data-stu-id="541ba-323">Running SQLdiag as a Service</span></span>  
 <span data-ttu-id="541ba-324">Si desea usar **SQLdiag** para recopilar los datos de diagnóstico durante largos períodos de tiempo en los que puede ser necesario cerrar sesión en el equipo en el que se está ejecutando **SQLdiag** , puede ejecutarlo como servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-324">When you want to use **SQLdiag** to collect diagnostic data for long periods of time during which you might need to log out of the computer on which **SQLdiag** is running, you can run it as a service.</span></span>  
  
 <span data-ttu-id="541ba-325">**Para registrar SQLDiag para que se ejecute como servicio**</span><span class="sxs-lookup"><span data-stu-id="541ba-325">**To register SQLDiag to run as a service**</span></span>  
  
 <span data-ttu-id="541ba-326">Puede registrar **SQLdiag** para que se ejecute como servicio si especifica el argumento **/R** en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-326">You can register **SQLdiag** to run as a service by specifying the **/R** argument at the command line.</span></span> <span data-ttu-id="541ba-327">De esta forma se registra **SQLdiag** para que se ejecute como servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-327">This registers **SQLdiag** to run as a service.</span></span> <span data-ttu-id="541ba-328">El nombre de servicio de **SQLdiag** es SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="541ba-328">The **SQLdiag** service name is SQLDIAG.</span></span> <span data-ttu-id="541ba-329">Cualquier otro argumento que especifique en la línea de comandos cuando registre **SQLDiag** como servicio se conservará y se reutilizará cuando se inicie el servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-329">Any other arguments you specify on the command line when you register **SQLDiag** as a service are preserved and reused when the service is started.</span></span>  
  
 <span data-ttu-id="541ba-330">Para cambiar el nombre predeterminado del servicio SQLDIAG, use el argumento de la línea de comandos **/A** .</span><span class="sxs-lookup"><span data-stu-id="541ba-330">To change the default SQLDIAG service name, use the **/A** command-line argument to specify another name.</span></span> <span data-ttu-id="541ba-331">**SQLdiag** agrega el prefijo DIAG$ de forma automática a cualquier nombre de instancia de **SQLdiag** especificado con **/A** para crear nombres de servicio significativos.</span><span class="sxs-lookup"><span data-stu-id="541ba-331">**SQLdiag** automatically prefixes DIAG$ to any **SQLdiag** instance name specified with **/A** to create sensible service names.</span></span>  
  
 <span data-ttu-id="541ba-332">**Para eliminar el servicio SQLDIAG del registro**</span><span class="sxs-lookup"><span data-stu-id="541ba-332">**To unregister the SQLDIAG service**</span></span>  
  
 <span data-ttu-id="541ba-333">Para eliminar el servicio del Registro, especifique el argumento **/U** .</span><span class="sxs-lookup"><span data-stu-id="541ba-333">To unregister the service, specify the **/U** argument.</span></span> <span data-ttu-id="541ba-334">Si elimina del Registro **SQLdiag** como servicio, también se eliminan las claves del servicio del Registro de Windows.</span><span class="sxs-lookup"><span data-stu-id="541ba-334">Unregistering **SQLdiag** as a service also deletes the Windows registry keys of the service.</span></span>  
  
 <span data-ttu-id="541ba-335">**Para iniciar o reiniciar el servicio SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="541ba-335">**To start or restart the SQLDIAG service**</span></span>  
  
 <span data-ttu-id="541ba-336">Para iniciar o reiniciar el servicio SQLDIAG, ejecute **SQLDiag START** desde la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-336">To start or restart the SQLDIAG service, run **SQLDiag START** from the command line.</span></span>  
  
 <span data-ttu-id="541ba-337">Si ejecuta varias instancias de **SQLdiag** con el argumento **/A** , también puede pasar el nombre de instancia de **SQLdiag** en la línea de comandos cuando inicie el servicio.</span><span class="sxs-lookup"><span data-stu-id="541ba-337">If you are running multiple instances of **SQLdiag** by using the **/A** argument, you can also pass the **SQLdiag** instance name on the command line when you start the service.</span></span> <span data-ttu-id="541ba-338">Por ejemplo, para iniciar una instancia de **SQLdiag** denominada Instance1, use la siguiente sintaxis:</span><span class="sxs-lookup"><span data-stu-id="541ba-338">For example, to start a **SQLdiag** instance named Instance1, use the following syntax:</span></span>  
  
```  
SQLDIAG START /A Instance1  
```  
  
 <span data-ttu-id="541ba-339">También puede usar el comando **net start** para iniciar el servicio SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="541ba-339">You can also use the **net start** command to start the SQLDIAG service.</span></span>  
  
 <span data-ttu-id="541ba-340">Cuando se reinicia **SQLdiag**, sobrescribe el contenido de la carpeta de salida actual.</span><span class="sxs-lookup"><span data-stu-id="541ba-340">When you restart **SQLdiag**, it overwrites the contents in the current output folder.</span></span> <span data-ttu-id="541ba-341">Para evitarlo, especifique **/N 2** en la línea de comandos para cambiar el nombre de la carpeta de salida cuando se inicie la utilidad.</span><span class="sxs-lookup"><span data-stu-id="541ba-341">To avoid this, specify **/N 2** on the command line to rename the output folder when the utility starts.</span></span>  
  
 <span data-ttu-id="541ba-342">No se permite pausar el servicio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="541ba-342">Pausing the **SQLdiag** service is not supported.</span></span>  
  
## <a name="running-multiple-instances-of-sqldiag"></a><span data-ttu-id="541ba-343">Ejecutar varias instancias de SQLdiag</span><span class="sxs-lookup"><span data-stu-id="541ba-343">Running Multiple Instances of SQLdiag</span></span>  
 <span data-ttu-id="541ba-344">Ejecute varias instancias de **SQLdiag** en el mismo equipo especificando **/a**_SQLdiag_application_name_ en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-344">Run multiple instances of **SQLdiag** on the same computer by specifying **/A**_SQLdiag_application_name_ on the command line.</span></span> <span data-ttu-id="541ba-345">Resulta útil para recopilar distintos conjuntos de diagnósticos de la misma instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] de forma simultánea.</span><span class="sxs-lookup"><span data-stu-id="541ba-345">This is useful for collecting different sets of diagnostics simultaneously from the same [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="541ba-346">Por ejemplo, puede configurar una instancia con nombre de **SQLdiag** para que ejecute una recopilación de datos ligera de forma constante.</span><span class="sxs-lookup"><span data-stu-id="541ba-346">For example, you can configure a named instance of **SQLdiag** to continuously perform lightweight data collection.</span></span> <span data-ttu-id="541ba-347">De este modo, si se produce un problema específico en [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], puede ejecutar la instancia predeterminada de **SQLdiag** para recopilar los diagnósticos relativos a ese problema o para recopilar un conjunto de diagnósticos que los servicios de soporte al cliente de [!INCLUDE[msCoName](../includes/msconame-md.md)] le hayan solicitado para diagnosticar un problema.</span><span class="sxs-lookup"><span data-stu-id="541ba-347">Then, if a specific problem occurs on [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], you can run the default **SQLdiag** instance to collect diagnostics for that problem, or to gather a set of diagnostics that [!INCLUDE[msCoName](../includes/msconame-md.md)] Customer Support Services has asked you to gather to diagnose a problem.</span></span>  
  
## <a name="collecting-diagnostic-data-from-clustered-sql-server-instances"></a><span data-ttu-id="541ba-348">Recopilar datos de diagnóstico de instancias de SQL Server en clúster</span><span class="sxs-lookup"><span data-stu-id="541ba-348">Collecting Diagnostic Data from Clustered SQL Server Instances</span></span>  
 <span data-ttu-id="541ba-349">**SQLdiag** permite recopilar datos de diagnóstico de instancias de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] en clúster.</span><span class="sxs-lookup"><span data-stu-id="541ba-349">**SQLdiag** supports collecting diagnostic data from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances.</span></span> <span data-ttu-id="541ba-350">Para recopilar diagnósticos de instancias de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] agrupadas, asegúrese de que se especifica **"."** para el atributo **name** del elemento **\<Machine>** en el archivo de configuración SQLDiag.Xml y no especifique el argumento **/G** en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-350">To gather diagnostics from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances, make sure that **"."** is specified for the **name** attribute of the **\<Machine>** element in the configuration file SQLDiag.Xml and do not specify the **/G** argument on the command line.</span></span> <span data-ttu-id="541ba-351">De forma predeterminada, se especifica **"."** para el atributo **name** del archivo de configuración y se desactiva el argumento **/G** .</span><span class="sxs-lookup"><span data-stu-id="541ba-351">By default, **"."** is specified for the **name** attribute in the configuration file and the **/G** argument is turned off.</span></span> <span data-ttu-id="541ba-352">Normalmente, cuando se realiza la recopilación desde una instancia de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] en clúster, no es necesario editar el archivo de configuración ni cambiar los argumentos de la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="541ba-352">Typically, you do not need to edit the configuration file or change the command line arguments when collecting from a clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="541ba-353">Si se especifica **"."** como nombre de equipo, **SQLdiag** detecta que se está ejecutando en un clúster y recupera simultáneamente la información de diagnóstico de todas las instancias virtuales de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instaladas en el clúster.</span><span class="sxs-lookup"><span data-stu-id="541ba-353">When **"."** is specified as the machine name, **SQLdiag** detects that it is running on a cluster, and simultaneously retrieves diagnostic information from all virtual instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that are installed on the cluster.</span></span> <span data-ttu-id="541ba-354">Si quiere recopilar información de diagnóstico solo de una de las instancias virtuales de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] que se ejecutan en el equipo, especifique ese [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] virtual para el atributo **name** del elemento **\<Machine>** de SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="541ba-354">If you want to collect diagnostic information from only one virtual instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that is running on a computer, specify that virtual [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] for the **name** attribute of the **\<Machine>** element in SQLDiag.Xml.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="541ba-355">Para recopilar información de seguimiento de [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] desde instancias agrupadas de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , deben habilitarse los recursos compartidos con fines administrativos (ADMIN$) en el clúster.</span><span class="sxs-lookup"><span data-stu-id="541ba-355">To collect [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] trace information from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances, administrative shares (ADMIN$) must be enabled on the cluster.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="541ba-356">Consulte también</span><span class="sxs-lookup"><span data-stu-id="541ba-356">See Also</span></span>  
 [<span data-ttu-id="541ba-357">Referencia de la utilidad del símbolo del sistema &#40;motor de base de datos&#41;</span><span class="sxs-lookup"><span data-stu-id="541ba-357">Command Prompt Utility Reference &#40;Database Engine&#41;</span></span>](command-prompt-utility-reference-database-engine.md)  
  
  
