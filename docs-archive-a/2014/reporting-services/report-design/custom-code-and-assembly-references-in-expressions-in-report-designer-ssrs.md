---
title: Referencias a ensamblados y código personalizado en expresiones en el Diseñador de informes (SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87748018"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="b8fc4-102">Referencias a ensamblados y código personalizado en expresiones en el Diseñador de informes (SSRS)</span><span class="sxs-lookup"><span data-stu-id="b8fc4-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="b8fc4-103">Puede agregar referencias al código personalizado incrustado en un informe o a los ensamblados personalizados que haya generado y guardado en el equipo e implementado en el servidor de informes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="b8fc4-104">El código incrustado se utiliza en constantes, funciones complejas o funciones personalizadas que se usan varias veces en un único informe.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="b8fc4-105">Use ensamblados de código personalizados para mantener el código en un único lugar y compartirlo con el fin de utilizarlos en múltiples informes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="b8fc4-106">El código personalizado puede incluir nuevas constantes, variables, funciones o subrutinas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="b8fc4-107">Puede incluir referencias de solo lectura en las colecciones integradas, como la colección Parameters.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="b8fc4-108">Sin embargo, no puede pasar conjuntos de valores de datos de informe a las funciones personalizadas; concretamente, no se admiten agregados personalizados.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="b8fc4-109">Para cálculos dependientes del tiempo que se evalúan una sola vez en tiempo de ejecución y cuyo valor desea conservar a lo largo del procesamiento del informe, considere la posibilidad de usar una variable de informe o una variable de grupo.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="b8fc4-110">Para más información, vea [Referencias a las colecciones de variables de informe y de grupo &#40;Generador de informes y SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="b8fc4-111">El Diseñador de informes es el entorno de creación preferido para agregar código personalizado a un informe.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="b8fc4-112">El Generador de informes admite el procesamiento de informes que tienen expresiones válidas o que incluyen referencias a ensamblados personalizados en un servidor de informes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="b8fc4-113">El Generador de informes no proporciona un medio para agregar una referencia a un ensamblado personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b8fc4-114">Tenga en cuenta que durante la actualización de un servidor de informes, los informes que dependen de ensamblados personalizados pueden requerir pasos adicionales para completar la actualización.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="b8fc4-115">Para obtener más información, vea [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a> <span data-ttu-id="b8fc4-116">Trabajar con código personalizado en el Generador de informes</span><span class="sxs-lookup"><span data-stu-id="b8fc4-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="b8fc4-117">En el Generador de informes, puede abrir un informe desde un servidor de informes que incluya referencias a ensamblados personalizados.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="b8fc4-118">Por ejemplo, puede modificar los informes creados e implementados mediante el uso del Diseñador de informes en [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8fc4-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="b8fc4-119">Los ensamblados personalizados deben implementarse en el servidor de informes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="b8fc4-120">No puede realizar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="b8fc4-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="b8fc4-121">Agregar referencias o instancias de miembro de clase a un informe.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="b8fc4-122">Obtener una vista previa de un informe con referencias a ensamblados personalizados en modo local.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="b8fc4-123">Incluir referencias a funciones de uso frecuente</span><span class="sxs-lookup"><span data-stu-id="b8fc4-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="b8fc4-124">Use el cuadro de diálogo **Expresión** para ver una lista organizada en categorías de las funciones de uso frecuente integradas en [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8fc4-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="b8fc4-125">Si expande **Funciones comunes** y hace clic en una categoría, el panel **Elemento** muestra la lista de funciones que puede incluir en una expresión.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="b8fc4-126">Entre las funciones comunes se incluyen las clases de los [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> <xref:System.Convert> espacios de nombres y y las funciones de la biblioteca en tiempo de [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] ejecución.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="b8fc4-127">Para mayor comodidad, puede ver las funciones de uso más frecuente en el cuadro de diálogo **Expresión** , donde aparecen agrupadas por categorías: Texto, Fecha y hora, Matemáticas, Inspección, Flujo de programa, Agregado, Finanzas, Conversión y Varios.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="b8fc4-128">Las funciones de uso menos frecuente no aparecen en la lista, pero se pueden usar en una expresión.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="b8fc4-129">Para usar una función integrada, haga doble clic en el nombre de la función en el panel Elemento.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="b8fc4-130">En el panel Descripción, aparece una descripción de la función; en el panel Ejemplo, aparece un ejemplo de la llamada a la función.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="b8fc4-131">En el panel de código, al escribir el nombre de la función seguido de un paréntesis izquierdo **(**, la ayuda de IntelliSense muestra todas las sintaxis válidas para la llamada de función.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="b8fc4-132">Por ejemplo, para calcular el valor máximo de un campo denominado `Quantity` en una tabla, agregue la expresión simple `=Max(` al panel de código y, a continuación, use las etiquetas inteligentes para ver todas las posibles sintaxis válidas para la llamada a la función.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="b8fc4-133">Para completar este ejemplo, escriba `=Max(Fields!Quantity.Value)`.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="b8fc4-134">Para más información sobre cada función, vea <xref:System.Math>, <xref:System.Convert>y [Miembros de la biblioteca en tiempo de ejecución de Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) en MSDN.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a><span data-ttu-id="b8fc4-135">Incluir referencias a funciones de uso menos frecuente</span><span class="sxs-lookup"><span data-stu-id="b8fc4-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="b8fc4-136">Para incluir una referencia a otros espacios de nombres de CLR de uso menos frecuente es necesario usar una referencia completa (por ejemplo, <xref:System.Text.StringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="b8fc4-137">IntelliSense no se admite en el panel de código del cuadro de diálogo **Expresión** para estas funciones menos frecuentes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="b8fc4-138">Para obtener más información, vea [Miembros de la biblioteca en tiempo de ejecución de Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) en MSDN.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a> <span data-ttu-id="b8fc4-139">Incluir referencias a ensamblados externos</span><span class="sxs-lookup"><span data-stu-id="b8fc4-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="b8fc4-140">Para incluir una referencia a una clase de un ensamblado externo, debe identificar el ensamblado para el procesador de informes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="b8fc4-141">Use la página **Referencias** del cuadro de diálogo **Propiedades del informe** para especificar el nombre completo del ensamblado que se va a agregar al informe.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="b8fc4-142">En la expresión, debe usar el nombre completo para la clase del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="b8fc4-143">Las clases de un ensamblado externo no aparecen en el cuadro de diálogo **Expresión** ; es necesario que proporcione el nombre correcto de la clase.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="b8fc4-144">Un nombre completo incluye el espacio de nombres, el nombre de la clase y el nombre del miembro.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a> <span data-ttu-id="b8fc4-145">Incluir código incrustado</span><span class="sxs-lookup"><span data-stu-id="b8fc4-145">Including Embedded Code</span></span>  
 <span data-ttu-id="b8fc4-146">Para agregar código incrustado a un informe, use la pestaña Código del cuadro de diálogo **Propiedades del informe** .</span><span class="sxs-lookup"><span data-stu-id="b8fc4-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="b8fc4-147">El bloque de código que cree puede contener varios métodos.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="b8fc4-148">Los métodos del código incrustado se deben escribir en [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] y deben estar basados en instancias.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="b8fc4-149">El procesador de informes agrega automáticamente referencias para los espacios de nombres System.Convert y System.Math.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="b8fc4-150">Use la página **Referencias** del cuadro de diálogo **Propiedades del informe** para agregar referencias de ensamblado adicionales.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="b8fc4-151">Para más información, vea [Agregar una referencia de ensamblado a un informe &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="b8fc4-152">Los métodos del código incrustado están disponibles a través del miembro `Code` definido globalmente.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="b8fc4-153">Para tener acceso a ellos, se hace referencia al miembro `Code` y al nombre del método.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="b8fc4-154">En el siguiente ejemplo, se llama al método `ToUSD`, que convierte el valor del campo `StandardCost` en un valor de moneda:</span><span class="sxs-lookup"><span data-stu-id="b8fc4-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="b8fc4-155">Para hacer referencia a colecciones integradas en el código personalizado, incluya una referencia al objeto integrado `Report`:</span><span class="sxs-lookup"><span data-stu-id="b8fc4-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="b8fc4-156">En los ejemplos siguientes se muestra cómo definir algunas constantes y variables personalizadas.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="b8fc4-157">Aunque las constantes personalizadas no aparecen en la categoría **Constantes** del cuadro de diálogo **Expresión** (que solo muestra las constantes integradas), se pueden agregar referencias a ellas desde cualquier expresión, como se muestra en los ejemplos siguientes.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="b8fc4-158">En una expresión, una constante personalizada se trata como `Variant`.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="b8fc4-159">En el ejemplo siguiente se incluyen tanto la referencia a código como la implementación en el código de la función `FixSpelling`, que sustituye por el texto `"Bicycle"` todas las repeticiones del texto "Bike" en el campo `SubCategory`.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="b8fc4-160">Cuando el código siguiente se incrusta en un bloque de código de la definición de informe, muestra una implementación del método `FixSpelling`.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="b8fc4-161">En este ejemplo se muestra cómo usar una referencia completa a la [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` clase.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="b8fc4-162">Para más información sobre las colecciones de objetos integradas y la inicialización, vea [Referencias a campos globales y de usuario integrados &#40;Generador de informes y SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) e [Inicializar objetos de ensamblados personalizados](../custom-assemblies/initializing-custom-assembly-objects.md).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a> <span data-ttu-id="b8fc4-163">Incluir referencias a parámetros desde el código</span><span class="sxs-lookup"><span data-stu-id="b8fc4-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="b8fc4-164">Se puede hacer referencia a la colección global Parameters mediante código personalizado en un bloque de código de la definición de informe o en un ensamblado personalizado proporcionado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="b8fc4-165">La colección Parameters es de solo lectura y no tiene iteradores públicos.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="b8fc4-166">No se puede usar una [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construcción para recorrer la colección.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="b8fc4-167">Debe conocer el nombre del parámetro definido en la definición de informe para poder hacer referencia a él en el código.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="b8fc4-168">No obstante, puede recorrer en iteración todos los valores de un parámetro de varios valores.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="b8fc4-169">En la tabla siguiente se incluyen ejemplos de referencias a la colección integrada `Parameters` desde código personalizado:</span><span class="sxs-lookup"><span data-stu-id="b8fc4-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="b8fc4-170">Descripción</span><span class="sxs-lookup"><span data-stu-id="b8fc4-170">Description</span></span>|<span data-ttu-id="b8fc4-171">Referencia en la expresión</span><span class="sxs-lookup"><span data-stu-id="b8fc4-171">Reference in Expression</span></span>|<span data-ttu-id="b8fc4-172">Definición del código personalizado</span><span class="sxs-lookup"><span data-stu-id="b8fc4-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="b8fc4-173">Pasa la totalidad de la colección global Parameters al código personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="b8fc4-174">Esta función devuelve el valor de un parámetro de informe determinado, *MyParameter*.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="b8fc4-175">Pasa un parámetro individual al código personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="b8fc4-176">En este ejemplo se devuelve el valor del parámetro pasado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="b8fc4-177">Si el parámetro es un parámetro de varios valores, la cadena devuelta es una concatenación de todos los valores.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a> <span data-ttu-id="b8fc4-178">Incluir referencias al código desde ensamblados personalizados</span><span class="sxs-lookup"><span data-stu-id="b8fc4-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="b8fc4-179">Para utilizar ensamblados personalizados en un informe, primero debe crear el ensamblado, hacer que esté disponible para el Diseñador de informes, agregar una referencia a él en el informe y, a continuación, utilizar una expresión en el informe que haga referencia a los métodos de dicho ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="b8fc4-180">Cuando implemente el informe en el servidor de informes, también debe implementar el ensamblado personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="b8fc4-181">Para obtener información sobre cómo crear un ensamblado personalizado y hacer que esté disponible en [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], vea [Usar ensamblados personalizados con informes](../custom-assemblies/using-custom-assemblies-with-reports.md).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="b8fc4-182">Para incluir en una expresión una referencia a código personalizado, debe llamar al miembro de una clase dentro del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="b8fc4-183">La manera de hacerlo depende de si el método es estático o se basa en instancias.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="b8fc4-184">Los métodos estáticos de un ensamblado de código están disponibles globalmente en el informe.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="b8fc4-185">El acceso a estos métodos estáticos en expresiones se lleva a cabo a través de la especificación del espacio de nombres, la clase y el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="b8fc4-186">En el ejemplo siguiente se llama al método `ToGBP` , que convierte el valor del valor **StandardCost** de dólares a libras esterlinas:</span><span class="sxs-lookup"><span data-stu-id="b8fc4-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="b8fc4-187">Los métodos basados en instancias están disponibles a través del miembro `Code` definido globalmente.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="b8fc4-188">Para tener acceso a estos métodos, debe hacerse referencia al miembro `Code`, seguido del nombre de la instancia y del método.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="b8fc4-189">En el ejemplo siguiente se llama al método `ToEUR` de instancia, que convierte el valor de **StandardCost** de dólares a euros:</span><span class="sxs-lookup"><span data-stu-id="b8fc4-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="b8fc4-190">En el Diseñador de informes, un ensamblado personalizado se carga una vez y no se descarga hasta que se cierra [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b8fc4-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="b8fc4-191">Si se obtiene la vista previa de un informe, se realizan cambios en un ensamblado personalizado que se utiliza en el informe y, después, se vuelve a obtener la vista previa del informe, los cambios no aparecerán en la segunda vista previa.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="b8fc4-192">Para volver a cargar el ensamblado, cierre [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] , vuelva a abrirlo y obtenga la vista previa del informe.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="b8fc4-193">Para obtener más información sobre cómo tener acceso al código, vea [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a> <span data-ttu-id="b8fc4-194">Pasar colecciones integradas a ensamblados personalizados</span><span class="sxs-lookup"><span data-stu-id="b8fc4-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="b8fc4-195">Si quiere pasar colecciones integradas (como las colecciones *Globals* o *Parameters* ) a un ensamblado personalizado para su procesamiento, necesita agregar una referencia de ensamblado de su proyecto de código al ensamblado que define las colecciones integradas y el acceso al espacio de nombres correcto.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="b8fc4-196">Dependiendo de si desarrolla el ensamblado personalizado para un informe que se ejecuta en un servidor de informes (informe de servidor) o para un informe que se ejecuta localmente en una aplicación .NET (informe local), el ensamblado al que debe hacerse referencia será diferente.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="b8fc4-197">Consulte a continuación para más información.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-197">See below for details.</span></span>  
  
-   <span data-ttu-id="b8fc4-198">**Espacio de nombres:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="b8fc4-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="b8fc4-199">**Ensamblado (informe local):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="b8fc4-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="b8fc4-200">**Ensamblado (informe de servidor):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="b8fc4-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="b8fc4-201">Como el contenido de las colecciones *Fields* y *ReportItems* puede cambiar dinámicamente en tiempo de ejecución, no las incluya en las llamadas al ensamblado personalizado (por ejemplo, en una variable miembro).</span><span class="sxs-lookup"><span data-stu-id="b8fc4-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="b8fc4-202">La misma recomendación se aplica normalmente a todas las colecciones integradas.</span><span class="sxs-lookup"><span data-stu-id="b8fc4-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b8fc4-203">Consulte también</span><span class="sxs-lookup"><span data-stu-id="b8fc4-203">See Also</span></span>  
 <span data-ttu-id="b8fc4-204">[Agregar código a un informe &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="b8fc4-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="b8fc4-205">[Usar ensamblados personalizados con informes](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="b8fc4-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="b8fc4-206">[Agregar una referencia de ensamblado a un informe &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="b8fc4-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="b8fc4-207">[Reporting Services tutoriales &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="b8fc4-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="b8fc4-208">[Ejemplos de expresiones &#40;Generador de informes y SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="b8fc4-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="b8fc4-209">Ejemplos de informes (Generador de informes y SSRS)</span><span class="sxs-lookup"><span data-stu-id="b8fc4-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  
