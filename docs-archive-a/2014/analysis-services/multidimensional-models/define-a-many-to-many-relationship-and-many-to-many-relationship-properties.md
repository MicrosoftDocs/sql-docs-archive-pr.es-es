---
title: Definir una relación de varios a varios y las propiedades de la relación de varios a varios | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- many-to-many relationships [Analysis Services]
ms.assetid: edb5f61a-a581-467a-a367-134b7f9b849f
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cd5d46ce07ff8eb6a3893c0dac261797c6ef19e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87676695"
---
# <a name="define-a-many-to-many-relationship-and-many-to-many-relationship-properties"></a><span data-ttu-id="66d8f-102">Definir una relación de varios a varios y las propiedades de las relaciones de varios a varios</span><span class="sxs-lookup"><span data-stu-id="66d8f-102">Define a Many-to-Many Relationship and Many-to-Many Relationship Properties</span></span>
  <span data-ttu-id="66d8f-103">En este tema se explican las dimensiones varios a varios de Analysis Services, incluido cuándo usarlas y cómo crearlas.</span><span class="sxs-lookup"><span data-stu-id="66d8f-103">This topic explains many-to-many dimensions in Analysis Services, including when to use them and how to create them.</span></span>  
  
## <a name="introduction"></a><span data-ttu-id="66d8f-104">Introducción</span><span class="sxs-lookup"><span data-stu-id="66d8f-104">Introduction</span></span>  
 <span data-ttu-id="66d8f-105">Analysis Services admite dimensiones varios a varios, lo que permite realizar análisis más complejos que los que se pueden describir en un esquema de estrella clásico.</span><span class="sxs-lookup"><span data-stu-id="66d8f-105">Analysis Services supports many-to-many dimensions, allowing for more complex analytics than what can be described in a classic star schema.</span></span> <span data-ttu-id="66d8f-106">En un esquema de estrella clásico, todas las dimensiones tienen una relación uno a varios con un tabla de hechos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-106">In a classic star schema, all dimensions have a one-to-many relationship with a fact table.</span></span> <span data-ttu-id="66d8f-107">Cada hecho se combina con un miembro de dimensión; un único miembro de dimensión está asociado a varios hechos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-107">Each fact joins to one dimension member; a single dimension member is associated with many facts.</span></span>  
  
 <span data-ttu-id="66d8f-108">La relación de varios a varios elimina esta restricción de modelado al permitir que un hecho (como el saldo de una cuenta) se asocie a varios miembros de la misma dimensión (el saldo de una cuenta conjunta se puede atribuir a dos o más propietarios de una cuenta conjunta).</span><span class="sxs-lookup"><span data-stu-id="66d8f-108">Many-to-many removes this modeling restriction by enabling a fact (such as an account balance) to be associated with multiple members of the same dimension (the balance of a joint account can be attributed to two or more owners of a joint account).</span></span>  
  
 <span data-ttu-id="66d8f-109">Conceptualmente, una relación dimensional de varios a varios en Analysis Services es equivalente a las relaciones de varios a varios de un modelo relacional y admite los mismos tipos de escenarios.</span><span class="sxs-lookup"><span data-stu-id="66d8f-109">Conceptually, a many-to-many dimensional relationship in Analysis Services is equivalent to many-to-many relationships in a relational model, supporting the same kinds of scenarios.</span></span> <span data-ttu-id="66d8f-110">He aquí algunos ejemplos de relaciones de varios a varios:</span><span class="sxs-lookup"><span data-stu-id="66d8f-110">Common examples of many-to-many include:</span></span>  
  
-   <span data-ttu-id="66d8f-111">Los alumnos se inscriben en varios cursos; cada curso tiene varios alumnos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-111">Students are enrolled in many courses; each course has many students.</span></span>  
  
-   <span data-ttu-id="66d8f-112">Los médicos tienen varios pacientes; los pacientes tienen varios médicos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-112">Doctors have many patients; patients have many doctors.</span></span>  
  
-   <span data-ttu-id="66d8f-113">Los clientes tienen varias cuentas bancarias; las cuentas bancarias pueden pertenecer a más de un cliente.</span><span class="sxs-lookup"><span data-stu-id="66d8f-113">Customers have many bank accounts; bank accounts might belong to more than one customer.</span></span>  
  
-   <span data-ttu-id="66d8f-114">En Adventure Works, varios clientes tienen varias razones para pedir un producto, y un motivo de venta puede estar asociado a varios pedidos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-114">In Adventure Works, many customers have many reasons for ordering a product, and a sales reason can be associated with many orders.</span></span>  
  
 <span data-ttu-id="66d8f-115">Analíticamente, el problema que resuelve una relación de varios a varios es una representación exacta de un recuento o una suma con respecto a la relación dimensional (eliminando normalmente los dobles recuentos al realizar cálculos para un miembro de dimensión determinado).</span><span class="sxs-lookup"><span data-stu-id="66d8f-115">Analytically, the problem that a many-to-many relationship solves is accurate representation of a count or sum relative to the dimensional relationship (usually by eliminating double-counts when performing calculations for a specific dimension member).</span></span> <span data-ttu-id="66d8f-116">Es necesario ver un ejemplo para aclarar este concepto.</span><span class="sxs-lookup"><span data-stu-id="66d8f-116">An example is necessary to clarify this point.</span></span> <span data-ttu-id="66d8f-117">Imagine un producto o un servicio que pertenece a más de una categoría.</span><span class="sxs-lookup"><span data-stu-id="66d8f-117">Consider a product or service that belongs to more than one category.</span></span> <span data-ttu-id="66d8f-118">Si estuviera contando el número de servicios por categoría, querría que un servicio que pertenezca a ambas categorías se incluyera en todas las categorías.</span><span class="sxs-lookup"><span data-stu-id="66d8f-118">If you were counting the number of services by category, you would want a service belonging to both categories to be included in each one.</span></span> <span data-ttu-id="66d8f-119">Al mismo tiempo, no querría exagerar el número de servicios que proporciona.</span><span class="sxs-lookup"><span data-stu-id="66d8f-119">At the same time, you would not want to overstate the number of services that you provide.</span></span> <span data-ttu-id="66d8f-120">Al especificar la relación dimensional de varios a varios, es más probable que obtenga los resultados correctos al consultar por categoría o por servicio.</span><span class="sxs-lookup"><span data-stu-id="66d8f-120">By specifying the many-to-many dimensional relationship, you are more likely to get the correct results back when querying by category or by service.</span></span> <span data-ttu-id="66d8f-121">Sin embargo, siempre es necesario realizar pruebas exhaustivas para asegurarse de que este es el caso.</span><span class="sxs-lookup"><span data-stu-id="66d8f-121">However, thorough testing is always necessary to ensure that this is the case.</span></span>  
  
 <span data-ttu-id="66d8f-122">Estructuralmente, la creación de una relación dimensional de varios a varios es similar a la creación de una relación de varios a varios en un modelo de datos relacionales.</span><span class="sxs-lookup"><span data-stu-id="66d8f-122">Structurally, creating a many-to-many dimensional relationship is similar to how you might create many-to-many in a relational data model.</span></span> <span data-ttu-id="66d8f-123">Mientras que un modelo relacional emplea una *tabla de unión* para almacenar las asociaciones de filas, un modelo multidimensional utiliza un *grupo de medida intermedio*.</span><span class="sxs-lookup"><span data-stu-id="66d8f-123">Whereas a relational model uses a *junction table* to store row associations, a multidimensional model uses an *intermediate measure group*.</span></span> <span data-ttu-id="66d8f-124">El grupo de medida intermedio es el término que usamos para referirnos a una tabla que asigna miembros de distintas dimensiones.</span><span class="sxs-lookup"><span data-stu-id="66d8f-124">Intermediate measure group is the term we use to refer to a table that maps members from different dimensions.</span></span>  
  
 <span data-ttu-id="66d8f-125">Visualmente, una relación dimensional de varios a varios no se indica en un diagrama de cubo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-125">Visually, a many-to-many dimensional relationship is not indicated in a cube diagram.</span></span> <span data-ttu-id="66d8f-126">En su lugar, usa la pestaña Uso de dimensiones para identificar rápidamente cualquier relación de varios a varios de un modelo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-126">Instead, use the Dimension Usage tab to quickly identify any many-to-many relationships in a model.</span></span> <span data-ttu-id="66d8f-127">Una relación de varios a varios se indica mediante el icono siguiente.</span><span class="sxs-lookup"><span data-stu-id="66d8f-127">A many-to-many relationship is indicated by the following icon.</span></span>  
  
 <span data-ttu-id="66d8f-128">![Icono de varios a varios en Uso de dimensiones](../media/ssas-m2m-icondimusage.png "Icono de varios a varios en Uso de dimensiones")</span><span class="sxs-lookup"><span data-stu-id="66d8f-128">![Many-to-many icon in dimension usage](../media/ssas-m2m-icondimusage.png "Many-to-many icon in dimension usage")</span></span>  
  
 <span data-ttu-id="66d8f-129">Haga clic en el botón para abrir el cuadro de diálogo Definir relación con el fin de comprobar que el tipo de relación es varios a varios y ver qué grupo de medida intermedio se emplea en la relación.</span><span class="sxs-lookup"><span data-stu-id="66d8f-129">Click the button to open the Define Relationship dialog box to verify the relationship type is many-to-many, and to view which intermediate measure group is used in the relationship.</span></span>  
  
 <span data-ttu-id="66d8f-130">![Botón definir relación en uso de dimensiones](../media/ssas-m2m-btndimusage.png "Botón definir relación en uso de dimensiones")</span><span class="sxs-lookup"><span data-stu-id="66d8f-130">![Define Relationship button  in dimension usage](../media/ssas-m2m-btndimusage.png "Define Relationship button  in dimension usage")</span></span>  
  
 <span data-ttu-id="66d8f-131">En secciones posteriores aprenderá a configurar una dimensión varios a varios y probar los comportamientos del modelo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-131">In subsequent sections, you will learn how to set up a many-to-many dimension and test model behaviors.</span></span> <span data-ttu-id="66d8f-132">Si prefiere ver información adicional o seguir algún tutorial primero, vea **Más información** al final de este artículo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-132">If you would rather review additional information or try tutorials first, see **Learn More** at the end of this article.</span></span>  
  
## <a name="create-a-many-to-many-dimension"></a><span data-ttu-id="66d8f-133">Crear una dimensión varios a varios</span><span class="sxs-lookup"><span data-stu-id="66d8f-133">Create a many-to-many dimension</span></span>  
 <span data-ttu-id="66d8f-134">Una relación de varios a varios sencilla incluye dos dimensiones que tienen una cardinalidad varios a varios, un grupo de medida intermedio para almacenar asociaciones de miembros y un grupo de medida de hechos que contiene datos que se pueden medir, como una suma de ventas totales o el saldo de una cuenta bancaria.</span><span class="sxs-lookup"><span data-stu-id="66d8f-134">A simple many-to-many relationship includes two dimensions having a many-to-many cardinality, an intermediate measure group for storing member associations, and a fact measure group containing measurable data, such as sum of total sales or the balance of a bank account.</span></span>  
  
 <span data-ttu-id="66d8f-135">Las dimensiones de una relación de varios a varios pueden tener tablas correspondientes en la vista del origen de datos, donde cada dimensión del modelo se basa en una tabla existente en un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-135">Dimensions in a many-to-many relationship might have correspondent tables in the DSV, where each dimension in the model is based on an existing table in a data source.</span></span> <span data-ttu-id="66d8f-136">Por el contrario, las dimensiones del modelo pueden derivar de menos tablas físicas o de tablas físicas diferentes de la vista del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-136">Conversely, the dimensions in your model might derive from fewer or different physical tables in the DSV.</span></span> <span data-ttu-id="66d8f-137">Usando Razones de venta y Pedidos de venta como ejemplo, el cubo de ejemplo de Adventure Works muestra una relación de varios a varios que usa dimensiones que existen como estructuras de datos solo del modelo, sin homólogos físicos en la vista del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-137">Using Sales Reasons and Sales Orders as a case in point, the Adventure Works sample cube demonstrates a many-to-many relationship using dimensions that exist as model-only data structures, without physical counterparts in the DSV.</span></span> <span data-ttu-id="66d8f-138">La dimensión Pedidos de venta se basa en una tabla de hechos, no en una tabla de dimensiones, del origen de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="66d8f-138">The Sales Order dimension is based on a fact table, rather than a dimension table, in the underlying data source.</span></span>  
  
 <span data-ttu-id="66d8f-139">En el procedimiento siguiente se da por supuesto que ya sabe qué entidades participan en la relación de varios a varios.</span><span class="sxs-lookup"><span data-stu-id="66d8f-139">The next procedure assumes that you already know which entities participate in the many-to-many relationship.</span></span> <span data-ttu-id="66d8f-140">Vea **Más información** si desea más información al respecto.</span><span class="sxs-lookup"><span data-stu-id="66d8f-140">See **Learn More** for further study.</span></span>  
  
 <span data-ttu-id="66d8f-141">Con el fin de ilustrar los pasos necesarios para crear una relación de varios a varios, en este procedimiento se vuelve a crear una de las relaciones de varios a varios del cubo de ejemplo de Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="66d8f-141">To illustrate the steps used to create a many-to-many relationship, this procedure re-creates one of the many-to-many relationships in the Adventure Works sample cube.</span></span> <span data-ttu-id="66d8f-142">Si tiene el origen de datos (es decir, el almacenamiento de datos de ejemplo Adventure Works) instalado en una instancia de un motor de base de datos relacional, puede seguir estos pasos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-142">If you have the source data (that is, the Adventure Works sample data warehouse) installed on a relational database engine instance, you can follow these steps.</span></span>  
  
#### <a name="step-1-verify-dsv-relationships"></a><span data-ttu-id="66d8f-143">Paso 1: comprobar las relaciones de la vista del origen de datos</span><span class="sxs-lookup"><span data-stu-id="66d8f-143">Step 1: Verify DSV relationships</span></span>  
  
1.  <span data-ttu-id="66d8f-144">En SQL Server Data Tools, en un proyecto multidimensional, cree un origen de datos en el almacenamiento de datos relacional Adventure Works DW 2012, hospedado en una instancia de Motor de base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="66d8f-144">In SQL Server Data Tools, in a multidimensional project, create a data source to the Adventure Works DW 2012 relational data warehouse, hosted on a SQL Server Database Engine instance.</span></span>  
  
2.  <span data-ttu-id="66d8f-145">Cree una vista del origen de datos con las siguientes tablas existentes:</span><span class="sxs-lookup"><span data-stu-id="66d8f-145">Create a Data Source View using the following existing tables:</span></span>  
  
    -   <span data-ttu-id="66d8f-146">FactInternetSales</span><span class="sxs-lookup"><span data-stu-id="66d8f-146">FactInternetSales</span></span>  
  
    -   <span data-ttu-id="66d8f-147">FactInternetSalesReason</span><span class="sxs-lookup"><span data-stu-id="66d8f-147">FactInternetSalesReason</span></span>  
  
    -   <span data-ttu-id="66d8f-148">DimSalesReason</span><span class="sxs-lookup"><span data-stu-id="66d8f-148">DimSalesReason</span></span>  
  
3.  <span data-ttu-id="66d8f-149">Compruebe que todas las tablas que piensa usar en las relaciones de varios a varios están relacionadas en la vista del origen de datos mediante relaciones de clave principal.</span><span class="sxs-lookup"><span data-stu-id="66d8f-149">Verify that all of the tables you plan to use in the many-to-many relationships are related in the DSV through primary key relationships.</span></span> <span data-ttu-id="66d8f-150">Esto es obligatorio para poder establecer un vínculo al grupo de medida intermedio en un paso posterior.</span><span class="sxs-lookup"><span data-stu-id="66d8f-150">This is a requirement for establishing a link to the intermediate measure group in a subsequent step.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="66d8f-151">Si el origen de datos subyacente no proporciona relaciones de clave principal y externa, puede crear las relaciones manualmente en la vista del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-151">If the underlying data source does not provide primary and foreign key relationships, you can create the relationships manually in the DSV.</span></span> <span data-ttu-id="66d8f-152">Para más información, vea [Definir relaciones lógicas en una vista del origen de datos &#40;Analysis Services&#41;](define-logical-relationships-in-a-data-source-view-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="66d8f-152">For more information, see [Define Logical Relationships in a Data Source View &#40;Analysis Services&#41;](define-logical-relationships-in-a-data-source-view-analysis-services.md).</span></span>  
  
     <span data-ttu-id="66d8f-153">El ejemplo siguiente confirma que las tablas utilizadas en este procedimiento están vinculadas mediante claves principales.</span><span class="sxs-lookup"><span data-stu-id="66d8f-153">The following example confirms that the tables used in this procedure are linked using primary keys.</span></span>  
  
     <span data-ttu-id="66d8f-154">![Vista del origen de datos que muestra tablas relacionadas](../media/ssas-m2m-dsvpkeys.PNG "Vista del origen de datos que muestra tablas relacionadas")</span><span class="sxs-lookup"><span data-stu-id="66d8f-154">![DSV showing related tables](../media/ssas-m2m-dsvpkeys.PNG "DSV showing related tables")</span></span>  
  
#### <a name="step-2-create-dimensions-and-measure-groups"></a><span data-ttu-id="66d8f-155">Paso 2: crear dimensiones y grupos de medida</span><span class="sxs-lookup"><span data-stu-id="66d8f-155">Step 2: Create dimensions and measure groups</span></span>  
  
1.  <span data-ttu-id="66d8f-156">En SQL Server Data Tools, en un proyecto multidimensional, haga clic con el botón derecho en **Dimensiones** y seleccione **Nueva dimensión**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-156">In SQL Server Data Tools, in a multidimensional project, right-click **Dimensions** and select **New Dimension**.</span></span>  
  
2.  <span data-ttu-id="66d8f-157">Cree una dimensión nueva basada en la tabla existente **DimSalesReason**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-157">Create a new dimension based on existing table, **DimSalesReason**.</span></span> <span data-ttu-id="66d8f-158">Acepte todos los valores predeterminados al especificar el origen.</span><span class="sxs-lookup"><span data-stu-id="66d8f-158">Accept all of the default values when specifying the source.</span></span>  
  
     <span data-ttu-id="66d8f-159">En los atributos, selecciónelos todos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-159">For attributes, select all.</span></span>  
  
     <span data-ttu-id="66d8f-160">![Lista de atributos en nueva dimensión](../media/ssas-m2m-dimsalesreason.PNG "Lista de atributos en nueva dimensión")</span><span class="sxs-lookup"><span data-stu-id="66d8f-160">![Attributes list in new dimension](../media/ssas-m2m-dimsalesreason.PNG "Attributes list in new dimension")</span></span>  
  
3.  <span data-ttu-id="66d8f-161">Cree una segunda dimensión basada en la tabla existente Fact Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="66d8f-161">Create a second dimension based on existing table, Fact Internet Sales.</span></span> <span data-ttu-id="66d8f-162">Aunque se trata de una tabla de hechos, contiene información de Pedido de venta.</span><span class="sxs-lookup"><span data-stu-id="66d8f-162">Although this is a fact table, it contains Sales Order information.</span></span> <span data-ttu-id="66d8f-163">La usaremos para crear una dimensión Sales Order.</span><span class="sxs-lookup"><span data-stu-id="66d8f-163">We'll use it to build a Sales Order dimension.</span></span>  
  
4.  <span data-ttu-id="66d8f-164">En Especificar información de origen, verá una advertencia que indica que se debe especificar una columna Nombre.</span><span class="sxs-lookup"><span data-stu-id="66d8f-164">In Specify Source Information, you will see a warning that indicates a Name column must be specified.</span></span> <span data-ttu-id="66d8f-165">Elija **SalesOrderNumber** como nombre.</span><span class="sxs-lookup"><span data-stu-id="66d8f-165">Choose **SalesOrderNumber** as the Name.</span></span>  
  
     <span data-ttu-id="66d8f-166">![Dimensión Sales Order que muestra la columna de nombre](../media/ssas-m2m-dimsalesordersource.PNG "Dimensión Sales Order que muestra la columna de nombre")</span><span class="sxs-lookup"><span data-stu-id="66d8f-166">![Sales Order dimension showing the name column](../media/ssas-m2m-dimsalesordersource.PNG "Sales Order dimension showing the name column")</span></span>  
  
5.  <span data-ttu-id="66d8f-167">En la página siguiente del asistente, elija los atributos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-167">On the next page of the wizard, choose the attributes.</span></span> <span data-ttu-id="66d8f-168">En este ejemplo, puede seleccionar simplemente **SalesOrderNumber**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-168">In this example, you can select just **SalesOrderNumber**.</span></span>  
  
     <span data-ttu-id="66d8f-169">![Dimensión Sales order que muestra la lista de atributos](../media/ssas-m2m-dimsalesorderattrib.PNG "Dimensión Sales order que muestra la lista de atributos")</span><span class="sxs-lookup"><span data-stu-id="66d8f-169">![Sales order dimension showing attribute list](../media/ssas-m2m-dimsalesorderattrib.PNG "Sales order dimension showing attribute list")</span></span>  
  
6.  <span data-ttu-id="66d8f-170">Cambie el nombre de la dimensión a **Dim Sales Orders**, para que tenga una convención de nomenclatura coherente para las dimensiones.</span><span class="sxs-lookup"><span data-stu-id="66d8f-170">Rename the dimension to **Dim Sales Orders**, so that you have a consistent naming convention for the dimensions.</span></span>  
  
     <span data-ttu-id="66d8f-171">![Página del asistente que muestra el cambio de nombre de dimensión](../media/ssas-m2m-dimsalesorders.PNG "Página del asistente que muestra el cambio de nombre de dimensión")</span><span class="sxs-lookup"><span data-stu-id="66d8f-171">![Wizard page showing dimension rename](../media/ssas-m2m-dimsalesorders.PNG "Wizard page showing dimension rename")</span></span>  
  
7.  <span data-ttu-id="66d8f-172">Haga clic con el botón derecho en **Cubos** y seleccione **Nuevo cubo**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-172">Right-click **Cubes** and select **New Cube**.</span></span>  
  
8.  <span data-ttu-id="66d8f-173">En las tablas de grupo de medida, elija **FactInternetSales** y **FactInternetSalesReason**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-173">In measure group tables, choose **FactInternetSales** and **FactInternetSalesReason**.</span></span>  
  
     <span data-ttu-id="66d8f-174">Elige **FactInternetSales** porque contiene las medidas que desea usar en el cubo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-174">You are choosing **FactInternetSales** because it contains the measures you want to use in the cube.</span></span> <span data-ttu-id="66d8f-175">Elige **FactInternetSalesReason** porque es el grupo de medida intermedio que proporciona datos de asociación de miembros que relaciona los pedidos de venta con las razones de venta.</span><span class="sxs-lookup"><span data-stu-id="66d8f-175">You are choosing **FactInternetSalesReason** because it is the intermediate measure group, providing member association data that relates sales orders to sales reasons.</span></span>  
  
9. <span data-ttu-id="66d8f-176">Elija medidas para cada tabla de hechos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-176">Choose measures for each fact table.</span></span>  
  
     <span data-ttu-id="66d8f-177">Para simplificar el modelo, borre todas las medidas y, luego, seleccione solamente **Sales Amount** y **Fact Internet Sales Count** en la parte inferior de la lista.</span><span class="sxs-lookup"><span data-stu-id="66d8f-177">To simplify your model, clear all the measures, and then select just **Sales Amount** and **Fact Internet Sales Count** at the bottom of the list.</span></span> <span data-ttu-id="66d8f-178">**FactInternetSalesReason** tiene solo una medida, por lo que se selecciona automáticamente.</span><span class="sxs-lookup"><span data-stu-id="66d8f-178">The **FactInternetSalesReason** only has one measure, so it is selected for you automatically.</span></span>  
  
10. <span data-ttu-id="66d8f-179">En la lista de dimensiones, debe ver **Dim Sales Reason** y **Dim Sales Orders**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-179">In the dimension list, you should see **Dim Sales Reason** and **Dim Sales Orders**.</span></span>  
  
     <span data-ttu-id="66d8f-180">En la página Seleccionar nuevas dimensiones, el asistente le preguntará si desea crear una dimensión nueva para **Fact Internet Sales Dimension**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-180">In the Select New Dimensions page, the wizard prompts you to create a new dimension for **Fact Internet Sales Dimension**.</span></span> <span data-ttu-id="66d8f-181">No necesita esta dimensión, por lo que puede quitarla de la lista.</span><span class="sxs-lookup"><span data-stu-id="66d8f-181">You do not need this dimension, so you can clear it from the list.</span></span>  
  
11. <span data-ttu-id="66d8f-182">Asigne nombre al cubo y haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-182">Name the cube and click **Finish**.</span></span>  
  
#### <a name="step-3-define-many-to-many-relationship"></a><span data-ttu-id="66d8f-183">Paso 3: definir la relación de varios a varios</span><span class="sxs-lookup"><span data-stu-id="66d8f-183">Step 3: Define Many-to-Many relationship</span></span>  
  
1.  <span data-ttu-id="66d8f-184">En el diseñador de cubos, haga clic en la pestaña uso de dimensiones. Observe que ya hay una relación de varios a varios entre **Dim sales Reason** y **Fact Internet sales**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-184">In cube designer, click Dimension Usage tab. Notice that there is already a many-to-many relationship between **Dim Sales Reason** and **Fact Internet Sales**.</span></span> <span data-ttu-id="66d8f-185">Recuerde que el icono siguiente indica una relación de varios a varios.</span><span class="sxs-lookup"><span data-stu-id="66d8f-185">Recall that the following icon indicates a many-to-many relationship.</span></span>  
  
     <span data-ttu-id="66d8f-186">![Icono de varios a varios en Uso de dimensiones](../media/ssas-m2m-icondimusage.png "Icono de varios a varios en Uso de dimensiones")</span><span class="sxs-lookup"><span data-stu-id="66d8f-186">![Many-to-many icon in dimension usage](../media/ssas-m2m-icondimusage.png "Many-to-many icon in dimension usage")</span></span>  
  
2.  <span data-ttu-id="66d8f-187">Haga clic en la celda que es la intersección entre **Dim Sales Reason** y **Fact Internet Sales**y, luego, haga clic en el botón para abrir el cuadro de diálogo Definir relación.</span><span class="sxs-lookup"><span data-stu-id="66d8f-187">Click on the intersection cell between **Dim Sales Reason** and **Fact Internet Sales**, and then click the button to open the Define Relationship dialog box.</span></span>  
  
     <span data-ttu-id="66d8f-188">Puede ver que este cuadro de diálogo se usa para especificar una relación de varios a varios.</span><span class="sxs-lookup"><span data-stu-id="66d8f-188">You can see that this dialog box is used to specify a many-to-many relationship.</span></span> <span data-ttu-id="66d8f-189">Si fuera a agregar en su lugar dimensiones que tuvieran una relación normal, usaría este cuadro de diálogo para cambiarla a una relación de varios a varios.</span><span class="sxs-lookup"><span data-stu-id="66d8f-189">If you were adding dimensions that had a regular relationship instead, you would use this dialog box to change it to many-to-many.</span></span>  
  
     <span data-ttu-id="66d8f-190">![Botón definir relación en uso de dimensiones](../media/ssas-m2m-btndimusage.png "Botón definir relación en uso de dimensiones")</span><span class="sxs-lookup"><span data-stu-id="66d8f-190">![Define Relationship button  in dimension usage](../media/ssas-m2m-btndimusage.png "Define Relationship button  in dimension usage")</span></span>  
  
3.  <span data-ttu-id="66d8f-191">Implemente el proyecto en una instancia multidimensional de Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="66d8f-191">Deploy the project to an Analysis Services multidimensional instance.</span></span> <span data-ttu-id="66d8f-192">En el paso siguiente, examinará el cubo en Excel para comprobar sus comportamientos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-192">In the next step, you will browse the cube in Excel to verify its behaviors.</span></span>  
  
## <a name="testing-many-to-many"></a><span data-ttu-id="66d8f-193">Probar relaciones de varios a varios</span><span class="sxs-lookup"><span data-stu-id="66d8f-193">Testing Many-to-Many</span></span>  
 <span data-ttu-id="66d8f-194">Cuando se define una relación de varios a varios en un cubo, es obligatorio asegurarse de que las consultas devuelven los resultados esperados.</span><span class="sxs-lookup"><span data-stu-id="66d8f-194">When you define a many-to-many relationship in a cube, testing is imperative to ensure queries return expected results.</span></span> <span data-ttu-id="66d8f-195">Debe probar el cubo con la herramienta de la aplicación cliente que usarán los usuarios finales.</span><span class="sxs-lookup"><span data-stu-id="66d8f-195">You should test the cube using the client application tool that will be used by end-users.</span></span> <span data-ttu-id="66d8f-196">En el procedimiento siguiente, usará Excel para conectarse al cubo y comprobar los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="66d8f-196">In this next procedure, you will use Excel to connect to the cube and verify query results.</span></span>  
  
#### <a name="browse-the-cube-in-excel"></a><span data-ttu-id="66d8f-197">Examinar el cubo en Excel</span><span class="sxs-lookup"><span data-stu-id="66d8f-197">Browse the cube in Excel</span></span>  
  
1.  <span data-ttu-id="66d8f-198">Implemente el proyecto y examine el cubo para confirmar que las agregaciones son válidas.</span><span class="sxs-lookup"><span data-stu-id="66d8f-198">Deploy the project and then browse the cube to confirm the aggregations are valid.</span></span>  
  
2.  <span data-ttu-id="66d8f-199">En Excel, haga clic en **datos**  |  **de otros orígenes**  |  **desde Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-199">In Excel, click **Data** | **From Other Sources** | **From Analysis Services**.</span></span> <span data-ttu-id="66d8f-200">Especifique el nombre del servidor, y elija la base de datos y el cubo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-200">Enter the name of the server, choose the database and cube.</span></span>  
  
3.  <span data-ttu-id="66d8f-201">Cree una tabla dinámica que use lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="66d8f-201">Create a PivotTable that uses the following:</span></span>  
  
    -   <span data-ttu-id="66d8f-202">**Sales Amount** como valor</span><span class="sxs-lookup"><span data-stu-id="66d8f-202">**Sales Amount** as the Value</span></span>  
  
    -   <span data-ttu-id="66d8f-203">**Sales Reason Name** en columnas</span><span class="sxs-lookup"><span data-stu-id="66d8f-203">**Sales Reason Name** on Columns</span></span>  
  
    -   <span data-ttu-id="66d8f-204">**Sales Order Number** en Filas</span><span class="sxs-lookup"><span data-stu-id="66d8f-204">**Sales Order Number** on Rows</span></span>  
  
4.  <span data-ttu-id="66d8f-205">Analice los resultados.</span><span class="sxs-lookup"><span data-stu-id="66d8f-205">Analyze the results.</span></span> <span data-ttu-id="66d8f-206">Como estamos usando datos de ejemplo, la impresión inicial es que todos los pedidos de ventas tienen valores idénticos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-206">Because we are using sample data, the initial impression is that all sales orders have identical values.</span></span> <span data-ttu-id="66d8f-207">Sin embargo, si se desplaza hacia abajo, empieza a ver variaciones en los datos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-207">However, if you scroll down, you begin to see data variation.</span></span>  
  
     <span data-ttu-id="66d8f-208">Un poco hacia abajo puede ver el importe y las razones de ventas del número de pedido **SO5382**.</span><span class="sxs-lookup"><span data-stu-id="66d8f-208">Part way down, you can find the sales amount and sales reasons for order number **SO5382**.</span></span> <span data-ttu-id="66d8f-209">El total general de este pedido concreto es **539,99**y entre las razones se compra atribuidas a este pedido se incluyen Promotion, Other y Price.</span><span class="sxs-lookup"><span data-stu-id="66d8f-209">Grand total of this particular order is **539.99**, and the purchase reasons attributed to this order include Promotion, Other and Price.</span></span>  
  
     <span data-ttu-id="66d8f-210">![Hoja de cálculo de Excel que muestra agregaciones varios a varios](../media/ssas-m2m-excel.png "Hoja de cálculo de Excel que muestra agregaciones varios a varios")</span><span class="sxs-lookup"><span data-stu-id="66d8f-210">![Excel worksheet showing many-to-many aggregations](../media/ssas-m2m-excel.png "Excel worksheet showing many-to-many aggregations")</span></span>  
  
     <span data-ttu-id="66d8f-211">Observe que el importe de Sales Amount se calculó correctamente para el pedido; es **539,99** para todo el pedido.</span><span class="sxs-lookup"><span data-stu-id="66d8f-211">Notice that the Sales Amount is correctly calculated for the order; it is **539.99** for the entire order.</span></span> <span data-ttu-id="66d8f-212">Aunque se indica **539,99** para todas las razones, ese valor no se sumó para las tres razones, lo que infla erróneamente nuestro total general.</span><span class="sxs-lookup"><span data-stu-id="66d8f-212">Although **539.99** is indicated for each reason, that value is not summed for all three reasons, erroneously inflating our grand total.</span></span>  
  
     <span data-ttu-id="66d8f-213">En primer lugar, ¿por qué incluir un importe de ventas bajo cada razón de venta?</span><span class="sxs-lookup"><span data-stu-id="66d8f-213">Why put a sales amount under each sales reason in the first place?</span></span> <span data-ttu-id="66d8f-214">La respuesta es que nos permite identificar el importe de ventas que podemos atribuir a cada razón.</span><span class="sxs-lookup"><span data-stu-id="66d8f-214">The answer is that it allows us to identify the amount of sales we can attribute to each reason.</span></span>  
  
5.  <span data-ttu-id="66d8f-215">Desplácese hasta el final de la hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-215">Scroll to the bottom of the worksheet.</span></span> <span data-ttu-id="66d8f-216">Ahora es fácil ver que el precio es la razón más importante de las compras de los clientes con respecto a las demás razones y al total general.</span><span class="sxs-lookup"><span data-stu-id="66d8f-216">It is now easy to see that Price is the most important reason for customer purchases, relative to other reasons as well as the grand total.</span></span>  
  
     <span data-ttu-id="66d8f-217">![Libro de Excel que muestra totales en varios a varios](../media/ssas-m2m-excelgrandtotal.png "Libro de Excel que muestra totales en varios a varios")</span><span class="sxs-lookup"><span data-stu-id="66d8f-217">![Excel workbook showing totals in many-to-many](../media/ssas-m2m-excelgrandtotal.png "Excel workbook showing totals in many-to-many")</span></span>  
  
#### <a name="tips-for-handling-unexpected-query-results"></a><span data-ttu-id="66d8f-218">Sugerencias para controlar resultados inesperados de la consulta</span><span class="sxs-lookup"><span data-stu-id="66d8f-218">Tips for handling unexpected query results</span></span>  
  
1.  <span data-ttu-id="66d8f-219">Oculte las medidas del grupo de medida intermedio, como el recuento, que no devuelvan resultados significativos en una consulta.</span><span class="sxs-lookup"><span data-stu-id="66d8f-219">Hide measures in the intermediate measure group, such as the count, that do not return meaningful results in a query.</span></span> <span data-ttu-id="66d8f-220">Esto impide que la gente intente usar agregaciones que produzcan datos sin sentido.</span><span class="sxs-lookup"><span data-stu-id="66d8f-220">This prevents people from trying to use aggregations producing meaningless data.</span></span> <span data-ttu-id="66d8f-221">Para ocultar una medida, establezca **Visibilidad** en **False** en el atributo del Diseñador de dimensiones.</span><span class="sxs-lookup"><span data-stu-id="66d8f-221">To hide a measure, set **Visibility** to **False** on the attribute in dimension designer.</span></span>  
  
2.  <span data-ttu-id="66d8f-222">Cree perspectivas para usar un subconjunto de medidas y dimensiones que admitan la experiencia de análisis que desea proporcionar.</span><span class="sxs-lookup"><span data-stu-id="66d8f-222">Create perspectives to use a subset of measures and dimensions that support the analytical experience you want to provide.</span></span> <span data-ttu-id="66d8f-223">Puede que un cubo que contiene muchos grupos de medidas y dimensiones no sea adecuado en todos los casos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-223">Possibly, a cube that contains many measure groups and dimensions do not work well together in all cases.</span></span> <span data-ttu-id="66d8f-224">Al aislar las dimensiones y los grupos de medida que piensa usar conjuntamente, se asegura de obtener un resultado más predecible.</span><span class="sxs-lookup"><span data-stu-id="66d8f-224">By isolating the dimensions and measure groups that you intend to be used together, you ensure a more predictable outcome.</span></span>  
  
3.  <span data-ttu-id="66d8f-225">Recuerde siempre realizar la implementación y volver a conectarse después de cambiar un modelo.</span><span class="sxs-lookup"><span data-stu-id="66d8f-225">Always remember to deploy and reconnect after changing a model.</span></span> <span data-ttu-id="66d8f-226">En Excel, use el botón Actualizar de la cinta Analizar tabla dinámica.</span><span class="sxs-lookup"><span data-stu-id="66d8f-226">In Excel, use the Refresh button on the PivotTable Analyze ribbon.</span></span>  
  
4.  <span data-ttu-id="66d8f-227">Evite usar grupos de medida vinculada en diversas relaciones varios a varios, especialmente cuando estas relaciones están en distintos cubos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-227">Avoid using linked measure groups in multiple many-to-many relationships, especially when those relationships are in different cubes.</span></span> <span data-ttu-id="66d8f-228">Si lo hace, puede producir agregaciones ambiguas.</span><span class="sxs-lookup"><span data-stu-id="66d8f-228">Doing so can result in ambiguous aggregations.</span></span> <span data-ttu-id="66d8f-229">Para más información, vea [Cantidades incorrectas para medidas vinculadas en cubos que contienen relaciones varios a varios](https://social.technet.microsoft.com/wiki/contents/articles/22911.incorrect-amounts-for-linked-measures-in-cubes-containing-many-to-many-relationships-ssas-troubleshooting.aspx).</span><span class="sxs-lookup"><span data-stu-id="66d8f-229">For more information, see [Incorrect Amounts for Linked Measures in Cubes containing Many-to-Many Relationships](https://social.technet.microsoft.com/wiki/contents/articles/22911.incorrect-amounts-for-linked-measures-in-cubes-containing-many-to-many-relationships-ssas-troubleshooting.aspx).</span></span>  
  
##  <a name="learn-more"></a><a name="bkmk_Learn"></a><span data-ttu-id="66d8f-230">Aprende más</span><span class="sxs-lookup"><span data-stu-id="66d8f-230">Learn more</span></span>  
 <span data-ttu-id="66d8f-231">Use los vínculos siguientes para obtener información adicional que le ayude a dominar estos conceptos.</span><span class="sxs-lookup"><span data-stu-id="66d8f-231">Use the following links to get additional information that helps you master the concepts.</span></span>  
  
 [<span data-ttu-id="66d8f-232">Definir una dimensión varios a varios en Analysis Services</span><span class="sxs-lookup"><span data-stu-id="66d8f-232">How do I define a many-to-many dimension in Analysis Services</span></span>](../lesson-5-3-defining-a-many-to-many-relationship.md)  
  
 [<span data-ttu-id="66d8f-233">La revolución varios a varios 2.0</span><span class="sxs-lookup"><span data-stu-id="66d8f-233">The many-to-many Revolution 2.0</span></span>](https://go.microsoft.com/fwlink/?LinkId=324760)  
  
 [<span data-ttu-id="66d8f-234">Tutorial: Ejemplo de dimensiones varios a varios para SQL Server Analysis Services</span><span class="sxs-lookup"><span data-stu-id="66d8f-234">Tutorial: Many-to-many dimension example for SQL Server Analysis Services</span></span>](https://go.microsoft.com/fwlink/?LinkId=324761)  
  
## <a name="see-also"></a><span data-ttu-id="66d8f-235">Consulte también</span><span class="sxs-lookup"><span data-stu-id="66d8f-235">See Also</span></span>  
 <span data-ttu-id="66d8f-236">[Relaciones de dimensión](../multidimensional-models-olap-logical-cube-objects/dimension-relationships.md) </span><span class="sxs-lookup"><span data-stu-id="66d8f-236">[Dimension Relationships](../multidimensional-models-olap-logical-cube-objects/dimension-relationships.md) </span></span>  
 <span data-ttu-id="66d8f-237">[Instalar los datos y proyectos de ejemplo para el tutorial de modelado multidimensional de Analysis Services](../install-sample-data-and-projects.md) </span><span class="sxs-lookup"><span data-stu-id="66d8f-237">[Install Sample Data and Projects for the Analysis Services Multidimensional Modeling Tutorial](../install-sample-data-and-projects.md) </span></span>  
 <span data-ttu-id="66d8f-238">[Implementar proyectos de Analysis Services &#40;SSDT&#41;](deploy-analysis-services-projects-ssdt.md) </span><span class="sxs-lookup"><span data-stu-id="66d8f-238">[Deploy Analysis Services Projects &#40;SSDT&#41;](deploy-analysis-services-projects-ssdt.md) </span></span>  
 [<span data-ttu-id="66d8f-239">Perspectivas de modelos multidimensionales</span><span class="sxs-lookup"><span data-stu-id="66d8f-239">Perspectives in Multidimensional Models</span></span>](perspectives-in-multidimensional-models.md)  
  
  
