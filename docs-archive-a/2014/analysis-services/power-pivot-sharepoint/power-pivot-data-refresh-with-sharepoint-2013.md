---
title: Actualización de datos PowerPivot con SharePoint 2013 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87673326"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="0299f-102">Actualización de datos PowerPivot con SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="0299f-103">El diseño de la actualización de [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] modelos de datos en SharePoint 2013 usa Excel Services como componente principal para cargar y actualizar modelos de datos en una instancia de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] que se ejecuta en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="0299f-104">El servidor de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ejecuta fuera de la granja de servidores de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="0299f-105">La arquitectura usada anteriormente para la actualización de datos se basaba exclusivamente en el servicio de sistema de PowerPivot para cargar y actualizar modelos de datos en una instancia de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="0299f-106">La instancia de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] se ejecutaba localmente en el servidor de aplicaciones de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="0299f-107">La nueva arquitectura presenta también un nuevo método para mantener la información de programación como metadatos datos del elemento de libro en la biblioteca de documentos.</span><span class="sxs-lookup"><span data-stu-id="0299f-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="0299f-108">La arquitectura de SharePoint 2013 Excel Services admite tanto la **actualización de datos interactiva** como la **actualización de datos programada**.</span><span class="sxs-lookup"><span data-stu-id="0299f-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="0299f-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="0299f-110">**En este tema:**</span><span class="sxs-lookup"><span data-stu-id="0299f-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="0299f-111">Actualización de datos interactiva</span><span class="sxs-lookup"><span data-stu-id="0299f-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="0299f-112">Autenticación de Windows con conexiones de datos de libro y actualización de datos interactiva</span><span class="sxs-lookup"><span data-stu-id="0299f-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="0299f-113">Actualización de datos programada</span><span class="sxs-lookup"><span data-stu-id="0299f-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="0299f-114">Arquitectura de actualización de datos programada de SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="0299f-115">Otras consideraciones sobre la autenticación</span><span class="sxs-lookup"><span data-stu-id="0299f-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="0299f-116">Más información</span><span class="sxs-lookup"><span data-stu-id="0299f-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="0299f-117">Información previa</span><span class="sxs-lookup"><span data-stu-id="0299f-117">Background</span></span>  
 <span data-ttu-id="0299f-118">SharePoint Server 2013 Excel Services administra la actualización de datos para los libros de Excel 2013 y desencadena el procesamiento del modelo de datos en un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] servidor que se ejecuta en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="0299f-119">Para los libros de Excel 2010, Excel Services también administra la carga y el almacenamiento de libros y modelos de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="0299f-120">Sin embargo, Excel Services emplea el servicio de sistema de PowerPivot para enviar los comandos de procesamiento al modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="0299f-121">En la tabla siguiente se resumen los componentes que envían comandos de procesamiento para la actualización de datos según la versión del libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="0299f-122">Se supone que se usa un entorno de una granja de SharePoint 2013 configurada para usar un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="0299f-123">Libros de Excel 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="0299f-124">Libros de Excel 2010</span><span class="sxs-lookup"><span data-stu-id="0299f-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="0299f-125">Desencadenar la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="0299f-125">Trigger Data Refresh</span></span>|<span data-ttu-id="0299f-126">**Interactivo:** Usuario autenticado</span><span class="sxs-lookup"><span data-stu-id="0299f-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="0299f-127">**Programado:** Servicio de sistema de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="0299f-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="0299f-128">Servicio de sistema de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="0299f-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="0299f-129">Cargar el libro desde las bases de datos de contenido</span><span class="sxs-lookup"><span data-stu-id="0299f-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="0299f-130">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="0299f-131">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="0299f-132">Cargar modelo de datos en la instancia de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0299f-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="0299f-133">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="0299f-134">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="0299f-135">Enviar comandos de procesamiento a la instancia de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0299f-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="0299f-136">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="0299f-137">Servicio de sistema de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="0299f-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="0299f-138">Actualizar datos del libro</span><span class="sxs-lookup"><span data-stu-id="0299f-138">Update Workbook Data</span></span>|<span data-ttu-id="0299f-139">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="0299f-140">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="0299f-141">Guardar el libro y el modelo de datos en la base de datos de contenido</span><span class="sxs-lookup"><span data-stu-id="0299f-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="0299f-142">**Interactiva:** N/D</span><span class="sxs-lookup"><span data-stu-id="0299f-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="0299f-143">**Programado:** SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="0299f-144">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="0299f-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="0299f-145">En la tabla siguiente se resumen las características de actualización admitidas en una granja de SharePoint 2013 configurada para usar un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server en modo de SharePoint:</span><span class="sxs-lookup"><span data-stu-id="0299f-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="0299f-146">Libro creado en</span><span class="sxs-lookup"><span data-stu-id="0299f-146">Workbook created in</span></span>|<span data-ttu-id="0299f-147">Actualización de datos programada</span><span class="sxs-lookup"><span data-stu-id="0299f-147">Scheduled data refresh</span></span>|<span data-ttu-id="0299f-148">Actualización interactiva</span><span class="sxs-lookup"><span data-stu-id="0299f-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="0299f-149">2008 R2 PowerPivot para Excel</span><span class="sxs-lookup"><span data-stu-id="0299f-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="0299f-150">No compatible.</span><span class="sxs-lookup"><span data-stu-id="0299f-150">Not supported.</span></span> <span data-ttu-id="0299f-151">Actualizar el libro **( \* )**</span><span class="sxs-lookup"><span data-stu-id="0299f-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="0299f-152">No compatible.</span><span class="sxs-lookup"><span data-stu-id="0299f-152">Not supported.</span></span> <span data-ttu-id="0299f-153">Actualizar el libro **( \* )**</span><span class="sxs-lookup"><span data-stu-id="0299f-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="0299f-154">2012 PowerPivot para Excel</span><span class="sxs-lookup"><span data-stu-id="0299f-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="0299f-155">Compatible</span><span class="sxs-lookup"><span data-stu-id="0299f-155">Supported</span></span>|<span data-ttu-id="0299f-156">No compatible.</span><span class="sxs-lookup"><span data-stu-id="0299f-156">Not supported.</span></span> <span data-ttu-id="0299f-157">Actualizar el libro **( \* )**</span><span class="sxs-lookup"><span data-stu-id="0299f-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="0299f-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-158">Excel 2013</span></span>|<span data-ttu-id="0299f-159">Compatible</span><span class="sxs-lookup"><span data-stu-id="0299f-159">Supported</span></span>|<span data-ttu-id="0299f-160">Compatible</span><span class="sxs-lookup"><span data-stu-id="0299f-160">Supported</span></span>|  
  
 <span data-ttu-id="0299f-161">**( \* )** Para obtener más información acerca de las actualizaciones de libros, vea [Actualizar libros y actualización de datos programada &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="0299f-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="0299f-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="0299f-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="0299f-163">La actualización de datos interactiva, o manual, de SharePoint Server 2013 Excel Services puede actualizar modelos de datos con datos del origen de datos original.</span><span class="sxs-lookup"><span data-stu-id="0299f-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="0299f-164">La actualización de datos interactiva está disponible después de configurar una aplicación de Excel Services registrando un servidor de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] que se ejecuta en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="0299f-165">Para obtener más información, vea [Administrar la configuración del modelo de datos de Servicios de Excel (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span><span class="sxs-lookup"><span data-stu-id="0299f-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0299f-166">La actualización de datos interactiva solo está disponible para los libros creados en Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="0299f-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="0299f-167">Si intenta actualizar un libro de Excel 2010, Excel Services mostrará un mensaje de error similar a "error en la operación de PowerPivot: el libro se creó con una versión anterior de Excel y PowerPivot no se puede actualizar hasta que se actualice el archivo".</span><span class="sxs-lookup"><span data-stu-id="0299f-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="0299f-168">Para obtener más información sobre actualizaciones de libros, vea [Actualizar libros y actualización de datos programada &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="0299f-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="0299f-169">**Punto clave de interés de la actualización interactiva:**</span><span class="sxs-lookup"><span data-stu-id="0299f-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="0299f-170">La actualización de datos interactiva solo actualiza los datos de la sesión de usuario actual.</span><span class="sxs-lookup"><span data-stu-id="0299f-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="0299f-171">Los datos no se vuelven a guardar automáticamente en el elemento de libro en la base de datos de contenido de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="0299f-172">**Credenciales:** la actualización de datos interactiva puede usar la identidad del usuario que ha iniciado sesión como credenciales o credenciales almacenadas para conectarse al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="0299f-173">Las credenciales empleadas dependen de la configuración de autenticación de Excel Services definida para la conexión del libro al origen de datos externo.</span><span class="sxs-lookup"><span data-stu-id="0299f-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="0299f-174">**Libros admitidos:**  los libros creados en Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="0299f-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="0299f-175">**Para actualizar datos:**</span><span class="sxs-lookup"><span data-stu-id="0299f-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="0299f-176">Vea la ilustración que hay a continuación de estos pasos.</span><span class="sxs-lookup"><span data-stu-id="0299f-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="0299f-177">En una biblioteca de documentos de SharePoint, abra un libro PowerPivot en el explorador.</span><span class="sxs-lookup"><span data-stu-id="0299f-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="0299f-178">En la ventana del explorador, haga clic en el menú **Datos** y, a continuación, haga clic en **Actualizar la conexión seleccionada** o en **Actualizar todas las conexiones**.</span><span class="sxs-lookup"><span data-stu-id="0299f-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="0299f-179">Excel Services carga la base de datos de PowerPivot, la procesa y después la consulta para actualizar la caché de libros de Excel.</span><span class="sxs-lookup"><span data-stu-id="0299f-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="0299f-180">**Nota:** el libro actualizado no se vuelve a guardar automáticamente en la biblioteca de documentos.</span><span class="sxs-lookup"><span data-stu-id="0299f-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="0299f-181">![actualización de datos interactiva](../media/as-interactive-datarefresh-sharepoint2013.gif "actualización de datos interactiva")</span><span class="sxs-lookup"><span data-stu-id="0299f-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="0299f-182">Autenticación de Windows con conexiones de datos de libro y actualización de datos interactiva</span><span class="sxs-lookup"><span data-stu-id="0299f-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="0299f-183">Excel Services envía al servidor de Analysis Services un comando de proceso que indica al servidor que debe suplantar una cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="0299f-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="0299f-184">Para obtener derechos del sistema suficientes para realizar el proceso de suplantación-delegación de usuario, la cuenta de servicio de Analysis Services necesita el privilegio **Actuar como parte del sistema operativo** en el servidor local.</span><span class="sxs-lookup"><span data-stu-id="0299f-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="0299f-185">El servidor de Analysis Services también debe poder delegar las credenciales del usuario a orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="0299f-186">El resultado de la consulta se envía a Excel Services.</span><span class="sxs-lookup"><span data-stu-id="0299f-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="0299f-187">Experiencia de usuario típica: cuando un cliente selecciona "actualizar todas las conexiones" en un libro de Excel 2013 que contiene un modelo de PowerPivot, verá un mensaje de error similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="0299f-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="0299f-188">**Error durante la actualización de los datos externos:** Se produjo un error mientras se trabajaba con el modelo de datos del libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="0299f-189">Inténtelo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="0299f-189">Please try again.</span></span> <span data-ttu-id="0299f-190">No se pueden actualizar una o más conexiones de datos del libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="0299f-191">Según el proveedor de datos que esté usando, verá mensajes similares a los siguientes en el registro de ULS.</span><span class="sxs-lookup"><span data-stu-id="0299f-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="0299f-192">**Con SQL Native Client:**</span><span class="sxs-lookup"><span data-stu-id="0299f-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="0299f-193">No se pudo crear una conexión externa ni ejecutar una consulta.</span><span class="sxs-lookup"><span data-stu-id="0299f-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="0299f-194">Mensaje del proveedor: Se ha especificado el objeto fuera de línea 'DataSource', que hace referencia a los identificadores '20102481-39c8-4d21-bf63-68f583ad22bb', pero no se ha usado.</span><span class="sxs-lookup"><span data-stu-id="0299f-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="0299f-195">Error de OLE DB u ODBC: Error relacionado con la red o específico de instancia al establecer conexión con el servidor SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0299f-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="0299f-196">El servidor no se encuentra o no está accesible.</span><span class="sxs-lookup"><span data-stu-id="0299f-196">Server is not found or not accessible.</span></span> <span data-ttu-id="0299f-197">Compruebe si el nombre de la instancia es correcto y si SQL Server está configurado para permitir conexiones remotas.</span><span class="sxs-lookup"><span data-stu-id="0299f-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="0299f-198">Para obtener más información, vea los Libros en pantalla de SQL Server.; 08001; Proveedor de SSL: El paquete de seguridad solicitado no existe; 08001; El cliente no pudo establecer la conexión; 08001; No se admite el cifrado en el cliente; 08001.</span><span class="sxs-lookup"><span data-stu-id="0299f-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="0299f-199">, ConnectionName: ThisWorkbookDataModel, Libro: book1.xlsx.</span><span class="sxs-lookup"><span data-stu-id="0299f-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="0299f-200">**Con el proveedor Microsoft OLE DB para SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="0299f-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="0299f-201">No se pudo crear una conexión externa ni ejecutar una consulta.</span><span class="sxs-lookup"><span data-stu-id="0299f-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="0299f-202">Mensaje del proveedor: se ha especificado el objeto fuera de línea 'DataSource', que hace referencia a los identificadores '6e711bfa-b62f-4879-a177-c5dd61d9c242', pero no se ha usado.</span><span class="sxs-lookup"><span data-stu-id="0299f-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="0299f-203">Error de OLE DB u ODBC.</span><span class="sxs-lookup"><span data-stu-id="0299f-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="0299f-204">, ConnectionName: ThisWorkbookDataModel, Libro: OLEDB Provider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="0299f-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="0299f-205">**Con el proveedor de datos de .NET Framework para SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="0299f-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="0299f-206">No se pudo crear una conexión externa ni ejecutar una consulta.</span><span class="sxs-lookup"><span data-stu-id="0299f-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="0299f-207">Mensaje del proveedor: se ha especificado el objeto fuera de línea 'DataSource', que hace referencia a los identificadores 'f5fb916c-3eac-4d07-a542-531524c0d44a', pero no se ha usado.</span><span class="sxs-lookup"><span data-stu-id="0299f-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="0299f-208">Errores del motor relacional de alto nivel.</span><span class="sxs-lookup"><span data-stu-id="0299f-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="0299f-209">Excepción al utilizar la interfaz administrada IDbConnection: No se puede cargar el archivo o ensamblado 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' ni una de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="0299f-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="0299f-210">No se ha proporcionado el nivel de representación necesario o el nivel de representación no es válido.</span><span class="sxs-lookup"><span data-stu-id="0299f-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="0299f-211">(Excepción de HRESULT: 0x80070542).</span><span class="sxs-lookup"><span data-stu-id="0299f-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="0299f-212">, ConnectionName: ThisWorkbookDataModel, Libro: NETProvider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="0299f-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="0299f-213">**Resumen de pasos de configuración** Para configurar el privilegio **Actuar como parte del sistema operativo** en el servidor local:</span><span class="sxs-lookup"><span data-stu-id="0299f-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="0299f-214">En el servidor de Analysis Services que se ejecuta en modo de SharePoint, agregue la cuenta de servicio de Analysis Services al privilegio "**actuar como parte del sistema operativo**":</span><span class="sxs-lookup"><span data-stu-id="0299f-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="0299f-215">Ejecutar " `secpol.msc` "</span><span class="sxs-lookup"><span data-stu-id="0299f-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="0299f-216">Haga clic sucesivamente en **Directiva de seguridad local**, **Directivas locales**y **Asignación de derechos de usuario**.</span><span class="sxs-lookup"><span data-stu-id="0299f-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="0299f-217">Agregue la cuenta de servicio.</span><span class="sxs-lookup"><span data-stu-id="0299f-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="0299f-218">Reinicie Excel Services y rearranque el servidor de Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="0299f-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="0299f-219">No es necesaria la delegación desde la cuenta de servicio de Excel Services o desde el servicio de notificaciones de token de Windows (C2WTS) a la instancia de Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="0299f-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="0299f-220">Por tanto, no se necesita ninguna configuración para KCD desde Excel Services o C2WTS en el servicio PowerPivot AS.</span><span class="sxs-lookup"><span data-stu-id="0299f-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="0299f-221">Si el origen de datos backend está en el mismo servidor que la instancia [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , no se necesita la delegación restringida de Kerberos.</span><span class="sxs-lookup"><span data-stu-id="0299f-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="0299f-222">Sin embargo, la cuenta de servicio [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] requiere el derecho para actuar como parte del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="0299f-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="0299f-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="0299f-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="0299f-224">Para obtener más información, vea [actuar como parte del sistema operativo](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="0299f-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="0299f-225">Actualización de datos programada</span><span class="sxs-lookup"><span data-stu-id="0299f-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="0299f-226">**Puntos clave de interés de la actualización de datos programada:**</span><span class="sxs-lookup"><span data-stu-id="0299f-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="0299f-227">Necesita la implementación del complemento PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="0299f-228">Para obtener más información, vea [instalar o desinstalar el complemento de PowerPivot para SharePoint &#40;&#41;de SharePoint 2013 ](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="0299f-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="0299f-229">Un usuario configura una programación de actualización para un libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="0299f-230">En el momento programado, el servicio de sistema de PowerPivot envía una solicitud a Excel Services para:</span><span class="sxs-lookup"><span data-stu-id="0299f-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="0299f-231">Cargar y procesar la base de datos de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="0299f-232">Actualizar el libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="0299f-233">Volver a guardar el libro en la base de datos de contenido.</span><span class="sxs-lookup"><span data-stu-id="0299f-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="0299f-234">**Credenciales:** usa las credenciales almacenadas.</span><span class="sxs-lookup"><span data-stu-id="0299f-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="0299f-235">No usa la identidad del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="0299f-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="0299f-236">**Libros admitidos:** libros creados mediante el complemento [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot para Excel 2010 o con Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="0299f-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="0299f-237">No se admiten los libros creados en Excel 2010 con el complemento [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="0299f-238">Actualice el libro como mínimo al formato de [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="0299f-239">Para obtener más información sobre actualizaciones de libros, vea [Actualizar libros y actualización de datos programada &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="0299f-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="0299f-240">Para mostrar la página **Administrar actualización de datos** :</span><span class="sxs-lookup"><span data-stu-id="0299f-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="0299f-241">Vea la ilustración que hay a continuación de estos pasos.</span><span class="sxs-lookup"><span data-stu-id="0299f-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="0299f-242">En una biblioteca de documentos de SharePoint, haga clic en el **menú Abrir** (**...**) para un libro PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="0299f-243">Haga clic en el segundo **menú Abrir** y, a continuación, haga clic en **Administrar actualización de datos de PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="0299f-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="0299f-244">En la página **Administrar actualización de datos** , haga clic en **Habilitar** y configure la programación de actualización.</span><span class="sxs-lookup"><span data-stu-id="0299f-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="0299f-245">En el momento especificado, el servicio de sistema de PowerPivot envía una solicitud a Excel Services para:</span><span class="sxs-lookup"><span data-stu-id="0299f-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="0299f-246">Cargar y procesar el modelo de datos de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="0299f-247">Actualizar el libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="0299f-248">Volver a guardar el libro en la base de datos de contenido.</span><span class="sxs-lookup"><span data-stu-id="0299f-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="0299f-249">![menú contextual administrar actualización de datos](../media/as-manage-datarefresh-sharepoint2013.gif "menú contextual administrar actualización de datos")</span><span class="sxs-lookup"><span data-stu-id="0299f-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="0299f-250">Para obtener información sobre cómo actualizar libros desde SharePoint Online, vea [Actualizar libros de Excel con modelos de PowerPivot incrustados desde SharePoint Online (notas del producto)](https://technet.microsoft.com/library/jj992650.aspx) ( https://technet.microsoft.com/library/jj992650.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0299f-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="0299f-251">Arquitectura de actualización de datos programada en SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="0299f-252">En la ilustración siguiente se resume la arquitectura de actualización de datos de SharePoint 2013 y SQL Server 2012 SP1.</span><span class="sxs-lookup"><span data-stu-id="0299f-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="0299f-253">![arquitectura de actualización de datos de SQL Server 2012 SP1](../media/as-scheduled-data-refresh2012sp1-architecture.gif "arquitectura de actualización de datos de SQL Server 2012 SP1")</span><span class="sxs-lookup"><span data-stu-id="0299f-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="0299f-254">Descripción</span><span class="sxs-lookup"><span data-stu-id="0299f-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="0299f-255">**(1)**</span><span class="sxs-lookup"><span data-stu-id="0299f-255">**(1)**</span></span>|<span data-ttu-id="0299f-256">Motor de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0299f-256">Analysis Services Engine</span></span>|<span data-ttu-id="0299f-257">Un servidor de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] que se ejecuta en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="0299f-258">El servidor se ejecuta fuera de la granja de servidores de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="0299f-259">**dos**</span><span class="sxs-lookup"><span data-stu-id="0299f-259">**(2)**</span></span>|<span data-ttu-id="0299f-260">Interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="0299f-260">User Interface</span></span>|<span data-ttu-id="0299f-261">La interfaz de usuario consta de dos páginas:</span><span class="sxs-lookup"><span data-stu-id="0299f-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="0299f-262">una para definir la programación y la segunda para ver el historial de actualización.</span><span class="sxs-lookup"><span data-stu-id="0299f-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="0299f-263">Las páginas no obtienen acceso directamente a las bases de datos de aplicación de servicio PowerPivot pero usan el servicio de sistema de PowerPivot para obtener acceso a las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="0299f-264">**3**</span><span class="sxs-lookup"><span data-stu-id="0299f-264">**(3)**</span></span>|<span data-ttu-id="0299f-265">Servicio de sistema de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="0299f-265">PowerPivot System Service</span></span>|<span data-ttu-id="0299f-266">El servicio se instala al implementar el complemento PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="0299f-267">El servicio se emplea para lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0299f-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="0299f-268">Este servicio hospeda el motor de programación de actualización, que llama a las API de Excel Services para la actualización de datos de libros de Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="0299f-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="0299f-269">Para los libros de Excel 2010, el servicio realiza directamente el procesamiento del modelo de datos pero continúa usando Excel Services para cargar el modelo de datos y actualizar el libro.</span><span class="sxs-lookup"><span data-stu-id="0299f-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="0299f-270">Este servicio proporciona métodos para componentes como las páginas de la interfaz de usuario, para comunicarse con el servicio de sistema.</span><span class="sxs-lookup"><span data-stu-id="0299f-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="0299f-271">Administra las solicitudes de acceso externo a libros como origen de datos que se reciben del servicio Web PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="0299f-272">Administración de solicitudes de actualización de datos programada para los trabajos del temporizador y las páginas de configuración.</span><span class="sxs-lookup"><span data-stu-id="0299f-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="0299f-273">El servicio administra las solicitudes para leer datos dentro y fuera de la base de datos de aplicaciones de servicio y desencadena la actualización de datos con Excel Services.</span><span class="sxs-lookup"><span data-stu-id="0299f-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="0299f-274">Procesamiento de uso y trabajo de temporizador relacionado.</span><span class="sxs-lookup"><span data-stu-id="0299f-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="0299f-275">**4**</span><span class="sxs-lookup"><span data-stu-id="0299f-275">**(4)**</span></span>|<span data-ttu-id="0299f-276">Excel Calculation Services</span><span class="sxs-lookup"><span data-stu-id="0299f-276">Excel Calculation Services</span></span>|<span data-ttu-id="0299f-277">Responsable de cargar los modelos de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="0299f-278">**5**</span><span class="sxs-lookup"><span data-stu-id="0299f-278">**(5)**</span></span>|<span data-ttu-id="0299f-279">Servicio de almacenamiento seguro</span><span class="sxs-lookup"><span data-stu-id="0299f-279">Secure Store Service</span></span>|<span data-ttu-id="0299f-280">Si los valores de autenticación del libro están configurados para **usar la cuenta de usuario autenticado** o **ninguno**, se usan las credenciales ALMACENAdas en el identificador de aplicación de destino de almacenamiento seguro para la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="0299f-281">Para obtener más información, vea la sección [Otras consideraciones sobre la autenticación](#datarefresh_additional_authentication) en este tema.</span><span class="sxs-lookup"><span data-stu-id="0299f-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="0299f-282">**1,8**</span><span class="sxs-lookup"><span data-stu-id="0299f-282">**(6)**</span></span>|<span data-ttu-id="0299f-283">Trabajo de temporizador de actualización de datos de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="0299f-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="0299f-284">Indica al servicio de sistema de PowerPivot que se conecte a Excel Services para actualizar los modelos de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="0299f-285">necesita los proveedores de datos y las bibliotecas de cliente adecuados para que el servidor de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en modo de SharePoint pueda obtener acceso a los orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0299f-286">Como el servicio de sistema de PowerPivot ya no carga ni guarda modelos de PowerPivot, la mayoría de los valores para los modelos de almacenamiento en caché de un servidor de aplicaciones no se aplican a una granja de SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="0299f-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="0299f-287">Datos de registro de actualización de datos</span><span class="sxs-lookup"><span data-stu-id="0299f-287">Data refresh log data</span></span>  
 <span data-ttu-id="0299f-288">**Datos de uso:** puede ver los datos de uso de actualización de datos en el Panel de administración de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="0299f-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="0299f-289">Para ver los datos de uso:</span><span class="sxs-lookup"><span data-stu-id="0299f-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="0299f-290">En Administración central de SharePoint, haga clic en **Panel de administración de PowerPivot** en el grupo **Configuración de aplicación general** .</span><span class="sxs-lookup"><span data-stu-id="0299f-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="0299f-291">En la parte inferior del panel, consulte la **actividad de actualización de datos: actividad reciente** y **actualización de datos: errores recientes**.</span><span class="sxs-lookup"><span data-stu-id="0299f-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="0299f-292">Para obtener más información sobre los datos de uso y cómo habilitarlos, vea [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="0299f-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="0299f-293">**Datos del registro de diagnóstico:** puede ver datos de registro de diagnóstico de SharePoint relacionados con la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="0299f-294">En primer lugar, compruebe el registro de diagnósticos del **Servicio PowerPivot** en la página **Supervisión** de Administración central de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0299f-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="0299f-295">Es posible que necesite aumentar el nivel de registro para el "evento menos crítico" que se va a registrar.</span><span class="sxs-lookup"><span data-stu-id="0299f-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="0299f-296">Por ejemplo, establezca temporalmente el valor en **Detallado** y vuelva a ejecutar las operaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="0299f-297">Las entradas del registro contienen:</span><span class="sxs-lookup"><span data-stu-id="0299f-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="0299f-298">El **Área** de **Servicio PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="0299f-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="0299f-299">La categoría de **Actualización de datos**.</span><span class="sxs-lookup"><span data-stu-id="0299f-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="0299f-300">Examine **Configurar registro de diagnósticos**.</span><span class="sxs-lookup"><span data-stu-id="0299f-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="0299f-301">Para obtener más información, vea [configurar y ver archivos de registro de SharePoint y el registro de diagnósticos &#40;PowerPivot para SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span><span class="sxs-lookup"><span data-stu-id="0299f-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="0299f-302">Consideraciones de autenticación adicionales</span><span class="sxs-lookup"><span data-stu-id="0299f-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="0299f-303">Los valores del cuadro de diálogo **Configuración de autenticación de los Servicios de Excel** en Excel 2013 determinan la identidad de Windows que Excel Services y [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] emplean para la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="0299f-304">**Usar la cuenta de usuario autenticado**: Excel Services realiza la actualización de datos en la identidad del usuario que ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="0299f-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="0299f-305">**Usar una cuenta almacenada:** presupone un identificador de aplicación de Servicio de almacenamiento seguro de SharePoint, que Excel Services usa para recuperar el nombre de usuario y la contraseña para autenticar la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="0299f-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="0299f-306">**Ninguna**: se usa la **Cuenta de servicio desatendida** de Excel Services.</span><span class="sxs-lookup"><span data-stu-id="0299f-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="0299f-307">La cuenta de servicio se asocia a un proxy de almacenamiento seguro.</span><span class="sxs-lookup"><span data-stu-id="0299f-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="0299f-308">Configure los valores de la página **Configuración de la aplicación de Excel Services** , en la sección **Datos externos** .</span><span class="sxs-lookup"><span data-stu-id="0299f-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="0299f-309">Para abrir el cuadro de diálogo de configuración de autenticación:</span><span class="sxs-lookup"><span data-stu-id="0299f-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="0299f-310">Haga clic en la pestaña **Datos** en Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="0299f-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="0299f-311">Haga clic en **Conexiones** en la cinta de opciones.</span><span class="sxs-lookup"><span data-stu-id="0299f-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="0299f-312">En el cuadro de diálogo **Conexiones del libro**, seleccione la conexión y haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="0299f-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="0299f-313">En el cuadro de diálogo **propiedades de conexión** , haga clic en **definición**y, a continuación, haga clic en el botón **configuración de autenticación...** .</span><span class="sxs-lookup"><span data-stu-id="0299f-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="0299f-314">![Configuración de autenticación de los Servicios de Excel](../media/as-authentication-settings-4-ecs-in-excel2013.gif "Configuración de autenticación de los Servicios de Excel")</span><span class="sxs-lookup"><span data-stu-id="0299f-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="0299f-315">Para obtener más información sobre la autenticación de actualización de datos y el uso de credenciales, vea la entrada de blog [Actualizar datos PowerPivot en SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="0299f-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="0299f-316">Más información</span><span class="sxs-lookup"><span data-stu-id="0299f-316">More Information</span></span>  
 <span data-ttu-id="0299f-317">[Solución de problemas de actualización de datos PowerPivot](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span><span class="sxs-lookup"><span data-stu-id="0299f-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="0299f-318">[Excel Services en SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span><span class="sxs-lookup"><span data-stu-id="0299f-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="0299f-319">Consulte también</span><span class="sxs-lookup"><span data-stu-id="0299f-319">See Also</span></span>  
 <span data-ttu-id="0299f-320">[Actualizar libros y actualización de datos programada &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="0299f-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="0299f-321">Instalación de PowerPivot para SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="0299f-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
