---
title: Autenticación y autorización de PowerPivot | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 48230cc0-4037-4f99-8360-dadf4bc169bd
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cf777960b24d9c65c7e7f7d9651eeb48e0fe42b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87744393"
---
# <a name="powerpivot-authentication-and-authorization"></a><span data-ttu-id="3d29f-102">Autenticación y autorización de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="3d29f-102">PowerPivot Authentication and Authorization</span></span>
  <span data-ttu-id="3d29f-103">Una implementación de PowerPivot para SharePoint que se ejecuta dentro de una granja de servidores de SharePoint 2010 usa el subsistema de autenticación y el modelo de autorización que proporcionan los servidores de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-103">A PowerPivot for SharePoint deployment that runs within a SharePoint 2010 farm uses the authentication subsystem and authorization model provided by SharePoint servers.</span></span> <span data-ttu-id="3d29f-104">La infraestructura de seguridad de SharePoint se extiende al contenido y a las operaciones de PowerPivot porque todo el contenido relacionado con PowerPivot está almacenado en bases de datos de contenido de SharePoint, y todas las operaciones relacionadas con PowerPivot las realizan los servicios compartidos de PowerPivot en la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-104">SharePoint security infrastructure extends to PowerPivot content and operations because all PowerPivot-related content is stored in SharePoint content databases and all PowerPivot-related operations are performed by PowerPivot shared services in the farm.</span></span> <span data-ttu-id="3d29f-105">Los usuarios que solicitan un libro que contiene los datos PowerPivot se autentican usando una identidad de usuario de SharePoint que se basa en su identidad de usuario de Windows.</span><span class="sxs-lookup"><span data-stu-id="3d29f-105">Users who request a workbook that contains PowerPivot data are authenticated using a SharePoint user identity that is based on their Windows user identity.</span></span> <span data-ttu-id="3d29f-106">Los permisos para ver el libro determinan si la solicitud se concede o se deniega.</span><span class="sxs-lookup"><span data-stu-id="3d29f-106">View permissions on the workbook determine whether the request is granted or denied.</span></span>  
  
 <span data-ttu-id="3d29f-107">Dado que para el análisis de los datos de autoservicio se requiere la integración con Excel Services, la protección de un servidor de PowerPivot requiere que también se conozca la seguridad de Excel Services.</span><span class="sxs-lookup"><span data-stu-id="3d29f-107">Because integration with Excel Services is required for self-service data analytics, securing a PowerPivot server requires that you also understand Excel Services security.</span></span> <span data-ttu-id="3d29f-108">Cuando un usuario consulta una tabla dinámica que tiene una conexión de datos a datos PowerPivot, Excel Services reenvía una solicitud de conexión de datos a un servidor de PowerPivot de la granja para cargar los datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-108">When a user queries a PivotTable that has a data connection to PowerPivot data, Excel Services forwards a data connection request to a PowerPivot server in the farm to load the data.</span></span> <span data-ttu-id="3d29f-109">Esta interacción entre los servidores requiere saber cómo establecer una configuración de seguridad para ambos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-109">This interaction between the servers requires that you understand how to configure security settings for both servers.</span></span>  
  
 <span data-ttu-id="3d29f-110">Haga clic en los siguientes vínculos para leer secciones concretas de este tema:</span><span class="sxs-lookup"><span data-stu-id="3d29f-110">Click the following links to read specific sections in this topic:</span></span>  
  
 [<span data-ttu-id="3d29f-111">Autenticación de Windows mediante el inicio de sesión en modo clásico</span><span class="sxs-lookup"><span data-stu-id="3d29f-111">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>](power-pivot-authentication-and-authorization.md#bkmk_auth)  
  
 [<span data-ttu-id="3d29f-112">Operaciones de PowerPivot que requieren la autorización del usuario</span><span class="sxs-lookup"><span data-stu-id="3d29f-112">PowerPivot Operations Requiring User Authorization</span></span>](#UserConnections)  
  
 [<span data-ttu-id="3d29f-113">Permisos de SharePoint para el acceso a datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="3d29f-113">SharePoint Permissions for PowerPivot Data Access</span></span>](#Permissions)  
  
 [<span data-ttu-id="3d29f-114">Consideraciones de seguridad de Excel Services para los libros PowerPivot</span><span class="sxs-lookup"><span data-stu-id="3d29f-114">Excel Services security considerations for PowerPivot workbooks</span></span>](#excel)  
  
##  <a name="windows-authentication-using-classic-mode-sign-in-requirement"></a><a name="bkmk_auth"></a><span data-ttu-id="3d29f-115">Autenticación de Windows con el requisito de inicio de sesión en modo clásico</span><span class="sxs-lookup"><span data-stu-id="3d29f-115">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>  
 <span data-ttu-id="3d29f-116">PowerPivot para SharePoint admite un conjunto reducido de las opciones de autenticación disponibles en SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-116">PowerPivot for SharePoint supports a reduced set of the authentication options that are available in SharePoint.</span></span> <span data-ttu-id="3d29f-117">De las opciones de autenticación disponibles, solo se admite la autenticación de Windows para una implementación de PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-117">Of the available authentication options, only Windows authentication is supported for a PowerPivot for SharePoint deployment.</span></span> <span data-ttu-id="3d29f-118">Además, la aplicación web a través de la que se produce el inicio de sesión debe estar configurada para el modo clásico.</span><span class="sxs-lookup"><span data-stu-id="3d29f-118">In addition, the web application through which sign-in occurs must be configured for classic mode.</span></span>  
  
 <span data-ttu-id="3d29f-119">Se requiere la autenticación de Windows porque el motor de datos de Analysis Services de una implementación de PowerPivot para SharePoint solo admite este tipo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="3d29f-119">Windows authentication is required because the Analysis Services data engine in a PowerPivot for SharePoint deployment supports only Windows authentication.</span></span> <span data-ttu-id="3d29f-120">Excel Services establece conexiones con Analysis Services a través del proveedor OLE DB MSOLAP mediante una identidad de usuario de Windows que se ha autenticado a través de NTLM o del protocolo Kerberos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-120">Excel Services establishes connections to Analysis Services via the MSOLAP OLE DB provider using a Windows user identity that was authenticated via NTLM or the Kerberos protocol.</span></span>  
  
 <span data-ttu-id="3d29f-121">El segundo requisito, la autenticación en modo clásico en la aplicación web, es necesario para asegurarse de que el servicio web PowerPivot funciona.</span><span class="sxs-lookup"><span data-stu-id="3d29f-121">The second requirement, classic mode authentication on the web application, is required to ensure the operability of the PowerPivot web service.</span></span> <span data-ttu-id="3d29f-122">El servicio web es un componente que se ejecuta en un servidor web front-end y que proporciona redirección HTTP a un servidor PowerPivot para SharePoint de la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-122">The web service is a component that runs on a Web front-end and provides HTTP redirection to a PowerPivot for SharePoint server in the farm.</span></span> <span data-ttu-id="3d29f-123">Mientras que el servicio web dispone de notificaciones para las comunicaciones entre servicios, no dispone de ellas para las solicitudes de conexión de datos que enruta a un servicio compartido PowerPivot de la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-123">While the web service is claims aware for service-to-service communications, it is not claims aware for the data connection requests that it routes to a PowerPivot shared service in the farm.</span></span> <span data-ttu-id="3d29f-124">Las solicitudes para cargar los datos PowerPivot solo se admiten en las conexiones autenticadas que proceden de IIS y usan una identidad de Windows.</span><span class="sxs-lookup"><span data-stu-id="3d29f-124">Requests to load PowerPivot data are only supported for authenticated connections that come from IIS using a Windows identity.</span></span> <span data-ttu-id="3d29f-125">El inicio de sesión en modo clásico en la aplicación web es lo que permite una conexión correcta desde el servicio web PowerPivot a los servicios compartidos de PowerPivot en la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-125">Classic mode sign-in on the web application is what enables a successful connection from the PowerPivot web service to PowerPivot shared services in the farm.</span></span>  
  
 <span data-ttu-id="3d29f-126">Aunque el inicio de sesión en modo clásico no es necesario en el escenario de acceso a datos más frecuente (cuando los datos PowerPivot se extraen del mismo libro de Excel que los representa), no intente usar PowerPivot para SharePoint con aplicaciones web de SharePoint configuradas para usar otros proveedores de autenticación.</span><span class="sxs-lookup"><span data-stu-id="3d29f-126">Although classic mode sign-in is not required for the more common data access scenario (where PowerPivot data is extracted from the same Excel workbook that renders it) do not attempt to use PowerPivot for SharePoint with SharePoint web applications that are configured to use other authentication providers.</span></span> <span data-ttu-id="3d29f-127">Si lo hace, se producirá un error de conexión cada vez que los usuarios intenten conectar con libros PowerPivot como origen de datos externo.</span><span class="sxs-lookup"><span data-stu-id="3d29f-127">Doing so will result in a connection failure whenever users try to connect to PowerPivot workbooks as an external data source.</span></span>  
  
 <span data-ttu-id="3d29f-128">Sin el inicio de sesión en modo clásico, fallarán los siguientes tipos de solicitudes administradas por el servicio web de PowerPivot:</span><span class="sxs-lookup"><span data-stu-id="3d29f-128">Without classic mode sign-in, the following types of requests that are handled by PowerPivot Web service will fail:</span></span>  
  
-   <span data-ttu-id="3d29f-129">Cualquier solicitud de datos de PowerPivot que se origine desde fuera de la granja (por ejemplo, creando un informe en el Diseñador de informes o en el Generador de informes, donde el origen de datos es una URL de SharePoint que apunta a un libro PowerPivot)</span><span class="sxs-lookup"><span data-stu-id="3d29f-129">Any request for PowerPivot data that originates from outside the farm (for example, creating a report in Report Designer or Report Builder, where the data source is a SharePoint URL to a PowerPivot workbook)</span></span>  
  
-   <span data-ttu-id="3d29f-130">Las solicitudes originadas en la granja desde una aplicación cliente o informes que usen un libro PowerPivot como origen de datos externo (crear un libro en la aplicación de escritorio de Excel, usando como origen de datos un segundo libro de Excel publicado que contiene datos PowerPivot)</span><span class="sxs-lookup"><span data-stu-id="3d29f-130">In-farm requests from a client application or report that uses the PowerPivot workbook as an external data source (for example, creating a workbook in the Excel desktop application, using as your data source a second published Excel workbook containing PowerPivot data)</span></span>  
  
### <a name="how-to-check-the-authentication-provider-for-your-application"></a><span data-ttu-id="3d29f-131">Comprobar el proveedor de autenticación para la aplicación</span><span class="sxs-lookup"><span data-stu-id="3d29f-131">How to check the authentication provider for your application</span></span>  
 <span data-ttu-id="3d29f-132">Cuando cree nuevas aplicaciones web, asegúrese de seleccionar la opción **Modo clásico de autenticación** en la página Crear nueva aplicación web.</span><span class="sxs-lookup"><span data-stu-id="3d29f-132">When creating new web applications, be sure to select the **Classic mode authentication** option in the Create New Web Application page.</span></span>  
  
 <span data-ttu-id="3d29f-133">En el caso de aplicaciones web existentes, use las siguientes instrucciones para comprobar que la aplicación web está configurada para usar la autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="3d29f-133">For existing web applications, use the following instructions to verify the web application is configured to use Windows authentication.</span></span>  
  
1.  <span data-ttu-id="3d29f-134">En administración central, en administración de aplicaciones, haga clic en **Administrar aplicaciones web**.</span><span class="sxs-lookup"><span data-stu-id="3d29f-134">In Central Administration, in Application Management, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="3d29f-135">Seleccione la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="3d29f-135">Select the web application.</span></span>  
  
3.  <span data-ttu-id="3d29f-136">Haga clic en **Proveedores de autenticación**.</span><span class="sxs-lookup"><span data-stu-id="3d29f-136">Click **Authentication Providers**.</span></span>  
  
4.  <span data-ttu-id="3d29f-137">Compruebe que tiene un proveedor para cada zona, y que la zona predeterminada está establecida en Windows.</span><span class="sxs-lookup"><span data-stu-id="3d29f-137">Verify that you have one provider for each zone, and the Default zone is set to Windows.</span></span>  
  
##  <a name="powerpivot-operations-requiring-user-authorization"></a><a name="UserConnections"></a><span data-ttu-id="3d29f-138">Operaciones de PowerPivot que requieren la autorización del usuario</span><span class="sxs-lookup"><span data-stu-id="3d29f-138">PowerPivot Operations Requiring User Authorization</span></span>  
 <span data-ttu-id="3d29f-139">La autorización de SharePoint se usa exclusivamente para todos los niveles de acceso al procesamiento de datos y las consultas de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-139">SharePoint authorization is used exclusively for all levels of access to PowerPivot query and data processing.</span></span>  
  
 <span data-ttu-id="3d29f-140">No se admite el modelo de autorización basada en roles de Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="3d29f-140">The Analysis Services role-based authorization model is not supported.</span></span> <span data-ttu-id="3d29f-141">No hay ninguna autorización basada en roles para los datos PowerPivot en el nivel de celda, fila o tabla.</span><span class="sxs-lookup"><span data-stu-id="3d29f-141">There is no role-based authorization for PowerPivot data at the cell, row, or table level.</span></span> <span data-ttu-id="3d29f-142">No puede proteger partes diferentes del libro para conceder o denegar el acceso a la información confidencial que contiene para usuarios concretos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-142">You cannot secure different parts of the workbook to grant or deny access to sensitive data within it for specific users.</span></span> <span data-ttu-id="3d29f-143">Los datos PowerPivot incrustados están completamente disponibles para los usuarios que tienen permisos para ver el libro de Excel en una biblioteca de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-143">Embedded PowerPivot data is wholly available to users who have View permissions on the Excel workbook in a SharePoint library.</span></span>  
  
 <span data-ttu-id="3d29f-144">PowerPivot para SharePoint suplantará a un usuario de SharePoint en los casos siguientes:</span><span class="sxs-lookup"><span data-stu-id="3d29f-144">PowerPivot for SharePoint will impersonate a SharePoint user in the following cases:</span></span>  
  
-   <span data-ttu-id="3d29f-145">Consultas a tablas dinámicas o gráficos dinámicos que tengan conexiones de datos a una base de datos PowerPivot, donde una aplicación de servicio PowerPivot establece las conexiones en nombre de un usuario a una instancia de servicio compartido PowerPivot concreta que procesa los datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-145">Queries to PivotTables or PivotCharts that have data connections to a PowerPivot database, where a PowerPivot service application establishes connections on behalf of a user to a specific PowerPivot shared service instance that processes the data.</span></span>  
  
-   <span data-ttu-id="3d29f-146">La carga de datos PowerPivot de la memoria caché o de una biblioteca, si los datos no están disponibles de otra forma.</span><span class="sxs-lookup"><span data-stu-id="3d29f-146">Loading PowerPivot data from cache or a library if the data is not otherwise available.</span></span> <span data-ttu-id="3d29f-147">Si se realiza una solicitud de conexión de datos para datos PowerPivot que aún no está cargados en el sistema, la instancia de [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] usará la identidad del usuario de SharePoint para recuperar el origen de datos de una biblioteca de contenido y cargarlo en la memoria.</span><span class="sxs-lookup"><span data-stu-id="3d29f-147">If a data connection request is made for PowerPivot data that is not already loaded in the system, the [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] instance will use the identity of the SharePoint user to retrieve the data source from a content library and load it into memory.</span></span>  
  
-   <span data-ttu-id="3d29f-148">Las operaciones de actualización de datos que guardan una copia actualizada del origen de datos al libro en una biblioteca de contenido.</span><span class="sxs-lookup"><span data-stu-id="3d29f-148">Data refresh operations that save an updated copy of the data source to the workbook in a content library.</span></span> <span data-ttu-id="3d29f-149">En este caso, se realiza un registro real de la operación utilizando el nombre de usuario y la contraseña que se recuperan de una aplicación de destino en el Servicio de almacenamiento seguro.</span><span class="sxs-lookup"><span data-stu-id="3d29f-149">In this case, an actual log on operation is performed using the user name and password that is retrieved from a target application in Secure Store Service.</span></span> <span data-ttu-id="3d29f-150">Las credenciales pueden ser la cuenta de actualización de datos desatendida de PowerPivot o las credenciales que se almacenaron con la programación de actualización de datos al crearse.</span><span class="sxs-lookup"><span data-stu-id="3d29f-150">Credentials can be the PowerPivot unattended data refresh account, or credentials that were stored with the data refresh schedule when it was created.</span></span> <span data-ttu-id="3d29f-151">Para obtener más información, vea [configurar credenciales almacenadas para la actualización de datos powerpivot &#40;PowerPivot para SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) y [configurar la cuenta de actualización de datos desatendida de PowerPivot &#40;PowerPivot para SharePoint ](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="3d29f-151">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="sharepoint-permissions-for-powerpivot-data-access"></a><a name="Permissions"></a><span data-ttu-id="3d29f-152">Permisos de SharePoint para el acceso a datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="3d29f-152">SharePoint Permissions for PowerPivot Data Access</span></span>  
 <span data-ttu-id="3d29f-153">La publicación, administración y protección de un libro PowerPivot solamente se admite a través de la integración de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-153">Publishing, managing, and securing a PowerPivot workbook is supported solely through SharePoint integration.</span></span> <span data-ttu-id="3d29f-154">Los servidores de SharePoint proporcionan subsistemas de autenticación y autorización que se aseguran de que se produce un acceso legítimo a los datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-154">SharePoint servers provide authentication and authorization subsystems that ensure legitimate access to data.</span></span> <span data-ttu-id="3d29f-155">No hay ningún escenario admitido para implementar de forma segura un libro PowerPivot fuera de una granja de servidores de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-155">There are no supported scenarios for securely deploying a PowerPivot workbook outside of a SharePoint farm.</span></span>  
  
 <span data-ttu-id="3d29f-156">El acceso de usuario a los datos PowerPivot del servidor es de solo lectura mediante permisos para ver o superiores.</span><span class="sxs-lookup"><span data-stu-id="3d29f-156">User access to PowerPivot data is read-only on the server through View permissions or higher.</span></span> <span data-ttu-id="3d29f-157">Los permisos de contribución permiten agregar y modificar el archivo.</span><span class="sxs-lookup"><span data-stu-id="3d29f-157">Contribute permissions allow for adding and editing the file.</span></span> <span data-ttu-id="3d29f-158">Las modificaciones en los datos PowerPivot requieren la descarga del libro a una aplicación de escritorio de Excel que tenga instalado PowerPivot para Excel.</span><span class="sxs-lookup"><span data-stu-id="3d29f-158">Changes to PowerPivot data require that you download the workbook to an Excel desktop application that has PowerPivot for Excel installed.</span></span> <span data-ttu-id="3d29f-159">Los permisos de contribución en el archivo determinarán si el usuario puede descargar el archivo localmente y guardar los cambios de nuevo en SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-159">Contribute permissions on the file will determine whether the user can download the file locally and then save changes back to SharePoint.</span></span>  
  
 <span data-ttu-id="3d29f-160">Por tanto, los niveles de permisos Contribuir y Solo ver definen el conjunto vigente de permisos para el acceso de los usuarios a los datos PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-160">As such, Contribute and View Only levels of permission define the effective set of permissions for user access to PowerPivot data.</span></span> <span data-ttu-id="3d29f-161">Otros niveles de permisos funcionan hasta el punto en que tienen los mismos permisos que Contribuir y Solo ver (por ejemplo, dado que Lectura incluye los permisos Solo ver, un usuario al que se le asigne Lectura tendrá el mismo acceso que otro con el permiso Solo ver).</span><span class="sxs-lookup"><span data-stu-id="3d29f-161">Other permission levels work to the extent that they have the same permissions as Contribute and View Only (For example, because Read includes View Only permissions, a user who is assigned to Read will have same level of access as View Only).</span></span>  
  
 <span data-ttu-id="3d29f-162">En la siguiente tabla se resumen los niveles de permisos que determinan el acceso a los datos PowerPivot y operaciones del servidor:</span><span class="sxs-lookup"><span data-stu-id="3d29f-162">The following table summarizes the permission levels that determine access to PowerPivot data and server operations:</span></span>  
  
|<span data-ttu-id="3d29f-163">Nivel del permiso</span><span class="sxs-lookup"><span data-stu-id="3d29f-163">Permission level</span></span>|<span data-ttu-id="3d29f-164">Permite estas tareas</span><span class="sxs-lookup"><span data-stu-id="3d29f-164">Allows these tasks</span></span>|  
|----------------------|------------------------|  
|<span data-ttu-id="3d29f-165">Administrador de granja o de servicio</span><span class="sxs-lookup"><span data-stu-id="3d29f-165">Farm or service administrator</span></span>|<span data-ttu-id="3d29f-166">Instalar, habilitar y configurar servicios y aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="3d29f-166">Install, enable, and configure services and applications.</span></span><br /><br /> <span data-ttu-id="3d29f-167">Usar el panel de administración de PowerPivot y ver informes administrativos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-167">Use PowerPivot Management Dashboard and view administrative reports.</span></span>|  
|<span data-ttu-id="3d29f-168">Control total</span><span class="sxs-lookup"><span data-stu-id="3d29f-168">Full control</span></span>|<span data-ttu-id="3d29f-169">Activar la integración de características de PowerPivot en el nivel de colección de sitios.</span><span class="sxs-lookup"><span data-stu-id="3d29f-169">Activate PowerPivot feature integration at the site collection level.</span></span><br /><br /> <span data-ttu-id="3d29f-170">Crear una biblioteca de la galería de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-170">Create a PowerPivot Gallery library.</span></span><br /><br /> <span data-ttu-id="3d29f-171">Crear una biblioteca de fuentes de distribución de datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-171">Create a data feed library.</span></span>|  
|<span data-ttu-id="3d29f-172">Contribuir</span><span class="sxs-lookup"><span data-stu-id="3d29f-172">Contribute</span></span>|<span data-ttu-id="3d29f-173">Agregar, modificar, eliminar y descargar libros PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-173">Add, edit, delete, and download PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="3d29f-174">Configurar actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-174">Configure data refresh.</span></span><br /><br /> <span data-ttu-id="3d29f-175">Crear nuevos libros e informes basados en libros PowerPivot en un sitio de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-175">Create new workbooks and reports based on PowerPivot workbooks on a SharePoint site.</span></span><br /><br /> <span data-ttu-id="3d29f-176">Crear documentos de servicio de datos en una biblioteca de fuentes de distribución de datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-176">Create data service documents in a data feed library</span></span>|  
|<span data-ttu-id="3d29f-177">Lectura</span><span class="sxs-lookup"><span data-stu-id="3d29f-177">Read</span></span>|<span data-ttu-id="3d29f-178">Obtener acceso a los libros PowerPivot como un origen de datos externo, donde la dirección URL del libro se escribe explícitamente en un cuadro de diálogo de conexión (por ejemplo, en el Asistente para la conexión de datos de Excel).</span><span class="sxs-lookup"><span data-stu-id="3d29f-178">Access PowerPivot workbooks as an external data source, where the workbook URL is explicitly entered in a connection dialog box (for example, in Excel's Data Connection Wizard).</span></span>|  
|<span data-ttu-id="3d29f-179">Solo ver</span><span class="sxs-lookup"><span data-stu-id="3d29f-179">View Only</span></span>|<span data-ttu-id="3d29f-180">Ver libros PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-180">View PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="3d29f-181">Ver el historial de la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-181">View data refresh history.</span></span><br /><br /> <span data-ttu-id="3d29f-182">Conectarse con un libro local a un libro PowerPivot en un sitio de SharePoint, para cambiar sus datos de otras maneras.</span><span class="sxs-lookup"><span data-stu-id="3d29f-182">Connect a local workbook to a PowerPivot workbook on a SharePoint site, to repurpose its data in other ways.</span></span><br /><br /> <span data-ttu-id="3d29f-183">Descargue una instantánea del libro.</span><span class="sxs-lookup"><span data-stu-id="3d29f-183">Download a snapshot of the workbook.</span></span> <span data-ttu-id="3d29f-184">La instantánea es una copia estática de los datos, segmentaciones de datos, filtros, fórmulas ni conexiones de datos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-184">The snapshot is a static copy of the data, without slicers, filters, formulas, or data connections.</span></span> <span data-ttu-id="3d29f-185">El contenido de la instantánea es parecido al que se obtiene al copiar los valores de las celdas de la ventana del explorador.</span><span class="sxs-lookup"><span data-stu-id="3d29f-185">The contents of the snapshot are similar to copying cell values from the browser window.</span></span>|  
  
##  <a name="excel-services-security-considerations-for-powerpivot-workbooks"></a><a name="excel"></a><span data-ttu-id="3d29f-186">Consideraciones de seguridad de Excel Services para los libros PowerPivot</span><span class="sxs-lookup"><span data-stu-id="3d29f-186">Excel Services security considerations for PowerPivot workbooks</span></span>  
 <span data-ttu-id="3d29f-187">El procesamiento de consultas de PowerPivot en el lado servidor está unido estrechamente a los servicios de Excel.</span><span class="sxs-lookup"><span data-stu-id="3d29f-187">PowerPivot server-side query processing is tightly coupled with Excel services.</span></span> <span data-ttu-id="3d29f-188">La integración de productos comienza en el nivel de documento, donde los libros PowerPivot son archivos de libro de Excel (.xlsx) que contienen o hacen referencia a datos PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-188">Product integration begins at the document level, in that PowerPivot workbooks are Excel workbook (.xlsx) files that either contain or reference PowerPivot data.</span></span> <span data-ttu-id="3d29f-189">No hay ninguna extensión de archivo independiente para un libro PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-189">There is no separate file extension for a PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="3d29f-190">Cuando un libro PowerPivot se abre en un sitio de SharePoint, Excel Services lee las cadenas de conexión de datos PowerPivot incrustadas y reenvía la solicitud al proveedor OLE DB de Analysis Services de SQL Server local.</span><span class="sxs-lookup"><span data-stu-id="3d29f-190">When a PowerPivot workbook is opened on a SharePoint site, Excel Services reads the embedded PowerPivot data connection string and forwards the request to the local SQL Server Analysis Services OLE DB provider.</span></span> <span data-ttu-id="3d29f-191">A continuación, el proveedor pasa la información de conexión a un servidor de PowerPivot en la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-191">The provider then passes the connection information to a PowerPivot server in the farm.</span></span> <span data-ttu-id="3d29f-192">Para que la solicitud fluya uniformemente entre los dos servidores, Excel Services se debe configurar para usar valores que son requeridos por PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-192">In order for requests to flow seamlessly between the two servers, Excel Services must be configured to use settings that are required by PowerPivot for SharePoint.</span></span>  
  
 <span data-ttu-id="3d29f-193">En Excel Services, la configuración relativa a la seguridad se especifica en las ubicaciones confiables, proveedores de datos confiables y bibliotecas de conexiones de datos confiables.</span><span class="sxs-lookup"><span data-stu-id="3d29f-193">In Excel Services, security-related configuration settings are specified on trusted locations, trusted data providers, and trusted data connection libraries.</span></span> <span data-ttu-id="3d29f-194">En la siguiente tabla se describen los valores que habilitan o mejoran el acceso a datos PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-194">The following table describes the settings that enable or enhance PowerPivot data access.</span></span> <span data-ttu-id="3d29f-195">Si no aparece aquí un valor, no tiene ningún efecto en las conexiones con el servidor de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-195">If a setting is not listed here, it has no effect on PowerPivot server connections.</span></span> <span data-ttu-id="3d29f-196">Para obtener instrucciones sobre cómo especificar estos valores paso a paso, vea la sección "habilitar Excel Services" en [configuración inicial &#40;PowerPivot para SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="3d29f-196">For instructions on how to specify these settings step by step, see the section "Enable Excel Services" in [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3d29f-197">La mayoría de la configuración relacionada con la seguridad se aplica a las ubicaciones confiables.</span><span class="sxs-lookup"><span data-stu-id="3d29f-197">Most security-related settings apply to trusted locations.</span></span> <span data-ttu-id="3d29f-198">Si desea conservar los valores predeterminados o usar valores diferentes para sitios distintos, puede crear una ubicación confiable adicional para sitios que contienen datos PowerPivot y, a continuación, configurar los siguientes valores solo para ese sitio.</span><span class="sxs-lookup"><span data-stu-id="3d29f-198">If you want to preserve default values or use different values for different sites, you can create an additional trusted location for sites that contain PowerPivot data, and then configure the following settings for just that site.</span></span> <span data-ttu-id="3d29f-199">Para obtener más información, consulte [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span><span class="sxs-lookup"><span data-stu-id="3d29f-199">For more information, see [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span></span>  
  
|<span data-ttu-id="3d29f-200">Área</span><span class="sxs-lookup"><span data-stu-id="3d29f-200">Area</span></span>|<span data-ttu-id="3d29f-201">Configuración</span><span class="sxs-lookup"><span data-stu-id="3d29f-201">Setting</span></span>|<span data-ttu-id="3d29f-202">Descripción</span><span class="sxs-lookup"><span data-stu-id="3d29f-202">Description</span></span>|  
|----------|-------------|-----------------|  
|<span data-ttu-id="3d29f-203">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="3d29f-203">Web application</span></span>|<span data-ttu-id="3d29f-204">Proveedor de autenticación de Windows</span><span class="sxs-lookup"><span data-stu-id="3d29f-204">Windows authentication provider</span></span>|<span data-ttu-id="3d29f-205">PowerPivot convierte un token de notificación que obtiene de Excel Services en una identidad de usuario de Windows.</span><span class="sxs-lookup"><span data-stu-id="3d29f-205">PowerPivot converts a claims token that it gets from Excel Services to a Windows user identity.</span></span> <span data-ttu-id="3d29f-206">Cualquier aplicación web que use Excel Services como un recurso se debe configurar para usar el proveedor de autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="3d29f-206">Any web application that uses Excel Services as a resource must be configured to use the Windows authentication provider.</span></span>|  
|<span data-ttu-id="3d29f-207">Ubicación confiable</span><span class="sxs-lookup"><span data-stu-id="3d29f-207">Trusted location</span></span>|<span data-ttu-id="3d29f-208">Tipo de ubicación</span><span class="sxs-lookup"><span data-stu-id="3d29f-208">Location Type</span></span>|<span data-ttu-id="3d29f-209">Este valor debe estar establecido en **Microsoft SharePoint Foundation**.</span><span class="sxs-lookup"><span data-stu-id="3d29f-209">This value must be set to **Microsoft SharePoint Foundation**.</span></span> <span data-ttu-id="3d29f-210">Los servidores de PowerPivot recuperan una copia del archivo .xlsx y la cargan en un servidor de Analysis Services en la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-210">PowerPivot servers retrieve a copy of the .xlsx file and load it on an Analysis Services server in the farm.</span></span> <span data-ttu-id="3d29f-211">El servidor solo puede recuperar archivos .xlsx de una biblioteca de contenidos.</span><span class="sxs-lookup"><span data-stu-id="3d29f-211">The server can only retrieve .xlsx files from a content library.</span></span>|  
||<span data-ttu-id="3d29f-212">Permitir datos externos</span><span class="sxs-lookup"><span data-stu-id="3d29f-212">Allow External Data</span></span>|<span data-ttu-id="3d29f-213">Este valor debe estar establecido en **Bibliotecas de conexiones de datos de confianza e incrustadas**.</span><span class="sxs-lookup"><span data-stu-id="3d29f-213">This value must be set to **Trusted data connection libraries and embedded**.</span></span> <span data-ttu-id="3d29f-214">Los libros PowerPivot contienen conexiones de datos incrustadas.</span><span class="sxs-lookup"><span data-stu-id="3d29f-214">PowerPivot data connections are embedded in the workbook.</span></span> <span data-ttu-id="3d29f-215">Si deniega las conexiones incrustadas, los usuarios pueden ver la memoria caché de la tabla dinámica, pero no podrán utilizar los datos PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-215">If you disallow embedded connections, users can view the PivotTable cache, but they will not be able to interact with the PowerPivot data.</span></span>|  
||<span data-ttu-id="3d29f-216">Avisar al actualizar</span><span class="sxs-lookup"><span data-stu-id="3d29f-216">Warn on Refresh</span></span>|<span data-ttu-id="3d29f-217">Este valor debería estar deshabilitado si está usando la galería de PowerPivot para almacenar libros e informes.</span><span class="sxs-lookup"><span data-stu-id="3d29f-217">This value should be disabled if you are using PowerPivot Gallery to store workbooks and reports.</span></span> <span data-ttu-id="3d29f-218">La galería de PowerPivot incluye una característica de vista previa de documentos que funciona mejor si están desactivadas actualizar al abrir y Avisar al actualizar.</span><span class="sxs-lookup"><span data-stu-id="3d29f-218">PowerPivot Gallery includes a document preview feature that works best if both refresh on open and Warn on Refresh are turned off.</span></span>|  
|<span data-ttu-id="3d29f-219">Proveedores de datos confiables</span><span class="sxs-lookup"><span data-stu-id="3d29f-219">Trusted data providers</span></span>|<span data-ttu-id="3d29f-220">MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="3d29f-220">MSOLAP.4</span></span><br /><br /> <span data-ttu-id="3d29f-221">MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="3d29f-221">MSOLAP.5</span></span>|<span data-ttu-id="3d29f-222">MSOLAP.4 está incluido de forma predeterminada, pero el acceso a datos PowerPivot requiere que el proveedor de MSOLAP.4 sea la versión SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="3d29f-222">MSOLAP.4 is included by default, but PowerPivot data access requires that the MSOLAP.4 provider be the SQL Server 2008 R2 version.</span></span><br /><br /> <span data-ttu-id="3d29f-223">MSOLAP.5 se instala con la versión [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] de PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="3d29f-223">MSOLAP.5 is installed with the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of PowerPivot for SharePoint.</span></span><br /><br /> <span data-ttu-id="3d29f-224">No quite estos proveedores de la lista de proveedores de datos confiables.</span><span class="sxs-lookup"><span data-stu-id="3d29f-224">Do not remove these providers from the trusted data provider list.</span></span> <span data-ttu-id="3d29f-225">En algunos casos, es posible que tenga que instalar copias adicionales de este proveedor en otros servidores de SharePoint de la granja.</span><span class="sxs-lookup"><span data-stu-id="3d29f-225">In some cases, you might need to install additional copies of this provider on other SharePoint servers in your farm.</span></span> <span data-ttu-id="3d29f-226">Para más información, consulte [Instalar el proveedor OLE DB de Analysis Services en servidores de SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="3d29f-226">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>|  
|<span data-ttu-id="3d29f-227">Bibliotecas de conexiones de datos confiables</span><span class="sxs-lookup"><span data-stu-id="3d29f-227">Trusted data connection libraries</span></span>|<span data-ttu-id="3d29f-228">Opcional.</span><span class="sxs-lookup"><span data-stu-id="3d29f-228">Optional.</span></span>|<span data-ttu-id="3d29f-229">Puede usar archivos de conexión de datos de Office (.odc) en libros PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="3d29f-229">You can use Office Data Connection (.odc) files in PowerPivot workbooks.</span></span> <span data-ttu-id="3d29f-230">Si utiliza archivos .odc para proporcionar información de conexión a libros PowerPivot locales, puede agregar los mismos archivos .odc a esta biblioteca.</span><span class="sxs-lookup"><span data-stu-id="3d29f-230">If you use .odc files to provide connection information to local PowerPivot workbooks, you can add the same .odc files to this library.</span></span>|  
|<span data-ttu-id="3d29f-231">Ensamblados de funciones definidas por el usuario</span><span class="sxs-lookup"><span data-stu-id="3d29f-231">User defined function assembly</span></span>|<span data-ttu-id="3d29f-232">No es aplicable.</span><span class="sxs-lookup"><span data-stu-id="3d29f-232">Not applicable.</span></span>|<span data-ttu-id="3d29f-233">PowerPivot para SharePoint omite los ensamblados de funciones definidas por el usuario que implemente para Excel Services.</span><span class="sxs-lookup"><span data-stu-id="3d29f-233">PowerPivot for SharePoint ignores user-defined function assemblies that you build deploy for Excel Services.</span></span> <span data-ttu-id="3d29f-234">Si confía en los ensamblados definidos por el usuario para conseguir un comportamiento determinado, tenga en cuenta que el procesamiento de consultas de PowerPivot no usará las funciones definidas por el usuario que ha creado.</span><span class="sxs-lookup"><span data-stu-id="3d29f-234">If you rely on user-defined assemblies for a specific behavior, be aware that PowerPivot query processing will not use the user-defined functions you created.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="3d29f-235">Consulte también</span><span class="sxs-lookup"><span data-stu-id="3d29f-235">See Also</span></span>  
 <span data-ttu-id="3d29f-236">[Configurar cuentas de servicio PowerPivot](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="3d29f-236">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 <span data-ttu-id="3d29f-237">[Configurar la cuenta de actualización de datos desatendida de PowerPivot &#40;PowerPivot para SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="3d29f-237">[Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span></span>  
 <span data-ttu-id="3d29f-238">[Crear una ubicación de confianza para los sitios de PowerPivot en administración central](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span><span class="sxs-lookup"><span data-stu-id="3d29f-238">[Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span></span>  
 [<span data-ttu-id="3d29f-239">Arquitectura de seguridad de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="3d29f-239">PowerPivot Security Architecture</span></span>](https://go.microsoft.com/fwlink/?linkID=220970)  
  
  
