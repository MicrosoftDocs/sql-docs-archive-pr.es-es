---
title: 'No pueden actualizar los datos de una conexión de datos del libro. Vuelva a intentarlo o póngase en contacto con el administrador del sistema. No se pudieron actualizar las siguientes conexiones: datos PowerPivot | Microsoft Docs'
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9c25c2597bbc7aa16fb8b66d4ffddbf0df14515e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87748308"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a><span data-ttu-id="d0e4f-104">No pueden actualizar los datos de una conexión de datos del libro.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-104">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="d0e4f-105">Vuelva a intentarlo o póngase en contacto con el administrador del sistema.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-105">Try again or contact your system administrator.</span></span> <span data-ttu-id="d0e4f-106">No se pudieron actualizar las siguientes conexiones: datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d0e4f-106">The following connections failed to refresh: PowerPivot Data</span></span>
  <span data-ttu-id="d0e4f-107">Para los libros de Excel que contienen datos PowerPivot, Excel Services devuelve este error si envía una solicitud de conexión a un servidor PowerPivot y se produce un error en la solicitud.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-107">For Excel workbooks that contain PowerPivot data, Excel Services returns this error if it submits a connection request to a PowerPivot server and the request fails.</span></span>  
  
## <a name="details"></a><span data-ttu-id="d0e4f-108">Detalles</span><span class="sxs-lookup"><span data-stu-id="d0e4f-108">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="d0e4f-109">Se aplica a:</span><span class="sxs-lookup"><span data-stu-id="d0e4f-109">Applies to:</span></span>|<span data-ttu-id="d0e4f-110">Instalación de PowerPivot para SharePoint</span><span class="sxs-lookup"><span data-stu-id="d0e4f-110">PowerPivot for SharePoint installation</span></span>|  
|<span data-ttu-id="d0e4f-111">Versión del producto</span><span class="sxs-lookup"><span data-stu-id="d0e4f-111">Product Version</span></span>|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="d0e4f-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="d0e4f-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span></span>|  
|<span data-ttu-id="d0e4f-113">Causa</span><span class="sxs-lookup"><span data-stu-id="d0e4f-113">Cause</span></span>|<span data-ttu-id="d0e4f-114">Vea a continuación.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-114">See below.</span></span>|  
|<span data-ttu-id="d0e4f-115">Texto del mensaje</span><span class="sxs-lookup"><span data-stu-id="d0e4f-115">Message Text</span></span>|<span data-ttu-id="d0e4f-116">No pueden actualizar los datos de una conexión de datos del libro.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-116">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="d0e4f-117">Vuelva a intentarlo o póngase en contacto con el administrador del sistema.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-117">Try again or contact your system administrator.</span></span> <span data-ttu-id="d0e4f-118">No se pudieron actualizar las siguientes conexiones: datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="d0e4f-118">The following connections failed to refresh: PowerPivot Data</span></span>|  
  
## <a name="explanation-and-resolution"></a><span data-ttu-id="d0e4f-119">Explicación y resolución</span><span class="sxs-lookup"><span data-stu-id="d0e4f-119">Explanation and Resolution</span></span>  
 <span data-ttu-id="d0e4f-120">Excel Services no puede conectarse con los datos PowerPivot o cargarlos.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-120">Excel Services cannot connect to or load the PowerPivot data.</span></span> <span data-ttu-id="d0e4f-121">Este error puede producirse por alguna de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="d0e4f-121">Conditions that cause this error to occur include the following:</span></span>  
  
 <span data-ttu-id="d0e4f-122">**Escenario 1: el servicio no se inicia**</span><span class="sxs-lookup"><span data-stu-id="d0e4f-122">**Scenario 1: Service is not started**</span></span>  
  
 <span data-ttu-id="d0e4f-123">No se ha iniciado la instancia de SQL Server Analysis Services (PowerPivot).</span><span class="sxs-lookup"><span data-stu-id="d0e4f-123">The SQL Server Analysis Services (PowerPivot) instance is not started.</span></span> <span data-ttu-id="d0e4f-124">Una contraseña caducada hará que el servicio deje de funcionar.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-124">An expired password will cause the service to stop running.</span></span> <span data-ttu-id="d0e4f-125">Para obtener más información acerca de cómo cambiar la contraseña, vea [configurar las cuentas de servicio PowerPivot](configure-power-pivot-service-accounts.md) e [iniciar o detener un servidor PowerPivot para SharePoint](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span><span class="sxs-lookup"><span data-stu-id="d0e4f-125">For more information about changing the password, see [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) and [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span></span>  
  
 <span data-ttu-id="d0e4f-126">**Escenario 2a: abrir un libro de la versión anterior en el servidor**</span><span class="sxs-lookup"><span data-stu-id="d0e4f-126">**Scenario 2a: Opening an earlier version workbook n the server**</span></span>  
  
 <span data-ttu-id="d0e4f-127">El libro que intenta abrir podría haberse creado en la versión SQL Server 2008 R2 de PowerPivot para Excel.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-127">The workbook you are attempting to open might have been created in the SQL Server 2008 R2 version of PowerPivot for Excel.</span></span> <span data-ttu-id="d0e4f-128">Probablemente, el proveedor de datos de Analysis Services que se especifica en la cadena de conexión de datos no está presente en el equipo que controla la solicitud.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-128">Most likely, the Analysis Services data provider that is specified in the data connection string is not present on the computer that is handling the request.</span></span>  
  
 <span data-ttu-id="d0e4f-129">Si este es el caso, encontrará este mensaje en el registro de ULS: "error al actualizar para ' datos PowerPivot ' en el libro ' \<URL to workbook> '", seguido de "no se puede obtener una conexión".</span><span class="sxs-lookup"><span data-stu-id="d0e4f-129">If this is the case, you will find this message in the ULS log: "Refresh failed for 'PowerPivot Data' in the workbook '\<URL to workbook>'", followed by "Unable to get a connection".</span></span>  
  
 <span data-ttu-id="d0e4f-130">Para determinar la versión del libro, ábralo en Excel y compruebe qué proveedor de datos se especifica en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-130">To determine the version of the workbook, open it in Excel and check which data provider is specified in the connection string.</span></span> <span data-ttu-id="d0e4f-131">Un libro de SQL Server 2008 R2 usa MSOLAP.4 como su proveedor de datos.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-131">A SQL Server 2008 R2 workbook uses MSOLAP.4 as its data provider.</span></span>  
  
 <span data-ttu-id="d0e4f-132">Para evitar este problema, puede actualizar el libro.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-132">To work around this issue, you can upgrade the workbook.</span></span> <span data-ttu-id="d0e4f-133">Opcionalmente, puede instalar las bibliotecas cliente de la versión SQL Server 2008 R2 de Analysis Services en los equipos físicos que ejecutan PowerPivot para SharePoint o Excel Services:</span><span class="sxs-lookup"><span data-stu-id="d0e4f-133">Alternatively, you can install client libraries from the SQL Server 2008 R2 version of Analysis Services on the physical computers running PowerPivot for SharePoint or Excel Services:</span></span>  
  
 [<span data-ttu-id="d0e4f-134">Instalar el proveedor OLE DB de Analysis Services en servidores de SharePoint</span><span class="sxs-lookup"><span data-stu-id="d0e4f-134">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 <span data-ttu-id="d0e4f-135">**Escenario 2b: Excel Services se ejecuta en un servidor de aplicaciones que tiene una versión incorrecta de las bibliotecas de cliente**</span><span class="sxs-lookup"><span data-stu-id="d0e4f-135">**Scenario 2b: Excel Services is running on an application server that has the wrong version of the client libraries**</span></span>  
  
 <span data-ttu-id="d0e4f-136">De forma predeterminada, SharePoint Server 2010 instala la versión SQL Server 2008 del proveedor OLE DB de Analysis Services en los servidores de aplicaciones que ejecutan Excel Services.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-136">By default, SharePoint Server 2010 installs the SQL Server 2008 version of the Analysis Services OLE DB provider on application servers that run Excel Services.</span></span> <span data-ttu-id="d0e4f-137">En una granja de servidores que admite el acceso a datos PowerPivot, todos los servidores físicos que ejecutan aplicaciones que solicitan datos de PowerPivot, por ejemplo, Excel Services y PowerPivot para SharePoint, deben usar una versión posterior del proveedor de datos.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-137">In a farm that supports PowerPivot data access, all physical servers running applications that request PowerPivot data, such as Excel Services and PowerPivot for SharePoint, must use a later version of the data provider.</span></span>  
  
 <span data-ttu-id="d0e4f-138">Los servidores que ejecutan PowerPivot para SharePoint obtienen el proveedor de datos OLE DB actualizado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-138">Servers that run PowerPivot for SharePoint get the updated OLE DB data provider automatically.</span></span> <span data-ttu-id="d0e4f-139">Otros servidores, como los que ejecutan una instancia independiente de Excel Services (sin PowerPivot para SharePoint en el mismo equipo), deben aplicar una revisión para usar las bibliotecas más recientes del cliente.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-139">Other servers, such as those running a standalone instance Excel Services without PowerPivot for SharePoint on the same computer, must be patched to use the newer client libraries.</span></span> <span data-ttu-id="d0e4f-140">Para más información, consulte [Instalar el proveedor OLE DB de Analysis Services en servidores de SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="d0e4f-140">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>  
  
 <span data-ttu-id="d0e4f-141">**Escenario 3: el controlador de dominio no está disponible**</span><span class="sxs-lookup"><span data-stu-id="d0e4f-141">**Scenario 3: Domain controller is unavailable**</span></span>  
  
 <span data-ttu-id="d0e4f-142">La causa podría ser que un controlador de dominio no está disponible para validar la identidad del usuario.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-142">The cause might be that a domain controller is not available to validate the user identity.</span></span> <span data-ttu-id="d0e4f-143">Notificaciones del servicio de token de Windows requiere un controlador de dominio para autenticar al usuario de SharePoint en cada conexión.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-143">A domain controller is required by the Claims to Windows Token Service to authenticate the SharePoint user on each connection.</span></span> <span data-ttu-id="d0e4f-144">Notificaciones del servicio de token de Windows no utiliza las credenciales almacenadas en memoria caché.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-144">The Claims to Windows Token Service does not use cached credentials.</span></span> <span data-ttu-id="d0e4f-145">Valida la identidad del usuario para cada conexión.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-145">It validates the user identity for each connection.</span></span>  
  
 <span data-ttu-id="d0e4f-146">Puede confirmar la causa de este error en el archivo de registro de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-146">You can confirm the cause of this error by viewing the SharePoint log file.</span></span> <span data-ttu-id="d0e4f-147">Si los registros de SharePoint incluyen el mensaje "No se puede obtener WindowsIdentity de IClaimsIdentity", la identidad del usuario no se pudo autenticar.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-147">If the SharePoint logs include the message "Failed to get WindowsIdentity from IClaimsIdentity", the user identity could not be authenticated.</span></span>  
  
 <span data-ttu-id="d0e4f-148">Para evitar este problema, una el equipo al mismo dominio del servidor PowerPivot o instale un controlador de dominio en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-148">To work around this problem, join the computer to the same domain as the PowerPivot server, or install a domain controller on your local computer.</span></span> <span data-ttu-id="d0e4f-149">La segunda solución, instalar el controlador de dominio, le exigirá que cree cuentas de dominio locales para todos los servicios y usuarios.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-149">The second solution, installing the domain controller, will require you to create local domain accounts for all services and users.</span></span> <span data-ttu-id="d0e4f-150">Tendrá que configurar cuentas de servicio y permisos de SharePoint para las cuentas que defina.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-150">You will need to configure service accounts and SharePoint permissions for the accounts you define.</span></span>  
  
 <span data-ttu-id="d0e4f-151">La instalación de un controlador de dominio en el equipo resulta útil si desea utilizar PowerPivot para SharePoint en un estado sin conexión.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-151">Installing a domain controller on your computer is useful if your objective is to use PowerPivot for SharePoint in an offline state.</span></span> <span data-ttu-id="d0e4f-152">Para obtener instrucciones detalladas acerca de cómo usar PowerPivot sin conexión, vea la entrada de blog sobre cómo desconectar el servidor PowerPivot de la red [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241) .</span><span class="sxs-lookup"><span data-stu-id="d0e4f-152">For detailed instructions on how to use PowerPivot offline, see the blog entry for "Taking your PowerPivot server off the network" on [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241).</span></span>  
  
 <span data-ttu-id="d0e4f-153">**Escenario 4: servidor inestable**</span><span class="sxs-lookup"><span data-stu-id="d0e4f-153">**Scenario 4: Unstable server**</span></span>  
  
 <span data-ttu-id="d0e4f-154">Uno o más servicios pueden estar en un estado incoherente.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-154">One or more services might be in an inconsistent state.</span></span> <span data-ttu-id="d0e4f-155">En algunos casos, al ejecutar IISRESET, se resolverá el problema.</span><span class="sxs-lookup"><span data-stu-id="d0e4f-155">In some cases, running IISRESET will resolve the problem.</span></span>  
  
  
