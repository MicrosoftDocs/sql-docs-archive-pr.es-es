---
title: Programar una actualización de datos (PowerPivot para SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 8571208f-6aae-4058-83c6-9f916f5e2f9b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9d6078cf59c27c15ead8f22047ba9add20757be7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87669916"
---
# <a name="schedule-a-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="37be8-102">Programar una actualización de datos (PowerPivot para SharePoint)</span><span class="sxs-lookup"><span data-stu-id="37be8-102">Schedule a Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="37be8-103">Puede programar la actualización de datos para obtener actualizaciones automáticas de los datos PowerPivot dentro de un libro de Excel que publicara en un sitio de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37be8-103">You can schedule data refresh to get automatic updates to PowerPivot data inside an Excel workbook that you published to a SharePoint site.</span></span>  
  
 <span data-ttu-id="37be8-104">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="37be8-104">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="37be8-105">**En este tema:**</span><span class="sxs-lookup"><span data-stu-id="37be8-105">**In this topic:**</span></span>  
  
 [<span data-ttu-id="37be8-106">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="37be8-106">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="37be8-107">Información general sobre la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="37be8-107">Data Refresh Overview</span></span>](#intro)  
  
 [<span data-ttu-id="37be8-108">Habilitar y programar la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="37be8-108">Enable and schedule data refresh</span></span>](#drenablesched)  
  
 [<span data-ttu-id="37be8-109">Comprobar la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="37be8-109">Verify Data Refresh</span></span>](#drverify)  
  
> [!NOTE]  
>  <span data-ttu-id="37be8-110">Las instancias de servidor de Analysis Services realizan la actualización de los datos PowerPivot en la granja de servidores de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37be8-110">PowerPivot data refresh is performed by Analysis Services server instances in the SharePoint farm.</span></span> <span data-ttu-id="37be8-111">No está relacionada con la característica de actualización de datos que se proporciona en Excel Services.</span><span class="sxs-lookup"><span data-stu-id="37be8-111">It is not related to the data refresh feature that is provided in Excel Services.</span></span> <span data-ttu-id="37be8-112">La característica de programación de actualizaciones de datos de PowerPivot no actualizará los datos que no sean de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37be8-112">The PowePivot Schedule data refresh feature will not refresh non PowerPivot data.</span></span>  
  
##  <a name="prerequisites"></a><a name="prereq"></a> <span data-ttu-id="37be8-113">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="37be8-113">Prerequisites</span></span>  
 <span data-ttu-id="37be8-114">Debe tener el nivel de permisos para contribuir o uno superior en el libro si desea crear una programación para la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-114">You must have Contribute level of permission or greater on the workbook to create a data refresh schedule.</span></span>  
  
 <span data-ttu-id="37be8-115">Los orígenes de datos externos a los que se tiene acceso durante la actualización de datos deben estar disponibles y las credenciales que especifique en la programación deben tener el permiso de acceso a esos orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-115">External data sources that are accessed during data refresh must be available and the credentials you specify in the schedule must have permission to access those data sources.</span></span> <span data-ttu-id="37be8-116">La actualización de datos programada requiere la ubicación de un origen de datos que sea accesible a través de una conexión de red (por ejemplo, desde un recurso compartido de archivos de red en lugar de una carpeta local en la estación de trabajo).</span><span class="sxs-lookup"><span data-stu-id="37be8-116">Scheduled data refresh requires a data source location that is accessible over a network connection (for example, from a network file share rather than a local folder on your workstation).</span></span>  
  
 <span data-ttu-id="37be8-117">El origen de datos no puede ser un documento de Office ni una base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="37be8-117">The data source cannot be an Office document or Access database.</span></span> <span data-ttu-id="37be8-118">Office no admite el uso de los componentes de conectividad de Office en un entorno de servidor.</span><span class="sxs-lookup"><span data-stu-id="37be8-118">Office does not support the use of the Office data connectivity components in a server environment.</span></span> <span data-ttu-id="37be8-119">Si el libro contiene datos de estos orígenes, asegúrese de quitar esos orígenes de la lista de orígenes de datos en la programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-119">If your workbook contains data from these sources, be sure to remove those sources from the data source list in your data refresh schedule.</span></span>  
  
 <span data-ttu-id="37be8-120">El libro debe ser una versión de [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="37be8-120">The workbook must be a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version.</span></span> <span data-ttu-id="37be8-121">Si usa los libros creados en la versión anterior de PowerPivot para Excel, la actualización de datos de la programación no funcionará a menos que actualice la base de datos a la nueva versión.</span><span class="sxs-lookup"><span data-stu-id="37be8-121">If you use workbooks that were created in the previous release of PowerPivot for Excel, schedule data refresh will not work unless you upgrade the database to the most recent version.</span></span>  
  
 <span data-ttu-id="37be8-122">El libro se debe proteger en el momento en que la operación de actualización finalice.</span><span class="sxs-lookup"><span data-stu-id="37be8-122">The workbook must be checked in at the time the refresh operation is finished.</span></span> <span data-ttu-id="37be8-123">Para ello, una vez finalizada la actualización de los datos, se realiza un bloqueo del libro del archivo. Este bloqueo se ejecuta cuando se guarda el archivo, y no cuando se inicia la actualización.</span><span class="sxs-lookup"><span data-stu-id="37be8-123">A lock on the workbook is placed on the file at the end of data refresh, when the file is saved, rather than when refresh starts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="37be8-124">El servidor no bloquea el libro mientras la actualización de datos esté en curso.</span><span class="sxs-lookup"><span data-stu-id="37be8-124">The server does not lock the workbook while the data refresh is in progress.</span></span> <span data-ttu-id="37be8-125">Sin embargo, bloquea el archivo al final de la actualización de datos con el fin de proteger el archivo actualizado.</span><span class="sxs-lookup"><span data-stu-id="37be8-125">However, it does lock the file at the end of data refresh for the purpose of checking in the updated file.</span></span> <span data-ttu-id="37be8-126">En este momento, el archivo se desprotege para otro usuario, se producirán los datos actualizados. Del mismo modo, si el archivo está protegido, pero es significativamente diferente de la copia recuperada por el servidor al inicio de la actualización de datos, se descartarán los datos actualizados.</span><span class="sxs-lookup"><span data-stu-id="37be8-126">If at this time, the file is checked out to another user, the refreshed data will be thrown out. Similarly, if the file is checked in, but it is significantly different from the copy retrieved by the server at the start of data refresh, the refreshed data will be discarded.</span></span>  
  
##  <a name="data-refresh-overview"></a><a name="intro"></a><span data-ttu-id="37be8-127">Información general sobre la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="37be8-127">Data Refresh Overview</span></span>  
 <span data-ttu-id="37be8-128">Los datos PowerPivot de libro de Excel pueden originarse en varios orígenes de datos externos como son bases de datos externas o archivos de datos a los que tiene acceso desde servidores remotos o desde recursos compartidos de archivos de red.</span><span class="sxs-lookup"><span data-stu-id="37be8-128">PowerPivot data in an Excel workbook can originate from multiple external data sources, including external databases or data files that you access from remote servers or network file shares.</span></span> <span data-ttu-id="37be8-129">En el caso de libros PowerPivot que contengan datos importados de orígenes de datos externos o conectados, puede configurar la actualización de datos para programar una importación automática de los datos actualizados de esos orígenes iniciales.</span><span class="sxs-lookup"><span data-stu-id="37be8-129">For PowerPivot workbooks that contain imported data from connected or external data sources, you can configure data refresh to schedule an automatic import of updated data from those original sources.</span></span>  
  
 <span data-ttu-id="37be8-130">El acceso a un origen de datos externo se obtiene a través de una dirección URL, ruta UNC o cadena de conexión incrustada que se especifica al importar los datos originales en el libro utilizando la aplicación cliente de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37be8-130">An external data source is accessed through an embedded connection string, URL, or UNC path that you specified when you imported the original data into the workbook using the PowerPivot client application.</span></span> <span data-ttu-id="37be8-131">La información de conexión original que está almacenada en el libro PowerPivot se reutiliza para las operaciones de actualización de datos subsiguientes.</span><span class="sxs-lookup"><span data-stu-id="37be8-131">Original connection information that is stored in the PowerPivot workbook is reused for subsequent data refresh operations.</span></span> <span data-ttu-id="37be8-132">Aunque puede sobrescribir las credenciales que se usan para conectarse a los orígenes de datos, no puede sobrescribir las cadenas de conexión para la actualización de datos; solo se utiliza la información de conexión existente.</span><span class="sxs-lookup"><span data-stu-id="37be8-132">Although you can overwrite credentials used to connect to data sources, you cannot overwrite connection strings for data refresh purposes; only existing connection information is used.</span></span>  
  
 <span data-ttu-id="37be8-133">Solo hay una página de programación de actualización de datos para cada libro y toda la información de programación se especifica en esa página.</span><span class="sxs-lookup"><span data-stu-id="37be8-133">There is only one data refresh schedule page for each workbook, and all schedule information is specified on that page.</span></span> <span data-ttu-id="37be8-134">Normalmente, la persona que creó el libro define la programación.</span><span class="sxs-lookup"><span data-stu-id="37be8-134">Typically, the person who authored the workbook defines the schedule.</span></span>  
  
 <span data-ttu-id="37be8-135">Como propietario de la programación, realice las siguientes tareas:</span><span class="sxs-lookup"><span data-stu-id="37be8-135">As the schedule owner, you perform the following tasks:</span></span>  
  
-   <span data-ttu-id="37be8-136">Defina la programación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="37be8-136">Define the default schedule.</span></span> <span data-ttu-id="37be8-137">Esta es la programación que se utiliza si no hay ninguna programación definida en el nivel del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-137">This is the schedule that is used if there are no scheduled defined at the data source level.</span></span>  
  
-   <span data-ttu-id="37be8-138">Especifique las credenciales que se van a usar para ejecutar la actualización de los datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-138">Specify the credentials used to run data refresh</span></span>  
  
-   <span data-ttu-id="37be8-139">Elija los orígenes de datos que se van a incluir en la operación de actualización.</span><span class="sxs-lookup"><span data-stu-id="37be8-139">Choose which data sources to include in the refresh operation.</span></span>  
  
-   <span data-ttu-id="37be8-140">Si lo desea, puede especificar también programaciones específicas en línea y las credenciales de cada origen de datos que se va a consultar durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-140">Optionally, specify in-line, individual schedules and credentials for each data source that is queried during data refresh.</span></span> <span data-ttu-id="37be8-141">Cada origen de datos se puede actualizar de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="37be8-141">Each data source can be refreshed independently.</span></span> <span data-ttu-id="37be8-142">Si crea programaciones personalizadas para cada origen de datos, se omitirá la programación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="37be8-142">If you create custom schedules for every data source, the default schedule is ignored.</span></span>  
  
 <span data-ttu-id="37be8-143">Al crear programaciones específicas para orígenes de datos individuales se permite hacer coincidir la programación de la actualización con las fluctuaciones en los orígenes de datos externos.</span><span class="sxs-lookup"><span data-stu-id="37be8-143">Creating granular schedules for individual data sources enables you to match the refresh schedule to fluctuations in the external data sources.</span></span> <span data-ttu-id="37be8-144">Por ejemplo, si un origen de datos externo contiene datos transaccionales que se generan a lo largo del día, puede crear una programación individual de la actualización de datos para que ese origen de datos obtenga su información actualizada por la noche.</span><span class="sxs-lookup"><span data-stu-id="37be8-144">For example, if an external data source contains transactional data that is generated throughout the day, you can create an individual data refresh schedule for that data source to get its updated information nightly.</span></span>  
  
##  <a name="enable-and-schedule-data-refresh"></a><a name="drenablesched"></a><span data-ttu-id="37be8-145">Habilitar y programar la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="37be8-145">Enable and schedule data refresh</span></span>  
 <span data-ttu-id="37be8-146">Utilice las siguientes instrucciones para programar la actualización de datos para los datos PowerPivot en un libro de Excel que esté publicado en una biblioteca de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37be8-146">Use the following instructions to schedule data refresh for PowerPivot data in an Excel workbook that is published to a SharePoint library.</span></span>  
  
1.  <span data-ttu-id="37be8-147">En la biblioteca que contenga el libro, selecciónelo y, a continuación, haga clic en la flecha abajo para mostrar una lista de comandos.</span><span class="sxs-lookup"><span data-stu-id="37be8-147">In the library that contains the workbook, select the workbook and then click the down arrow to display a list of commands.</span></span>  
  
2.  <span data-ttu-id="37be8-148">Haga clic en **Administrar actualización de datos PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="37be8-148">Click **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="37be8-149">Si ya se ha definido una programación de actualización de datos, en su lugar verá la página del historial para ver la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-149">If a data refresh schedule is already defined, you will see the View Data Refresh history page instead.</span></span> <span data-ttu-id="37be8-150">Puede hacer clic en **Configurar actualización de datos** para abrir la página de definición de la programación.</span><span class="sxs-lookup"><span data-stu-id="37be8-150">You can click **Configure data refresh** to open the schedule definition page.</span></span>  
  
3.  <span data-ttu-id="37be8-151">En la página de definición de la programación, active la casilla **Habilitar** .</span><span class="sxs-lookup"><span data-stu-id="37be8-151">In the schedule definition page, select the **Enable** checkbox.</span></span>  
  
4.  <span data-ttu-id="37be8-152">En Detalles de programación, especifique el tipo de programación y sus detalles.</span><span class="sxs-lookup"><span data-stu-id="37be8-152">In Schedule Details, specify the type of schedule and specify its details.</span></span> <span data-ttu-id="37be8-153">En este paso se crea la programación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="37be8-153">This step creates the default schedule.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="37be8-154">Asegúrese de activar la casilla **También actualizar lo más rápido posible** .</span><span class="sxs-lookup"><span data-stu-id="37be8-154">Be sure to select the **Also refresh as soon as possible** checkbox.</span></span> <span data-ttu-id="37be8-155">Esto le permite comprobar que la actualización de datos funciona para este libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-155">Doing so lets you verify that data refresh is operational for this workbook.</span></span> <span data-ttu-id="37be8-156">Tenga en cuenta que una vez guardada la programación, puede tardar hasta un minuto el inicio de la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-156">Note that after you save schedule, it can take up to a minute for data refresh to start.</span></span>  
  
5.  <span data-ttu-id="37be8-157">En Hora de inicio más temprana, elija una de las siguientes:</span><span class="sxs-lookup"><span data-stu-id="37be8-157">In Earliest Start Time, choose one of the following:</span></span>  
  
    1.  <span data-ttu-id="37be8-158">**Después del horario comercial** especifica un período de procesamiento fuera del horario comercial cuando es más probable que los servidores de bases de datos tengan los datos actuales que se generaron a lo largo del día laboral.</span><span class="sxs-lookup"><span data-stu-id="37be8-158">**After business hours** specifies an off-hours processing period when database servers are more likely to have current data that was generated throughout the business day.</span></span>  
  
    2.  <span data-ttu-id="37be8-159">**Hora de inicio más temprana específica** es la hora y los minutos de la hora más cercana del día en que le gustaría que la solicitud de actualización de datos se agregara a una cola de procesos.</span><span class="sxs-lookup"><span data-stu-id="37be8-159">**Specific earliest start time** is the hour and minutes of the earliest time of day the data refresh request is added to a process queue.</span></span> <span data-ttu-id="37be8-160">Los minutos se pueden especificar en intervalos de 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="37be8-160">You can specify minutes in 15-minute intervals.</span></span> <span data-ttu-id="37be8-161">La configuración se aplica al día actual así como a fechas futuras.</span><span class="sxs-lookup"><span data-stu-id="37be8-161">The setting applies to the current day as well as future dates.</span></span> <span data-ttu-id="37be8-162">Por ejemplo, si especifica el valor 6:30 a.m.</span><span class="sxs-lookup"><span data-stu-id="37be8-162">For example, if you specify a value of 6:30 A.M.</span></span> <span data-ttu-id="37be8-163">y la hora actual son las 4:30 p.m., la solicitud de actualización se agregará a la cola en el día actual porque 4:30 p.m.</span><span class="sxs-lookup"><span data-stu-id="37be8-163">and the current time is 4:30 P.M., the refresh request will be added to the queue in the current day because 4:30 P.M.</span></span> <span data-ttu-id="37be8-164">es después de las 6:30 a.m.</span><span class="sxs-lookup"><span data-stu-id="37be8-164">is after 6:30 A.M.</span></span>  
  
     <span data-ttu-id="37be8-165">La hora de inicio más temprana define cuándo se agrega una solicitud a la cola de procesos.</span><span class="sxs-lookup"><span data-stu-id="37be8-165">Earliest start time defines when a request is added to the process queue.</span></span> <span data-ttu-id="37be8-166">El procesamiento real se produce cuando el servidor tiene los recursos adecuados para comenzar el procesamiento de los datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-166">Actual processing occurs when the server has adequate resources to begin data processing.</span></span> <span data-ttu-id="37be8-167">El tiempo de procesamiento real se registrará en el historial de la actualización de datos una vez completado el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="37be8-167">Actual processing time will be recorded in data refresh history after processing is complete.</span></span>  
  
6.  <span data-ttu-id="37be8-168">Active la casilla **También actualizar lo más rápido posible** para ejecutar la actualización de datos en cuanto el servidor pueda procesarla.</span><span class="sxs-lookup"><span data-stu-id="37be8-168">Select the checkbox **Also refresh as soon as possible** to run data refresh as soon as the server can process it.</span></span> <span data-ttu-id="37be8-169">Un resultado correcto de un trabajo de actualización de datos comprueba que los orígenes de datos disponibles y que los permisos y la configuración de servidor están establecidos correctamente.</span><span class="sxs-lookup"><span data-stu-id="37be8-169">A successful outcome of a data refresh job verifies that the data sources are available and that permissions and server configuration are set correctly.</span></span>  
  
7.  <span data-ttu-id="37be8-170">En Notificaciones de correo electrónico, escriba la dirección de correo electrónico de la persona a la que se debería notificar en caso de un error de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="37be8-170">In E-mail notifications, enter the e-mail address of the person who should be notified in the event of a processing error.</span></span>  
  
8.  <span data-ttu-id="37be8-171">En Credenciales, especifique una cuenta utilizada para ejecutar el trabajo de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-171">In Credentials, specify an account used to run the data refresh job.</span></span> <span data-ttu-id="37be8-172">La cuenta debe tener permisos para contribuir en el libro y poder abrirlo y actualizar sus datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-172">The account must have Contribute permissions on the workbook so that it can open the workbook to refresh its data.</span></span> <span data-ttu-id="37be8-173">Debe ser una cuenta de usuario de dominio de Windows.</span><span class="sxs-lookup"><span data-stu-id="37be8-173">It must be a Windows domain user account.</span></span> <span data-ttu-id="37be8-174">En muchos casos, esta cuenta también debe tener permisos de lectura en los orígenes de datos externos utilizados durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-174">In many cases, this account must also have read permissions on the external data sources used during data refresh.</span></span> <span data-ttu-id="37be8-175">En concreto, si importó originalmente los datos mediante la opción Utilizar autenticación de Windows, la cadena de conexión se genera para utilizar las credenciales de Windows del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="37be8-175">Specifically, if you originally imported the data using the Use Windows Authentication option, then the connection string is built to use the Windows credentials of the current user.</span></span> <span data-ttu-id="37be8-176">Si el usuario actual es la cuenta de actualización de datos, la cuenta debe tener permisos de lectura en el origen de datos externo para que la actualización de datos se realice correctamente.</span><span class="sxs-lookup"><span data-stu-id="37be8-176">If the current user is the data refresh account, that account must have read permissions on the external data source in order for data refresh to succeed.</span></span> <span data-ttu-id="37be8-177">Elija una de las siguientes opciones:</span><span class="sxs-lookup"><span data-stu-id="37be8-177">Choose one of the following options:</span></span>  
  
    1.  <span data-ttu-id="37be8-178">Elija **Usar la cuenta de actualización de datos configurada por el administrador** para procesar la operación de actualización de datos mediante la cuenta de actualización de datos desatendida de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37be8-178">Choose **Use the data refresh account configured by the administrator** to process the data refresh operation using the PowerPivot unattended data refresh account.</span></span>  
  
    2.  <span data-ttu-id="37be8-179">Elija **Conectar con las siguientes credenciales de usuario de Windows** si desea escribir un nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="37be8-179">Choose **Connect using the following Windows user credentials** if you want to enter a user name and password.</span></span> <span data-ttu-id="37be8-180">Escriba la información de la cuenta con el formato dominio\usuario.</span><span class="sxs-lookup"><span data-stu-id="37be8-180">Enter the account information in domain\user format.</span></span>  
  
    3.  <span data-ttu-id="37be8-181">Elija **Conectar con las credenciales guardadas en el Servicio de almacenamiento seguro** si conoce el identificador de una aplicación de destino que contenga las credenciales almacenadas previamente que desea utilizar.</span><span class="sxs-lookup"><span data-stu-id="37be8-181">Choose **Connect using the credentials saved in Secure Store Service** if you know the ID of a target application that contains previously stored credentials you want to use.</span></span>  
  
     <span data-ttu-id="37be8-182">Para obtener más información acerca de estas opciones, vea [configurar credenciales almacenadas para la actualización de datos powerpivot &#40;PowerPivot para SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) y [configurar la cuenta de actualización de datos desatendida de PowerPivot &#40;PowerPivot para SharePoint ](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="37be8-182">For more information about these options, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
9. <span data-ttu-id="37be8-183">En Orígenes de datos, active la casilla **Todos los orígenes de datos** si desea que la actualización de datos vuelva a consultar todos los orígenes de datos originales.</span><span class="sxs-lookup"><span data-stu-id="37be8-183">In Data Sources, select the **All data sources** checkbox if you want data refresh to re-query all of the original data sources.</span></span>  
  
     <span data-ttu-id="37be8-184">Si selecciona esta opción, cualquier origen de datos externo que proporcione los datos PowerPivot se incluye automáticamente en la actualización, aun cuando la lista de orígenes de datos cambie con el tiempo a medida que agregue o quite los orígenes de datos que proporcionan datos al libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-184">If you select this option, any external data source that provides PowerPivot data is automatically included in the refresh, even if the list of data sources changes over time as you add or remove data sources that provide data to the workbook.</span></span>  
  
     <span data-ttu-id="37be8-185">Desactive la casilla **Todos los orígenes de datos** si desea seleccionar manualmente qué orígenes de datos incluir.</span><span class="sxs-lookup"><span data-stu-id="37be8-185">Clear the **All data sources** checkbox if you want to manually select which data sources to include.</span></span> <span data-ttu-id="37be8-186">Si posteriormente modifica el libro agregando un nuevo origen de datos, asegúrese de actualizar la lista de orígenes de datos en la programación.</span><span class="sxs-lookup"><span data-stu-id="37be8-186">If you later modify the workbook by adding a new data source, be sure to update the data source list in the schedule.</span></span> <span data-ttu-id="37be8-187">De lo contrario, los orígenes de datos más recientes no se incluirán en la operación de actualización.</span><span class="sxs-lookup"><span data-stu-id="37be8-187">Otherwise, newer data sources will not be included in the refresh operation.</span></span>  
  
     <span data-ttu-id="37be8-188">La lista de orígenes de datos entre los que puede elegir se recupera del libro PowerPivot al abrir la página Administrar actualización de datos PowerPivot para el libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-188">The list of data sources that you can choose from is retrieved from the PowerPivot workbook when you open the Manage PowerPivot Data Refresh page for the workbook.</span></span>  
  
     <span data-ttu-id="37be8-189">Asegúrese de seleccionar solo los orígenes de datos que cumplan los siguientes criterios:</span><span class="sxs-lookup"><span data-stu-id="37be8-189">Be sure to select only those data sources that meet the following criteria:</span></span>  
  
    -   <span data-ttu-id="37be8-190">El origen de datos debe estar disponible en la ubicación indicada en el momento en que se produce la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-190">The data source must be available at the time that data refresh occurs and at the stated location.</span></span> <span data-ttu-id="37be8-191">Si el origen de datos original está en una unidad de disco local del usuario que creó el libro, debe excluir ese origen de datos de la operación de actualización de datos o encontrar una manera de publicarlo en una ubicación que sea accesible a través de una conexión de red.</span><span class="sxs-lookup"><span data-stu-id="37be8-191">If the original data source is on a local disk drive of the person who authored the workbook, you must either exclude that data source from the data refresh operation, or find a way to publish that data source to a location that is accessible through a network connection.</span></span> <span data-ttu-id="37be8-192">Si mueve un origen de datos a una ubicación de red, asegúrese de abrir el libro en [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] y actualice la información de conexión del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-192">If you move a data source to a network location, be sure to open the workbook in [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] and update the data source connection information.</span></span> <span data-ttu-id="37be8-193">Esto es necesario para restablecer la información de conexión que está almacenada en el libro PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37be8-193">This is necessary to re-establish the connection information that is stored in the PowerPivot workbook.</span></span>  
  
    -   <span data-ttu-id="37be8-194">Se debe tener acceso al origen de datos utilizando la información de credenciales que está insertada en el libro PowerPivot o que se haya especificado en la programación.</span><span class="sxs-lookup"><span data-stu-id="37be8-194">The data source must be accessed using the credential information that is embedded in the PowerPivot workbook or that is specified in the schedule.</span></span> <span data-ttu-id="37be8-195">La información de credenciales insertadas se almacena en el libro PowerPivot al importar los datos con PowerPivot para Excel.</span><span class="sxs-lookup"><span data-stu-id="37be8-195">Embedded credential information is stored in the PowerPivot workbook when you import data using PowerPivot for Excel.</span></span> <span data-ttu-id="37be8-196">La información de credenciales insertada suele ser SSPI=IntegratedSecurity o SSPI=TrustedConnection, lo que significa que las credenciales del usuario actual se usan para conectarse al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-196">Embedded credential information is often SSPI=IntegratedSecurity or SSPI=TrustedConnection, which means use the credentials of the current user to connect to the data source.</span></span> <span data-ttu-id="37be8-197">Si desea invalidar la información de credenciales en la programación de actualización de datos, puede especificar credenciales predefinidas almacenadas.</span><span class="sxs-lookup"><span data-stu-id="37be8-197">If you want to override the credential information in your data refresh schedule, you can specify predefined, stored credentials.</span></span> <span data-ttu-id="37be8-198">Para obtener más información, vea [configurar credenciales almacenadas para la actualización de datos PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="37be8-198">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
    -   <span data-ttu-id="37be8-199">La actualización de datos debe realizarse para todos los orígenes de datos que especifique.</span><span class="sxs-lookup"><span data-stu-id="37be8-199">Data refresh must succeed for all of the data sources that you specify.</span></span> <span data-ttu-id="37be8-200">De lo contrario, se descartan los datos actualizados y se queda con la última versión guardada del libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-200">Otherwise, the refreshed data is discarded, leaving you with the last saved version of the workbook.</span></span> <span data-ttu-id="37be8-201">Excluya cualquier origen de datos en el que no confíe completamente.</span><span class="sxs-lookup"><span data-stu-id="37be8-201">Exclude any data sources that you are not sure about.</span></span>  
  
    -   <span data-ttu-id="37be8-202">La actualización de datos no debe invalidar otros datos del libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-202">Data refresh must not invalidate other data in your workbook.</span></span> <span data-ttu-id="37be8-203">Al actualizar un subconjunto de los datos, es importante que sepa si el libro es válido aún una vez se agreguen nuevos datos con datos estáticos que no sean del mismo período.</span><span class="sxs-lookup"><span data-stu-id="37be8-203">When you refresh a subset of your data, it is important that you understand whether the workbook is still valid once newer data is aggregated with static data that is not from the same time period.</span></span> <span data-ttu-id="37be8-204">Como autor de un libro, es su responsabilidad conocer sus dependencia de datos y asegurarse de que la actualización de datos es adecuada para el propio libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-204">As a workbook author, it is up to you to know your data dependencies and ensure that data refresh is appropriate for the workbook itself.</span></span>  
  
10. <span data-ttu-id="37be8-205">Opcionalmente, puede definir programaciones individuales para orígenes de datos concretos.</span><span class="sxs-lookup"><span data-stu-id="37be8-205">Optionally, you can define individual schedules for specific data sources.</span></span> <span data-ttu-id="37be8-206">Esto es útil si tiene orígenes de datos originales que se actualicen a sí mismos según una programación.</span><span class="sxs-lookup"><span data-stu-id="37be8-206">This is useful if you have original data sources that are themselves updated on a schedule.</span></span> <span data-ttu-id="37be8-207">Por ejemplo, si un origen de datos PowerPivot utiliza los datos de un data mart que se actualiza todos los lunes a las 02:00 horas, puede definir una programación incorporada para que el data mart recupere sus datos actualizados todos los lunes a las 04:00 horas.</span><span class="sxs-lookup"><span data-stu-id="37be8-207">For example, if a PowerPivot data source uses data from a data mart that is refreshed every Monday at 02:00 hours, you can define an inline schedule for the data mart to retrieve its refreshed data every Monday at 04:00 hours.</span></span>  
  
11. <span data-ttu-id="37be8-208">Haga clic en **Aceptar** para guardar la programación.</span><span class="sxs-lookup"><span data-stu-id="37be8-208">Click **OK** to save your schedule.</span></span>  
  
##  <a name="verify-data-refresh"></a><a name="drverify"></a><span data-ttu-id="37be8-209">Comprobar la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="37be8-209">Verify Data Refresh</span></span>  
 <span data-ttu-id="37be8-210">La mejor forma de comprobar la actualización de datos es ejecutarla inmediatamente y revisar la página del historial para ver si se completó de modo correcto.</span><span class="sxs-lookup"><span data-stu-id="37be8-210">The best way to verify data refresh is to execute data refresh right away and then review the history page to see whether it completed successfully.</span></span> <span data-ttu-id="37be8-211">Al activar la casilla **También actualizar lo más rápido posible** en la programación se comprobará que la actualización de datos está operativa.</span><span class="sxs-lookup"><span data-stu-id="37be8-211">Selecting the **Also refresh as soon as possible** checkbox on your schedule will provide the verification that data refresh is operational.</span></span>  
  
 <span data-ttu-id="37be8-212">Puede ver el registro actual y pasado de las operaciones de actualización de datos en la página Historial de actualización de datos para el libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-212">You can view the current and past record of data refresh operations in the Data Refresh History page for the workbook.</span></span> <span data-ttu-id="37be8-213">Esta página solo aparece si la actualización de datos se ha programado para un libro.</span><span class="sxs-lookup"><span data-stu-id="37be8-213">This page only appears if data refresh has been scheduled for a workbook.</span></span> <span data-ttu-id="37be8-214">Si no hay ninguna programación de actualización de datos, la página de definición de la programación aparece en su lugar.</span><span class="sxs-lookup"><span data-stu-id="37be8-214">If there is no data refresh schedule, the schedule definition page appears instead.</span></span>  
  
 <span data-ttu-id="37be8-215">Debe tener permisos para contribuir u otros superiores para ver el historial de la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-215">You must have Contribute permissions or greater to view data refresh history.</span></span>  
  
1.  <span data-ttu-id="37be8-216">En un sitio de SharePoint, abra la biblioteca que contiene un libro PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37be8-216">On a SharePoint site, open the library that contains a PowerPivot workbook.</span></span>  
  
     <span data-ttu-id="37be8-217">No hay ningún indicador visual que identifique qué libros en una biblioteca de SharePoint contienen datos PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="37be8-217">There is no visual indicator that identifies which workbooks in a SharePoint library contain PowerPivot data.</span></span> <span data-ttu-id="37be8-218">Debe saber de antemano qué libros contienen los datos PowerPivot actualizables.</span><span class="sxs-lookup"><span data-stu-id="37be8-218">You must know in advance which workbooks contain refreshable PowerPivot data.</span></span>  
  
2.  <span data-ttu-id="37be8-219">Seleccione el documento y, a continuación, haga clic en la flecha abajo que aparece a la derecha.</span><span class="sxs-lookup"><span data-stu-id="37be8-219">Select the document, and then click the down arrow that appears to the right.</span></span>  
  
3.  <span data-ttu-id="37be8-220">Seleccione **Administrar actualización de datos PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="37be8-220">Select **Manage PowerPivot Data Refresh**.</span></span>  
  
 <span data-ttu-id="37be8-221">Aparece la página del historial y muestra un registro completo de toda la actividad de actualización de los datos PowerPivot en el libro de Excel actual, incluido el estado de la operación de actualización de datos más reciente.</span><span class="sxs-lookup"><span data-stu-id="37be8-221">The history page appears, showing a complete record for all refresh activity for PowerPivot data in the current Excel workbook, including the status of the most recent data refresh operation.</span></span>  
  
 <span data-ttu-id="37be8-222">En algunos casos, podría ver que los tiempos de procesamiento reales difieren del tiempo que especificó.</span><span class="sxs-lookup"><span data-stu-id="37be8-222">In some cases, you might see actual processing times that differ from the time you specified.</span></span> <span data-ttu-id="37be8-223">Esto ocurrirá si hay mucha carga de procesamiento en el servidor.</span><span class="sxs-lookup"><span data-stu-id="37be8-223">This will occur if there is a heavy processing load on the server.</span></span> <span data-ttu-id="37be8-224">Con mucha carga, la instancia de servicio de [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] esperará a que se liberen suficientes recursos del sistema antes de comenzar una actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-224">Under heavy load, the [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] service instance will wait until enough system resources are free before it begins a data refresh.</span></span>  
  
 <span data-ttu-id="37be8-225">El libro se debe proteger en el momento en que la operación de actualización finalice.</span><span class="sxs-lookup"><span data-stu-id="37be8-225">The workbook must be checked in when the refresh operation is finished.</span></span> <span data-ttu-id="37be8-226">El libro se guardará con los datos actualizados en ese momento.</span><span class="sxs-lookup"><span data-stu-id="37be8-226">The workbook will be saved with the refreshed data at that time.</span></span> <span data-ttu-id="37be8-227">Si se desprotege el archivo, la actualización de datos se omite hasta el siguiente período programado.</span><span class="sxs-lookup"><span data-stu-id="37be8-227">If the file is checked out, data refresh is skipped until the next scheduled time.</span></span>  
  
 <span data-ttu-id="37be8-228">Si ve un mensaje de estado inesperado (por ejemplo, que informa acerca de un error o de la cancelación de la operación de actualización), puede investigar el problema comprobando los permisos y la disponibilidad del servidor.</span><span class="sxs-lookup"><span data-stu-id="37be8-228">If you see a status message that is unexpected (for example, a refresh operation failed or was cancelled), you can investigate the problem by checking permissions and server availability.</span></span>  
  
 <span data-ttu-id="37be8-229">Revise la página de solución de problemas de actualización de datos PowerPivot en el WIKI de TechNet de ayuda para resolver problemas de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="37be8-229">Review the PowerPivot data refresh troubleshooting page on the TechNet WIKI for help on resolving data refresh problems.</span></span> <span data-ttu-id="37be8-230">Para obtener más información vea [Solucionar problemas de la actualización de datos PowerPivot](https://go.microsoft.com/fwlink/?LinkId=251594).</span><span class="sxs-lookup"><span data-stu-id="37be8-230">For more information see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkId=251594).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="37be8-231">Los administradores de SharePoint pueden ayudarle a solucionar los problemas de la actualización de datos viendo los informes de la actualización de datos consolidados en el Panel de administración de PowerPivot en Administración central.</span><span class="sxs-lookup"><span data-stu-id="37be8-231">SharePoint administrators can help you troubleshoot data refresh problems by viewing the consolidated data refresh reports in the PowerPivot Management Dashboard in Central Administration.</span></span> <span data-ttu-id="37be8-232">Para obtener más información, vea [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="37be8-232">For more information, see [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37be8-233">Consulte también</span><span class="sxs-lookup"><span data-stu-id="37be8-233">See Also</span></span>  
 <span data-ttu-id="37be8-234">[Actualización de datos PowerPivot con SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="37be8-234">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="37be8-235">[Ver el historial de actualización de datos &#40;PowerPivot para SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="37be8-235">[View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="37be8-236">Configurar credenciales almacenadas para la actualización de datos PowerPivot &#40;PowerPivot para SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="37be8-236">Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;</span></span>](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
