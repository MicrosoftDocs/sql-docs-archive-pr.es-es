---
title: Actualizar libros y actualización de datos programada (SharePoint 2013) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: a49c4af4-e243-4926-be97-74da1f9d54eb
author: minewiskan
ms.author: owend
ms.openlocfilehash: 185fe0864bc4c1cdda9a63fa97a17319d65dc87d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87744915"
---
# <a name="upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013"></a><span data-ttu-id="e4649-102">Actualizar libros y actualización de datos programada (SharePoint 2013)</span><span class="sxs-lookup"><span data-stu-id="e4649-102">Upgrade Workbooks and Scheduled Data Refresh (SharePoint 2013)</span></span>
  <span data-ttu-id="e4649-103">En este tema se explica la experiencia de usuario de libros creados en entornos anteriores de PowerPivot y cómo actualizar los libros PowerPivot para poder aprovechar las nuevas características presentadas en esta versión.</span><span class="sxs-lookup"><span data-stu-id="e4649-103">This topic explains the user experience of workbooks created in previous PowerPivot environments and how to upgrade PowerPivot workbooks so that you can take advantage of new features introduced in this release.</span></span> <span data-ttu-id="e4649-104">Para obtener más información acerca de las nuevas características, vea [novedades de PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span><span class="sxs-lookup"><span data-stu-id="e4649-104">To learn more about new features, see [What's New in PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="e4649-105">No se puede revertir la actualización de los libros que se actualizan automáticamente en el servidor.</span><span class="sxs-lookup"><span data-stu-id="e4649-105">You cannot rollback upgrade for workbooks that are upgraded automatically on the server.</span></span> <span data-ttu-id="e4649-106">Una vez actualizado un libro, permanece actualizado.</span><span class="sxs-lookup"><span data-stu-id="e4649-106">Once a workbook is upgraded, it remains upgraded.</span></span> <span data-ttu-id="e4649-107">Para usar una versión anterior, puede volver a publicar el libro anterior en SharePoint, restaurar una versión anterior o reciclar el libro.</span><span class="sxs-lookup"><span data-stu-id="e4649-107">To use a previous version, you can republish the previous workbook to SharePoint, restore a previous version, or recycle the workbook.</span></span> <span data-ttu-id="e4649-108">Para obtener más información acerca de cómo restaurar o reciclar un documento en SharePoint, vea [Planear la protección de contenido mediante papeleras de reciclaje y control de versiones](https://go.microsoft.com/fwlink/?LinkId=238669).</span><span class="sxs-lookup"><span data-stu-id="e4649-108">For more information about restoring or recycling a document in SharePoint, see [Plan to protect content by using recycle bins and versioning](https://go.microsoft.com/fwlink/?LinkId=238669).</span></span>  
  
 <span data-ttu-id="e4649-109">Este tema contiene las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="e4649-109">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="e4649-110">Información general sobre la actualización de libros</span><span class="sxs-lookup"><span data-stu-id="e4649-110">Overview of Upgrading Workbooks</span></span>](#bkmk_overview)  
  
-   [<span data-ttu-id="e4649-111">Actualizar libros de SQL Server 2008 R2 a libros de SQL Server 2012 Service Pack 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="e4649-111">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>](#bkmk_to_2012sp1_from_2008r2)  
  
-   [<span data-ttu-id="e4649-112">Actualizar libros a Office 2013 desde versiones creadas con el complemento 2012 PowerPivot para Excel</span><span class="sxs-lookup"><span data-stu-id="e4649-112">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>](#bkmk_to_2012sp1_from_2012)  
  
-   [<span data-ttu-id="e4649-113">Actualizar a libros de SQL Server 2012 desde versiones creadas con el complemento 2008 R2 PowerPivot para Excel 2010</span><span class="sxs-lookup"><span data-stu-id="e4649-113">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>](#bkmk_to_2012_from_2008R2)  
  
-   [<span data-ttu-id="e4649-114">Ejecutar varias versiones de libro en un servidor más reciente</span><span class="sxs-lookup"><span data-stu-id="e4649-114">Running Multiple Workbook Versions on a Newer Server</span></span>](#bkmk_runold)  
  
##  <a name="overview-of-upgrading-workbooks"></a><a name="bkmk_overview"></a><span data-ttu-id="e4649-115">Información general sobre la actualización de libros</span><span class="sxs-lookup"><span data-stu-id="e4649-115">Overview of Upgrading Workbooks</span></span>  
 <span data-ttu-id="e4649-116">Un libro PowerPivot es un libro de Excel que contiene datos PowerPivot incrustados.</span><span class="sxs-lookup"><span data-stu-id="e4649-116">A PowerPivot workbook is an Excel workbook that contains embedded PowerPivot data.</span></span> <span data-ttu-id="e4649-117">Actualizar un libro tiene dos ventajas:</span><span class="sxs-lookup"><span data-stu-id="e4649-117">Upgrading a workbook has two benefits:</span></span>  
  
-   <span data-ttu-id="e4649-118">Usar las nuevas características de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4649-118">Use new features in [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span></span>  
  
-   <span data-ttu-id="e4649-119">Habilita la actualización de datos programada para los libros que se ejecutan con servidor de [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services en modo de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e4649-119">Enables scheduled data refresh for workbooks that run with a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services server in SharePoint mode.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e4649-120">No puede revertir un libro actualizado, por lo que debe asegurarse de realizar una copia del archivo si desea usarlo en la versión anterior de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)]o en una versión anterior de [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4649-120">You cannot rollback an upgraded workbook, so be sure to make a copy of the file if you want to use it in the previous version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], or on a previous version of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="e4649-121">En la tabla siguiente se muestran la compatibilidad y el comportamiento de los libros PowerPivot según el entorno en el que se creó el libro.</span><span class="sxs-lookup"><span data-stu-id="e4649-121">The following table lists the support and behavior of PowerPivot workbooks based on the environment  in which the workbook was created.</span></span> <span data-ttu-id="e4649-122">El comportamiento descrito incluye la experiencia general del usuario, las opciones de actualización admitidas para actualizar el libro al entorno concreto y el comportamiento de la actualización de datos programada de un libro que aún no se ha actualizado.</span><span class="sxs-lookup"><span data-stu-id="e4649-122">The behavior described includes the general user experience, the supported upgrade options to upgrade the workbook to the particular environment, and the behavior of scheduled data refresh of a workbook that has not yet been upgraded.</span></span>  
  
### <a name="workbook-behavior-and-upgrade-options"></a><span data-ttu-id="e4649-123">Comportamiento y opciones de actualización del libro</span><span class="sxs-lookup"><span data-stu-id="e4649-123">Workbook Behavior and Upgrade Options</span></span>  
  
|<span data-ttu-id="e4649-124">Creado en</span><span class="sxs-lookup"><span data-stu-id="e4649-124">Created In</span></span>|\<|<span data-ttu-id="e4649-125">Compatibilidad y comportamiento</span><span class="sxs-lookup"><span data-stu-id="e4649-125">Support and Behavior</span></span>|>|  
|----------------|--------|--------------------------|--------|  
||<span data-ttu-id="e4649-126">**PowerPivot para SharePoint 2010 de 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="e4649-126">**2008 R2 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="e4649-127">**PowerPivot para SharePoint 2010 de 2012**</span><span class="sxs-lookup"><span data-stu-id="e4649-127">**2012 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="e4649-128">**PowerPivot para SharePoint 2013 de 2012 SP1**</span><span class="sxs-lookup"><span data-stu-id="e4649-128">**2012 SP1 PowerPivot for SharePoint 2013**</span></span>|  
|<span data-ttu-id="e4649-129">**2008 R2 PowerPivot para Excel 2010**</span><span class="sxs-lookup"><span data-stu-id="e4649-129">**2008 R2 PowerPivot for Excel 2010**</span></span>|<span data-ttu-id="e4649-130">Todas las características</span><span class="sxs-lookup"><span data-stu-id="e4649-130">All Features</span></span>|<span data-ttu-id="e4649-131">**Experiencia** : los usuarios pueden interactuar con el libro en el explorador y usarlo como origen de datos para otras soluciones.</span><span class="sxs-lookup"><span data-stu-id="e4649-131">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="e4649-132">**Actualización** : los libros se actualizarán automáticamente en la biblioteca de documentos si la actualización automática está habilitada para el servicio del sistema PowerPivot en la granja de servidores de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e4649-132">**Upgrade:** Workbooks will auto upgrade in the document library if Auto Upgrade is enabled for the PowerPivot system Service in the SharePoint farm,</span></span><br /><br /> <span data-ttu-id="e4649-133">**Programar la actualización de datos** : NO se admite.</span><span class="sxs-lookup"><span data-stu-id="e4649-133">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="e4649-134">Es necesario actualizar el libro.</span><span class="sxs-lookup"><span data-stu-id="e4649-134">Workbook needs to be upgraded.</span></span>|<span data-ttu-id="e4649-135">**Experiencia** : los usuarios pueden interactuar con el libro y usarlo como origen de datos para otras soluciones.</span><span class="sxs-lookup"><span data-stu-id="e4649-135">**Experience:** Users can interact with the workbook and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="e4649-136">**Actualización** : la actualización automática no está disponible.</span><span class="sxs-lookup"><span data-stu-id="e4649-136">**Upgrade:** Auto upgrade is not available.</span></span> <span data-ttu-id="e4649-137">Los usuarios deben actualizar manualmente sus libros de 2008 R2 a la versión 2012 o a la versión de Office 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-137">Users must manually upgrade their 2008 R2 workbooks to the 2012 version or to the office 2013 version.</span></span><br /><br /> <span data-ttu-id="e4649-138">**Programar la actualización de datos** : NO se admite.</span><span class="sxs-lookup"><span data-stu-id="e4649-138">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="e4649-139">Es necesario actualizar el libro.</span><span class="sxs-lookup"><span data-stu-id="e4649-139">Workbook needs to be upgraded.</span></span>|  
|<span data-ttu-id="e4649-140">**2012 PowerPivot para Excel**</span><span class="sxs-lookup"><span data-stu-id="e4649-140">**2012 PowerPivot for Excel**</span></span>|<span data-ttu-id="e4649-141">No compatible</span><span class="sxs-lookup"><span data-stu-id="e4649-141">Not supported</span></span>|<span data-ttu-id="e4649-142">Todas las características</span><span class="sxs-lookup"><span data-stu-id="e4649-142">All Features</span></span>|<span data-ttu-id="e4649-143">**Experiencia** : los usuarios pueden interactuar con el libro en el explorador y usarlo como origen de datos para otras soluciones.</span><span class="sxs-lookup"><span data-stu-id="e4649-143">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span> <span data-ttu-id="e4649-144">La programación de la actualización de datos está disponible.</span><span class="sxs-lookup"><span data-stu-id="e4649-144">Schedule data refresh is available.</span></span><br /><br /> <span data-ttu-id="e4649-145">**Actualización** : la actualización automática no se admite.</span><span class="sxs-lookup"><span data-stu-id="e4649-145">**Upgrade:** Auto upgrade is not supported.</span></span> <span data-ttu-id="e4649-146">Los usuarios pueden actualizar manualmente sus libros a la versión de Office 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-146">Users can manually upgrade their workbooks to the Office 2013 version.</span></span><br /><br /> <span data-ttu-id="e4649-147">**Programar la actualización de datos** : se admite.</span><span class="sxs-lookup"><span data-stu-id="e4649-147">**Schedule data refresh:** supported.</span></span>|  
|<span data-ttu-id="e4649-148">**Excel 2013**</span><span class="sxs-lookup"><span data-stu-id="e4649-148">**Excel 2013**</span></span>|<span data-ttu-id="e4649-149">No compatible</span><span class="sxs-lookup"><span data-stu-id="e4649-149">Not supported</span></span>|<span data-ttu-id="e4649-150">No compatible</span><span class="sxs-lookup"><span data-stu-id="e4649-150">Not supported</span></span>|<span data-ttu-id="e4649-151">Todas las características</span><span class="sxs-lookup"><span data-stu-id="e4649-151">All Features</span></span>|  
  
##  <a name="upgrade-to-sql-server-2012-service-pack-1-sp1-workbooks-from-2008-r2-workbooks"></a><a name="bkmk_to_2012sp1_from_2008r2"></a><span data-ttu-id="e4649-152">Actualizar a SQL Server 2012 libros de Service Pack 1 (SP1) de libros de 2008 R2</span><span class="sxs-lookup"><span data-stu-id="e4649-152">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>  
 <span data-ttu-id="e4649-153">En esta sección se describe cómo actualizar libros de SQL Server 2008 R2 PowerPivot para Excel 2010 a libros de SQL Server 2012 SP1 PowerPivot para Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-153">This section describes upgrading to SQL Server 2012 SP1 PowerPivot for Excel 2013 workbooks from SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="e4649-154">**Cambio de comportamiento** : los libros de SQL Server 2008 R2 PowerPivot no se actualizarán automáticamente cuando se usen en SQL Server 2012 SP1 PowerPivot para SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-154">**Behavior Change:** SQL Server 2008 R2 PowerPivot workbooks will not be automatically upgraded  when they are used in SQL Server 2012 SP1 PowerPivot for SharePoint 2013.</span></span> <span data-ttu-id="e4649-155">Por tanto, las actualizaciones de datos programadas no funcionarán para los libros de SQL Server 2008 R2 PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-155">Therefore, scheduled data refreshes will not work for SQL Server 2008 R2 PowerPivot workbooks</span></span>  
  
 <span data-ttu-id="e4649-156">Los libros de SQL Server 2008 R2 se abrirán en PowerPivot para SharePoint 2013, pero las actualizaciones de datos programadas no funcionarán.</span><span class="sxs-lookup"><span data-stu-id="e4649-156">2008 R2 workbooks will open in PowerPivot for SharePoint 2013, however scheduled data refreshes will not work.</span></span> <span data-ttu-id="e4649-157">Si examina el historial de actualización verá un mensaje de error similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="e4649-157">If you review the refresh history you will see an error message similar to the following:</span></span>  
  
 <span data-ttu-id="e4649-158">"El libro contiene un modelo de PowerPivot no admitido.</span><span class="sxs-lookup"><span data-stu-id="e4649-158">"The workbook contains an unsupported PowerPivot model.</span></span> <span data-ttu-id="e4649-159">El modelo de PowerPivot del libro tiene el formato de SQL Server 2008 R2 PowerPivot para Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="e4649-159">The PowerPivot model in the workbook is in the SQL Server 2008 R2 PowerPivot for Excel 2010 format.</span></span> <span data-ttu-id="e4649-160">Los modelos de PowerPivot admitidos son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="e4649-160">Supported PowerPivot models are the following:</span></span>  
  
-   <span data-ttu-id="e4649-161">SQL Server 2012 PowerPivot para Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="e4649-161">SQL Server 2012 PowerPivot for Excel 2010.</span></span>  
  
-   <span data-ttu-id="e4649-162">SQL Server 2012 PowerPivot para Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-162">SQL Server 2012 PowerPivot for Excel 2013.</span></span>  
  
 <span data-ttu-id="e4649-163">**Cómo actualizar un libro** : la actualización de datos programada no funcionará hasta que actualice el libro a un libro de 2012.</span><span class="sxs-lookup"><span data-stu-id="e4649-163">**How to upgrade a workbook:** The Scheduled data refresh will not work until you upgrade the workbook to a 2012 workbook.</span></span> <span data-ttu-id="e4649-164">Para actualizar el libro y el modelo que contiene, complete una de las acciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="e4649-164">To upgrade the workbook and model it contains, complete one of the following:</span></span>  
  
-   <span data-ttu-id="e4649-165">Descargue y abra el libro en Microsoft Excel 2010 con el complemento SQL Server 2012 PowerPivot para Excel instalado.</span><span class="sxs-lookup"><span data-stu-id="e4649-165">Download and open the workbook in Microsoft Excel 2010 with the SQL Server 2012 PowerPivot for Excel add-in installed.</span></span>  
  
     <span data-ttu-id="e4649-166">Abra la ventana de PowerPivot y actualice el modelo de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-166">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="e4649-167">Después, guarde el libro y vuelva a publicarlo en SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e4649-167">Then save the workbook and republish it to SharePoint.</span></span>  
  
-   <span data-ttu-id="e4649-168">Descargue y abra el libro en Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-168">Download and open the workbook in Microsoft Excel 2013.</span></span>  
  
     <span data-ttu-id="e4649-169">Abra la ventana de PowerPivot y actualice el modelo de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-169">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="e4649-170">Después, guarde el libro y vuelva a publicarlo en el servidor de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e4649-170">Then save the workbook and republish it to the SharePoint server.</span></span>  
  
 <span data-ttu-id="e4649-171">Para obtener más información sobre los cambios en las características de Analysis Services, vea [cambios de comportamiento en Analysis Services características en SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)</span><span class="sxs-lookup"><span data-stu-id="e4649-171">For more information on Changes to Analysis Services features, see [Behavior Changes to Analysis Services Features in SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)</span></span>  
  
 <span data-ttu-id="e4649-172">Para obtener más información sobre el historial de actualización, vea [ver el historial de actualización de datos &#40;PowerPivot para SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="e4649-172">For more information on refresh history, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>  
  
##  <a name="upgrade-to-office-2013-workbooks-from-versions-created-by-using-the-2012-powerpivot-add-in-for-excel"></a><a name="bkmk_to_2012sp1_from_2012"></a><span data-ttu-id="e4649-173">Actualizar a libros de Office 2013 desde versiones creadas con 2012 el complemento de PowerPivot para Excel</span><span class="sxs-lookup"><span data-stu-id="e4649-173">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>  
 <span data-ttu-id="e4649-174">En esta sección se describe cómo actualizar libros **de** SQL Server 2012 PowerPivot para Excel 2010 **a** SQL Server 2012 SP1 PowerPivot para Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-174">This section describes Upgrading **to** SQL Server 2012 SP1 PowerPivot in Excel 2013 **from** SQL Server 2012 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="e4649-175">La actualización de un libro resuelve el siguiente error que aparece al intentar la actualización de datos programada en el libro de una versión anterior:</span><span class="sxs-lookup"><span data-stu-id="e4649-175">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="e4649-176">"La operación de actualización de los libros creados con la versión anterior de PowerPivot no está disponible".</span><span class="sxs-lookup"><span data-stu-id="e4649-176">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="e4649-177">**Cómo actualizar un libro**</span><span class="sxs-lookup"><span data-stu-id="e4649-177">**How to upgrade a workbook**</span></span>  
  
1.  <span data-ttu-id="e4649-178">Actualice cada libro manualmente abriéndolo en Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-178">Upgrade each workbook manually by opening it in Microsoft Excel 2013.</span></span>  
  
2.  <span data-ttu-id="e4649-179">Para actualizar el libro y el modelo que contiene, descargue y abra el libro en Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-179">To upgrade the workbook and model it contains, download and open the workbook in Microsoft Excel 2013.</span></span>  
  
3.  <span data-ttu-id="e4649-180">Abra la ventana de PowerPivot y actualice el modelo de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-180">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
4.  <span data-ttu-id="e4649-181">Después, guarde el libro y vuelva a publicarlo en el servidor de SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="e4649-181">Then save the workbook and republish it to the SharePoint 2013 server.</span></span>  
  
##  <a name="upgrade-to-sql-server-2012-workbooks-from-versions-created-by-using-the-2008-r2-powerpivot-add-in-for-excel-2010"></a><a name="bkmk_to_2012_from_2008R2"></a><span data-ttu-id="e4649-182">Actualización de los libros de SQL Server 2012 a partir de las versiones creadas con el complemento 2008 R2 PowerPivot para Excel 2010</span><span class="sxs-lookup"><span data-stu-id="e4649-182">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>  
 <span data-ttu-id="e4649-183">En esta sección se describe cómo actualizar libros **de** SQL Server 2008 R2 PowerPivot para Excel 2010 **a** libros de SQL Server 2012 PowerPivot para Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="e4649-183">This section describes Upgrading **to** SQL Server 2012 PowerPivot for Excel 2010 **from** SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="e4649-184">La actualización de un libro resuelve el siguiente error que aparece al intentar la actualización de datos programada en el libro de una versión anterior:</span><span class="sxs-lookup"><span data-stu-id="e4649-184">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="e4649-185">"La operación de actualización de los libros creados con la versión anterior de PowerPivot no está disponible".</span><span class="sxs-lookup"><span data-stu-id="e4649-185">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="e4649-186">**Cómo actualizar un libro**</span><span class="sxs-lookup"><span data-stu-id="e4649-186">**How to upgrade a workbook**</span></span>  
  
 <span data-ttu-id="e4649-187">Hay dos formas de realizar la actualización:</span><span class="sxs-lookup"><span data-stu-id="e4649-187">There are two ways to upgrade:</span></span>  
  
1.  <span data-ttu-id="e4649-188">Actualice cada libro manualmente; para ello, ábralo en Excel en un equipo que tenga la versión [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] de PowerPivot para Excel y, a continuación, vuelva a publicarlo en el servidor.</span><span class="sxs-lookup"><span data-stu-id="e4649-188">Upgrade each workbook manually by opening it in Excel on a computer that has the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of PowerPivot for Excel, and then republish it to the server.</span></span> <span data-ttu-id="e4649-189">Al abrir el libro en la versión más reciente del complemento, se producen las operaciones internas siguientes: el proveedor de datos en la cadena de conexión de datos del libro se actualiza a MSOLAP.5, se actualizan los metadatos y las relaciones se vuelven a crear para adecuarlas a una implementación más reciente.</span><span class="sxs-lookup"><span data-stu-id="e4649-189">When you open the workbook in the newer version of the add-in, the following internal operations occur: the data provider in the workbook data connection string is updated to MSOLAP.5, metadata is updated, and relationships are recreated to conform to a newer implementation.</span></span>  
  
2.  <span data-ttu-id="e4649-190">Como alternativa, un administrador de SharePoint puede permitir que la característica de actualización automática para el servicio del sistema PowerPivot de una granja de servidores de SharePoint actualice automáticamente un libro de [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot cuando se ejecute la actualización de datos programada (solo se actualizan los libros que están configurados para la actualización de datos programada).</span><span class="sxs-lookup"><span data-stu-id="e4649-190">Alternatively, a SharePoint Administrator  can enable the auto-upgrade feature for the PowerPivot System Service in a SharePoint farm to  automatically upgrade a [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot workbook when schedule data refresh runs (only workbooks that are configured for scheduled data refresh are upgraded).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e4649-191">La actualización automática es una característica de configuración del servidor; no puede habilitarla o deshabilitarla para libros, bibliotecas o colecciones de sitios concretos.</span><span class="sxs-lookup"><span data-stu-id="e4649-191">Automatic upgrade is a server configuration feature; you cannot enable or disable it for specific workbooks, libraries, or site collections.</span></span>  
  
 <span data-ttu-id="e4649-192">**Cómo configurar la actualización automática durante la actualización de datos**</span><span class="sxs-lookup"><span data-stu-id="e4649-192">**How to configure automatic upgrade during data refresh**</span></span>  
  
 <span data-ttu-id="e4649-193">Para usar la actualización automática, debe activar la casilla **Actualizar automáticamente los libros PowerPivot para habilitar la actualización de datos desde el servidor** en la herramienta de configuración de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-193">To use automatic upgrade, you must select the **Automatically upgrade PowerPivot workbooks to enable data refresh from the server** checkbox in the PowerPivot Configuration Tool.</span></span> <span data-ttu-id="e4649-194">En la herramienta, la casilla está en la página **Actualizar el servicio de sistema de PowerPivot** y en la página **Crear una aplicación de servicio PowerPivot** si se configura una nueva instalación.</span><span class="sxs-lookup"><span data-stu-id="e4649-194">Within the tool, the checkbox is on the **Upgrade PowerPivot System Service** page, and on the **Create PowerPivot Service Application** page if you are configuring a new installation.</span></span>  
  
 <span data-ttu-id="e4649-195">Puede ejecutar el cmdlet siguiente para comprobar si la actualización automática está habilitada:</span><span class="sxs-lookup"><span data-stu-id="e4649-195">You can run the following cmdlet to verify whether automatic upgrade is enabled:</span></span>  
  
```  
PS C:\Windows\system32> Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="e4649-196">La salida de Get-PowerPivotSystemService es una lista de propiedades y valores correspondientes.</span><span class="sxs-lookup"><span data-stu-id="e4649-196">The output from Get-PowerPivotSystemService is a list of properties and corresponding values.</span></span> <span data-ttu-id="e4649-197">Debería aparecer `WorkbookUpgradeOnDataRefresh` en la lista de propiedades.</span><span class="sxs-lookup"><span data-stu-id="e4649-197">You should see `WorkbookUpgradeOnDataRefresh` in the property list.</span></span> <span data-ttu-id="e4649-198">Se establecerá en **true** si la actualización automática está habilitada.</span><span class="sxs-lookup"><span data-stu-id="e4649-198">It will be set to **true** if automatic upgrade is enabled.</span></span> <span data-ttu-id="e4649-199">Si es **false**, continúe en el paso siguiente, habilitar la actualización automática del libro.</span><span class="sxs-lookup"><span data-stu-id="e4649-199">If it is **false**, continue to the next step, enabling automatic workbook upgrade.</span></span>  
  
 <span data-ttu-id="e4649-200">Para habilitar la actualización automática del libro, ejecute el comando siguiente:</span><span class="sxs-lookup"><span data-stu-id="e4649-200">To enable automatic workbook upgrade, run the following command:</span></span>  
  
```  
PS C:\Windows\system32> Set-PowerPivotSystemService -WorkbookUpgradeOnDataRefresh:$true -Confirm:$false  
```  
  
 <span data-ttu-id="e4649-201">Después de actualizar el libro, puede usar la actualización de datos programada y las nuevas características del complemento PowerPivot para Excel.</span><span class="sxs-lookup"><span data-stu-id="e4649-201">After you upgrade the workbook, you can use scheduled data refresh and new features in the PowerPivot for Excel add-in.</span></span>  
  
##  <a name="running-multiple-workbook-versions-on-a-newer-server"></a><a name="bkmk_runold"></a> <span data-ttu-id="e4649-202">Ejecutar varias versiones de un libro en un servidor más reciente</span><span class="sxs-lookup"><span data-stu-id="e4649-202">Running Multiple Workbook Versions on a Newer Server</span></span>  
 <span data-ttu-id="e4649-203">Puede ejecutar versiones anteriores y recientes de los libros PowerPivot en paralelo en una instancia de [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] de [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4649-203">You can run older and newer versions of PowerPivot workbooks side by side on a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] instance of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="e4649-204">Según cómo haya instalado el servidor, **es posible que necesite** instalar una versión anterior del proveedor OLE DB de Analysis Services para poder obtener acceso a libros anteriores y recientes en el mismo servidor.</span><span class="sxs-lookup"><span data-stu-id="e4649-204">Depending on how you installed the server, **you might need** to install a previous version of the Analysis Services OLE DB provider before you can access older and newer workbooks on the same server.</span></span>  
  
 <span data-ttu-id="e4649-205">Tenga en cuenta que no se admite la publicación de libros de una versión más reciente en instancias anteriores de SQL Server de [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e4649-205">Note that Publishing newer version workbooks on previous SQL Server instances of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] is not supported.</span></span> <span data-ttu-id="e4649-206">Una instancia de [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] no cargará un libro creado en la versión de [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)]y una instancia de SQL Server 2012 no cargará libros de Office 2013 con modelos de datos avanzados que se hayan creado con la versión de [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] de PowerPivot en Excel.</span><span class="sxs-lookup"><span data-stu-id="e4649-206">A [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] instance will not load a workbook that you created in the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], and a SQL Server 2012 instance will not load Office 2013 workbooks with advanced data models that you created using the [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] version of PowerPivot in Excel.</span></span>  
  
###  <a name="how-to-check-for-msolap-data-provider-information-in-a-powerpivot-workbook"></a><a name="bkmk_msolapxslx"></a><span data-ttu-id="e4649-207">Cómo comprobar la información del proveedor de datos MSOLAP en un libro PowerPivot</span><span class="sxs-lookup"><span data-stu-id="e4649-207">How to Check for MSOLAP Data Provider Information in a PowerPivot Workbook</span></span>  
 <span data-ttu-id="e4649-208">Siga estas indicaciones para comprobar qué proveedor OLE DB se utiliza en un libro PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-208">Use the following instructions to check which OLE DB provider is used in a PowerPivot workbook.</span></span> <span data-ttu-id="e4649-209">La comprobación de la información de conexión de datos no requiere que se instale el complemento de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e4649-209">Checking the data connection information does not require the [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] add-in to be installed.</span></span>  
  
1.  <span data-ttu-id="e4649-210">En Excel, en la pestaña Datos, haga clic en **Conexiones**.</span><span class="sxs-lookup"><span data-stu-id="e4649-210">In Excel, on the Data tab, click **Connections**.</span></span> <span data-ttu-id="e4649-211">Haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="e4649-211">Click **Properties**.</span></span>  
  
2.  <span data-ttu-id="e4649-212">En la pestaña **Definición** , la versión del proveedor aparece al principio de la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="e4649-212">On the **Definition** tab, the provider version appears at the beginning of the connection string.</span></span>  
  
     <span data-ttu-id="e4649-213">**Provider=MSOLAP.5** indica que el libro es [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4649-213">**Provider=MSOLAP.5** indicates the workbook is [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
     <span data-ttu-id="e4649-214">**Provider=MSOLAP.4** indica [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4649-214">**Provider=MSOLAP.4** indicates [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span>  
  
     <span data-ttu-id="e4649-215">**Data Source=$Embedded$** indica que es un libro PowerPivot, con una base de datos incrustada.</span><span class="sxs-lookup"><span data-stu-id="e4649-215">**Data Source=$Embedded$** indicates that the workbook is a PowerPivot workbook, using an embedded database.</span></span>  
  
###  <a name="how-to-check-for-the-current-version-of-the-msolap-data-provider-on-a-local-computer"></a><a name="bkmk_msolappc"></a> <span data-ttu-id="e4649-216">Comprobar la versión actual del proveedor de datos MSOLAP en un equipo local</span><span class="sxs-lookup"><span data-stu-id="e4649-216">How to Check for the Current Version of the MSOLAP Data Provider on a Local Computer</span></span>  
 <span data-ttu-id="e4649-217">Utilice las siguientes instrucciones para comprobar qué proveedor OLE DB es la versión actual en el servidor o la estación de trabajo que ejecuta los libros PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="e4649-217">Use the following instructions to check which OLE DB provider is the current version on the server or workstation that runs PowerPivot workbooks.</span></span> <span data-ttu-id="e4649-218">Conocer la versión actual puede ayudarle a solucionar errores de conexión de los datos después de actualizar.</span><span class="sxs-lookup"><span data-stu-id="e4649-218">Knowing the current version can help you troubleshoot data connection errors after upgrading.</span></span>  
  
1.  <span data-ttu-id="e4649-219">En el Editor del Registro, vaya a HKEY_CLASSES_ROOT</span><span class="sxs-lookup"><span data-stu-id="e4649-219">In the Registry Editor, go to HKEY_CLASSES_ROOT</span></span>  
  
2.  <span data-ttu-id="e4649-220">Desplácese hasta MSOLAP.</span><span class="sxs-lookup"><span data-stu-id="e4649-220">Scroll down to MSOLAP.</span></span> <span data-ttu-id="e4649-221">Compruebe que MSOLAP.5 aparece entre los proveedores OLAP instalados en el sistema.</span><span class="sxs-lookup"><span data-stu-id="e4649-221">Verify that MSOLAP.5 is listed among the OLAP providers installed on the system.</span></span> <span data-ttu-id="e4649-222">Compruebe que MSOLAP | CurVer está establecido en MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="e4649-222">Verify that MSOLAP | CurVer is set to MSOLAP.5</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e4649-223">Consulte también</span><span class="sxs-lookup"><span data-stu-id="e4649-223">See Also</span></span>  
 <span data-ttu-id="e4649-224">[Migrar PowerPivot a SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="e4649-224">[Migrate PowerPivot to SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span></span>  
 <span data-ttu-id="e4649-225">[PowerPivot para SharePoint de actualización](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="e4649-225">[Upgrade PowerPivot for SharePoint](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span></span>  
 <span data-ttu-id="e4649-226">[Novedades de Analysis Services y Business Intelligence](../../what-s-new-in-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="e4649-226">[What's New in Analysis Services and Business Intelligence](../../what-s-new-in-analysis-services.md) </span></span>  
 [<span data-ttu-id="e4649-227">Ver el historial de actualización de datos &#40;PowerPivot para SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="e4649-227">View Data Refresh History &#40;PowerPivot for SharePoint&#41;</span></span>](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)  
  
  
