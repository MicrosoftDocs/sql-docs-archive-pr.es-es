---
title: Configurar credenciales almacenadas para la actualización de datos PowerPivot (PowerPivot para SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 987eff0f-bcfe-4bbd-81e0-9aca993a2a75
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a1350c5d776891397401e9d3127b7849281b106
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87670032"
---
# <a name="configure-stored-credentials-for-powerpivot-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="bc491-102">Configurar las credenciales almacenadas para la actualización de datos PowerPivot (PowerPivot para SharePoint)</span><span class="sxs-lookup"><span data-stu-id="bc491-102">Configure Stored Credentials for PowerPivot Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="bc491-103">Los trabajos de actualización de datos PowerPivot se pueden ejecutar en cualquier cuenta de usuario de Windows, siempre que cree una aplicación de destino en el Servicio de almacenamiento seguro para almacenar las credenciales que desea utilizar.</span><span class="sxs-lookup"><span data-stu-id="bc491-103">PowerPivot data refresh jobs can run under any Windows user account as long as you create a target application in Secure Store Service to store the credentials you want to use.</span></span> <span data-ttu-id="bc491-104">De igual forma, si desea proporcionar un inicio de sesión de base de datos que no sea el utilizado originalmente para importar los datos en PowerPivot para Excel, puede asignar esas credenciales a una aplicación de destino del Servicio de almacenamiento seguro y, a continuación, especificar esa aplicación de destino en una programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-104">Similarly, if you want to provide a database login that varies from the one used to originally import the data in PowerPivot for Excel, you can map those credentials to a Secure Store Service target application, and then specify that target application in a data refresh schedule.</span></span>  
  
 <span data-ttu-id="bc491-105">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="bc491-105">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="bc491-106">Después de seguir las instrucciones incluidas en este tema, podrá utilizar la siguiente opción de credenciales en la página de programación de actualización de datos PowerPivot:</span><span class="sxs-lookup"><span data-stu-id="bc491-106">After you follow the instructions in this topic, you will be able to use the following credentials option in the PowerPivot data refresh schedule page:</span></span>  
  
 <span data-ttu-id="bc491-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span><span class="sxs-lookup"><span data-stu-id="bc491-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span></span>  
  
 <span data-ttu-id="bc491-108">En este tema se explica cómo configurar los nombres de usuario y las contraseñas que se utilizan para la actualización de datos PowerPivot en una granja de SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="bc491-108">This topic explains how to set up the user names and passwords that are used for PowerPivot data refresh in a SharePoint 2010 farm.</span></span> <span data-ttu-id="bc491-109">Antes de realizar estos pasos, debe de haber habilitado el Servicio de almacenamiento seguro y haber generado una clave maestra.</span><span class="sxs-lookup"><span data-stu-id="bc491-109">Before you can use these steps, you must have enabled Secure Store Service and generated a master key.</span></span> <span data-ttu-id="bc491-110">Para obtener más información, vea [actualización de datos PowerPivot con SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span><span class="sxs-lookup"><span data-stu-id="bc491-110">For more information, see [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span></span>  
  
 <span data-ttu-id="bc491-111">Este tema contiene las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="bc491-111">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="bc491-112">Configurar una cuenta de Windows para la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="bc491-112">Configure any Windows account for data refresh</span></span>](#configAny)  
  
 [<span data-ttu-id="bc491-113">Configurar una cuenta predefinida para tener acceso a orígenes de datos externos o de otros proveedores</span><span class="sxs-lookup"><span data-stu-id="bc491-113">Configure a predefined account for accessing external or third-party data sources</span></span>](#config3rd)  
  
 <span data-ttu-id="bc491-114">Si tiene problemas para configurar o usar la actualización de datos, consulte la página de solución de problemas de la [actualización de datos PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) en el sitio wiki de TechNet para ver posibles soluciones.</span><span class="sxs-lookup"><span data-stu-id="bc491-114">If you have problems configuring or using data refresh, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>  
  
##  <a name="configure-any-windows-account-for-data-refresh"></a><a name="configAny"></a><span data-ttu-id="bc491-115">Configurar cualquier cuenta de Windows para la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="bc491-115">Configure any Windows account for data refresh</span></span>  
 <span data-ttu-id="bc491-116">Cuando un usuario de SharePoint define una programación de actualización de datos, debe especificar la identidad del usuario bajo la que se realiza la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-116">When a SharePoint user defines a data refresh schedule, he or she must specify the user identity under which data refresh is performed.</span></span> <span data-ttu-id="bc491-117">Para hacerlo, puede seleccionar la cuenta de actualización de datos desatendida de PowerPivot, escribir su cuenta de usuario de dominio de Windows, o escribir otra cuenta de usuario de Windows que sea válida con fines de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-117">Options include selecting the PowerPivot unattended data refresh account, entering his or her Windows domain user account, or entering some other Windows user account that is valid for data refresh purposes.</span></span> <span data-ttu-id="bc491-118">Los pasos descritos en esta sección son para realizar la última opción: especificar otra cuenta de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc491-118">The steps in this section are for the last option: specifying some other Windows account.</span></span>  
  
 <span data-ttu-id="bc491-119">Puede elegir este método si desea una alternativa al uso de la cuenta de actualización de datos desatendida de PowerPivot (disponible para todos los usuarios de PowerPivot en SharePoint) o de las credenciales del propietario del libro.</span><span class="sxs-lookup"><span data-stu-id="bc491-119">You might choose this approach if you want an alternative to using the PowerPivot unattended data refresh account (available to all PowerPivot users on SharePoint) or the credentials of the workbook owner.</span></span> <span data-ttu-id="bc491-120">Por ejemplo, podría interesarle poner varias cuentas de actualización de datos a disposición de distintos grupos de trabajo, de forma que le sea más fácil realizar el seguimiento y administrar la actividad de actualización de datos en el nivel de la organización.</span><span class="sxs-lookup"><span data-stu-id="bc491-120">For example, you might want to make a series of data refresh accounts available to different workgroups to help you track and manage data refresh activity at the organizational level.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="bc491-121">Las personas y aplicaciones que utilizan esta aplicación de destino (y las credenciales que almacena) deben aparecer como miembros de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc491-121">People and applications that use this target application (and the credentials that it stores) must be listed as members of the application.</span></span> <span data-ttu-id="bc491-122">Debe agregar la identidad de cada aplicación de servicio PowerPivot que utilizará la aplicación de destino, su cuenta de Windows y las cuentas de usuario o de grupo de las personas que vayan a especificar esta aplicación de destino en sus programaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-122">You must add the identity of each PowerPivot service application that will use the target application, your Windows account, and the group or user accounts of people who will be specifying this target application in their data refresh schedules.</span></span> <span data-ttu-id="bc491-123">Puede especificar todas estas cuentas al crear la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-123">You can specify all of these accounts when you create the target application.</span></span> <span data-ttu-id="bc491-124">Si no sabe todas las cuentas de usuario y de grupo que requerirán acceso a esta aplicación, puede agregarlas posteriormente una vez creada la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-124">If you do not know all of the user and group accounts that will require access to this application, you can add them later after the target application is created.</span></span>  
  
 <span data-ttu-id="bc491-125">Hay 4 pasos para configurar credenciales almacenadas para la actualización de datos:</span><span class="sxs-lookup"><span data-stu-id="bc491-125">There are 4 parts to configuring stored credentials for data refresh:</span></span>  
  
-   <span data-ttu-id="bc491-126">Cree la aplicación de destino que almacena las credenciales.</span><span class="sxs-lookup"><span data-stu-id="bc491-126">Create the target application that stores the credentials.</span></span>  
  
-   <span data-ttu-id="bc491-127">Conceda permisos de contribución a la cuenta.</span><span class="sxs-lookup"><span data-stu-id="bc491-127">Grant Contribute permissions to the account.</span></span>  
  
-   <span data-ttu-id="bc491-128">Conceda permisos de lectura a la cuenta para tener acceso a los orígenes de datos externos durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-128">Grant the account read permissions to access external data sources during data refresh.</span></span>  
  
-   <span data-ttu-id="bc491-129">Compruebe que la actualización de datos funciona al especificar esta aplicación de destino en una programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-129">Verify that data refresh works when you specify this target application in a data refresh schedule.</span></span>  
  
### <a name="step-1-create-a-target-application"></a><span data-ttu-id="bc491-130">Paso 1: crear un identificador de la aplicación de destino</span><span class="sxs-lookup"><span data-stu-id="bc491-130">Step 1: Create a target application</span></span>  
  
1.  <span data-ttu-id="bc491-131">En Administración central, en Administración de aplicaciones, haga clic en **Administrar aplicaciones de servicio**.</span><span class="sxs-lookup"><span data-stu-id="bc491-131">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="bc491-132">Haga clic en **servicio de almacenamiento seguro**.</span><span class="sxs-lookup"><span data-stu-id="bc491-132">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="bc491-133">En administrar aplicaciones de destino, haga clic en **nuevo**.</span><span class="sxs-lookup"><span data-stu-id="bc491-133">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="bc491-134">Como identificador de la aplicación de destino, escriba una cadena de texto.</span><span class="sxs-lookup"><span data-stu-id="bc491-134">In Target application ID, type a text string.</span></span> <span data-ttu-id="bc491-135">La cadena debe ser única, pero también debería ser fácil de recordar.</span><span class="sxs-lookup"><span data-stu-id="bc491-135">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="bc491-136">Los usuarios escribirán esta cadena en las páginas de la programación de actualización de datos cada vez que deseen utilizar las credenciales que están almacenadas en esta aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc491-136">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="bc491-137">En Nombre para mostrar, escriba un nombre descriptivo.</span><span class="sxs-lookup"><span data-stu-id="bc491-137">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="bc491-138">Este nombre solo se utiliza para la presentación.</span><span class="sxs-lookup"><span data-stu-id="bc491-138">This name is used for display purposes only.</span></span> <span data-ttu-id="bc491-139">No se usa para especificar la aplicación de destino en una programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-139">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="bc491-140">En Correo electrónico de contacto, escriba su dirección de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="bc491-140">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="bc491-141">En tipo de aplicación de destino, seleccione **Grupo**.</span><span class="sxs-lookup"><span data-stu-id="bc491-141">In Target Application Type, select **Group**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="bc491-142">Es necesario elegir el tipo de cuenta Grupo, porque permite especificar todas las cuentas de servicio y usuario solicitando acceso a las credenciales.</span><span class="sxs-lookup"><span data-stu-id="bc491-142">Choosing a Group account type is necessary because it allows you to specify all of the user and service accounts requesting access to the credentials.</span></span> <span data-ttu-id="bc491-143">Para cada solicitud, el Servicio de sistema de PowerPivot comprueba si el solicitante es un miembro de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-143">For each request, PowerPivot System Service verifies whether the requestor is a member of the target application.</span></span>  
  
8.  <span data-ttu-id="bc491-144">Omita la dirección URL de la página de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-144">Skip Target Application Page URL.</span></span> <span data-ttu-id="bc491-145">La actualización de datos PowerPivot no la utiliza.</span><span class="sxs-lookup"><span data-stu-id="bc491-145">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="bc491-146">Haga clic en **Next**.</span><span class="sxs-lookup"><span data-stu-id="bc491-146">Click **Next**.</span></span>  
  
10. <span data-ttu-id="bc491-147">En la página **especificar los campos de credenciales para la aplicación de destino de almacenamiento seguro** , acepte los valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="bc491-147">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values.</span></span> <span data-ttu-id="bc491-148">Los nombres de campo y los tipos deben ser el nombre de usuario de Windows y la contraseña de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc491-148">Field names and types should be Windows User Name and Windows Password.</span></span>  
  
11. <span data-ttu-id="bc491-149">Haga clic en Siguiente.</span><span class="sxs-lookup"><span data-stu-id="bc491-149">Click Next.</span></span>  
  
12. <span data-ttu-id="bc491-150">En Administradores de la aplicación de destino, especifique las cuentas de usuario de dominio de Windows de los usuarios de SharePoint que deberían tener acceso administrativo a las configuraciones de la aplicación de destino (por ejemplo, la capacidad de agregar o quitar cuentas en la lista Miembros).</span><span class="sxs-lookup"><span data-stu-id="bc491-150">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to target application settings (for example, the ability to add or remove accounts from the Members list).</span></span>  
  
13. <span data-ttu-id="bc491-151">En Miembros, agregue las siguientes cuentas de usuario y de grupo:</span><span class="sxs-lookup"><span data-stu-id="bc491-151">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="bc491-152">Dado que crea la aplicación, agregue su cuenta de usuario de Windows a la lista Miembros.</span><span class="sxs-lookup"><span data-stu-id="bc491-152">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="bc491-153">Agregue la identidad del grupo de aplicaciones de la aplicación de servicio PowerPivot para que pueda recuperar las credenciales cuando la actualización de datos se programe para ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="bc491-153">Add the application pool identity of the PowerPivot service application so that it can retrieve the credentials when data refresh is scheduled to run.</span></span> <span data-ttu-id="bc491-154">Para ver la identidad del grupo de aplicaciones, vaya a **Administrar aplicaciones de servicio**, seleccione la aplicación de servicio PowerPivot haciendo clic en el espacio vacío situado junto al nombre (Esto selecciona la fila) y, a continuación, haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="bc491-154">To view the application pool identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="bc491-155">La cuenta de seguridad que aparece en esta página es la cuenta que desea agregar como miembro de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-155">The security account that appears on this page is the account to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="bc491-156">Agregue cuentas de usuario y grupo de Windows que vayan a tener acceso a esta aplicación de destino en las programaciones de la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-156">Add Windows user and group accounts that will be entering this target application in data refresh schedules.</span></span>  
  
14. <span data-ttu-id="bc491-157">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="bc491-157">Click **OK**.</span></span>  
  
15. <span data-ttu-id="bc491-158">Seleccione la aplicación de destino que acaba de crear, haga clic en la flecha abajo y seleccione **establecer credenciales.**</span><span class="sxs-lookup"><span data-stu-id="bc491-158">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="bc491-159">En Propietario de la Credencial, observe que la lista de propietarios de credenciales es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="bc491-159">In Credential Owner, notice that the list of credential owners is read-only.</span></span> <span data-ttu-id="bc491-160">Las cuentas que tienen propiedad sobre las credenciales son los miembros de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-160">The accounts who have ownership over the credentials are the members of the target application.</span></span> <span data-ttu-id="bc491-161">Para agregar o quitar un propietario de credencial, debe agregar o quitar cuentas en la lista de miembros de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-161">To add or remove a credential owner, you must add or remove accounts from the target application members list.</span></span>  
  
     <span data-ttu-id="bc491-162">En Nombre de usuario de Windows y Contraseña de Windows, escriba las credenciales de la cuenta de usuario de Windows que se utilizará para ejecutar la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-162">In Windows User Name and Windows Password, type credentials of Windows user account that will be used to run data refresh.</span></span>  
  
17. <span data-ttu-id="bc491-163">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="bc491-163">Click **OK**.</span></span>  
  
###  <a name="step-2-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a><span data-ttu-id="bc491-164">Paso 2: conceder permisos de contribución a la cuenta</span><span class="sxs-lookup"><span data-stu-id="bc491-164">Step 2: Grant Contribute permissions to the account</span></span>  
 <span data-ttu-id="bc491-165">Para poder utilizar las credenciales almacenadas, la cuenta debe tener asignados permisos de contribución en cualquier libro PowerPivot para el que se use.</span><span class="sxs-lookup"><span data-stu-id="bc491-165">Before you can use the stored credentials, the account must be assigned Contribute permissions on any PowerPivot workbook for which it is used.</span></span> <span data-ttu-id="bc491-166">Este nivel de permisos es necesario para abrir el libro desde una biblioteca y, a continuación, volver a guardarlo en la biblioteca antes de que se actualicen los datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-166">This permission level is necessary to open the workbook from a library and then save it back to the library after the data is refreshed.</span></span>  
  
 <span data-ttu-id="bc491-167">La asignación de permisos es un paso que lo realiza el administrador de la colección de sitios.</span><span class="sxs-lookup"><span data-stu-id="bc491-167">Assigning permissions is a step that is performed by the site collection administrator.</span></span> <span data-ttu-id="bc491-168">Los permisos de SharePoint se pueden asignar en la colección de sitios raíz o en cualquier nivel inferior a este, incluidos documentos y elementos individuales.</span><span class="sxs-lookup"><span data-stu-id="bc491-168">SharePoint permissions can be assigned at the root site collection or at any level below that, including on individual documents and items.</span></span> <span data-ttu-id="bc491-169">La forma en la que establezca los permisos variará en función de la pormenorización que necesite.</span><span class="sxs-lookup"><span data-stu-id="bc491-169">How you set permissions will vary depending on how granular you need them to be.</span></span> <span data-ttu-id="bc491-170">En los siguientes pasos se muestra un enfoque para conceder permisos.</span><span class="sxs-lookup"><span data-stu-id="bc491-170">The following steps show you one approach for granting permissions.</span></span>  
  
1.  <span data-ttu-id="bc491-171">En un sitio de SharePoint, en acciones del sitio, haga clic en **permisos del sitio**.</span><span class="sxs-lookup"><span data-stu-id="bc491-171">On a SharePoint site, in Site Actions, click **Site Permissions**.</span></span>  
  
2.  <span data-ttu-id="bc491-172">Haga clic en **Concesión de permisos**.</span><span class="sxs-lookup"><span data-stu-id="bc491-172">Click **Grant Permissions**.</span></span>  
  
3.  <span data-ttu-id="bc491-173">En Seleccionar usuarios, escriba el nombre de la cuenta de usuario de dominio de Windows que especificó en la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-173">In Select users, type the name of the Windows domain user account that you specified in the target application.</span></span>  
  
4.  <span data-ttu-id="bc491-174">En conceder permisos, seleccione **conceder permiso a los usuarios directamente**.</span><span class="sxs-lookup"><span data-stu-id="bc491-174">In Grant Permissions, select **Grant users permission directly**.</span></span>  
  
5.  <span data-ttu-id="bc491-175">Seleccione **contribuir**y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="bc491-175">Select **Contribute**, and then click **OK**.</span></span>  
  
###  <a name="step-3-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a><span data-ttu-id="bc491-176">Paso 3: conceder permisos de lectura para tener acceso a los orígenes de datos externos utilizados en la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="bc491-176">Step 3: Grant read permissions to access external data sources used in data refresh</span></span>  
 <span data-ttu-id="bc491-177">Al importar datos a un libro PowerPivot, las conexiones con datos externos se suelen basar en conexiones de confianza o en conexiones suplantadas que utilizan la identidad del usuario actual para conectarse al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-177">When importing data into a PowerPivot workbook, connections to external data are often based on trusted connections or impersonated connections that use the identity of the current user to connect to the data source.</span></span> <span data-ttu-id="bc491-178">Estos tipos de conexiones solo funcionan cuando el usuario actual tiene permiso para leer los datos que va a importar.</span><span class="sxs-lookup"><span data-stu-id="bc491-178">These types of connections work only when the current user has permission to read the data that he or she is importing.</span></span>  
  
 <span data-ttu-id="bc491-179">En un escenario de actualización de datos, la misma cadena de conexión que se usó para importar los datos se reutiliza ahora para actualizarlos.</span><span class="sxs-lookup"><span data-stu-id="bc491-179">In a data refresh scenario, the same connection string that was used to import data is now reused to refresh the data.</span></span> <span data-ttu-id="bc491-180">Si la cadena de conexión supone que el usuario es el actual (por ejemplo, una cadena que incluye Integrated_Security=SSPI), el Servicio de sistema de PowerPivot pasará la identidad del usuario especificado en la aplicación de destino como usuario actual.</span><span class="sxs-lookup"><span data-stu-id="bc491-180">If the connection string assumes the current user (for example, a string that includes Integrated_Security=SSPI), then the PowerPivot System Service will pass the user identity specified in the target application as the current user.</span></span> <span data-ttu-id="bc491-181">Esta conexión solo tendrá éxito si la cuenta dispone de permisos de lectura en el origen de datos externo.</span><span class="sxs-lookup"><span data-stu-id="bc491-181">This connection will only succeed if the account has read permissions on the external data source.</span></span>  
  
 <span data-ttu-id="bc491-182">Por esta razón, debe conceder los permisos de solo lectura a la cuenta en todos los orígenes de datos externos que se utilicen durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-182">For this reason, you must grant the account read-only permissions on all of the external data sources that are used during data refresh.</span></span>  
  
 <span data-ttu-id="bc491-183">Si es administrador de los orígenes de datos que se usan en su organización, puede crear un inicio de sesión y asignar los permisos necesarios.</span><span class="sxs-lookup"><span data-stu-id="bc491-183">If you are an administrator of the data sources used in your organization, you can create a login and assign the necessary permissions.</span></span> <span data-ttu-id="bc491-184">De lo contrario, debe ponerse en contacto con los propietarios de los datos y proporcionarles la información de las cuentas.</span><span class="sxs-lookup"><span data-stu-id="bc491-184">Otherwise, you must contact the data owners and provide the account information.</span></span> <span data-ttu-id="bc491-185">Asegúrese de especificar la cuenta de usuario de dominio de Windows que se asigne a la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-185">Be sure to specify the Windows domain user account that maps to the target application.</span></span> <span data-ttu-id="bc491-186">Esta es la cuenta que especificó en "paso 1: crear una aplicación de destino" en este tema.</span><span class="sxs-lookup"><span data-stu-id="bc491-186">This is the account you specified in "Step 1: Create a target application" in this topic.</span></span>  
  
###  <a name="step-4-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a><span data-ttu-id="bc491-187">Paso 4: comprobar la disponibilidad de la cuenta en las páginas de configuración de actualización de datos</span><span class="sxs-lookup"><span data-stu-id="bc491-187">Step 4: Verify account availability in data refresh configuration pages</span></span>  
  
1.  <span data-ttu-id="bc491-188">Abra una página de configuración de la actualización de datos para un libro publicado que contenga los datos PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="bc491-188">Open a data refresh configuration page for a published workbook that contains PowerPivot data.</span></span> <span data-ttu-id="bc491-189">Para obtener instrucciones sobre cómo abrir la página, vea [programar una actualización de datos &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="bc491-189">For instructions on how to open the page, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="bc491-190">Compruebe que la opción **conectar con las credenciales guardadas en servicio de almacenamiento seguro (SSS) para iniciar sesión en el origen de datos** está habilitada en la página de configuración de la actualización de datos y, a continuación, escriba el nombre de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-190">Verify that the **Connect using the credentials saved in Secure Store Service (SSS) to log on to the data source** option is enabled in the data refresh configuration page, and then enter the name of the target application.</span></span>  
  
3.  <span data-ttu-id="bc491-191">Active la casilla **también actualizar lo más rápido posible** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="bc491-191">Select the **Also refresh as soon as possible** checkbox, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="bc491-192">En la biblioteca que contiene el libro, seleccione el libro, haga clic en la flecha abajo que aparece a la derecha y, a continuación, seleccione **administrar actualización de datos PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="bc491-192">In the library that contains the workbook, select the workbook, click the down arrow that appears to right, and then select **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="bc491-193">Es posible que tenga que esperar varios minutos si el trabajo de actualización de datos devuelve una gran cantidad de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-193">You might need to wait several minutes if the data refresh job is returning a large amount of data.</span></span>  
  
 <span data-ttu-id="bc491-194">Si se produce un error, puede hacer clic en **Configurar programación** en la página historial de actualización de datos para probar otras credenciales.</span><span class="sxs-lookup"><span data-stu-id="bc491-194">If an error occurs, you can click **Configure schedule** in the data refresh history page to try different credentials.</span></span> <span data-ttu-id="bc491-195">También puede que necesite inspeccionar la información de conexión de orígenes de datos en el libro original para ver la cadena de conexión que se utiliza durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-195">You might also need to inspect the data source connection information in the original workbook to view the connection string that is used during data refresh.</span></span> <span data-ttu-id="bc491-196">La cadena de conexión proporcionará información sobre la ubicación del servidor y la base de datos que se pueden utilizar para solucionar el problema.</span><span class="sxs-lookup"><span data-stu-id="bc491-196">The connection string will provide information about the server location and database that you can use to troubleshoot the problem.</span></span>  
  
 <span data-ttu-id="bc491-197">Para obtener más información acerca de la solución de problemas, consulte solución de problemas de la [actualización de datos PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) en el sitio wiki de TechNet.</span><span class="sxs-lookup"><span data-stu-id="bc491-197">For more information about troubleshooting, see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/p/?LinkID=223279) on the TechNet Wiki.</span></span>  
  
##  <a name="configure-a-predefined-account-for-accessing-external-or-third-party-data-sources"></a><a name="config3rd"></a><span data-ttu-id="bc491-198">Configurar una cuenta predefinida para tener acceso a orígenes de datos externos o de terceros</span><span class="sxs-lookup"><span data-stu-id="bc491-198">Configure a predefined account for accessing external or third-party data sources</span></span>  
 <span data-ttu-id="bc491-199">Los servidores de la base de datos a menudo vienen con sus propios métodos de autenticación.</span><span class="sxs-lookup"><span data-stu-id="bc491-199">Database servers often come with their own authentication methods.</span></span> <span data-ttu-id="bc491-200">Si tiene un libro PowerPivot que requiere que las credenciales de la base de datos tengan acceso a un origen de datos externo durante la actualización de datos, puede crear un identificador de la aplicación de destino para las credenciales y, a continuación, especificar la aplicación de destino en la sección Orígenes de datos de la página de actualización de datos de programación.</span><span class="sxs-lookup"><span data-stu-id="bc491-200">If you have a PowerPivot workbook that requires database credentials to access an external data source during data refresh, you can create a target application ID for the credentials, and then specify the target application in the Data Sources section of the schedule data refresh page.</span></span>  
  
 <span data-ttu-id="bc491-201">Este paso solo es necesario si desea proporcionar a los usuarios una opción para invalidar las credenciales de la base de datos que ya estén incrustadas en el libro PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="bc491-201">This step is only necessary if you want to provide users with an option of overriding the database credentials that are already embedded in the PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="bc491-202">Este paso solo funciona si la cadena de conexión ya incluye un nombre de usuario y una contraseña.</span><span class="sxs-lookup"><span data-stu-id="bc491-202">This step only works if the connection string already includes a user name and password.</span></span> <span data-ttu-id="bc491-203">Tenga en cuenta que tener credenciales en la cadena de conexión es relativamente raro, de modo que su capacidad para utilizar esta opción será, en cierto modo, limitada.</span><span class="sxs-lookup"><span data-stu-id="bc491-203">Note that having credentials in the connection string is relatively uncommon, so your ability to make use of this option is somewhat limited.</span></span> <span data-ttu-id="bc491-204">En la mayoría de los casos, tendrá solo un identificador de usuario y una contraseña en la cadena de conexión si utiliza la autenticación de la base de datos para conectarse al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-204">In most cases, you will only have a user ID and password in the connection string if you are using database authentication to connect to the data source.</span></span> <span data-ttu-id="bc491-205">Para obtener más información acerca de cómo comprobar la cadena de conexión para ver si incluye un identificador de usuario y una contraseña, vea la sección "conceder permisos para crear programaciones y obtener acceso a datos externos" en la [actualización de datos PowerPivot con SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span><span class="sxs-lookup"><span data-stu-id="bc491-205">For more information about how to check the connection string to see if it includes a User ID and password, see the "Grant permissions to create schedules and access external data" section in [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span></span>  
  
1.  <span data-ttu-id="bc491-206">En Administración central, en Administración de aplicaciones, haga clic en **Administrar aplicaciones de servicio**.</span><span class="sxs-lookup"><span data-stu-id="bc491-206">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="bc491-207">Haga clic en **servicio de almacenamiento seguro**.</span><span class="sxs-lookup"><span data-stu-id="bc491-207">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="bc491-208">En administrar aplicaciones de destino, haga clic en **nuevo**.</span><span class="sxs-lookup"><span data-stu-id="bc491-208">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="bc491-209">Como identificador de la aplicación de destino, escriba una cadena de texto.</span><span class="sxs-lookup"><span data-stu-id="bc491-209">In Target application ID, type a text string.</span></span> <span data-ttu-id="bc491-210">La cadena debe ser única, pero también debería ser fácil de recordar.</span><span class="sxs-lookup"><span data-stu-id="bc491-210">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="bc491-211">Los usuarios escribirán esta cadena en las páginas de la programación de actualización de datos cada vez que deseen utilizar las credenciales que están almacenadas en esta aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc491-211">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="bc491-212">En Nombre para mostrar, escriba un nombre descriptivo.</span><span class="sxs-lookup"><span data-stu-id="bc491-212">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="bc491-213">Este nombre solo se utiliza para la presentación.</span><span class="sxs-lookup"><span data-stu-id="bc491-213">This name is used for display purposes only.</span></span> <span data-ttu-id="bc491-214">No se usa para especificar la aplicación de destino en una programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-214">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="bc491-215">En Correo electrónico de contacto, escriba su dirección de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="bc491-215">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="bc491-216">En tipo de aplicación de destino, seleccione **Grupo**.</span><span class="sxs-lookup"><span data-stu-id="bc491-216">In Target Application Type, select **Group**.</span></span>  
  
8.  <span data-ttu-id="bc491-217">Omita la dirección URL de la página de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-217">Skip Target Application Page URL.</span></span> <span data-ttu-id="bc491-218">La actualización de datos PowerPivot no la utiliza.</span><span class="sxs-lookup"><span data-stu-id="bc491-218">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="bc491-219">Haga clic en **Next**.</span><span class="sxs-lookup"><span data-stu-id="bc491-219">Click **Next**.</span></span>  
  
10. <span data-ttu-id="bc491-220">En la página **especificar los campos de credenciales para la aplicación de destino de almacenamiento seguro** , acepte los valores predeterminados solo si el origen de datos usa la autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc491-220">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values only if the data source uses Windows authentication.</span></span> <span data-ttu-id="bc491-221">En caso contrario, elija los tipos de campo que sean válidos para el origen de datos y, a continuación, modifique los nombres de campo de forma que coincidan con el tipo.</span><span class="sxs-lookup"><span data-stu-id="bc491-221">Otherwise, choose the field types that are valid for your data source, and then edit the field names to match the type.</span></span>  
  
     <span data-ttu-id="bc491-222">Por ejemplo, podría especificar Nombre de usuario de SQL Server y Contraseña de usuario de SQL Server como los nombres de campo y, a continuación, elegir Nombre de usuario y Contraseña para los tipos de campo.</span><span class="sxs-lookup"><span data-stu-id="bc491-222">For example, you might specify SQL Server User Name and SQL Server User Password for field names, and then choose User Name and Password for field types.</span></span>  
  
11. <span data-ttu-id="bc491-223">Haga clic en Siguiente.</span><span class="sxs-lookup"><span data-stu-id="bc491-223">Click Next.</span></span>  
  
12. <span data-ttu-id="bc491-224">En Administradores de la aplicación de destino, especifique las cuentas de usuario de dominio de Windows de los usuarios de SharePoint que deberían tener acceso administrativo a las configuraciones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc491-224">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to the application settings.</span></span>  
  
13. <span data-ttu-id="bc491-225">En Miembros, agregue las siguientes cuentas de usuario y de grupo:</span><span class="sxs-lookup"><span data-stu-id="bc491-225">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="bc491-226">Dado que crea la aplicación, agregue su cuenta de usuario de Windows a la lista Miembros.</span><span class="sxs-lookup"><span data-stu-id="bc491-226">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="bc491-227">Agregue la identidad del grupo de aplicaciones de cada aplicación de servicio PowerPivot que vaya a utilizar la aplicación de destino para tener acceso a sus credenciales almacenadas.</span><span class="sxs-lookup"><span data-stu-id="bc491-227">Add the application pool identity of each PowerPivot service application that will be using the target application to access its stored credentials.</span></span> <span data-ttu-id="bc491-228">Para ver la identidad, vaya a **Administrar aplicaciones de servicio**, seleccione la aplicación de servicio PowerPivot haciendo clic en el espacio vacío situado junto al nombre (Esto selecciona la fila) y, a continuación, haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="bc491-228">To view the identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="bc491-229">La cuenta de seguridad que aparece en esta página es la cuenta que desea agregar como un miembro de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="bc491-229">The security account that appears on this page is the account that you want to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="bc491-230">Agregue las cuentas de usuario y grupo de Windows que vayan a tener acceso a esta aplicación de destino en la sección de orígenes de datos de una página de programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="bc491-230">Add Windows user and group accounts that will be entering this target application in the data sources section of a data refresh schedule page.</span></span>  
  
14. <span data-ttu-id="bc491-231">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="bc491-231">Click **OK**.</span></span>  
  
15. <span data-ttu-id="bc491-232">Seleccione la aplicación de destino que acaba de crear, haga clic en la flecha abajo y seleccione **establecer credenciales.**</span><span class="sxs-lookup"><span data-stu-id="bc491-232">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="bc491-233">Escriba las credenciales que se utilizarán para conectarse al origen de datos (por ejemplo, el nombre de usuario y la contraseña de un inicio de sesión de SQL Server).</span><span class="sxs-lookup"><span data-stu-id="bc491-233">Enter the credentials that will be used to connect to the data source (for example, the user name and password of a SQL Server login).</span></span>  
  
17. <span data-ttu-id="bc491-234">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="bc491-234">Click **OK**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bc491-235">Consulte también</span><span class="sxs-lookup"><span data-stu-id="bc491-235">See Also</span></span>  
 <span data-ttu-id="bc491-236">[Programar una actualización de datos &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="bc491-236">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="bc491-237">Actualización de datos PowerPivot con SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="bc491-237">PowerPivot Data Refresh with SharePoint 2010</span></span>](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
