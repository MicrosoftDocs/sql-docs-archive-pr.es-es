---
title: Actualización de datos PowerPivot con SharePoint 2010 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01874bf521055d1441b695a238d09440021d2718
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/04/2020
ms.locfileid: "87747734"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a><span data-ttu-id="81119-102">Actualización de datos PowerPivot con SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="81119-102">PowerPivot Data Refresh with SharePoint 2010</span></span>
  <span data-ttu-id="81119-103">La actualización de datos [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] es una operación del lado servidor programada que consulta orígenes de datos externos para actualizar datos [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] incrustados en un libro de Excel 2010 almacenado en una biblioteca de contenido.</span><span class="sxs-lookup"><span data-stu-id="81119-103">[!INCLUDE[ssGemini](../includes/ssgemini-md.md)]t data refresh is a scheduled server-side operation that queries external data sources to update embedded [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data in an Excel 2010 workbook that is stored in a content library.</span></span>

 <span data-ttu-id="81119-104">La actualización de datos es una característica integrada de [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] para SharePoint, pero su uso requiere la ejecución de servicios y trabajos de temporizador específicos en la granja de SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="81119-104">Data refresh is a built-in feature of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint, but using it requires that you run specific services and timer jobs in your SharePoint 2010 farm.</span></span> <span data-ttu-id="81119-105">A menudo, para que la actualización de datos se realice correctamente, suelen requerirse procedimientos de administración adicionales, como la instalación de proveedores de datos y la comprobación de permisos de base de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-105">Additional administrative steps, such as installing data providers and checking database permissions, are often required for data refresh to succeed.</span></span>

 <span data-ttu-id="81119-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="81119-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>

> [!NOTE]
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="81119-107">y SharePoint Server 2013 Excel Services usan una arquitectura diferente para la actualización de datos de modelos de datos de [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="81119-107">and SharePoint Server 2013 Excel Services use a different architecture for data refresh of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data models.</span></span> <span data-ttu-id="81119-108">La nueva arquitectura emplea Excel Services como componente principal para cargar modelos de datos de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-108">The new architecture utilizes Excel Services as the primary component to load PowerPivot data models.</span></span> <span data-ttu-id="81119-109">La arquitectura usada anteriormente para la actualización de datos se basaba en un servidor que ejecutaba el Servicio de sistema de PowerPivot y [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] en modo de SharePoint para cargar los modelos de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-109">The previous data refresh architecture used relied on a server running PowerPivot System Service and [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] in SharePoint mode to load data models.</span></span> <span data-ttu-id="81119-110">Para obtener más información, vea [actualización de datos PowerPivot con SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="81119-110">For more information, see [PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span></span>

 <span data-ttu-id="81119-111">**En este tema:**</span><span class="sxs-lookup"><span data-stu-id="81119-111">**In this topic:**</span></span>

 [<span data-ttu-id="81119-112">Paso 1: habilitar Servicio de almacenamiento seguro y generar una clave maestra</span><span class="sxs-lookup"><span data-stu-id="81119-112">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>](#bkmk_services)

 [<span data-ttu-id="81119-113">Paso 2: desactivar opciones de credencial que no desee admitir</span><span class="sxs-lookup"><span data-stu-id="81119-113">Step 2: Turn off credential options that you do not want to support</span></span>](#bkmk_creds)

 [<span data-ttu-id="81119-114">Paso 3: crear aplicaciones de destino para almacenar credenciales que se utilizan en la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-114">Step 3: Create target applications to store credentials used in data refresh</span></span>](#bkmk_stored)

 [<span data-ttu-id="81119-115">Paso 4: configurar el servidor para actualizaciones de datos escalables</span><span class="sxs-lookup"><span data-stu-id="81119-115">Step 4: Configure the server for scalable data refresh</span></span>](#bkmk_scale)

 [<span data-ttu-id="81119-116">Paso 5: instalar los proveedores de datos utilizados para importar datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="81119-116">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>](#bkmk_installdp)

 [<span data-ttu-id="81119-117">Paso 6: conceder permisos para crear programaciones y acceder a los orígenes de datos externos</span><span class="sxs-lookup"><span data-stu-id="81119-117">Step 6: Grant permissions to create schedules and access external data sources</span></span>](#bkmk_accounts)

 [<span data-ttu-id="81119-118">Paso 7: habilitar la actualización del libro para la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-118">Step 7: Enable workbook upgrade for data refresh</span></span>](#bkmk_upgradewrkbk)

 [<span data-ttu-id="81119-119">Paso 8: comprobar la configuración de las actualizaciones de datos</span><span class="sxs-lookup"><span data-stu-id="81119-119">Step 8: Verify data refresh configuration</span></span>](#bkmk_verify)

 [<span data-ttu-id="81119-120">Modificar las opciones de configuración para la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-120">Modify Configuration Settings for Data Refresh</span></span>](#bkmk_config)

 [<span data-ttu-id="81119-121">Volver a programar el trabajo del temporizador de actualización de datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="81119-121">Reschedule the PowerPivot Data Refresh timer job</span></span>](#configTimerJob)

 [<span data-ttu-id="81119-122">Deshabilitar el trabajo del temporizador de actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-122">Disable the Data Refresh Timer Job</span></span>](#bkmk_disableDR)

 <span data-ttu-id="81119-123">Cuando se haya asegurado de que los permisos y el entorno del servidor están configurados, la actualización de datos estará lista para usarse.</span><span class="sxs-lookup"><span data-stu-id="81119-123">After you ensure that the server environment and permissions are configured, data refresh is ready to use.</span></span> <span data-ttu-id="81119-124">Para usar una actualización de datos, el usuario de SharePoint crea una programación en un libro PowerPivot que especifica con qué frecuencia se produce la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-124">To use data refresh, a SharePoint user creates a schedule on a PowerPivot workbook that specifies how often data refresh occurs.</span></span> <span data-ttu-id="81119-125">La creación de la programación suele realizarla el propietario del libro o el autor que publica el archivo en SharePoint.</span><span class="sxs-lookup"><span data-stu-id="81119-125">Creating the schedule is typically done by the workbook owner or author who published the file to SharePoint.</span></span> <span data-ttu-id="81119-126">Esta persona crea y administra las programaciones de la actualización de datos para los libros que posee.</span><span class="sxs-lookup"><span data-stu-id="81119-126">This person creates and manages the data refresh schedules for the workbooks that he or she owns.</span></span> <span data-ttu-id="81119-127">Para obtener más información, vea [programar una actualización de datos &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-127">For more information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>

##  <a name="step-1-enable-secure-store-service-and-generate-a-master-key"></a><a name="bkmk_services"></a><span data-ttu-id="81119-128">Paso 1: habilitar Servicio de almacenamiento seguro y generar una clave maestra</span><span class="sxs-lookup"><span data-stu-id="81119-128">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>
 <span data-ttu-id="81119-129">La actualización de datos PowerPivot depende de Servicio de almacenamiento seguro para proporcionar las credenciales que se utilizan para ejecutar trabajos de actualización de datos y conectarse a orígenes de datos externos que utilizan credenciales almacenadas.</span><span class="sxs-lookup"><span data-stu-id="81119-129">PowerPivot data refresh depends on Secure Store Service to provide credentials used to run data refresh jobs and to connect to external data sources that use stored credentials.</span></span>

 <span data-ttu-id="81119-130">Si instaló PowerPivot para SharePoint utilizando la opción Nuevo servidor, el Servicio de almacenamiento seguro se configura automáticamente.</span><span class="sxs-lookup"><span data-stu-id="81119-130">If you installed PowerPivot for SharePoint using the New Server option, the Secure Store Service is configured for you.</span></span> <span data-ttu-id="81119-131">En todos los demás escenarios de instalación, debe crear y configurar una aplicación de servicio y generar una clave de cifrado maestra para el Servicio de almacenamiento seguro.</span><span class="sxs-lookup"><span data-stu-id="81119-131">For all other installation scenarios, you must create and configure a service application and generate a master encryption key for Secure Store Service.</span></span>

> [!NOTE]
>  <span data-ttu-id="81119-132">Para configurar el Servicio de almacenamiento seguro o delegar la administración de dicho servicio a otro usuario, debe ser el administrador de una granja.</span><span class="sxs-lookup"><span data-stu-id="81119-132">You must be a farm administrator to configure Secure Store Service or delegate Secure Store Service administration to another user.</span></span> <span data-ttu-id="81119-133">Para establecer o modificar la configuración, una vez habilitada, debe ser el administrador de una aplicación de servicio.</span><span class="sxs-lookup"><span data-stu-id="81119-133">You must be a service application administrator to configure or modify settings after it is enabled.</span></span>

1.  <span data-ttu-id="81119-134">En Administración central, en Administración de aplicaciones, haga clic en **Administrar aplicaciones de servicio**.</span><span class="sxs-lookup"><span data-stu-id="81119-134">In Central Administration, in Application Management, click **Manage service applications**.</span></span>

2.  <span data-ttu-id="81119-135">En la cinta de opciones de aplicaciones de servicio, en crear, haga clic en **nuevo**.</span><span class="sxs-lookup"><span data-stu-id="81119-135">In the Service Applications ribbon, in Create, click **New**.</span></span>

3.  <span data-ttu-id="81119-136">Seleccione **servicio de almacenamiento seguro**.</span><span class="sxs-lookup"><span data-stu-id="81119-136">Select **Secure Store Service**.</span></span>

4.  <span data-ttu-id="81119-137">En la página **crear aplicación de almacenamiento seguro** , escriba un nombre para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="81119-137">In the **Create Secure Store Application** page, enter a name for the application.</span></span>

5.  <span data-ttu-id="81119-138">En **base de datos**, especifique la instancia de SQL Server que hospedará la base de datos para esta aplicación de servicio.</span><span class="sxs-lookup"><span data-stu-id="81119-138">In **Database**, specify the SQL Server instance that will host the database for this service application.</span></span> <span data-ttu-id="81119-139">El valor predeterminado es la instancia del motor de base de datos de SQL Server que hospeda las bases de datos de configuración de la granja.</span><span class="sxs-lookup"><span data-stu-id="81119-139">The default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span>

6.  <span data-ttu-id="81119-140">En **nombre**de la base de datos, escriba el nombre de la base de datos de aplicación de servicio.</span><span class="sxs-lookup"><span data-stu-id="81119-140">In **Database Name**, enter the name of the service application database.</span></span> <span data-ttu-id="81119-141">El valor predeterminado es Secure_Store_Service_DB_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="81119-141">The default value is Secure_Store_Service_DB_\<guid>.</span></span> <span data-ttu-id="81119-142">El nombre predeterminado corresponde al de la aplicación de servicio.</span><span class="sxs-lookup"><span data-stu-id="81119-142">The default name corresponds to the default name of the service application.</span></span> <span data-ttu-id="81119-143">Si escribió un nombre de aplicación del servicio único, siga una convención de nomenclatura similar para el nombre de la base de datos, de modo que pueda administrarlos juntos.</span><span class="sxs-lookup"><span data-stu-id="81119-143">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>

7.  <span data-ttu-id="81119-144">En **Autenticación de bases de datos**, el valor predeterminado es Autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="81119-144">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="81119-145">Si elige Authentication SQL, consulte la guía de administrador de SharePoint para obtener información sobre cómo utilizar el tipo de autenticación en la granja.</span><span class="sxs-lookup"><span data-stu-id="81119-145">If you choose SQL Authentication, refer to the SharePoint administrator guide for guidance on how to use the authentication type in your farm.</span></span>

8.  <span data-ttu-id="81119-146">En grupo de aplicaciones, seleccione **crear nuevo grupo de aplicaciones.**</span><span class="sxs-lookup"><span data-stu-id="81119-146">In Application Pool, select **Create new application pool.**</span></span> <span data-ttu-id="81119-147">Especifique un nombre descriptivo que ayudará a otros administradores del servidor a identificar cómo se utiliza el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="81119-147">Specify a descriptive name that will help other server administrators identify how the application pool is used.</span></span>

9. <span data-ttu-id="81119-148">Seleccione una cuenta de seguridad para el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="81119-148">Select a security account for the application pool.</span></span> <span data-ttu-id="81119-149">Especifique una cuenta administrada para utilizar una cuenta de usuario de dominio.</span><span class="sxs-lookup"><span data-stu-id="81119-149">Specify a managed account to use a domain user account.</span></span>

10. <span data-ttu-id="81119-150">Acepte los valores predeterminados restantes y, a continuación, haga clic en **Aceptar.**</span><span class="sxs-lookup"><span data-stu-id="81119-150">Accept the remaining default values, and then click **OK.**</span></span> <span data-ttu-id="81119-151">La aplicación de servicio aparecerá junto a otros servicios administrados en la lista de aplicaciones de servicio de la granja.</span><span class="sxs-lookup"><span data-stu-id="81119-151">The service application will appear alongside other managed services in the farm's service application list.</span></span>

11. <span data-ttu-id="81119-152">Haga clic en la aplicación Servicio de almacenamiento seguro en la lista.</span><span class="sxs-lookup"><span data-stu-id="81119-152">Click the Secure Store Service application from the list.</span></span>

12. <span data-ttu-id="81119-153">En la cinta de opciones de aplicaciones de servicio, haga clic en **administrar**.</span><span class="sxs-lookup"><span data-stu-id="81119-153">In the Service Applications ribbon, click **Manage**.</span></span>

13. <span data-ttu-id="81119-154">En administración de claves, haga clic en **generar nueva clave**.</span><span class="sxs-lookup"><span data-stu-id="81119-154">In Key Management, click **Generate New Key**.</span></span>

14. <span data-ttu-id="81119-155">Especifique y confirme una frase de contraseña.</span><span class="sxs-lookup"><span data-stu-id="81119-155">Enter and then confirm a pass phrase.</span></span> <span data-ttu-id="81119-156">La frase de contraseña se utilizará para agregar más aplicaciones de servicio compartidas del almacén seguro.</span><span class="sxs-lookup"><span data-stu-id="81119-156">The pass phrase will be used to add additional secure store shared service applications.</span></span>

15. <span data-ttu-id="81119-157">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="81119-157">Click **OK**.</span></span>

 <span data-ttu-id="81119-158">Para que esté disponible el registro de auditoría de las operaciones del Servicio de almacenamiento, que se utiliza para solucionar problemas, es necesario habilitarlo antes.</span><span class="sxs-lookup"><span data-stu-id="81119-158">Audit logging of Store Service operations, which is useful for troubleshooting purposes, must be enabled before it is available.</span></span> <span data-ttu-id="81119-159">Para obtener más información acerca de cómo habilitar el registro, vea [configurar servicio de almacenamiento seguro (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span><span class="sxs-lookup"><span data-stu-id="81119-159">For more information about how to enable logging, see [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span></span>

##  <a name="step-2-turn-off-credential-options-that-you-do-not-want-to-support"></a><a name="bkmk_creds"></a><span data-ttu-id="81119-160">Paso 2: desactivar las opciones de credenciales que no desea admitir</span><span class="sxs-lookup"><span data-stu-id="81119-160">Step 2: Turn off credential options that you do not want to support</span></span>
 <span data-ttu-id="81119-161">La actualización de datos PowerPivot proporciona tres opciones de credencial en una programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-161">PowerPivot data refresh provides three credential options in a data refresh schedule.</span></span> <span data-ttu-id="81119-162">Cuando el propietario de un libro programa una actualización de datos, elige una de estas opciones, que determinan la cuenta en la que se ejecutará el trabajo de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-162">When a workbook owner schedules data refresh, he or she chooses one of these options, thereby determining the account under which the data refresh job runs.</span></span> <span data-ttu-id="81119-163">Como administrador, puede determinar qué opciones de credencial estarán disponibles para los propietarios de las programaciones.</span><span class="sxs-lookup"><span data-stu-id="81119-163">As an administrator, you can determine which credential options are available to schedule owners.</span></span>

 <span data-ttu-id="81119-164">Debe tener como mínimo una opción disponible para que la actualización de datos funcione.</span><span class="sxs-lookup"><span data-stu-id="81119-164">You must have at least one option that is available in order for data refresh to work.</span></span>

 <span data-ttu-id="81119-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="81119-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="81119-166">La opción 1, **usar la cuenta de actualización de datos configurada por el administrador**, siempre aparece en la página de definición de la programación, pero solo funciona si se configura la cuenta de actualización de datos desatendida.</span><span class="sxs-lookup"><span data-stu-id="81119-166">Option 1, **Use the data refresh account configured by the administrator**, always appears on the schedule definition page, but only works if you configure the unattended data refresh account.</span></span> <span data-ttu-id="81119-167">Para obtener más información sobre cómo crear la cuenta, vea [configurar la cuenta de actualización de datos desatendida de PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-167">For more information on how to create the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="81119-168">La opción 2, **conectar con las siguientes credenciales de Windows**, siempre aparece en la página, pero solo funciona cuando se habilita la opción **permitir a los usuarios especificar credenciales de Windows personalizadas** en la página Configuración de la aplicación de servicio.</span><span class="sxs-lookup"><span data-stu-id="81119-168">Option 2, **Connect using the following windows credentials**, always appears on the page, but only works when you enable the **Allow users to enter custom Windows credentials** option in the service application configuration page.</span></span> <span data-ttu-id="81119-169">Esta opción está habilitada de forma predeterminada, pero puede deshabilitarla si los inconvenientes de utilizarla superan a las ventajas (vea más abajo).</span><span class="sxs-lookup"><span data-stu-id="81119-169">This option is enabled by default, but you can disable it if the disadvantages of using it outweigh the advantages (see below).</span></span>

 <span data-ttu-id="81119-170">La opción 3, **conectar con las credenciales guardadas en servicio de almacenamiento seguro**, siempre aparece en la página, pero solo funciona cuando un propietario de la programación proporciona una aplicación de destino válida.</span><span class="sxs-lookup"><span data-stu-id="81119-170">Option 3, **Connect using the credentials saved in Secure Store Service**, always appears on the page, but only works when a schedule owner provides a valid target application.</span></span> <span data-ttu-id="81119-171">Un administrador debe crear de antemano estas aplicaciones de destino y proporcionar después el nombre de aplicación a los creadores de las programaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-171">An administrator must create these target applications in advance and then provide the application name to those who create the data refresh schedules.</span></span> <span data-ttu-id="81119-172">Para obtener más información sobre cómo crear una aplicación de destino para las operaciones de actualización de datos, vea [configurar credenciales almacenadas para la actualización de datos PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-172">For more information on how to create a target application for data refresh operations, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="81119-173">**Configuración de la opción de credencial 2, "conectar con las siguientes credenciales de usuario de Windows"**</span><span class="sxs-lookup"><span data-stu-id="81119-173">**Configuring credential option 2, "Connect using the following Windows user credentials"**</span></span>

 <span data-ttu-id="81119-174">La aplicación de servicio PowerPivot incluyen una opción de credencial que permite a los propietarios de las programaciones escribir un nombre de usuario y una contraseña de Windows arbitrarios para ejecutar un trabajo de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-174">PowerPivot service application includes a credential option that allows schedule owners to enter an arbitrary Windows user name and password for running a data refresh job.</span></span> <span data-ttu-id="81119-175">Esta es la segunda opción de credencial de la página de definición de la programación:</span><span class="sxs-lookup"><span data-stu-id="81119-175">This is the second credential option in the schedule definition page:</span></span>

 <span data-ttu-id="81119-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="81119-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span></span>

 <span data-ttu-id="81119-177">Esta opción de credencial se habilita de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="81119-177">This credential option is enabled by default.</span></span> <span data-ttu-id="81119-178">Cuando se habilite esta opción de credencial, el Servicio de sistema de PowerPivot generará una aplicación de destino en el Servicio de almacenamiento seguro para almacenar el nombre de usuario y la contraseña especificados por el propietario de la programación.</span><span class="sxs-lookup"><span data-stu-id="81119-178">When this credential option is enabled, PowerPivot System Service will generate a target application in Secure Store Service to store the user name and password entered by the schedule owner.</span></span> <span data-ttu-id="81119-179">Una aplicación de destino generada se crea con esta Convención de nomenclatura: PowerPivotDataRefresh_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="81119-179">A generated target application is created using this naming convention: PowerPivotDataRefresh_\<guid>.</span></span> <span data-ttu-id="81119-180">Las aplicaciones de destino se crean para cada conjunto de credenciales de Windows.</span><span class="sxs-lookup"><span data-stu-id="81119-180">One target application is created for each set of Windows credentials.</span></span> <span data-ttu-id="81119-181">Si ya existe una aplicación de destino que es propiedad del Servicio de sistema PowerPivot y almacena el nombre de usuario y la contraseña especificados por la persona que ha definido la programación, el Servicio de sistema de PowerPivot utilizará esa aplicación de destino en lugar de crear otra.</span><span class="sxs-lookup"><span data-stu-id="81119-181">If a target application already exists that is owned by the PowerPivot System Service and stores the username and password entered by the person defining the schedule, PowerPivot System Service will use that target application rather than create a new one.</span></span>

 <span data-ttu-id="81119-182">La principal ventaja de utilizar esta opción de credencial es la facilidad de uso y la simplicidad.</span><span class="sxs-lookup"><span data-stu-id="81119-182">The primary advantage of using this credential option is ease of use and simplicity.</span></span> <span data-ttu-id="81119-183">El trabajo previo es mínimo porque las aplicaciones de destino ya están creadas.</span><span class="sxs-lookup"><span data-stu-id="81119-183">Advance work is minimal because target applications are created for you.</span></span> <span data-ttu-id="81119-184">Además, al ejecutar la actualización de datos con las credenciales del propietario de la programación (que probablemente es la persona que creó el libro), también, se simplifica el nivel inferior de los requisitos de permiso.</span><span class="sxs-lookup"><span data-stu-id="81119-184">Also, running data refresh under the credentials of the schedule owner (who is most likely the person who created the workbook) simplifies permission requirements downstream.</span></span> <span data-ttu-id="81119-185">Probablemente, este usuario ya tiene los permisos de la base de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="81119-185">Most likely, this user already has permissions on the target database.</span></span> <span data-ttu-id="81119-186">Cuando la actualización de datos se ejecuta con la identidad de usuario de Windows de esta persona, las conexiones de datos que especifican "usuario actual" funcionarán automáticamente.</span><span class="sxs-lookup"><span data-stu-id="81119-186">When data refresh runs under this person's Windows user identity, any data connections that specify 'current user' will work automatically.</span></span>

 <span data-ttu-id="81119-187">La desventaja es la limitación de la capacidad de administración.</span><span class="sxs-lookup"><span data-stu-id="81119-187">The disadvantage is limited management capability.</span></span> <span data-ttu-id="81119-188">Aunque las aplicaciones de destino se crean automáticamente, no se eliminan del mismo modo ni se actualizan cuando cambia la información de la cuenta.</span><span class="sxs-lookup"><span data-stu-id="81119-188">Although target applications are created automatically, they are not deleted automatically or updated as account information changes.</span></span> <span data-ttu-id="81119-189">Las directivas de expiración de contraseñas pueden hacer que estas aplicaciones de destino queden desfasadas.</span><span class="sxs-lookup"><span data-stu-id="81119-189">Password expiration policies might cause these target applications to become out of date.</span></span> <span data-ttu-id="81119-190">Los trabajos de actualización de datos que utilicen credenciales caducadas empezarán a producir errores.</span><span class="sxs-lookup"><span data-stu-id="81119-190">Data refresh jobs that use expired credentials will start to fail.</span></span> <span data-ttu-id="81119-191">Cuando suceda esto, los propietarios de las programaciones tendrán que actualizar sus credenciales proporcionando los valores actuales de nombre de usuario y contraseña en una programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-191">When this occurs, schedule owners will need to update their credentials by providing current user name and password values in a data refresh schedule.</span></span> <span data-ttu-id="81119-192">En ese punto se creará una nueva aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="81119-192">A new target application will be created at that point.</span></span> <span data-ttu-id="81119-193">Con el tiempo, a medida que los usuarios agreguen y revisen la información de credenciales en sus programas de actualización de datos, puede encontrarse con un número enorme de aplicaciones de destino generadas automáticamente en su sistema.</span><span class="sxs-lookup"><span data-stu-id="81119-193">Over time, as users add and revise credential information in their data refresh schedules, you might find that you have a large number of auto-generated target applications on your system.</span></span>

 <span data-ttu-id="81119-194">Actualmente, no hay ningún modo de determinar cuáles de estas aplicaciones de destino están activas o inactivas ni de seguir una aplicación de destino concreta hasta las programaciones de actualización de datos que la utilizan.</span><span class="sxs-lookup"><span data-stu-id="81119-194">Currently, there is no way to determine which of these target applications are active or inactive, nor is there a way to trace a specific target application back to the data refresh schedules that use it.</span></span> <span data-ttu-id="81119-195">En general, debe dejar las aplicaciones de destino tal cual, porque si las eliminara podría interrumpir las programaciones de actualización de datos existentes.</span><span class="sxs-lookup"><span data-stu-id="81119-195">In general, you should leave the target applications alone, as deleting them might break existing data refresh schedules.</span></span> <span data-ttu-id="81119-196">Al eliminar una aplicación de destino que todavía está en uso, se producirá un error en la actualización de datos con el mensaje "no se encontró la aplicación de destino", que aparece en la página historial de actualización de datos del libro.</span><span class="sxs-lookup"><span data-stu-id="81119-196">Deleting a target application that is still in use will cause data refresh to fail with the message, "Target application not found", appearing in the data refresh history page of the workbook.</span></span>

 <span data-ttu-id="81119-197">Si opta por deshabilitar esta opción de credencial, podrá eliminar todas las aplicaciones de destino que se generaron para la actualización de datos de PowerPivot sin ningún riesgo.</span><span class="sxs-lookup"><span data-stu-id="81119-197">Should you choose to disable this credential option, you can safely delete all of the target applications that were generated for PowerPivot data refresh.</span></span>

 <span data-ttu-id="81119-198">**Deshabilitar el uso de credenciales de Windows arbitrarias en programaciones de actualización de datos**</span><span class="sxs-lookup"><span data-stu-id="81119-198">**Disabling the use of arbitrary Windows credentials in data refresh schedules**</span></span>

1.  <span data-ttu-id="81119-199">En administración central, en administración de aplicaciones, haga clic en **Administrar aplicaciones de servicio**.</span><span class="sxs-lookup"><span data-stu-id="81119-199">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="81119-200">Haga clic en el nombre de la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-200">Click the PowerPivot service application name.</span></span> <span data-ttu-id="81119-201">Se muestra el Panel de administración de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-201">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="81119-202">En acciones, haga clic en configurar las opciones de la **aplicación de servicio** para abrir la página de configuración de la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-202">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="81119-203">En la sección actualización de datos, desactive la casilla **permitir a los usuarios especificar credenciales de Windows personalizadas** .</span><span class="sxs-lookup"><span data-stu-id="81119-203">In the Data Refresh section, clear the **Allow users to enter custom Windows credentials** checkbox.</span></span>

     <span data-ttu-id="81119-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span><span class="sxs-lookup"><span data-stu-id="81119-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span></span>

##  <a name="step-3-create-target-applications-to-store-credentials-used-in-data-refresh"></a><a name="bkmk_stored"></a><span data-ttu-id="81119-205">Paso 3: crear aplicaciones de destino para almacenar las credenciales usadas en la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-205">Step 3: Create target applications to store credentials used in data refresh</span></span>
 <span data-ttu-id="81119-206">Una vez configurado el Servicio de almacenamiento seguro, los administradores de SharePoint pueden crear aplicaciones de destino para que las credenciales almacenadas estén disponibles con fines de actualización de datos, incluida la cuenta de actualización de datos desatendida de PowerPivot o cualquier otra cuenta que se utilice para ejecutar el trabajo o conectar con orígenes de datos externos.</span><span class="sxs-lookup"><span data-stu-id="81119-206">Once Secure Store Service is configured, SharePoint administrators can create target applications to make stored credentials available for data refresh purposes, including the PowerPivot unattended data refresh account or any other account that is used to either run the job or connect to external data sources.</span></span>

 <span data-ttu-id="81119-207">Recuerde, como se señaló en la sección anterior, que tiene que crear aplicaciones de destino para que puedan utilizarse determinadas opciones de credencial.</span><span class="sxs-lookup"><span data-stu-id="81119-207">Recall from the previous section that you need to create target applications in order for certain credential options to be usable.</span></span> <span data-ttu-id="81119-208">Concretamente, debe crear aplicaciones de destino para la cuenta de actualización de datos desatendida de PowerPivot, además de cualquier otra credencial almacenada que considere que es probable que se utilice en las operaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-208">Specifically, you must create target applications for the PowerPivot unattended data refresh account, plus any additional stored credentials that you expect would be used in data refresh operations.</span></span>

 <span data-ttu-id="81119-209">Para obtener más información sobre cómo crear aplicaciones de destino que contengan credenciales almacenadas, vea [configurar la cuenta de actualización de datos desatendida de powerpivot &#40;PowerPivot para SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) y [configurar credenciales almacenadas para la actualización de datos PowerPivot &#40;PowerPivot para SharePoint ](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="81119-209">For more information about how to create target applications that contain stored credentials, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) and [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

##  <a name="step-4-configure-the-server-for-scalable-data-refresh"></a><a name="bkmk_scale"></a><span data-ttu-id="81119-210">Paso 4: configurar el servidor para la actualización de datos escalable</span><span class="sxs-lookup"><span data-stu-id="81119-210">Step 4: Configure the server for scalable data refresh</span></span>
 <span data-ttu-id="81119-211">De forma predeterminada, las instalaciones de PowerPivot para SharePoint admiten consultas a petición y actualizaciones de datos programadas.</span><span class="sxs-lookup"><span data-stu-id="81119-211">By default, each PowerPivot for SharePoint installation supports both on-demand queries and scheduled data refresh.</span></span>

 <span data-ttu-id="81119-212">Puede especificar para cada instalación si la instancia de servidor de Analysis Services admitirá consultas y actualizaciones de datos programadas o estará dedicada a una clase concreta de operación.</span><span class="sxs-lookup"><span data-stu-id="81119-212">For each installation, you can specify whether the Analysis Services server instance supports both query and scheduled data refresh, or is dedicated to a specific type of operation.</span></span> <span data-ttu-id="81119-213">Si tiene varias instalaciones de PowerPivot para SharePoint en su granja, podría plantearse dedicar un servidor exclusivamente para las operaciones de actualización de datos si encuentra que los trabajos se retrasan o producen errores.</span><span class="sxs-lookup"><span data-stu-id="81119-213">If you have multiple installations of PowerPivot for SharePoint in your farm, you might consider dedicating a server for just data refresh operations if you find that jobs are delayed or failing.</span></span>

 <span data-ttu-id="81119-214">Además, si el hardware subyacente lo admite, puede aumentar el número de trabajos de actualización de datos que se ejecutan en paralelo.</span><span class="sxs-lookup"><span data-stu-id="81119-214">Additionally, if the underlying hardware supports it, you can increase the number of data refresh jobs that run in parallel.</span></span> <span data-ttu-id="81119-215">De forma predeterminada, el número de trabajos que se pueden ejecutar en paralelo se calcula en función de la memoria del sistema, pero se puede aumentar si se tiene más capacidad de CPU para admitir la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="81119-215">By default, the number of jobs that can run in parallel is calculated based on system memory, but you can increase that number if you have additional CPU capacity to support the workload.</span></span>

 <span data-ttu-id="81119-216">Para obtener más información, vea [configurar la actualización de datos dedicada o el procesamiento de solo consultas &#40;PowerPivot para SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-216">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span>

##  <a name="step-5-install-data-providers-used-to-import-powerpivot-data"></a><a name="bkmk_installdp"></a><span data-ttu-id="81119-217">Paso 5: instalar proveedores de datos utilizados para importar datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="81119-217">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>
 <span data-ttu-id="81119-218">Una operación de actualización de datos es esencialmente la repetición de una operación de importación que recuperó los datos originales.</span><span class="sxs-lookup"><span data-stu-id="81119-218">A data refresh operation is essentially a repeat of an import operation that retrieved the original data.</span></span> <span data-ttu-id="81119-219">Esto significa que los mismos proveedores de datos utilizados para importar los datos en la aplicación cliente PowerPivot deben estar instalados en el servidor PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-219">This means that the same data providers used to import the data in the PowerPivot client application must also be installed on the PowerPivot server.</span></span>

 <span data-ttu-id="81119-220">Debe ser administrador local para instalar los proveedores de datos en un servidor de Windows.</span><span class="sxs-lookup"><span data-stu-id="81119-220">You must be a local administrator to install data providers on a Windows server.</span></span> <span data-ttu-id="81119-221">Si instala controladores adicionales, asegúrese de instalarlos en cada equipo de la granja de SharePoint que tenga PowerPivot para SharePoint instalado.</span><span class="sxs-lookup"><span data-stu-id="81119-221">If you install additional drivers, be sure to install them on each computer in the SharePoint farm that has an installation of PowerPivot for SharePoint.</span></span> <span data-ttu-id="81119-222">Si tiene varios servidores de PowerPivot en la granja, debe instalar los proveedores en cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="81119-222">If you have multiple PowerPivot servers in the farm, you must install the providers on each one.</span></span>

 <span data-ttu-id="81119-223">Recuerde que los servidores de SharePoint son aplicaciones de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="81119-223">Remember that SharePoint servers are 64-bit applications.</span></span> <span data-ttu-id="81119-224">Asegúrese de instalar la versión de 64 bits de los proveedores de datos que usa para que admitan las operaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-224">Be sure to install the 64-bit version of the data providers you are using to support data refresh operations.</span></span>

##  <a name="step-6-grant-permissions-to-create-schedules-and-access-external-data-sources"></a><a name="bkmk_accounts"></a><span data-ttu-id="81119-225">Paso 6: conceder permisos para crear programaciones y obtener acceso a orígenes de datos externos</span><span class="sxs-lookup"><span data-stu-id="81119-225">Step 6: Grant permissions to create schedules and access external data sources</span></span>
 <span data-ttu-id="81119-226">Los propietarios o los autores de los libros deben tener el permiso para **contribuir** si desean programar la actualización de los datos en un libro.</span><span class="sxs-lookup"><span data-stu-id="81119-226">Workbook owners or authors must have **Contribute** permission to schedule data refresh on a workbook.</span></span> <span data-ttu-id="81119-227">Dado este nivel de permiso, puede abrir y editar la página de configuración de la actualización de datos del libro para especificar las credenciales y la información de programación que se usa para actualizar los datos.</span><span class="sxs-lookup"><span data-stu-id="81119-227">Given this permission level, he or she can open and edit the workbook's data refresh configuration page to specify the credentials and schedule information used to refresh the data.</span></span>

 <span data-ttu-id="81119-228">Además de los permisos de SharePoint, también se deben revisar los permisos de base de datos de los orígenes de datos externos para asegurarse de que las cuentas utilizadas durante la actualización de datos tengan suficientes derechos de acceso a los datos.</span><span class="sxs-lookup"><span data-stu-id="81119-228">In addition to SharePoint permissions, database permissions on external data sources must also be reviewed to ensure that accounts used during data refresh have sufficient access rights to the data.</span></span> <span data-ttu-id="81119-229">La determinación de los requisitos de permiso requerirá una evaluación cuidadosa por su parte porque los permisos que necesita conceder variarán en función de la cadena de conexión del libro y la identidad del usuario con la que se está ejecutando el trabajo de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-229">Determining permission requirements will require careful evaluation on your part because the permissions that you need to grant will vary depending on the connection string in the workbook and the user identity under which the data refresh job is running.</span></span>

 <span data-ttu-id="81119-230">**Por qué son importantes las cadenas de conexión existentes de un libro PowerPivot para las operaciones de actualización de datos PowerPivot**</span><span class="sxs-lookup"><span data-stu-id="81119-230">**Why existing connection strings in a PowerPivot workbook matter to PowerPivot data refresh operations**</span></span>

 <span data-ttu-id="81119-231">Cuando se ejecuta la actualización de datos, el servidor envía una solicitud de conexión al origen de datos externo utilizando la cadena de conexión que se creó cuando se importaron originalmente los datos.</span><span class="sxs-lookup"><span data-stu-id="81119-231">When data refresh runs, the server sends a connection request to the external data source using the connection string that was created when the data was originally imported.</span></span> <span data-ttu-id="81119-232">La ubicación del servidor, el nombre de base de datos y los parámetros de autenticación especificados en esa cadena de conexión se vuelven a utilizar durante la actualización de datos para acceder a los mismos orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-232">The server location, database name, and authentication parameters specified in that connection string are now reused during data refresh to access the same data sources.</span></span> <span data-ttu-id="81119-233">La cadena de conexión y su construcción general no se pueden modificar para la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-233">The connection string and its overall construction cannot be modified for data refresh purposes.</span></span> <span data-ttu-id="81119-234">Simplemente se vuelve a actualizar tal cual durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-234">It is simply reused as-is during data refresh.</span></span> <span data-ttu-id="81119-235">En algunos casos, si va a utilizar una autenticación diferente a la de Windows para conectarse a un origen de datos, puede reemplazar el nombre de usuario y la contraseña en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="81119-235">In some cases, if you are using non-Windows authentication to connect to a data source, you can override the user name and password in the connection string.</span></span> <span data-ttu-id="81119-236">Se proporciona más información sobre esto más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="81119-236">More detail about this is provided further on in this topic.</span></span>

 <span data-ttu-id="81119-237">Para la mayoría de los libros, la opción de autenticación predeterminada de la conexión es utilizar conexiones de confianza o la seguridad integrada de Windows, lo que produce cadenas de conexión que incluyen `SSPI=IntegratedSecurity` o `SSPI=TrustedConnection`.</span><span class="sxs-lookup"><span data-stu-id="81119-237">For most workbooks, the default authentication option on the connection is to use trusted connections or Windows integrated security, resulting in connection strings that include `SSPI=IntegratedSecurity` or `SSPI=TrustedConnection`.</span></span> <span data-ttu-id="81119-238">Cuando se usa esta cadena de conexión durante la actualización de datos, la cuenta utilizada para ejecutar el trabajo de actualización de datos se convierte en el ' usuario actual '.</span><span class="sxs-lookup"><span data-stu-id="81119-238">When this connection string is used during data refresh, the account used to run the data refresh job becomes the 'current user'.</span></span> <span data-ttu-id="81119-239">Como tal, esta cuenta necesitará permisos de lectura en cualquier origen de datos externo al que se acceda a través de una conexión de confianza.</span><span class="sxs-lookup"><span data-stu-id="81119-239">As such, this account needs read permissions on any external data source that is accessed via a trusted connection.</span></span>

 <span data-ttu-id="81119-240">**¿Ha habilitado la cuenta de actualización de datos desatendida de PowerPivot?**</span><span class="sxs-lookup"><span data-stu-id="81119-240">**Did you enable the PowerPivot unattended data refresh account?**</span></span>

 <span data-ttu-id="81119-241">Si la respuesta es sí, debe otorgar esos permisos de lectura de la cuenta en los orígenes de datos a los que se accede durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-241">If yes, then you should grant that account read permissions on data sources that are accessed during data refresh.</span></span> <span data-ttu-id="81119-242">La razón por la que esta cuenta necesita permisos de lectura es que en un libro que usa las opciones de autenticación predeterminadas, la cuenta desatendida será el ' usuario actual ' durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-242">The reason why this account needs read permissions is because in a workbook that uses the default authentication options, the unattended account will be the 'current user' during data refresh.</span></span> <span data-ttu-id="81119-243">A menos que el propietario de la programación invalide las credenciales en la cadena de conexión, esta cuenta necesitará permisos de lectura en todos los orígenes de datos que se utilicen de forma activa en una organización.</span><span class="sxs-lookup"><span data-stu-id="81119-243">Unless the schedule owner overrides the credentials in the connection string, this account will need read permissions on any number of data sources that are actively used in your organization.</span></span>

 <span data-ttu-id="81119-244">**¿Está utilizando la opción de credencial 2: permitir al propietario de la programación especificar un nombre de usuario y contraseña de Windows?**</span><span class="sxs-lookup"><span data-stu-id="81119-244">**Are you using credential option 2: allowing the schedule owner to enter a Windows user name and password?**</span></span>

 <span data-ttu-id="81119-245">Normalmente, los usuarios que crean libros PowerPivot ya tienen suficientes permisos porque importaron los datos en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="81119-245">Typically, users who create PowerPivot workbooks already have sufficient permissions because he or she already imported the data in the first place.</span></span> <span data-ttu-id="81119-246">Si estos usuarios configuran posteriormente la actualización de datos para ejecutarse con su propia identidad de usuario de Windows, se utilizará su cuenta de usuario de Windows, que ya posee derechos sobre la base de datos, para recuperar datos durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-246">If these users subsequently configure data refresh to run under their own Windows user identity, their Windows user account, which already has rights on the database, will be used to retrieve data during data refresh.</span></span> <span data-ttu-id="81119-247">Los permisos existentes deberían ser suficientes.</span><span class="sxs-lookup"><span data-stu-id="81119-247">Existing permissions should be sufficient.</span></span>

 <span data-ttu-id="81119-248">**¿Está utilizando la opción de credencial 3: utilizar una aplicación de destino del Servicio de almacenamiento seguro para proporcionar una identidad de usuario para ejecutar trabajos de actualización de datos?**</span><span class="sxs-lookup"><span data-stu-id="81119-248">**Are you using credential option 3: using a Secure Store Service target application to provide a user identity for running data refresh jobs?**</span></span>

 <span data-ttu-id="81119-249">Todas las cuentas que se utilicen para ejecutar un trabajo de la actualización de datos necesitan permisos de lectura, por los mismas motivos que los descritos para la cuenta de la actualización de datos desatendida de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-249">Any account used to run a data refresh job needs read permissions, for the same reasons as those described for the PowerPivot unattended data refresh account.</span></span>

 <span data-ttu-id="81119-250">**Cómo comprobar las cadenas de conexión para determinar si se pueden invalidar las credenciales utilizadas durante la actualización de datos**</span><span class="sxs-lookup"><span data-stu-id="81119-250">**How to check connection strings to determine whether you can override credentials used during data refresh**</span></span>

 <span data-ttu-id="81119-251">Como se indicó anteriormente, podrá sustituir el nombre de usuario y la contraseña en el nivel de trabajo de actualización de datos si la conexión utiliza una autenticación diferente a la de Windows (por ejemplo, la autenticación de SQL Server).</span><span class="sxs-lookup"><span data-stu-id="81119-251">As previously noted, you can substitute a different user name and password at the data refresh job level if the connection is using non-Windows authentication (for example, SQL Server authentication).</span></span> <span data-ttu-id="81119-252">Las credenciales diferentes a la de Windows se pasan a la cadena de conexión utilizando los parámetros de identificador de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="81119-252">Non-Windows credentials are passed on the connection string using the User ID and Password parameters.</span></span> <span data-ttu-id="81119-253">Si el libro contiene una cadena de conexión con estos parámetros, también puede especificar un nombre de usuario y una contraseña diferentes para actualizar los datos procedentes de ese origen de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-253">If your workbook contains a connection string with these parameters, you can optionally specify a different user name and password for refreshing data from that data source.</span></span>

 <span data-ttu-id="81119-254">Los siguientes pasos explican cómo determinar si tiene una cadena de conexión que acepta invalidaciones de nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="81119-254">The following steps explain how to determine whether you have a connection string that accepts user name and password overrides.</span></span>

1.  <span data-ttu-id="81119-255">Abra el libro en Excel.</span><span class="sxs-lookup"><span data-stu-id="81119-255">Open the workbook in Excel.</span></span>

2.  <span data-ttu-id="81119-256">Abra la ventana de PowerPivot (en Excel, en la cinta de opciones de PowerPivot, haga clic en la ventana de PowerPivot).</span><span class="sxs-lookup"><span data-stu-id="81119-256">Open the PowerPivot window (in Excel, on the PowerPivot ribbon, click PowerPivot Window).</span></span>

3.  <span data-ttu-id="81119-257">Haga clic en **diseño**.</span><span class="sxs-lookup"><span data-stu-id="81119-257">Click **Design**.</span></span>

4.  <span data-ttu-id="81119-258">Haga clic en **conexiones existentes**.</span><span class="sxs-lookup"><span data-stu-id="81119-258">Click **Existing Connections**.</span></span>

     <span data-ttu-id="81119-259">Todas las conexiones utilizadas en el libro se enumeran en **conexiones de datos PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="81119-259">All of the connections used in the workbook are listed under **PowerPivot Data Connections**.</span></span>

5.  <span data-ttu-id="81119-260">Seleccione la conexión, haga clic en **Editar**y, a continuación, haga clic en **avanzadas**.</span><span class="sxs-lookup"><span data-stu-id="81119-260">Select the connection and click **Edit**, and then click **Advanced**.</span></span> <span data-ttu-id="81119-261">La cadena de conexión se encuentra en la parte inferior de la página.</span><span class="sxs-lookup"><span data-stu-id="81119-261">The connection string is at the bottom of the page.</span></span>

 <span data-ttu-id="81119-262">Si ve **Integrated Security = SSPI** en la cadena de conexión, no puede invalidar las credenciales en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="81119-262">If you see **Integrated Security=SSPI** in the connection string, you cannot override the credentials in the connection string.</span></span> <span data-ttu-id="81119-263">La conexión siempre utilizará al usuario actual.</span><span class="sxs-lookup"><span data-stu-id="81119-263">The connection will always use the current user.</span></span> <span data-ttu-id="81119-264">Se omitirá cualquier credencial que proporcione.</span><span class="sxs-lookup"><span data-stu-id="81119-264">Any credentials that you provide are ignored.</span></span>

 <span data-ttu-id="81119-265">Si ve \*\*Persist Security info = false, password = \* \* \* \* \* \* \* \* \* \* \* , userid = \<userlogin> \*\*, tendrá una cadena de conexión que aceptará invalidaciones de credenciales.</span><span class="sxs-lookup"><span data-stu-id="81119-265">If you see **Persist Security Info=False, Password=\*\*\*\*\*\*\*\*\*\*\*, UserID=\<userlogin>**,then you have a connection string that will accept credential overrides.</span></span> <span data-ttu-id="81119-266">Las credenciales que aparecen en una cadena de conexión (como las de identificación de usuario y contraseña) no son credenciales de Windows, sino que son inicios de sesión de base de datos u otras cuentas de inicio de sesión válidos para el origen de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="81119-266">Credentials that appear in a connection string (such as UserID and Password) are not Windows credentials, but rather database logins or other sign-in accounts that are valid for the target data source.</span></span>

 <span data-ttu-id="81119-267">**Cómo invalidar credenciales en la cadena de conexión**</span><span class="sxs-lookup"><span data-stu-id="81119-267">**How to override credentials in the connection string**</span></span>

 <span data-ttu-id="81119-268">Para invalidar credenciales, especifique las credenciales de origen de datos en la programación de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-268">Overriding credentials is done by specifying data source credentials in the data refresh schedule.</span></span> <span data-ttu-id="81119-269">Como administrador, puede proporcionar una aplicación de destino en el Servicio de almacenamiento seguro que asigne las credenciales usadas para acceder a los datos externos.</span><span class="sxs-lookup"><span data-stu-id="81119-269">As an administrator, you can provide a target application in Secure Store Service that maps the credentials used to access external data.</span></span> <span data-ttu-id="81119-270">El propietario de la programación puede especificar el identificador de la aplicación de destino en la programación de la actualización de datos que defina.</span><span class="sxs-lookup"><span data-stu-id="81119-270">The schedule owner can then enter the target application ID in the data refresh schedule that he or she defines.</span></span> <span data-ttu-id="81119-271">Para obtener más información acerca de cómo crear esta aplicación de destino, vea [configurar credenciales almacenadas para la actualización de datos PowerPivot &#40;PowerPivot para SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-271">For more information about creating this target application, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="81119-272">También, el propietario de la programación puede escribir en el conjunto de credenciales que se utilizan para conectar a los orígenes de datos durante la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-272">Alternatively, the schedule owner can type in the set of credentials that are used to connect to data sources during data refresh.</span></span> <span data-ttu-id="81119-273">La siguiente ilustración muestra esta opción de origen de datos en la página de definición de la programación.</span><span class="sxs-lookup"><span data-stu-id="81119-273">The following illustration shows this data source option in the schedule definition page.</span></span>

 <span data-ttu-id="81119-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span><span class="sxs-lookup"><span data-stu-id="81119-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span></span>

 <span data-ttu-id="81119-275">**Identificar los requisitos de acceso a datos**</span><span class="sxs-lookup"><span data-stu-id="81119-275">**Identifying data access requirements**</span></span>

 <span data-ttu-id="81119-276">Como se ha indicado en secciones anteriores, la cuenta utilizada para ejecutar la actualización de datos y conectarse a los orígenes de datos externos suele ser una y la misma.</span><span class="sxs-lookup"><span data-stu-id="81119-276">As noted in previous sections, the account used to run data refresh and connect to external data sources is often one and the same.</span></span> <span data-ttu-id="81119-277">Por tanto, el conjunto de opciones establecidas en esta parte de la página de programación de actualización de datos determina la cuenta que se utilizará para acceder a los orígenes de datos externos.</span><span class="sxs-lookup"><span data-stu-id="81119-277">As such, the account used to access external data sources is determined by the options set in this part of the data refresh schedule page.</span></span> <span data-ttu-id="81119-278">Esta podría ser la cuenta de la actualización de datos desatendida de PowerPivot, la cuenta de Windows de un usuario individual, o la cuenta almacenada en una aplicación de destino predefinida.</span><span class="sxs-lookup"><span data-stu-id="81119-278">This might be the PowerPivot unattended data refresh account, the Windows account of an individual user, or the account that is stored in a predefined target application.</span></span>

 <span data-ttu-id="81119-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="81119-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="81119-280">En los casos en que la cuenta utilizada para ejecutar la actualización de datos no coincida con la cuenta para importar datos (por ejemplo, la cuenta de la actualización de datos desatendida de PowerPivot mediante la opción de credencial uno, o algún otro conjunto de credenciales almacenadas mediante la opción de credencial tres), necesitará crear un nuevo inicio de sesión de base de datos para esa cuenta y concederle permisos de lectura en los orígenes de datos externos.</span><span class="sxs-lookup"><span data-stu-id="81119-280">In cases where the account used to run data refresh is different from the account used to import data (for example, the PowerPivot unattended data refresh account via credential option one, or some other set of stored credentials via credential option three), you will need to create a new database login for that account and grant it read permissions on the external data sources.</span></span>

 <span data-ttu-id="81119-281">Cuando conozca qué cuentas requieren acceso a datos, empiece a comprobar los permisos en los orígenes de datos que se utilizan con mayor frecuencia en los libros PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-281">Once you understand which accounts require data access, you can begin to check permissions on the data sources that are most often used in PowerPivot workbooks.</span></span> <span data-ttu-id="81119-282">Comience con cualquier almacenamiento de datos o base de datos de informes que se utilice activamente, pero solicite también a sus usuarios de PowerPivot más activos que introduzcan datos para averiguar qué orígenes de datos están utilizando.</span><span class="sxs-lookup"><span data-stu-id="81119-282">Start with any data warehouses or reporting databases that are actively used, but also solicit input from your most active PowerPivot users to find out which data sources they are using.</span></span> <span data-ttu-id="81119-283">Cuando tenga una lista de orígenes de datos, podrá empezar a comprobar cada uno de ellos para asegurarse de que se establecen correctamente los permisos.</span><span class="sxs-lookup"><span data-stu-id="81119-283">Once you have a list of data sources, you can begin checking each one to ensure that permissions are set correctly.</span></span>

##  <a name="step-7-enable-workbook-upgrade-for-data-refresh"></a><a name="bkmk_upgradewrkbk"></a><span data-ttu-id="81119-284">Paso 7: habilitar la actualización del libro para la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-284">Step 7: Enable workbook upgrade for data refresh</span></span>
 <span data-ttu-id="81119-285">De forma predeterminada, los libros creados con la versión de [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] de PowerPivot para Excel no se pueden configurar para la actualización de datos programada en una versión de [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] de PowerPivot para SharePoint.</span><span class="sxs-lookup"><span data-stu-id="81119-285">By default, workbooks that were created using the [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel cannot be configured for scheduled data refresh on a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version of PowerPivot for SharePoint.</span></span> <span data-ttu-id="81119-286">Si hospeda versiones de los libros PowerPivot más recientes y antiguas en el entorno de SharePoint, debe actualizar cualquier libro [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] para poder programarlos para la actualización automática de los datos en el servidor.</span><span class="sxs-lookup"><span data-stu-id="81119-286">If you host newer and older versions of PowerPivot workbooks in your SharePoint environment, you must upgrade any [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] workbooks first before they can be scheduled for automatic data refresh on the server.</span></span>

##  <a name="step-8-verify-data-refresh-configuration"></a><a name="bkmk_verify"></a><span data-ttu-id="81119-287">Paso 8: comprobar la configuración de la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-287">Step 8: Verify data refresh configuration</span></span>
 <span data-ttu-id="81119-288">Para comprobar la actualización de datos, debe tener un libro PowerPivot publicado en un sitio de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="81119-288">To verify data refresh, you must have a PowerPivot workbook that is published to a SharePoint site.</span></span> <span data-ttu-id="81119-289">Debe tener permisos para contribuir en el libro y para acceder a los orígenes de datos que estén incluidos en el programa de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-289">You must have Contribute permissions on the workbook and permissions to access any data sources that are included in the data refresh schedule.</span></span>

 <span data-ttu-id="81119-290">Cuando cree la programación, active la casilla **también actualizar lo más rápido posible** para ejecutar la actualización de datos inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="81119-290">When you create the schedule, select the **Also refresh as soon as possible** checkbox to run data refresh immediately.</span></span> <span data-ttu-id="81119-291">A continuación, puede comprobar la página del historial de actualización de datos de ese libro para comprobar que se ejecutó correctamente.</span><span class="sxs-lookup"><span data-stu-id="81119-291">You can then check the data refresh history page of that workbook to verify that it ran successfully.</span></span> <span data-ttu-id="81119-292">Recuerde que el trabajo del temporizador de actualización de datos PowerPivot se ejecuta cada minuto.</span><span class="sxs-lookup"><span data-stu-id="81119-292">Recall that the PowerPivot Data Refresh timer job runs every minute.</span></span> <span data-ttu-id="81119-293">La obtención de la confirmación de que la actualización de datos finalizó correctamente tardará como mínimo ese tiempo.</span><span class="sxs-lookup"><span data-stu-id="81119-293">It will take at least that long to get confirmation that data refresh succeeded.</span></span>

 <span data-ttu-id="81119-294">Asegúrese de probar todas las opciones de credencial que tiene previsto admitir.</span><span class="sxs-lookup"><span data-stu-id="81119-294">Be sure to try all of the credential options you plan to support.</span></span> <span data-ttu-id="81119-295">Por ejemplo, si configuró la cuenta de la actualización de datos desatendida de PowerPivot, compruebe que la actualización de datos finalice correctamente utilizando esa opción.</span><span class="sxs-lookup"><span data-stu-id="81119-295">For example, if you configured the PowerPivot unattended data refresh account, verify that data refresh succeeds using that option.</span></span> <span data-ttu-id="81119-296">Para obtener más información acerca de la programación y visualización de la información de estado, vea [programar una actualización de datos &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) y [ver el historial de actualización de datos &#40;PowerPivot para SharePoint ](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="81119-296">For more information about scheduling and viewing status information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) and [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="81119-297">Si se produce un error en la actualización de datos, consulte la página de solución de problemas de la [actualización de datos PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) en el wiki de TechNet para ver posibles soluciones.</span><span class="sxs-lookup"><span data-stu-id="81119-297">If data refresh fails, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>

##  <a name="modify-configuration-settings-for-data-refresh"></a><a name="bkmk_config"></a><span data-ttu-id="81119-298">Modificar la configuración de la actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-298">Modify Configuration Settings for Data Refresh</span></span>
 <span data-ttu-id="81119-299">Cada aplicación de servicio PowerPivot tiene valores de configuración que afectan a las operaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-299">Each PowerPivot service application has configuration settings that affect data refresh operations.</span></span> <span data-ttu-id="81119-300">En esta sección se explica cómo modificar dichos valores.</span><span class="sxs-lookup"><span data-stu-id="81119-300">This section explains how to modify those settings.</span></span>

###  <a name="set-business-hours-to-determine-off-hours-processing"></a><a name="procIntervals"></a><span data-ttu-id="81119-301">Establecer "horario comercial" para determinar el procesamiento fuera del horario laboral</span><span class="sxs-lookup"><span data-stu-id="81119-301">Set 'Business Hours' to determine off-hours processing</span></span>
 <span data-ttu-id="81119-302">Los usuarios de SharePoint que programan las operaciones de actualización de datos pueden especificar una hora de inicio anterior a "Después del horario comercial".</span><span class="sxs-lookup"><span data-stu-id="81119-302">SharePoint users who schedule data refresh operations can specify an earliest start time of "After business hours".</span></span> <span data-ttu-id="81119-303">Esto puede ser útil si desean recuperar datos de transacciones comerciales que se hayan acumulado durante el día.</span><span class="sxs-lookup"><span data-stu-id="81119-303">This may be useful if they want to retrieve business transaction data that accumulated during the business day.</span></span> <span data-ttu-id="81119-304">Como administrador de una granja, puede especificar el intervalo de horas que mejor define un día laboral en una organización.</span><span class="sxs-lookup"><span data-stu-id="81119-304">As a farm administrator, you can specify the range of hours that best defines a business day for your organization.</span></span> <span data-ttu-id="81119-305">Si define el día laboral como de 04:00 a 20:00 horas, el procesamiento de las actualizaciones de datos que se base en una hora de inicio "Después del horario comercial" comenzará a las 20:01.</span><span class="sxs-lookup"><span data-stu-id="81119-305">If you define the business day to be from 04:00 to 20:00, then data refresh processing that is based on an "After business hours" start time will begin at 20:01.</span></span>

 <span data-ttu-id="81119-306">Las solicitudes de actualización de datos que se ejecutan durante horas de poca actividad se agregan a la cola en el orden en el que se recibe la solicitud.</span><span class="sxs-lookup"><span data-stu-id="81119-306">Data refresh requests that run during off-hours are added to the queue in the order in which the request is received.</span></span> <span data-ttu-id="81119-307">Las solicitudes individuales se procesarán a medida que los recursos del servidor estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="81119-307">Individual requests will be processed as server resources become available.</span></span>

1.  <span data-ttu-id="81119-308">En administración central, en administración de aplicaciones, haga clic en **Administrar aplicaciones de servicio**.</span><span class="sxs-lookup"><span data-stu-id="81119-308">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="81119-309">Haga clic en el nombre de la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-309">Click the PowerPivot service application name.</span></span> <span data-ttu-id="81119-310">Se muestra el Panel de administración de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-310">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="81119-311">En acciones, haga clic en configurar las opciones de la **aplicación de servicio** para abrir la página de configuración de la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-311">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="81119-312">En la sección Actualización de datos, en Horario comercial, escriba una hora de inicio y una hora de finalización que defina el período de procesamiento en un horario posterior al comercial.</span><span class="sxs-lookup"><span data-stu-id="81119-312">In the Data Refresh section, in Business Hours, enter a start time and end time that defines the after business hours processing period.</span></span>

     <span data-ttu-id="81119-313">Si no desea definir un período de procesamiento en horas de poca actividad, puede especificar el mismo valor en Hora de inicio y en Hora de finalización (por ejemplo, 12:00 para ambas).</span><span class="sxs-lookup"><span data-stu-id="81119-313">If you do not want an off-hours processing period defined, you can enter the same value for both Start Time and End Time (for example, 12:00 for both times).</span></span> <span data-ttu-id="81119-314">Sin embargo, sea consciente de que las páginas de definición de la programación de los sitios de SharePoint seguirán manteniendo como opción "Después del horario comercial".</span><span class="sxs-lookup"><span data-stu-id="81119-314">However, be aware that the schedule definition pages on the SharePoint sites will still have "After business hours" as an option.</span></span> <span data-ttu-id="81119-315">Los usuarios que seleccionen esa opción en una granja que no tenga definido un intervalo de procesamiento en horas de poca actividad obtendrán a la larga errores en la actualización de datos porque los trabajos de procesamiento no podrán iniciarse.</span><span class="sxs-lookup"><span data-stu-id="81119-315">Users who select that option on a farm that has no off-hour processing range defined for it will eventually get data refresh errors as processing jobs fail to start.</span></span>

5.  <span data-ttu-id="81119-316">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="81119-316">Click **OK**.</span></span>

###  <a name="limit-how-long-data-refresh-history-is-retained"></a><a name="usagehist"></a><span data-ttu-id="81119-317">Limitar cuánto tiempo se conserva el historial de actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-317">Limit how long data refresh history is retained</span></span>
 <span data-ttu-id="81119-318">El historial de la actualización de datos es un registro detallado de los mensajes de error y de éxito que se generan con el tiempo para las operaciones de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-318">Data refresh history is a detailed record of the success and failure messages that are generated for data refresh operations over time.</span></span> <span data-ttu-id="81119-319">La información del historial se recopila y administra a través del sistema de recopilación de datos de uso en la granja.</span><span class="sxs-lookup"><span data-stu-id="81119-319">History information is gathered and managed through the usage data collection system in the farm.</span></span> <span data-ttu-id="81119-320">Por tanto, los límites que establezca en el historial de datos de uso también se aplicarán al historial de la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-320">As such, limits that you set on usage data history also apply to data refresh history.</span></span> <span data-ttu-id="81119-321">Dado que los informes de actividad de uso reúnen datos de todo el sistema de PowerPivot, se usa una sola configuración del historial para controlar la retención de los datos tanto para el historial de actualización de datos como para todos los demás datos de uso que se recopilan y almacenan.</span><span class="sxs-lookup"><span data-stu-id="81119-321">Because the usage activity reports pull together data from across the PowerPivot system, a single history setting is used to control data retention for both data refresh history and all other usage data that is collected and stored.</span></span>

1.  <span data-ttu-id="81119-322">En administración central, en administración de aplicaciones, haga clic en **Administrar aplicaciones de servicio**.</span><span class="sxs-lookup"><span data-stu-id="81119-322">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="81119-323">Haga clic en el nombre de la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-323">Click the PowerPivot service application name.</span></span> <span data-ttu-id="81119-324">Se muestra el Panel de administración de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-324">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="81119-325">En acciones, haga clic en configurar las opciones de la **aplicación de servicio** para abrir la página de configuración de la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-325">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="81119-326">En la sección de recopilación de datos de uso, en Historial de datos de uso, escriba el número de días para los que desea mantener un registro de actividad de la actualización de datos para cada libro.</span><span class="sxs-lookup"><span data-stu-id="81119-326">In the Usage Data Collection section, in Usage Data History, type the number of days for which you want to keep a record of data refresh activity for each workbook.</span></span>

     <span data-ttu-id="81119-327">El valor predeterminado es 365 días.</span><span class="sxs-lookup"><span data-stu-id="81119-327">The default is 365 days.</span></span> <span data-ttu-id="81119-328">El valor mínimo es 1 día y el valor máximo es 5000 días.</span><span class="sxs-lookup"><span data-stu-id="81119-328">The minimum value is 1 day and the maximum is 5000 days.</span></span> <span data-ttu-id="81119-329">0 especifica un período de retención ilimitado; los datos nunca se eliminan.</span><span class="sxs-lookup"><span data-stu-id="81119-329">0 specifies an unlimited retention period; data is never deleted.</span></span> <span data-ttu-id="81119-330">Observe que no hay ningún valor para desactivar el historial.</span><span class="sxs-lookup"><span data-stu-id="81119-330">Note that there is no setting for turning off history.</span></span>

5.  <span data-ttu-id="81119-331">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="81119-331">Click **OK**.</span></span>

 <span data-ttu-id="81119-332">La información del historial se pone a disposición de los usuarios de SharePoint cuando eligen la opción Administrar actualización de datos en un libro que tiene un historial de actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-332">History information is made available to SharePoint users when they choose the Manage Data Refresh option on a workbook that has a data refresh history.</span></span> <span data-ttu-id="81119-333">Esta información también se utiliza en el Panel de administraciones de PowerPivot que usan los administradores de una granja para administrar las operaciones de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-333">This information is also used in the PowerPivot Management Dashboard used by farm administrators to manage PowerPivot service operations.</span></span> <span data-ttu-id="81119-334">Para obtener más información, vea [ver el historial de actualización de datos &#40;PowerPivot para SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-334">For more information, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="81119-335">El almacenamiento físico a largo plazo de datos del historial está en la base de datos de aplicación de servicio PowerPivot para la aplicación de servicio PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="81119-335">Long-term physical storage of history data is in the PowerPivot service application database for the PowerPivot service application.</span></span> <span data-ttu-id="81119-336">Para obtener más información sobre cómo se recopilan y almacenan los datos de uso, vea [recopilación de datos de uso de PowerPivot](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span><span class="sxs-lookup"><span data-stu-id="81119-336">For more information about how usage data is collected and stored, see [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span></span>

##  <a name="reschedule-the-powerpivot-data-refresh-timer-job"></a><a name="configTimerJob"></a><span data-ttu-id="81119-337">Volver a programar el trabajo del temporizador de actualización de datos PowerPivot</span><span class="sxs-lookup"><span data-stu-id="81119-337">Reschedule the PowerPivot Data Refresh timer job</span></span>
 <span data-ttu-id="81119-338">Un trabajo de temporizador de actualización de datos PowerPivot que examina la información de programación en la base de datos de aplicación de servicio PowerPivot desencadena una actualización de datos programada en intervalos de un minuto.</span><span class="sxs-lookup"><span data-stu-id="81119-338">Scheduled data refresh is triggered by a PowerPivot Data Refresh timer job that scans schedule information in the PowerPivot service application database at one minute intervals.</span></span> <span data-ttu-id="81119-339">Cuando la actualización de datos se programa para iniciarse, el trabajo de temporizador agrega la solicitud a una cola de procesamiento en un servidor de PowerPivot disponible.</span><span class="sxs-lookup"><span data-stu-id="81119-339">When data refresh is scheduled to begin, the timer job adds the request to a processing queue on an available PowerPivot server.</span></span>

 <span data-ttu-id="81119-340">Puede aumentar el intervalo de tiempo entre análisis como técnica de ajuste del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="81119-340">You can increase the length of time between scans as a performance tuning technique.</span></span> <span data-ttu-id="81119-341">También puede deshabilitar el trabajo de temporizador para detener las operaciones de actualización de datos temporalmente mientras solucione problemas.</span><span class="sxs-lookup"><span data-stu-id="81119-341">You can also disable the timer job to temporarily stop data refresh operations while you troubleshoot problems.</span></span>

 <span data-ttu-id="81119-342">La configuración predeterminada es un minuto, que es el valor mínimo que se puede especificar.</span><span class="sxs-lookup"><span data-stu-id="81119-342">The default setting is one minute, which is the lowest value you can specify.</span></span> <span data-ttu-id="81119-343">Se recomienda este valor porque proporciona el resultado más predecible para las programaciones que se ejecutan en momentos arbitrarios a lo largo del día.</span><span class="sxs-lookup"><span data-stu-id="81119-343">This value is recommended because it provides the most predictable outcome for schedules that run at arbitrary times throughout the day.</span></span> <span data-ttu-id="81119-344">Por ejemplo, si un usuario programa la actualización de datos para las 4:15 p.m. y el trabajo de temporizador busca programaciones cada minuto, la solicitud de actualización de datos programada se detectará a las 4:15 y el procesamiento se producirá pocos minutos después de las 4:15.</span><span class="sxs-lookup"><span data-stu-id="81119-344">For example, if a user schedules data refresh for 4:15 PM, and the timer job scans for schedules every minute, the scheduled data refresh request will be detected at 4:15 and processing will occur within a few minutes of 4:15.</span></span>

 <span data-ttu-id="81119-345">Si aumenta el intervalo de exploración de modo que se ejecute con muy poca frecuencia (por ejemplo, una vez al día a medianoche), todas las operaciones de actualización de datos que se programen para ejecutarse durante ese intervalo se agregarán a la cola de procesamiento a la vez, con lo que se podría sobrecargar el servidor y privar a otras aplicaciones de los recursos del sistema.</span><span class="sxs-lookup"><span data-stu-id="81119-345">If you raise the scan interval so that it runs very infrequently (for example, once a day at midnight), all of the data refresh operations that were scheduled to run during that interval are added to the processing queue all at once, potentially overwhelming the server and starving other applications of system resources.</span></span> <span data-ttu-id="81119-346">Según el número de actualizaciones programadas, la cola de procesamiento de las operaciones de actualización de datos podría aumentar hasta un punto en que no todos los trabajos puedan completarse.</span><span class="sxs-lookup"><span data-stu-id="81119-346">Depending on the number of scheduled refreshes, the processing queue for data refresh operations might build up to such an extent that not all jobs will be able to complete.</span></span> <span data-ttu-id="81119-347">Las solicitudes de actualización de datos al final de la cola podrían quitarse si se ejecutaran en el intervalo de procesamiento siguiente.</span><span class="sxs-lookup"><span data-stu-id="81119-347">Data refresh requests at the end of the queue might be dropped if they run into the next processing interval.</span></span>

 <span data-ttu-id="81119-348">Si el hardware lo admite, puede aliviar este problema especificando procesadores adicionales para ejecutar más trabajos de actualización de datos en paralelo.</span><span class="sxs-lookup"><span data-stu-id="81119-348">If your hardware supports it, you can mitigate this problem by specifying additional processors to run more data refresh jobs in parallel.</span></span> <span data-ttu-id="81119-349">Para obtener más información, vea [configurar la actualización de datos dedicada o el procesamiento de solo consultas &#40;PowerPivot para SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="81119-349">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span> <span data-ttu-id="81119-350">Para obtener más información sobre cómo se detectan las solicitudes de actualización de datos, se agregan a una cola y se procesan, vea [actualización de datos PowerPivot](power-pivot-sharepoint/power-pivot-data-refresh.md).</span><span class="sxs-lookup"><span data-stu-id="81119-350">For more information about how data refresh requests are discovered, added to a queue, and processed, see [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span></span>

1.  <span data-ttu-id="81119-351">En Administración central, haga clic en **Supervisión**.</span><span class="sxs-lookup"><span data-stu-id="81119-351">In Central Administration, click **Monitoring**.</span></span>

2.  <span data-ttu-id="81119-352">Haga clic en **revisar definiciones de trabajo**.</span><span class="sxs-lookup"><span data-stu-id="81119-352">Click **Review Job Definitions**.</span></span>

3.  <span data-ttu-id="81119-353">Seleccione el **trabajo de temporizador de actualización de datos PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="81119-353">Select the **PowerPivot Data Refresh Timer Job**.</span></span>

4.  <span data-ttu-id="81119-354">Modifique la frecuencia de programación para cambiar la frecuencia con que el trabajo de temporizador realiza los exámenes para obtener información de programación de la actualización de datos.</span><span class="sxs-lookup"><span data-stu-id="81119-354">Modify the schedule frequency to change how often the timer job scans for data refresh schedule information.</span></span>

##  <a name="disable-the-data-refresh-timer-job"></a><a name="bkmk_disableDR"></a><span data-ttu-id="81119-355">Deshabilitar el trabajo de temporizador de actualización de datos</span><span class="sxs-lookup"><span data-stu-id="81119-355">Disable the Data Refresh Timer Job</span></span>
 <span data-ttu-id="81119-356">El trabajo de temporizador de actualización de datos PowerPivot se realiza en el nivel de granja y se habilita o deshabilita para todas las instancias del servidor de PowerPivot de la granja.</span><span class="sxs-lookup"><span data-stu-id="81119-356">The PowerPivot data refresh timer job is a farm-level timer job that is either enabled or disabled for all PowerPivot server instances in the farm.</span></span> <span data-ttu-id="81119-357">No está asociado a ninguna aplicación web ni a ninguna aplicación de servicio PowerPivot concretas.</span><span class="sxs-lookup"><span data-stu-id="81119-357">It is not tied to a specific Web application or PowerPivot service application.</span></span> <span data-ttu-id="81119-358">No puede deshabilitarlo en algunos servidores para obligar a que se procese la actualización de datos en otros servidores de la granja.</span><span class="sxs-lookup"><span data-stu-id="81119-358">You cannot disable it on some servers to force data refresh processing to other servers in the farm.</span></span>

 <span data-ttu-id="81119-359">Si deshabilita el trabajo de temporizador de actualización de datos PowerPivot, las solicitudes que ya estaban en la cola se procesarán, pero no se agregará ninguna solicitud nueva hasta que vuelva a habilitar el trabajo.</span><span class="sxs-lookup"><span data-stu-id="81119-359">If you disable the PowerPivot data refresh timer job, requests that were already in the queue will be processed, but no new requests will be added until you re-enable the job.</span></span> <span data-ttu-id="81119-360">Las solicitudes que se programaran para producirse en el pasado no se procesan.</span><span class="sxs-lookup"><span data-stu-id="81119-360">Requests that were scheduled to occur in the past are not processed.</span></span>

 <span data-ttu-id="81119-361">Deshabilitar el trabajo de temporizador no tiene ningún efecto en la disponibilidad de las características de las páginas de aplicación.</span><span class="sxs-lookup"><span data-stu-id="81119-361">Disabling the timer job has no effect on feature availability in application pages.</span></span> <span data-ttu-id="81119-362">No hay ninguna manera de quitar u ocultar la característica de actualización de datos en las aplicaciones web.</span><span class="sxs-lookup"><span data-stu-id="81119-362">There is no way to remove or hide the data refresh feature in web applications.</span></span> <span data-ttu-id="81119-363">Los usuarios que tengan permisos para contribuir o superiores todavía podrán crear nuevas programaciones para las operaciones de actualización de datos, aun cuando el trabajo de temporizador se deshabilite de forma permanente.</span><span class="sxs-lookup"><span data-stu-id="81119-363">Users who have Contribute permissions or above will still be able to create new schedules for data refresh operations, even if the timer job is permanently disabled.</span></span>

## <a name="see-also"></a><span data-ttu-id="81119-364">Consulte también</span><span class="sxs-lookup"><span data-stu-id="81119-364">See Also</span></span>
 <span data-ttu-id="81119-365">[Programar una actualización de datos &#40;PowerPivot para SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [configurar la actualización de datos dedicada o el procesamiento de solo consulta &#40;PowerPivot para SharePoint](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)&#41;[configurar la cuenta de actualización de datos desatendida de PowerPivot &#40;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) PowerPivot para SharePoint&#41;[configurar credenciales almacenadas para la actualización de datos PowerPivot](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) &#40;PowerPivot para SharePoint</span><span class="sxs-lookup"><span data-stu-id="81119-365">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)</span></span>


